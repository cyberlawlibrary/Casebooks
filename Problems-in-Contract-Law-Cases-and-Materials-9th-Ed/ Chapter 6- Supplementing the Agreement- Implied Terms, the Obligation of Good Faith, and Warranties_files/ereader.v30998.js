var checkSaveHighlight=!1,checkSaveNote=!1,checkUpdateHighlight=!1,checkUpdateNote=!1,checkDeleteHighlight=!1,checkDeleteNote=!1,checkSaveBrief=!1,checkSaveBriefNote=!1,checkUpdateBriefHighlight=!1,checkUpdateBriefNote=!1,checkDeleteBriefHighlight=!1,checkDeleteBriefNote=!1,saveHighlightsRequestData=null,saveBriefRequestData=null,allExistingAnnotationUniqueVal=[],allExistingBriefAnnotationUniqueVal=[],insideGlobalSearchResult=!1,insideBarCheck=!1,comingFromBackToPage=!1,insideTouchDevices=!1,currentPageNumIE,refreshPressedTrue,insideManageConnection=!1,comingFromDiffChapterAnnotation=!1,timer;function showHideToolbar(){timer=setTimeout(function(){insideEreader&&0===$("div.popover:visible").length&&($("#ebook-toc").popover("hide"),$("#ebook-toc-mobile").popover("hide"),$(".ebook-fontsize").popover("hide"),$(".rTsIconPopover").popover("hide"),$(document).popover("hide"),$(".ebook-search").popover("hide"),$(".ereader-chapter-list").popover("hide"))},3)}function unHideToolbar(){topOffset=157,clearTimeout(timer),$(window).trigger("resize")}function checkForChapterLoad(evt){var contextValue=evt.target;if(CaseConnect.loadPageNumber="","previous"===$(contextValue).attr("data-value")){CaseConnect.loadPageNumber=CaseConnect.previousChapterEndPageNumber;var handler="loadChapter",request={},data={};request.url="/bookContentRetrievalService/getBookContent",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=data,request.handler.request.apply(null,[request]),Utility.fireRequest(request)}else if("next"===$(contextValue).attr("data-value")){CaseConnect.loadPageNumber=CaseConnect.nextChapterStartPageNumber;var handler="loadChapter",request={},data={};request.url="/bookContentRetrievalService/getBookContent",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=data,request.handler.request.apply(null,[request]),Utility.fireRequest(request)}}function handleGotoPage(e,o){o?"goToPageTop"===o.currentTarget.getAttribute("goToPageTop")&&(CaseConnect.goToPageTop="goToPageTop"):CaseConnect.goToPageTop="";$(".ereader-chapter-list").popover("hide"),$(".ereader-chapter-list").find(".toggle-up-down").addClass("glyphicon-menu-down").removeClass("glyphicon-menu-up");var t=parseInt(e.toString(),10)?parseInt(e.toString(),10):e.toString();if("string"==typeof t&&-1!==t.indexOf("c")&&(t=t.toUpperCase()),document.getElementById("page-"+t)){comingFromBackToPage?comingFromBackToPage=!1:(CaseConnect.pageViewedHistory=[],CaseConnect.pageViewedHistory[0]={pagenum:CaseConnect.currentPageNumber,url:CaseConnect.currentPageHtmlLocation.split("#")[0]}),$("ol.epub-parenlistlcletter li").addClass("goToPageBug"),$("ol.epub-parenlistucletter li").addClass("goToPageBug"),$("ol.epub-parenlistdecimal li").addClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").addClass("goToPageBug"),$("ol.epub-ucletter li").addClass("goToPageBug"),$("ol.epub-lcletter li").addClass("goToPageBug"),$("ol.epub-ucroman li").addClass("goToPageBug"),$("ol.epub-lcroman li").addClass("goToPageBug"),$("ol.epub-decimal li").addClass("goToPageBug"),$(".epub-law-case-marker").addClass("goToPageBug"),$(".epub-law-heading-container").addClass("goToPageBug");var a=document.getElementById("page-"+t),n=document.getElementById("ereader-scroller"),s=a.offsetTop,i=$("#tab-section-container")[0].offsetTop,r=(a.offsetLeft,"");r=parseInt(s)>parseInt(i)?s:i,n.scrollTop=r,$("#btnGoToBack").attr("disabled",!1),$("#btnGoToBack").css("visibility","visible"),$("#btnGoToBackMobile").attr("disabled",!1),$("#btnGoToBackMobile").css("visibility","visible"),$("ol.epub-parenlistlcletter li").removeClass("goToPageBug"),$("ol.epub-parenlistucletter li").removeClass("goToPageBug"),$("ol.epub-parenlistdecimal li").removeClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").removeClass("goToPageBug"),$("ol.epub-ucletter li").removeClass("goToPageBug"),$("ol.epub-lcletter li").removeClass("goToPageBug"),$("ol.epub-ucroman li").removeClass("goToPageBug"),$("ol.epub-lcroman li").removeClass("goToPageBug"),$("ol.epub-decimal li").removeClass("goToPageBug"),$(".epub-law-case-marker").removeClass("goToPageBug"),$(".epub-law-heading-container").removeClass("goToPageBug")}else{fetchingAnnotationsForListing=!1;var c=parseInt(e.toString(),10)?parseInt(e.toString(),10):e.toString();"string"==typeof c&&-1!==c.indexOf("c")&&(c=c.toUpperCase()),"Internet Explorer"===CaseConnect.browserName?setTimeout(function(){comingFromBackToPage||(CaseConnect.currentPageHtmlLocation!==CaseConnect.tocPath?(CaseConnect.pageViewedHistory=[],CaseConnect.pageViewedHistory[0]={pagenum:CaseConnect.currentPageNumber,url:CaseConnect.currentPageHtmlLocation.split("#")[0]}):CaseConnect.pageViewedHistory.push({pagenum:CaseConnect.currentPageNumber,url:CaseConnect.currentPageHtmlLocation.split("#")[0]}))},1e3):comingFromBackToPage||(CaseConnect.currentPageHtmlLocation!==CaseConnect.tocPath?(CaseConnect.pageViewedHistory=[],CaseConnect.pageViewedHistory[0]={pagenum:CaseConnect.currentPageNumber,url:CaseConnect.currentPageHtmlLocation.split("#")[0]}):CaseConnect.pageViewedHistory.push({pagenum:CaseConnect.currentPageNumber,url:CaseConnect.currentPageHtmlLocation.split("#")[0]}));var l={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),streamContentRequiredFlag:map.isIE9,userActivityVO:{lastActivityCode:"EREADER_READING_BOOK",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId,bookISBN:CaseConnect.currentBookIsbn,pageNumber:c}};$("#page-loading-spinner").show(),$.ajax({url:properties[properties.env]+"/bookContentRetrievalService/getBookContent",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(l)}).then(function(o){if(o&&localStorage.setItem("ChapterId",o.bookVO.chapterId),sessionTimeOut(),void 0!==o.sessionAuthenticationToken&&("true"==o.resourceFlag&&(CaseConnect.resourceFlag,o.resourceFlag,$(".resourceMenushow").removeClass("resourceMenuhide")),null!=o.hasPCaseAnnotation&&null!=o.hasPCaseAnnotation&&("true"==o.hasPCaseAnnotation?CaseConnect.hasPCaseAnnotation="true":CaseConnect.hasPCaseAnnotation="false"),void 0!==o.casesFlag&&(CaseConnect.casesFlag=o.casesFlag,"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide()),void 0!==o.newsFeedFlag?(CaseConnect.newsFeedFlag=o.newsFeedFlag,"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide()):$(".hide-news-feed-class").hide(),localStorage.setItem("sessionAuthenticationToken",o.sessionAuthenticationToken)),"false"===o.status)sessionAuthFails(o),Utility.handleSessionAuthentication(o.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(o.responseJSON.errorMessg)):window.location=properties.ui_domain,$(window).trigger("resize");else if(CaseConnect.bookData=o.bookVO,CaseConnect.chapterTitle=o.bookVO.chapterTitle,CaseConnect.nextChapterStartPageNumber=o.bookVO.nextChapterStartPageNumber,CaseConnect.previousChapterEndPageNumber=o.bookVO.previousChapterEndPageNumber,CaseConnect.currentChapterEndPageNumber=o.bookVO.chapterEndPageNumber,CaseConnect.nextChapterNumber=o.bookVO.nextChapterNumber,CaseConnect.nextChapterTitle=o.bookVO.nextChapterTitle,CaseConnect.bookType=o.bookVO.bookType,CaseConnect.resourceFlag=o.resourceFlag,CaseConnect.casesFlag=o.casesFlag,CaseConnect.newsFeedFlag=o.newsFeedFlag,CaseConnect.currentBookId,"Internet Explorer"===CaseConnect.browserName)setTimeout(function(){if(""!==c?(CaseConnect.currentPageNumber=isNaN(parseInt(e.toString(),10))?e.toString():parseInt(e.toString(),10),"string"==typeof CaseConnect.currentPageNumber&&-1!==CaseConnect.currentPageNumber.indexOf("c")&&(CaseConnect.currentPageNumber=CaseConnect.currentPageNumber.toUpperCase())):"string"==typeof(c=CaseConnect.currentPageNumber)&&-1!==c.indexOf("c")&&(c=c.toUpperCase()),""===CaseConnect.bookData.pageHtmlLocation)$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.invalidPageNo);else{if(!0===map.isIE9){var t=o.bookVO.htmlPageContent;t.split("</head>")[1]&&$("#tab-section-container").html(t.split("</head>")[1]),CaseConnect.currentPageHtmlLocation="/casebook"+o.bookVO.pageHtmlLocation.split("?")[0].split("/casebook")[1]}else fetchDataFromCDNUrl(o.bookVO.pageHtmlLocation),CaseConnect.currentPageHtmlLocation="/casebook"+o.bookVO.pageHtmlLocation.split("?")[0].split("/casebook")[1];comingFromBackToPage?comingFromBackToPage=!1:($("#btnGoToBack").attr("disabled",!1),$("#btnGoToBack").css("visibility","visible"),$("#btnGoToBackMobile").attr("disabled",!1),$("#btnGoToBackMobile").css("visibility","visible")),updateChapterNameandDetails(),getAnnotatableChapterAndSupplementalList()}},5e3);else if(""!==c?(CaseConnect.currentPageNumber=isNaN(parseInt(e.toString(),10))?e.toString():parseInt(e.toString(),10),"string"==typeof CaseConnect.currentPageNumber&&-1!==CaseConnect.currentPageNumber.indexOf("c")&&(CaseConnect.currentPageNumber=CaseConnect.currentPageNumber.toUpperCase())):"string"==typeof(c=CaseConnect.currentPageNumber)&&-1!==c.indexOf("c")&&(c=c.toUpperCase()),""===CaseConnect.bookData.pageHtmlLocation)$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.invalidPageNo);else{if(!0===map.isIE9){var t=o.bookVO.htmlPageContent;t.split("</head>")[1]&&$("#tab-section-container").html(t.split("</head>")[1]),CaseConnect.currentPageHtmlLocation="/casebook"+o.bookVO.pageHtmlLocation.split("?")[0].split("/casebook")[1]}else fetchDataFromCDNUrl(o.bookVO.pageHtmlLocation),CaseConnect.currentPageHtmlLocation="/casebook"+o.bookVO.pageHtmlLocation.split("?")[0].split("/casebook")[1];comingFromBackToPage?comingFromBackToPage=!1:($("#btnGoToBack").attr("disabled",!1),$("#btnGoToBack").css("visibility","visible"),$("#btnGoToBackMobile").attr("disabled",!1),$("#btnGoToBackMobile").css("visibility","visible")),updateChapterNameandDetails(),getAnnotatableChapterAndSupplementalList()}},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}setTimeout(function(){$(window).width()<768&&($("head meta[name=viewport]").remove(),$("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=1,  user-scalable=1" />'))},500)}function changePageFont(){$(".ebook-fontsize").popover({html:!0,placement:"bottom",container:"body",template:'<div class="popover ebook-custom-popover ereader-font-change-popover" aria-label="Font Size" aria-hidden="true" tabindex="-1" role="dialog"><div class="popover-content popover-without-padding"></div></div>',content:function(){return $("#display-options-popover").html()}}),$(".ebook-fontsize").on("shown.bs.popover",function(){if(document.addEventListener("focus",function(e){var o=document.getElementsByClassName("ereader-font-change-popover")[0];null!=o&&(o.contains(e.target)||(e.stopPropagation(),o.focus()))},!0),focusNavInEreader=!0,"block"==$("#email-notification").css("display")){var e=$(".email-notification").height();$(".ereader-font-change-popover").css("margin-top",e+10)}else"none"==$("#email-notification").css("display")&&$(".ereader-font-change-popover").css("margin-top","10px")})}function changePageFontMobile(){insideEreader&&closeOverlayInMobile("ereader-nav-menu-mobile"),$(".mobile-read-menu-dropdown").hide(),changePageFont()}function searchBookTextMobile(){insideEreader&&closeOverlayInMobile("ereader-nav-menu-mobile"),searchBookText(),$(".mobile-read-menu-dropdown").hide()}function searchBookText(){$(".ebook-search").popover({html:!0,placement:"bottom",container:"body",template:'<div class="popover ebook-custom-popover search-popover" aria-hidden="true" tabindex="0" role="dialog" aria-label="Search Window"><div class="popover-content popover-without-padding popover-search-textbox-wrapper"></div></div>',content:function(){return $("#search-content-wrapper").html()}}),$(".popover-search-field").addClass("search-field-background"),$(".popover-search-field").placeholder("Search"),$(".ereader-text-search-cancel").hide()[1],$(".ebook-search").on("shown.bs.popover",function(){if(setTimeout(function(){var e;e=$("input#search-text")[0].value,$("input#search-text")[1].value="",$("input#search-text")[1].focus(),$("input#search-text")[1].click(),$("input#search-text")[1].value=e},150),"block"==$("#email-notification").css("display")){var e=$(".email-notification").height();$(".search-popover").css("margin-top",e+10)}else"none"==$("#email-notification").css("display")&&$(".search-popover").css("margin-top","10px")}),0===$(".search-result-list").children().length&&(searchedTextSaved=null),""!=$(".resultFound").html()?($(".search-result").show(),$(".search-loading-spinner").hide()):$(".search-result").hide(),searchBookTextInEreader(),focusNavInEreader=!0,$(".ebook-search").attr("title","Search")}function showGotoMenu(e){$("#ebook-toc").popover({html:!0,placement:"bottom",container:"body",template:'<div class="popover go-to-popover ebook-custom-popover search-popover ereader-menu-popover-desktop" role="dialog" tabindex="-1" aria-hidden="true" aria-label="Notes & Highlights" id=""><div id="ereader-menu-popover-content" class="popover-content ereader-menu-popover"></div></div>',content:function(){return $("#popover-note-highlight-content").html()}}),void 0!==e?showNotesHiglightpopover():$("#ereader-menu-popover-content div.notes-highlights-popover-content").html("")}function showGotoMenuMobile(e){insideEreader&&closeOverlayInMobile("ereader-nav-menu-mobile"),$("#ebook-toc-mobile").popover({html:!0,placement:"bottom",container:".ereader",template:'<div class="popover go-to-popover ebook-custom-popover search-popover ereader-menu-popover-mobile" role="dialog" tabindex="-1" aria-hidden="true" aria-label="Notes & Highlights" id=""><div id="ereader-menu-popover-content" class="popover-content ereader-menu-popover"></div></div>',content:function(){return $("#popover-note-highlight-content").html()}}),void 0!==e?showNotesHiglightpopover():$("#ereader-menu-popover-content div.notes-highlights-popover-content").html(""),$("#ereader-nav-menu-mobile").modal("hide")}function scrollTolastVisitedpage(){gotoPageFnCald&&(CaseConnect.currentPageNumber=currentPageNumb),"string"==typeof CaseConnect.currentPageNumber&&-1!==CaseConnect.currentPageNumber.indexOf("c")&&(CaseConnect.currentPageNumber=CaseConnect.currentPageNumber.toUpperCase());var e=document.getElementById("page-"+CaseConnect.currentPageNumber),o=document.getElementById("ereader-scroller");if(e){$("ol.epub-parenlistlcletter li").addClass("goToPageBug"),$("ol.epub-parenlistucletter li").addClass("goToPageBug"),$("ol.epub-parenlistdecimal li").addClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").addClass("goToPageBug"),$("ol.epub-ucletter li").addClass("goToPageBug"),$("ol.epub-lcletter li").addClass("goToPageBug"),$("ol.epub-ucroman li").addClass("goToPageBug"),$("ol.epub-lcroman li").addClass("goToPageBug"),$("ol.epub-decimal li").addClass("goToPageBug"),$(".epub-law-case-marker").addClass("goToPageBug"),$(".epub-law-heading-container").addClass("goToPageBug");var t=e.offsetTop,a=$("#tab-section-container")[0].offsetTop,n="";"Internet Explorer"===CaseConnect.browserName?setTimeout(function(){n=parseInt(t)>parseInt(a)?"toc"===CaseConnect.bookData.chapterType||"Contents"===CaseConnect.chapterTitle||"CONTENTS"===CaseConnect.chapterTitle?0:t:"toc"===CaseConnect.bookData.chapterType?0:a,o.scrollTop=n,$("#txtPageNum").val(CaseConnect.currentPageNumber),$("#txtPageNumMobile").val(CaseConnect.currentPageNumber)},500):(n=parseInt(t)>parseInt(a)?"toc"===CaseConnect.bookData.chapterType?0:e.offsetTop:"toc"===CaseConnect.bookData.chapterType?0:a,o.scrollTop=n),$("#txtPageNum").val(CaseConnect.currentPageNumber),$("#txtPageNumMobile").val(CaseConnect.currentPageNumber),$("ol.epub-parenlistlcletter li").removeClass("goToPageBug"),$("ol.epub-parenlistucletter li").removeClass("goToPageBug"),$("ol.epub-parenlistdecimal li").removeClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").removeClass("goToPageBug"),$("ol.epub-ucletter li").removeClass("goToPageBug"),$("ol.epub-lcletter li").removeClass("goToPageBug"),$("ol.epub-ucroman li").removeClass("goToPageBug"),$("ol.epub-lcroman li").removeClass("goToPageBug"),$("ol.epub-decimal li").removeClass("goToPageBug"),$(".epub-law-case-marker").removeClass("goToPageBug"),$(".epub-law-heading-container").removeClass("goToPageBug")}gotoPageFnCald=!1}function handleGotoMenu(){if($("#ereader-nav-menu-mobile").modal("hide"),$("#outline-nav-menu-mobile").modal("hide"),$("#themis-nav-menu-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),"toc"!==CaseConnect.bookData.chapterType){CaseConnect.pageViewedHistory=[],CaseConnect.pageViewedHistory[0]={pagenum:CaseConnect.currentPageNumber,url:CaseConnect.currentPageHtmlLocation.split("#")[0]};CaseConnect.currentPageHtmlLocation="/casebook"+CaseConnect.tocPath.split("?")[0].split("/casebook")[1],CaseConnect.currentPageNumber=$(".cc-pagenum-begin")[0].title,$(".notesText").remove(),$(".notesSpanBlock").remove(),$("#btnGoToBack").attr("disabled",!1),$("#btnGoToBack").css("visibility","visible"),$("#btnGoToBackMobile").attr("disabled",!1),$("#btnGoToBackMobile").css("visibility","visible"),$("#ebook-toc").popover("hide"),$("#ebook-toc-mobile").popover("hide"),CaseConnect.bookData.chapterType="toc",fetchTOCData("toc")}else $("#ebook-toc").popover("hide"),$("#ebook-toc-mobile").popover("hide")}function backToPage(){var e=null;if(2==CaseConnect.pageViewedHistory.length){e=CaseConnect.pageViewedHistory.pop(),$("#page-loading-spinner").show();var o="toc";fetchTOCData(o),CaseConnect.currentPageHtmlLocation="/casebook"+CaseConnect.tocPath.split("?")[0].split("/casebook")[1],CaseConnect.currentPageNumber=e.pagenum,CaseConnect.currentPageHtmlLocation=e.url,CaseConnect.bookData.chapterType="toc"}else if(1==CaseConnect.pageViewedHistory.length){if(e=CaseConnect.pageViewedHistory[0],document.getElementById("page-"+e.pagenum))CaseConnect.currentPageNumber=e.pagenum,currentPageNumb=e.pagenum,scrollTolastVisitedpage();else if(e.url===CaseConnect.tocPath){$("#page-loading-spinner").show();o="toc";fetchTOCData(o),CaseConnect.currentPageHtmlLocation="/casebook"+CaseConnect.tocPath.split("?")[0].split("/casebook")[1],CaseConnect.currentPageNumber=e.pagenum,CaseConnect.currentPageHtmlLocation=e.url,CaseConnect.bookData.chapterType="toc"}else comingFromBackToPage=!0,CaseConnect.goToPageTop="",handleGotoPage(e.pagenum),$("#btnGoToBack").attr("disabled",!0),$("#btnGoToBack").css("visibility","hidden"),$("#btnGoToBackMobile").attr("disabled",!0),$("#btnGoToBackMobile").css("visibility","hidden");CaseConnect.pageViewedHistory=[],$("#btnGoToBack").attr("disabled",!0),$("#btnGoToBack").css("visibility","hidden"),$("#btnGoToBackMobile").attr("disabled",!0),$("#btnGoToBackMobile").css("visibility","hidden"),$("#txtPageNum").val(e.pagenum),$("#txtPageNumMobile").val(e.pagenum)}}function loadEreaderFromLogin(e){if(highLightColor="#ede48c",searchedTextSaved=null,$(".ereader-main-header-title").html(""),Handler.login.removeUnderlineStyle(),void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),e.userActivityVO&&(null!=e.userActivityVO.hasPCaseAnnotation&&null!=e.userActivityVO.hasPCaseAnnotation&&("true"==e.userActivityVO.hasPCaseAnnotation?CaseConnect.hasPCaseAnnotation="true":CaseConnect.hasPCaseAnnotation="false"),e.userActivityVO.userSettingsVO&&e.userActivityVO.userSettingsVO.prefferedHighlightColor&&(highLightColor=e.userActivityVO.userSettingsVO.prefferedHighlightColor),null!=e.userActivityVO.userSettingsVO&&null!=e.userActivityVO.userSettingsVO&&("true"==e.userActivityVO.userSettingsVO.briefModalFlag?CaseConnect.welcomeCaseBriefInEreader="true":CaseConnect.welcomeCaseBriefInEreader="false")),disableCopyPaste(),globalChapterAnnotationList="",globalChapterBriefList="",$(".annotations-not-present-msg").text(""),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),CaseConnect.sessionAuthenticationToken=localStorage.getItem("sessionAuthenticationToken"),CaseConnect.bookData=e.userActivityVO.bookVOList,CaseConnect.bookData.explodedEpubPath=e.userActivityVO.bookVOList.exploadedEpubPath,CaseConnect.currentPageNumber=e.userActivityVO.bookVOList.lastReadPageNum,CaseConnect.currentBookId=e.userActivityVO.bookVOList.bookId,CaseConnect.bookType=e.userActivityVO.bookVOList.bookType,CaseConnect.resourceFlag=e.userActivityVO.resourceFlag,CaseConnect.casesFlag=e.userActivityVO.casesFlag,CaseConnect.newsFeedFlag=e.userActivityVO.newsFeedFlag,CaseConnect.tocPath=e.userActivityVO.bookVOList.tocPath,CaseConnect.chapterTitle=e.userActivityVO.bookVOList.chapterTitle,CaseConnect.nextChapterStartPageNumber=e.userActivityVO.bookVOList.nextChapterStartPageNumber,CaseConnect.previousChapterEndPageNumber=e.userActivityVO.bookVOList.previousChapterEndPageNumber,CaseConnect.currentChapterEndPageNumber=e.userActivityVO.bookVOList.chapterEndPageNumber,CaseConnect.nextChapterNumber=e.userActivityVO.bookVOList.nextChapterNumber,CaseConnect.nextChapterTitle=e.userActivityVO.bookVOList.nextChapterTitle,CaseConnect.preSetBriefLabelList=e.userActivityVO.labelVOList,CaseConnect.tocPath="/casebook"+CaseConnect.tocPath.split("?")[0].split("/casebook")[1],CaseConnect.bookTitle=CaseConnect.bookData.bookTitle,$("#page-loading-spinner").show(),map.wk_conatiner.load("ereader-header.html?v18453",function(){var e=Handlebars.getTemplate("ereader-content")();$(this).find("#ereader-container").append(e);(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide(),$(".hide-news-feed-class").hide(),"true"==CaseConnect.resourceFlag?($(".resourceMenushow").removeClass("resourceMenuhide"),$(".hide-ereader-class").show()):$(".hide-ereader-class").hide()),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),$(window).trigger("resize"),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide()}),"Internet Explorer"===CaseConnect.browserName&&(currentPageNumIE=CaseConnect.currentPageNumber),!0===map.isIE9){var o=e.userActivityVO.bookVOList.htmlPageContent;o.split("</head>")[1]&&setTimeout(function(){$("#tab-section-container").html(o.split("</head>")[1])},2e3),CaseConnect.currentPageHtmlLocation="/casebook"+e.userActivityVO.bookVOList.pageHtmlLocation.split("?")[0].split("/casebook")[1]}else setTimeout(function(){fetchDataFromCDNUrl(e.userActivityVO.bookVOList.pageHtmlLocation)},2e3),CaseConnect.currentPageHtmlLocation="/casebook"+e.userActivityVO.bookVOList.pageHtmlLocation.split("?")[0].split("/casebook")[1];if(!insideStaticPage){var t=$(window).width(),a=$(".main-container").width();t<768&&t>=a?$("#header-wrapper").hide():$("#header-wrapper").show()}setTimeout(function(){$(".ereader-main-header-title").html(CaseConnect.bookData.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle),$(".ereader-sub-header-total-pages").html(CaseConnect.bookData.totalChapterPageCount),null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&checkNewsFeedInApp(),expiryDate(),getMyRequestNoftificationCount(),bookChapterList=null,bookAnnotateFileList=null,bookChapterSupplimentList=null,loadDataListInPopover(),getChapterList(),getAnnotatableChapterAndSupplementalList(),getChapterAndSupplementalList(),topOffset=157,addEventListenerForIpadandAndroid(),updateChapterNameandDetails()},2e3)}function updateChapterNameandDetails(){var e=$(".ereader-content").height()+31;if($("#media-elements-column").css("height",e),-1!=navigator.userAgent.indexOf("iPad")?insideTouchDevices=!0:-1!=navigator.userAgent.indexOf("Android")&&(insideTouchDevices=!0),insideTouchDevices||showHideToolbar(),changePageFont(),searchBookText(),showGotoMenu(),showGotoMenuMobile(),gotoChapterRead(),showMessageNotificationAlert(),$("#links-container").empty(),$("#notes-container").empty(),$("#media-elements-column").empty(),$("#nextChapterFromBottomPage").empty(),$(".video-panel").empty(),CaseConnect.currentChapterTitle=CaseConnect.bookData.chapterTitle,CaseConnect.currentChapterId=CaseConnect.bookData.chapterId,"Contents"===CaseConnect.chapterTitle&&(CaseConnect.currentPageNumber=CaseConnect.bookData.chapterStartPageNumber,$(window).trigger("resize")),setTimeout(function(){loadImagesFromCDN()},2),"chapter"===CaseConnect.bookData.chapterType||"true"===CaseConnect.bookData.isAnnotatable){"Internet Explorer"===CaseConnect.browserName||"Chrome"===CaseConnect.browserName?$(".ereader-page-number-container").css("top","5px"):"Mac OS X"!==CaseConnect.deviceOS&&"iOS"!==CaseConnect.deviceOS||"Safari"!==CaseConnect.browserName||($(".ereader-sub-header-pageno").css("padding-top","5px"),$(".ereader-page-number-container").css("top","4px"));var o=null;document.getElementById("tab-section-container").getElementsByClassName("cc-chapter-title").length>0&&(o=document.getElementById("tab-section-container").getElementsByClassName("cc-chapter-title")[0].offsetTop+30),"textsize-default"!==currentFontId&&calculateFontSizeAndLineHeight(currentFontId),CaseConnect.bookTitle=CaseConnect.bookData.bookTitle,$(".chapter-navigation-top").css("margin-top",o),$("#previous-chapter-button").show(),$("#previous-chapter-button-bottom").show(),$("#next-chapter-button").show(),$("#next-chapter-button-bottom").show(),$(".ereader-page-number-container").show(),$(".ereader-section-title").show(),$(".ereader-main-header-title").html(CaseConnect.bookData.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle);CaseConnect.bookData.chapterNumber;$(".ereader-chapter-title").html(CaseConnect.bookData.navbarTitle),$(".ereader-booktitle-mobile").html(CaseConnect.bookData.bookTitle),$(".cc-pagenum-begin")&&$(".cc-pagenum-begin").length>=1?$(".ereader-page-number").html($(".cc-pagenum-begin")[0].title):$(".ereader-page-number").html($(".cc-pagenum-begin").title),$(".cc-section-title")&&$(".cc-section-title").length>=1?$(".ereader-section-title").html($(".cc-section-title")[0].textContent):$(".ereader-section-title").html($(".cc-section-title").textContent),$("#ebook-toc").attr("disabled",!1),$("#ebook-toc-mobile").attr("disabled",!1)}else{$("#page-loading-spinner").show(),"chapter_title_not_found"===CaseConnect.chapterTitle&&(CaseConnect.chapterTitle="Contents"),$("#nextChapterFromBottomPage").empty();CaseConnect.bookData.chapterNumber;$(".ereader-chapter-title").html(CaseConnect.bookData.navbarTitle),$(".ereader-booktitle-mobile").html(CaseConnect.bookData.bookTitle),$(".ereader-page-number-container").hide(),$(".ereader-section-title").hide()}saveUserLastActivity()}function loadImagesFromCDN(){if(CaseConnect.imgUrl=[],CaseBookConnect.imgTags,insideEreader)var e=$("#tab-section-container").find("img");if(insideCasesPage)e=$("#case-excerpt-block-cases").find("img");CaseBookConnect.imgTags=e,null!=e&&e.each(function(e,o){var t={genericServiceRequestVO:{inputBaseUrl:("/casebook/"+CaseConnect.bookData.bookISBN+"/ex-epub/OPS/images"+o.src.split("/images")[1]).split("?")[0]}};$.ajax({url:properties[properties.env]+"/manageUrlService/getCDNUrl",type:"POST",contentType:"application/json",accept:"application/json",async:!0,data:JSON.stringify(t)}).then(function(e){"true"===e.status&&CaseBookConnect.imgTags.each(function(o,t){-1!=e.genericServiceResponseVO.cdnUrl.indexOf(t.src.split("/images")[1])&&(t.src=e.genericServiceResponseVO.cdnUrl)})},function(e){alert(e.errorMessg)})}),insideEreader&&("chapter"===CaseConnect.bookData.chapterType||"true"===CaseConnect.bookData.isAnnotatable?(annotationListingChapterId=CaseConnect.currentChapterId,fetchAnnotations(CaseConnect.currentChapterId)):setTimeout(function(){if(CaseConnect.currentPageNumber=CaseConnect.bookData.chapterStartPageNumber,$("#txtPageNum").val(CaseConnect.currentPageNumber),$("#txtPageNumMobile").val(CaseConnect.currentPageNumber),$(window).trigger("resize"),document.getElementById("next-chapter-button-bottom"))if(bookChapterSupplimentList)for(var e=0;e<bookChapterSupplimentList.length;e++)CaseConnect.currentChapterId===bookChapterSupplimentList[e].chapterId&&bookChapterSupplimentList[e+1]&&($("#nextChapterFromBottomPage")[0].innerHTML=bookChapterSupplimentList[e+1].navbarTitle,CaseConnect.nextChapterStartPageNumber!==bookChapterSupplimentList[e+1].strStartPageNumber&&(CaseConnect.nextChapterStartPageNumber=bookChapterSupplimentList[e+1].strStartPageNumber));else getChapterAndSupplementalList();$("#page-loading-spinner").hide()},5e3))}function printDiv(e){$('[data-toggle="popover"]').each(function(){$(this).popover("hide")});var o=document.body.innerHTML;defaultFont();var t=document.getElementsByClassName(e)[0].innerHTML;document.body.innerHTML='<div style="text-align:justify; border-radius:5px; border: 1px solid #CCC; padding: 0 0 0 33px;">'+t+"</div>",window.print(),document.body.innerHTML=o,$(".go-to-popover").remove(),$(".search-popover").remove(),$(".ebook-custom-popover").remove(),changePageFont(),searchBookText(),showGotoMenu(),gotoChapterRead(),showGotoMenuMobile(),showMessageNotificationAlert(),scrollTolastVisitedpage(),$("#txtPageNum").val(CaseConnect.currentPageNumber),$("#txtPageNumMobile").val(CaseConnect.currentPageNumber),$(".highlightedText").each(function(){this.addEventListener("mouseup",highLightedTextClick)}),$(".anchorElementText").each(function(){this.addEventListener("mouseup",linkTextClick)}),$(".briefElementText").each(function(){this.addEventListener("mouseup",briefTextClicked)}),map.wk_conatiner=$("#wk_content"),map["loading-spinner"]=$("#page-loading-spinner"),map["content-wrapper"]=$("#content-wrapper"),map["ereader-container"]=$("#ereader-container"),map.wk_conatiner=$("#wk_content"),map.overlay=$(".popover-box-wrapper"),map.bookAccessCode=localStorage.bookAccessCode}function bookSpecificFeatureDisplay(){"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".ereader-heading-pipes").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide(),"true"==CaseConnect.resourceFlag?($(".resourceMenushow").removeClass("resourceMenuhide"),$(".hide-ereader-class").show()):$(".hide-ereader-class").hide()),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),adminSuppressFunc()}Handler.loadEreader={request:function(e){CaseConnect.outlineTimer&&clearTimeout(CaseConnect.outlineTimer),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#outline-nav-menu-mobile").modal("hide"),$("#themis-nav-menu-mobile").modal("hide"),$("#study-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),$(".ereader-main-header-title").html(""),e.data={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),streamContentRequiredFlag:map.isIE9,userActivityVO:{lastActivityCode:"EREADER_READING_BOOK",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{}},insideGlobalSearchResult&&CaseConnect.currentBookIsbn?(e.data.bookVO.bookISBN=CaseConnect.currentBookIsbn,e.data.bookVO.pageNumber=CaseConnect.currentPageNumber,""===CaseConnect.currentBookId&&null===CaseConnect.currentBookId||(e.data.bookVO.bookId=CaseConnect.currentBookId)):e.data.bookVO.bookId=CaseConnect.currentBookId,$("#page-loading-spinner").show()},response:function(e,o){if(globalChapterAnnotationList="",globalChapterBriefList="",(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),null!=e.hasPCaseAnnotation&&null!=e.hasPCaseAnnotation&&("true"==e.hasPCaseAnnotation?CaseConnect.hasPCaseAnnotation="true":CaseConnect.hasPCaseAnnotation="false"),expiryDate(),"true"==e.resourceFlag&&(CaseConnect.resourceFlag,e.resourceFlag,$(".resourceMenushow").removeClass("resourceMenuhide")),void 0!==e.casesFlag&&(CaseConnect.casesFlag,e.casesFlag),void 0!==e.newsFeedFlag&&(CaseConnect.newsFeedFlag,e.newsFeedFlag),null!=e.userSettingsVO&&null!=e.userSettingsVO&&("true"==e.userSettingsVO.briefModalFlag?CaseConnect.welcomeCaseBriefInEreader="true":CaseConnect.welcomeCaseBriefInEreader="false"),insideOutline=!1,insideGlobalSearchResult=!1,searchedTextSaved=null,Handler.login.removeUnderlineStyle(),void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),CaseConnect.outlineTimer&&clearTimeout(CaseConnect.outlineTimer),disableCopyPaste(),closeSearchText(),$(".annotations-not-present-msg").text(""),"false"===e.status)sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain;else if(e.bookVO){if(Utility.trackGA("read"),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),CaseConnect.sessionAuthenticationToken=localStorage.getItem("sessionAuthenticationToken"),CaseConnect.bookData=e.bookVO,CaseConnect.bookData.explodedEpubPath=e.bookVO.exploadedEpubPath,CaseConnect.currentPageNumber=e.bookVO.lastReadPageNum,CaseConnect.currentChapterId=e.bookVO.lastReadChapterId,CaseConnect.chapterTitle=e.bookVO.chapterTitle,CaseConnect.chapterId=e.bookVO.chapterId,CaseConnect.currentBookId=e.bookVO.bookId,CaseConnect.tocPath=e.bookVO.tocPath,CaseConnect.nextChapterStartPageNumber=e.bookVO.nextChapterStartPageNumber,CaseConnect.nextChapterNumber=e.bookVO.nextChapterNumber,CaseConnect.nextChapterTitle=e.bookVO.nextChapterTitle,CaseConnect.currentChapterEndPageNumber=e.bookVO.chapterEndPageNumber,CaseConnect.previousChapterEndPageNumber=e.bookVO.previousChapterEndPageNumber,CaseConnect.bookType=e.bookVO.bookType,CaseConnect.resourceFlag=e.resourceFlag,CaseConnect.casesFlag=e.casesFlag,CaseConnect.newsFeedFlag=e.newsFeedFlag,CaseConnect.freeTrialFlag=e.bookVO.freeTrialFlag,CaseConnect.adminStudyFlag=e.bookVO.adminStudyFlag,CaseConnect.adminOutlineFlag=e.bookVO.adminOutlineFlag,CaseConnect.adminInsightsFlag=e.bookVO.adminInsightsFlag,CaseConnect.adminNewsFlag=e.bookVO.adminNewsFlag,localStorage.setItem("freeTrialFlag",CaseConnect.freeTrialFlag),localStorage.setItem("adminStudyFlag",CaseConnect.adminStudyFlag),localStorage.setItem("adminOutlineFlag",CaseConnect.adminOutlineFlag),localStorage.setItem("adminInsightsFlag",CaseConnect.adminInsightsFlag),localStorage.setItem("adminNewsFlag",CaseConnect.adminNewsFlag),highLightColor="#ede48c",CaseConnect.bookTitle=CaseConnect.bookData.bookTitle,CaseConnect.tocPath="/casebook"+CaseConnect.tocPath.split("?")[0].split("/casebook")[1],e.userSettingsVO&&e.userSettingsVO.prefferedHighlightColor&&(highLightColor=e.userSettingsVO.prefferedHighlightColor),"Internet Explorer"===CaseConnect.browserName&&(currentPageNumIE=CaseConnect.currentPageNumber),localStorage.setItem("ChapterId",CaseConnect.chapterId),map.wk_conatiner.load("ereader-header.html?v18453",function(){var e=Handlebars.getTemplate("ereader-content")();$(this).find("#ereader-container").append(e);(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".ereader-heading-pipes").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide(),$(".hide-news-feed-class").hide(),adminSuppressFunc(),"true"==CaseConnect.resourceFlag?($(".resourceMenushow").removeClass("resourceMenuhide"),$(".hide-ereader-class").show()):$(".hide-ereader-class").hide()),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),$(window).trigger("resize"),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),adminSuppressFunc()}),!0===map.isIE9){var t=e.bookVO.htmlPageContent;t.split("</head>")[1]&&setTimeout(function(){$("#tab-section-container").html(t.split("</head>")[1])},2e3),CaseConnect.currentPageHtmlLocation="/casebook"+e.bookVO.pageHtmlLocation.split("?")[0].split("/casebook")[1]}else setTimeout(function(){fetchDataFromCDNUrl(e.bookVO.pageHtmlLocation)},2e3),CaseConnect.currentPageHtmlLocation="/casebook"+e.bookVO.pageHtmlLocation.split("?")[0].split("/casebook")[1];if(!insideStaticPage){var a=$(window).width(),n=$(".main-container").width();a<768&&a>=n?$("#header-wrapper").hide():$("#header-wrapper").show()}setTimeout(function(){$(".ereader-main-header-title").html(CaseConnect.bookData.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle),$(".ereader-sub-header-total-pages").html(CaseConnect.bookData.totalChapterPageCount),null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(checkNewsFeedInApp(),expiryDate()),getMyRequestNoftificationCount(),bookChapterList=null,bookChapterSupplimentList=null,bookAnnotateFileList=null,loadDataListInPopover(),getChapterList(),getAnnotatableChapterAndSupplementalList(),getChapterAndSupplementalList(),updateChapterNameandDetails(),getUserSettingsForAnnotation(),document.getElementById("ereader-scroller").scrollTop=0,topOffset=157,addEventListenerForIpadandAndroid()},2e3)}}},Handler.goToTutorial={request:function(e){e.data={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),streamContentRequiredFlag:map.isIE9,userActivityVO:{lastActivityCode:"EREADER_READING_BOOK",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId,pageNumber:CaseConnect.currentPageNumber}}},response:function(e,o){void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),"false"===e.status?(sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain):($("#page-loading-spinner").hide(),$("#ereader-nav-menu-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),void 0!==e.labelVOList?(CaseConnect.preSetBriefLabelList=e.labelVOList,loadDataListInPopover()):(CaseConnect.preSetBriefLabelList="",loadDataListInPopover()),"practicepack"==e.bookVO.bookType||"oer"==e.bookVO.bookType?($("#new-bookshelf-modal-faculty").modal("hide"),$("#practisepack-tutorial-faculty").modal("show"),$("#studyaid-tutorial-faculty").modal("hide"),caseBookTutorial=!1,practicePackTutorial=!0,studyAidTutorial=!1,slideIndex=1,showDivs(slideIndex)):"casebook"==e.bookVO.bookType||"coursebook"==e.bookVO.bookType?($("#new-bookshelf-modal-faculty").modal("show"),$("#practisepack-tutorial-faculty").modal("hide"),$("#studyaid-tutorial-faculty").modal("hide"),caseBookTutorial=!0,practicePackTutorial=!1,studyAidTutorial=!1,slideIndex=1,showDivs(slideIndex)):"studyaid"==e.bookVO.bookType?($("#new-bookshelf-modal-faculty").modal("hide"),$("#practisepack-tutorial-faculty").modal("hide"),$("#studyaid-tutorial-faculty").modal("show"),caseBookTutorial=!1,practicePackTutorial=!1,studyAidTutorial=!0,slideIndex=1,showDivs(slideIndex)):($("#new-bookshelf-modal-faculty").modal("hide"),$("#practisepack-tutorial-faculty").modal("hide"),$("#studyaid-tutorial-faculty").modal("hide"),caseBookTutorial=!1,practicePackTutorial=!1,studyAidTutorial=!1,slideIndex=1))}},Handler.goToBookShelf={request:function(e){$(".contactAssessmentSpecialistId").hide(),e.data={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}},$("#page-loading-spinner").show(),cancelCreateClassAgree()},response:function(e,o){localStorage.removeItem("refreshPwdContent"),$(".popover").hide(),insideResourcePagefromPermawithBookAssoc=!1,insideBookshelf=!0,enableCopyPaste(),closeOverlayInMobile("generic-nav-menu-mobile"),$(".modal-backdrop").remove(),CaseConnect.casesFlag="false",CaseConnect.currentChapterIdstudylanding="",Handler.login.removeUnderlineStyle(),void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),"false"===e.status?(sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain):(window.history.pushState({page:"bookshelf"},null,properties.ui_domain),"true"==e.mbeAdminFlag?(themisAdminlanding=!0,localStorage.setItem("themisAdminlanding",themisAdminlanding),localStorage.setItem("mbeAdminSchoolId",e.mbeAdminSchoolId)):(themisAdminlanding=!1,localStorage.removeItem("themisAdminlanding",themisAdminlanding)),e.userVO={userId:map.userId,userRole:map.userRole,userRole:map.userRoleId},e.regpart2="true",e.userActivityVO={},e.userActivityVO.bookVOList=e.bookVOList,void 0!==map.bookAccessCode&&(delete map.bookAccessCode,"Professor"===map.userRole?Handler.login.loadProfessorBookshelf(e):Handler.login.loadBookshelf(e),Utility.trackGA("bookshelf")),window.history.pushState({page:"bookshelf"},null,properties.ui_domain),addBookshelfLinkTOLogo(),"Professor"===map.userRole?Handler.login.loadProfessorBookshelf(e):Handler.login.loadBookshelf(e),Utility.trackGA("bookshelf"),Handler.login.updateStatusBar(),insideManageConnection=!1,changePageFont(),searchBookText(),showGotoMenu(),getMyRequestNoftificationCount(),$("#page-loading-spinner").hide())}},Handler.loadChapter={request:function(e){highlightPopoverVisible=!1,addBriefPopoverShown=!1,clickedInsidePcaseForAnnot=!1,alertMessageModalAppears=!0,$("#"+selectedNoteId).popover("hide"),e.data={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),streamContentRequiredFlag:map.isIE9,userActivityVO:{lastActivityCode:"EREADER_READING_BOOK",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId,pageNumber:CaseConnect.loadPageNumber}},$("#page-loading-spinner").show()},response:function(e,o){if(void 0!==e.sessionAuthenticationToken&&("true"==e.resourceFlag&&(CaseConnect.resourceFlag,e.resourceFlag,$(".resourceMenushow").removeClass("resourceMenuhide")),void 0!==e.casesFlag&&(CaseConnect.casesFlag=e.casesFlag,"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide()),void 0!==e.newsFeedFlag?(CaseConnect.newsFeedFlag=e.newsFeedFlag,"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide()):$(".hide-news-feed-class").hide(),null!=e.hasPCaseAnnotation&&null!=e.hasPCaseAnnotation&&("true"==e.hasPCaseAnnotation?CaseConnect.hasPCaseAnnotation="true":CaseConnect.hasPCaseAnnotation="false"),localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken)),"false"===e.status)sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain;else if(e.bookVO){if(CaseConnect.bookData=e.bookVO,CaseConnect.bookData.explodedEpubPath=e.bookVO.exploadedEpubPath,CaseConnect.currentChapterId=e.bookVO.lastReadChapterId,CaseConnect.chapterTitle=e.bookVO.chapterTitle,CaseConnect.currentBookId=e.bookVO.bookId,CaseConnect.tocPath=e.bookVO.tocPath,CaseConnect.nextChapterStartPageNumber=e.bookVO.nextChapterStartPageNumber,CaseConnect.previousChapterEndPageNumber=e.bookVO.previousChapterEndPageNumber,CaseConnect.currentChapterEndPageNumber=e.bookVO.chapterEndPageNumber,CaseConnect.nextChapterNumber=e.bookVO.nextChapterNumber,CaseConnect.nextChapterTitle=e.bookVO.nextChapterTitle,CaseConnect.bookType=e.bookVO.bookType,CaseConnect.resourceFlag=e.resourceFlag,CaseConnect.casesFlag=e.casesFlag,CaseConnect.newsFeedFlag=e.newsFeedFlag,CaseConnect.tocPath="/casebook"+CaseConnect.tocPath.split("?")[0].split("/casebook")[1],fetchAnnotationCalledOnce=!1,globalParaListForFetchCallOne=[],noParaInThisPage=!1,!0===map.isIE9){var t=e.bookVO.htmlPageContent;t.split("</head>")[1]&&$("#tab-section-container").html(t.split("</head>")[1]),CaseConnect.currentPageHtmlLocation="/casebook"+e.bookVO.pageHtmlLocation.split("?")[0].split("/casebook")[1]}else fetchDataFromCDNUrl(e.bookVO.pageHtmlLocation),CaseConnect.currentPageHtmlLocation="/casebook"+e.bookVO.pageHtmlLocation.split("?")[0].split("/casebook")[1];CaseConnect.currentPageNumber=$(".cc-pagenum-begin")[0].title,updateChapterNameandDetails(),getAnnotatableChapterAndSupplementalList(),document.getElementById("ereader-scroller").scrollTop=1}}};
var globalData={},globalDataText={},saveClicked,insideAssessment=!1,reportSelection=!1,qList=[],subQList=[];lastQuestioncheck=0,explainertype=0,CaseConnect.currentbookIdstudylanding="",CaseConnect.currentChapterIdstudylanding="",CaseConnect.currentChapterNumberstudylanding=0,CaseConnect.currentChapterTitlestudylanding="",CaseConnect.currentLearningObjId="",chapterNumber=0,LORightpanel=null,questionpage=0,globalQuestionId="",totalQuestionExplainer=0,totalCorrectExplainer=0,loadPreviousQuestion=0,issueSpottedId=0,insideQuestionLO=!1;var studyModal=0,myProgressList=!1,totalUnansweredInClass,totalNumberOfEnrolledStudentsInCurrentClass,totalNumberOfQuestionsInLO,totalQuestionsForAnActivity=1,comingFromDropDown,lastVisitedQuestionType,lastVisitedLearningObjectiveId,questionDetailsOfLO,activeQuesNumIndex=null,studyChapterListPopoverVisible=!1,templateArray=["multichoice","flashcard","essay","clustermcq","explanatory","hypothetical","clusterhypo","issuespotting"],questionTitleArr={multichoice:"MULTIPLE CHOICE",flashcard:"FLASHCARD",essay:"ESSAY",clustermcq:"MULTIPLE CHOICE",explanatory:"VIDEO",hypothetical:"SHORT ANSWER",clusterhypo:"HYPO",issuespotting:"ISSUE SPOTTING"},numberToCharacterMap={1:"a",2:"b",3:"c",4:"d",5:"e",6:"f",7:"g",8:"h",9:"i",10:"j",11:"k",12:"l",13:"m",14:"n",15:"o",16:"p",17:"q",18:"r",19:"s",20:"t",21:"u",22:"v",23:"w",24:"x",25:"y",26:"z"};function highlightIssue(e){var t=e;t.addClass("highlight issueVisited");var s=t.attr("id");issueSpottedId=s;var a={},n=[];(n=qList.length>0?qList:JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList.{.subAnswerVOList.spanId == "'+s+'"}',globalData)).length>0&&(a=n[0],n.length>1?(n.splice(0,1),qList=n):qList=[]);var i=$('<div id="issueText">'+a.questionText+'</div><div class="clear" style="padding: 0 0 10px;"></div>'),r=a.subAnswerVOList.issueMCQAnswerList,o="",d=$("#popover-content");d.html(i);for(var l=0;l<r.length;l++)o=$('<div class="radio-custom radio-custom-unanswered"><div class="radio"><label><input type="radio" name="optionsRadios" id="optionsRadios'+l+'" value="'+l+'" data-handler="issueSpotting.issueSpotSubmit">'+numberToCharacterMap[l+1]+". "+r[l].answer+"</label></div></div>"),d.append(o);d.append('<div id="feedback"></div>'),d.append('<button type="button" id="nextBtn" style="display:none; margin-top:10px; margin-left:57px" data-handler="issueSpotting.handleNextClick" value="Next" class="btn btn-default btn-lg btn-custom">Next</button>'),d.append('<div class="clear" style="padding:0"></div>');t.offset().top;setTimeout(function(){t.popover("show")},200)}function swapWithPrev(e){var t=$(e);t.parent().fadeOut(function(){t.parent().insertBefore(t.parent().prev()).fadeIn()})}function swapWithNext(e){var t=$(e);t.parent().fadeOut(function(){t.parent().insertAfter(t.parent().next()).fadeIn()})}function getDateTime(e){var t=e.getDate(),s=e.getMonth(),a=e.getFullYear(),n=e.getHours(),i=e.getMinutes(),r="am";return i<10&&(i="0"+i),n>=12&&(r="pm",n-=12),0==n&&(n=12),["January","February","March","April","May","June","July","August","September","October","November","December"][s]+" "+t+", "+a+" | "+n+":"+i+" "+r}function showGotoChapter(){$(".study-chapter-list-popover").popover({html:!0,placement:"bottom",template:'<div class="popover studychapter-custom-popover"><div class="popover-content study-chapter-popover"></div></div>',content:function(){return map.overlay.css("opacity","0"),map.overlay.fadeIn(200),$("#chapter-list-popover").html()}})}function toggleChapterListIcon(){"block"===$(".studychapter-custom-popover").css("display")?($(".study-chapter-list-popover").find(".toggle-up-down").addClass("glyphicon-menu-up").removeClass("glyphicon-menu-down"),studyChapterListPopoverVisible&&(document.activeElement.blur(),$(".study-chapter-list-popover")[0].focus(),studyChapterListPopoverVisible=!1)):($(".study-chapter-list-popover").find(".toggle-up-down").addClass("glyphicon-menu-down").removeClass("glyphicon-menu-up"),studyChapterListPopoverVisible=!0),showGotoChapter()}function showStudyNavInMoblie(){$("#study-nav-menu-mobile").modal("show")}function hideStudyNavInMoblie(){$("#study-nav-menu-mobile").modal("hide")}function updateChapterId(e,t){CaseConnect.currentChapterId=e,CaseConnect.currentBookId=t}function UpdateStatus(e,t){var s=$(t.target);s.hasClass("gray-thumbsDown")||s.hasClass("gray-thumbsUp")||t.stopPropagation(),$("#status").val(e),a={},Handler.thumbsUpDown.request(a);var a={method:"POST",url:properties[properties.env]+"/manageAssessmentService/saveQuestionResponse",data:a.data,handler:Handler.thumbsUpDown,target:null};Utility.fireRequest(a)}function updateStatusInPagination(e,t){var s="";if("correct"==t?$('ul.pagination a[id="anchor_'+e+'"]').parent().addClass("green").removeClass("red").removeClass("blue"):"incorrect"==t?$('ul.pagination a[id="anchor_'+e+'"]').parent().addClass("red").removeClass("green").removeClass("blue"):"partial"==t&&$('ul.pagination a[id="anchor_'+e+'"]').parent().addClass("blue").removeClass("red").removeClass("green"),void 0===CaseConnect.questionType||""===CaseConnect.questionType?s=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionType',globalData)[0]:"explanatory"==CaseConnect.questionType&&(s=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionType',globalDataText)[0]),"clustermcq"==s?s="multichoice":"clusterhypo"==s&&(s="hypothetical"),"explanatory"!=s){var a=CaseConnect.currentLearningObjId,n=JSPath.apply('.{.learningObjId == "'+a+'"}.learningObjectiveResponseList.{.questionType == "'+s+'"}',LORightpanel.learningObjectiveProgressVOList)[0];"multichoice"!==s?$("#paginationContainer #statusBar").html(n.totalCorrectAnswer+" correct | "+n.totalWrongAnswer+" incorrect | "+n.totalUnAnswered+" unanswered"):0==n.totalPartialCorrect?$("#paginationContainer #statusBar").html(n.totalCorrectAnswer+" correct | "+n.totalWrongAnswer+" incorrect | "+n.totalUnAnswered+" unanswered"):$("#paginationContainer #statusBar").html(n.totalCorrectAnswer+" correct | "+n.totalPartialCorrect+" partially correct | "+n.totalWrongAnswer+" incorrect | "+n.totalUnAnswered+" unanswered")}}function generateBridecovePlayer(e,t,s,a,n){return' <video data-video-id="'+e+'" data-account="20782352001" data-player="default" data-embed="default" data-application-id class="video-js" controls></video>'}function welcomeStudyForCasebook(){$("#study-centre-welcome-casebook").modal("show"),CaseConnect.studyModalCasebookFlag="false"}function welcomeStudyForStudyaid(){$("#study-centre-welcome-studyaid").modal("show"),CaseConnect.studyModalStudyaidFlag="false"}function saveStudyWelcomeModal(){var e=CaseConnect.studyModalStudyaidFlag,t=CaseConnect.studyModalCasebookFlag,s={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentBookId,lastReadChapterId:CaseConnect.currentChapterId,lastViewedLearningObjectId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId},chapterVO:{chapterId:CaseConnect.currentChapterId}};"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?s.casebookDisclaimerFlag=t:"studyaid"===CaseConnect.bookType&&(s.studyAidDisclaimerFlag=e),$("#page-loading-spinner").show(),$.ajax({url:properties[properties.env]+"/manageUserService/updateDisclaimerMessageStatus",type:"POST",contentType:"application/json",accept:"application/json",async:!1,data:JSON.stringify(s)}).then(function(e){"true"===e.status&&(void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),$("#page-loading-spinner").hide()),sessionTimeOut()},function(e){sessionAuthFails(e),sessionTimeOut(),alertMessagesModal(exceptionMsg.systemError)})}function insideStudy(e){"false"!=insideEreader&&insideEreader||"false"!=insideOutline&&insideOutline||insideAssessment||insideClassInsightsPage||"false"!=insideCasesPage&&insideCasesPage||insideResourcePage||insideNewsFeed,"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),insideStaticPage=!1,insideBookshelf=!1,insideEreader="false",insideOutline="false",insideOutline=!1,insideAssessment=!1,insideNewsFeed=!1,insideCasesPage=!1,insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!0,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,$(".ereader-hidden").hide(),$(".ereader-visible").show(),$("#ereader-nav-menu-mobile").modal("hide"),$("#outline-nav-menu-mobile").modal("hide"),$("#themis-nav-menu-mobile").modal("hide"),$("#bookshelf-nav-menu-mobile").modal("hide"),$("#news-feed-nav-mobile").modal("hide"),$("#cases-nav-menu-mobile").modal("hide"),$(".study-sub-header-study").removeAttr("style"),$("#casebook-footer-wrapper").show();var t=$(window).width(),s=$(".main-container").width();t<768&&t>=s?$("#header-wrapper").hide():$("#header-wrapper").show()}function saveUserLastActivityStudyCenter(e){CaseConnect.currentLearningObjId=e;var t=localStorage.getItem("userRole"),s=localStorage.getItem("userRoleId"),a={userVO:{userId:localStorage.getItem("userId"),userRole:null==t?"":t,userRoleId:null==s?"":s,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LEARNING_OBJECTIVE",pageNavigatingFrom:"studycenter",pageNavigatingTo:"studycenter",lastReadBookId:CaseConnect.currentBookId,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:e},sessionVO:map.sessionVO},questionVO:{learningObjectId:e}};$.ajax({url:properties[properties.env]+"/activityTrackingService/saveUserActivity",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){$(window).trigger("resize"),sessionTimeOut()},function(e){})}function loadStudyCenterFromLogin(e){null==CaseConnect.bookData&&(CaseConnect.bookData={},CaseConnect.bookData.bookTitle="",insideStaticPage=!1,insideBookshelf=!1,void 0!==e.userActivityVO.lastReadBookTitle?(CaseConnect.bookData.bookTitle=e.userActivityVO.lastReadBookTitle,CaseConnect.bookTitle=CaseConnect.bookData.bookTitle):void 0!==e.userActivityVO.chapterLearningObjectiveVO.chapterVO.bookTitle&&(CaseConnect.bookData.bookTitle=e.userActivityVO.chapterLearningObjectiveVO.chapterVO.bookTitle,CaseConnect.bookTitle=CaseConnect.bookData.bookTitle)),CaseConnect.currentbookIdstudylanding=e.userActivityVO.chapterLearningObjectiveVO.chapterVO.bookId,CaseConnect.currentBookId=e.userActivityVO.chapterLearningObjectiveVO.chapterVO.bookId,CaseConnect.currentChapterIdstudylanding=e.userActivityVO.chapterLearningObjectiveVO.chapterVO.chapterId,CaseConnect.currentChapterId=e.userActivityVO.chapterLearningObjectiveVO.chapterVO.chapterId,CaseConnect.currentChapterNumberstudylanding=e.userActivityVO.chapterLearningObjectiveVO.chapterVO.chapterNumber,CaseConnect.currentChapterTitlestudylanding=e.userActivityVO.chapterLearningObjectiveVO.chapterVO.navbarTitle,CaseConnect.bookType=e.userActivityVO.lastReadBookType,CaseConnect.resourceFlag=e.userActivityVO.resourceFlag,CaseConnect.casesFlag=e.userActivityVO.casesFlag,CaseConnect.newsFeedFlag=e.userActivityVO.newsFeedFlag,CaseConnect.studyModalCasebookFlag=e.userActivityVO.casebookDisclaimerFlag,CaseConnect.studyModalStudyaidFlag=e.userActivityVO.studyAidDisclaimerFlag,null==e.userActivityVO.lastViewedLearningObjectId?CaseConnect.currentLearningObjId="":CaseConnect.currentLearningObjId=e.userActivityVO.lastViewedLearningObjectId,CaseConnect.currentbookId=e.userActivityVO.chapterLearningObjectiveVO.chapterVO.bookId,CaseConnect.bookData.chapterType="chapter",Handler.learningObjective.response(e.userActivityVO),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),$(window).trigger("resize");var t=$(window).width(),s=$(".main-container").width();t<768&&t>=s?$("#header-wrapper").hide():$("#header-wrapper").show(),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide()}function handleDoneButton(e){var t=parseInt(globalData.totalQuestion),s=CaseConnect.currentLearningObjId,a=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionType',globalData)[0];"clustermcq"==a?a="multichoice":"clusterhypo"==a&&(a="hypothetical");var n=parseInt($("ul.pagination li.active > a").attr("id").split("_")[1]);if(0==JSPath.apply('.{.learningObjId == "'+s+'"}.learningObjectiveResponseList.{.questionType == "'+a+'"}',LORightpanel.learningObjectiveProgressVOList)[0].totalUnAnswered&&n==t)$("#nextBtn").hide(),$("#skipBtn").hide(),$("#doneBtn").show();else if(1!=t||"incorrect"!=e.status&&"correct"!=e.status&&"partial"!=e.status)if("flashcard"==a)if($(window).trigger("resize"),"Show Answer"==$("#btnFlagHideShow").html()){if(t>1)$("#nextBtn").hide(),$("#skipBtn").show(),$(window).width()<768?$(".flag-container-mobile-nextbtn").css("display","inline-block !important"):$(".flag-container-mobile-nextbtn").css("display","none !important");else $("#nextBtn").hide(),$("#skipBtn").hide();$("#doneBtn").hide()}else $("#btnFlagHideShow").html("Hide Answer"),t>1?($("#nextBtn").show(),$("#skipBtn").hide()):($("#nextBtn").hide(),$("#skipBtn").hide()),$("#doneBtn").hide(),$(".flag-container-mobile-nextbtn").css("display","none !important");else"incorrect"==e.status||"correct"==e.status||"partial"==e.status?(t>1&&$("#nextBtn").show(),$("#doneBtn").hide(),$("#skipBtn").hide()):(t>1?($("#nextBtn").hide(),$("#skipBtn").show()):($("#nextBtn").hide(),$("#skipBtn").hide()),$("#doneBtn").hide());else $("#skipBtn").hide(),$("#nextBtn").hide(),$("#doneBtn").show()}function showHideLearningObjectives(){var e=$(".target");if($("#link .Smallbutton").click(function(){var t=$($(this).data("target")).slideToggle();e.not(t).hide()}),void 0!==CaseConnect.currentLearningObjId){$("#studycenter-container #link #accordion").html();if(""!=CaseConnect.currentLearningObjId&&$("#"+CaseConnect.currentLearningObjId).length>0){var t=$("#"+CaseConnect.currentLearningObjId).attr("href").substring(1);$("#collapse0").removeClass("collapse in").addClass("collapse").parent().find(".question-home a").removeClass("lastClickedLink"),$("#collapse0").closest(".panel-custom").removeClass("active-lo-background"),$("#"+t).removeClass("collapse").addClass("collapse in").parent().find(".question-home a").addClass("lastClickedLink"),$("#"+t).closest(".panel-custom").addClass("active-lo-background")}else $(".panel :first").next().removeClass("collapse").addClass("collapse in").parent().find(".question-home a").addClass("lastClickedLink"),$(".panel :first").closest(".panel-custom").addClass("active-lo-background")}else $(".panel :first").next().removeClass("collapse").addClass("collapse in").parent().find(".question-home a").addClass("lastClickedLink"),$(".panel :first").closest(".panel-custom").addClass("active-lo-background");$('div[id^="learnContent"]').each(function(){var e=$(this).attr("id").split("_")[1];""==$.trim($(this).html())&&$("#learnImgContent_"+e).hide()}),$('div[id^="practiceContent"]').each(function(){var e=$(this).attr("id").split("_")[1];0==parseInt(LORightpanel.learningObjectiveProgressVOList[e].totalNumberOfQuestionInLearningObjective)&&$("#practiceImgContent_"+e).hide()}),$(window).trigger("resize")}function uploadVideo(e,t,s){var a=new RegExp(t,"g"),n=t.length;if(a.test(e)){var i=e.substring(0,e.indexOf(t)+n),r=e.substring(e.indexOf(t)+n);e=i+r.substring(0,r.indexOf(">")+1)+s+r.substring(r.indexOf(">")+1)}return e}function checkContent(e){var t=$(e.target).attr("questionType");tinyMCE.get(t+"Editor")&&""==$.trim(tinyMCE.get(t+"Editor").getContent())&&e.stopPropagation()}function rightpanelcontent(){$(window).width()>767&&(0!=$(".rightpanel-content-inner section .doughnut").length&&0!=$(".rightpanel-content-inner section .doughnut:visible").length||$(".rightpanel-content-inner section").html("<p>No other activities available for this topic.</p>"))}function getReportForStudyDashBoard(event){reportSelection=!0,CaseConnect.currentClassId=event.value,"-999"===event.value?(myProgressList=!0,comingFromDropDown=!1):myProgressList=!1;var handler="learningObjectiveFromEreader",request={},reqData={};request.url="/manageClassWebService/getStudyCenterViewForProfOrStudent",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=reqData,request.handler.request.apply(null,[request]),Utility.fireRequest(request),document.activeElement.blur()}function getStudentCount(){return"Professor"===map.userRole?myProgressList||"My Progress"===$("#drpdwnClassProgressSelection option:selected").text()?1:void 0!==CaseConnect.enrolledStudentsInCurrentClass?parseInt(CaseConnect.enrolledStudentsInCurrentClass):1:1}function UpdateStatusOfSubQuestionHypo(e,t){var s=$(t.target);s.hasClass("gray-thumbsDown")||s.hasClass("gray-thumbsUp")||t.stopPropagation(),subQuestionIndex=s.closest("div[id^=dvThumbs]").attr("id").split("_")[1],$("#thumbStatus_"+subQuestionIndex).val(e)}function autoSaveClusterHypo(){var handler="autoSaveClusterResponse",request={},data={};request.url="/manageAssessmentService/submitQuestionResponse",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=data;for(var subQuesToSave=$("div[id^=dvThumbs]:hidden"),toSave=!1,i=0;i<subQuesToSave.length;i++){var index=$(subQuesToSave[i]).attr("id").split("_")[1],responseText=tinyMCE.get("hypoEditor_"+index).getContent();if(""!=$.trim(responseText)){toSave=!0;break}}toSave&&(request.handler.request.apply(null,[request]),Utility.fireRequest(request),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut())}function showOtherActivity(){}function displayEndorseTooltipContent(){$("#endorse-ques-info-button-faculty").popover({html:!0,placement:"top",container:"body",template:'<div class="popover go-to-popover ebook-custom-popover" id="prof-endorse-popover"><div class="arrow menuArrow"></div><div id="ereader-menu-popover-content" class="popover-content ereader-menu-popover"></div></div>',content:function(){return $("#endorse-ques-popover-content").html()}})}function displayEndorseTooltipStudent(){$("#endorse-ques-info-button-student").popover({html:!0,placement:"top",container:"body",template:'<div class="popover go-to-popover ebook-custom-popover" id=""><div class="arrow menuArrow"></div><div id="ereader-menu-popover-content" class="popover-content ereader-menu-popover"></div></div>',content:function(){return $("#endorse-ques-popover-student").html()}})}function showNextHiddenQuesInPage(){$(".study-pagination-next-xs").hide(),$(".study-pagination-prev-xs").hide(),$(".study-pagination-next-large").show(),$(".study-pagination-prev-large").show();for(var e=0;e<questionDetailsOfLO.length;e++)e<5&&$("#anchor_"+questionDetailsOfLO[e].questionNumber).parent().hide(),e>4&&($("#anchor_"+questionDetailsOfLO[e].questionNumber).parent().show(),5===e&&$("ul.pagination a#anchor_"+questionDetailsOfLO[e].questionNumber).trigger("click"))}function showPrevHiddenQuesInPage(){$(".study-pagination-prev-xs").hide(),$(".study-pagination-next-xs").hide(),$(".study-pagination-next-large").show(),$(".study-pagination-prev-large").show();for(var e=0;e<questionDetailsOfLO.length;e++)e>4&&$("#anchor_"+questionDetailsOfLO[e].questionNumber).parent().hide(),e<5&&($("#anchor_"+questionDetailsOfLO[e].questionNumber).parent().show(),4===e&&$("ul.pagination a#anchor_"+questionDetailsOfLO[e].questionNumber).trigger("click"))}function appendQueryString(){var e="?fname="+localStorage.getItem("firstName")+"&lname="+localStorage.getItem("lastName")+"&email="+localStorage.getItem("email")+"&role="+localStorage.getItem("userRole")+"&casebooknav=true",t=$(".studyAidLink").attr("href"),s=t;if(null!=t&&""!=t){for(var a=t.split("/"),n=0;n<a.length;n++)if(-1!=a[n].indexOf("wklegaledu")||-1!=a[n].indexOf("aspenlaw")){s=t+e;break}$(".studyAidLink").attr("href",s)}}function loadStudyQuestionImagesFromCDN(){CaseConnect.imgUrl=[],CaseBookConnect.questionImgTags;var e=$("#questionContainer").find("img");CaseBookConnect.questionImgTags=e,e.each(function(e,t){var s={genericServiceRequestVO:{inputBaseUrl:("/casebook/questionimages"+t.src.split("questionimages")[1]).split("?")[0]}};$.ajax({url:properties[properties.env]+"/manageUrlService/getCDNUrl",type:"POST",contentType:"application/json",accept:"application/json",async:!0,data:JSON.stringify(s)}).then(function(e){"true"===e.status&&CaseBookConnect.questionImgTags.each(function(t,s){-1!=e.genericServiceResponseVO.cdnUrl.indexOf(s.src.split("/questionimages")[1])&&(s.src=e.genericServiceResponseVO.cdnUrl)}),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut()},function(e){(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),alert(data.errorMessg)})})}Handlebars.registerHelper("chooseOptions",function(e,t){return fetchCrctAnsOption(e)}),Handlebars.registerHelper("dateModified",function(e,t){return e?dateModification(e):""}),Handler.chapterList={request:function(e){if(void 0!==CaseConnect.currentBookId){var t=CaseConnect.currentBookId;e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"studycenter",pageNavigatingTo:"studycenter",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding},sessionVO:map.sessionVO},bookVO:{bookId:t}}}},response:function(e,t){if(localStorage.getItem("userId")||CaseConnect.currentUserId,"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=e;"object"==$.type(s.chapterVOList)&&(s.chapterVOList=[s.chapterVOList]),bookChapterList=s.chapterVOList,void 0!==CaseConnect.currentChapterNumberstudylanding&&0!=CaseConnect.currentChapterNumberstudylanding?s.currentChapterNumberstudylanding=CaseConnect.currentChapterNumberstudylanding:void 0!==CaseConnect.bookData&&void 0!==CaseConnect.bookData.chapterNumber?s.currentChapterNumberstudylanding=CaseConnect.bookData.chapterNumber:s.currentChapterNumberstudylanding="1";var a=Handlebars.getTemplate("chapter-list")(s);$("#chapter-list-popover").html(a)}}},Handler.learningObjective={request:function(e){$("#study-nav-menu-mobile").modal("hide"),Utility.showSpinner(),lastVisitedLearningObjectiveId="",null!=saveClicked&&clearInterval(saveClicked),CaseConnect.outlineTimer&&clearTimeout(CaseConnect.outlineTimer);var t=CaseConnect.currentBookId;if(void 0!==CaseConnect.currentBookId){if(""==CaseConnect.currentChapterId){var s="92c49890-daff-11e3-bcbf-21f520d5c4bb";t=t;chapterNumber="1",CaseConnect.currentChapterNumberstudylanding=chapterNumber,CaseConnect.currentChapterIdstudylanding=s,CaseConnect.currentbookIdstudylanding=t}else if(void 0===CaseConnect.currentChapterId){s=CaseConnect.currentChapterIdstudylanding,t=t;chapterNumber=CaseConnect.currentChapterNumberstudylanding,CaseConnect.currentChapterNumberstudylanding=chapterNumber,CaseConnect.currentChapterIdstudylanding=s,CaseConnect.currentbookIdstudylanding=t}else if(""!=CaseConnect.currentChapterIdstudylanding){s=CaseConnect.currentChapterIdstudylanding,t=CaseConnect.currentbookIdstudylanding;chapterNumber=CaseConnect.currentChapterNumberstudylanding}else if(1==questionpage){s=CaseConnect.currentChapterIdstudylanding,t=t;chapterNumber=CaseConnect.currentChapterNumberstudylanding}else{s=CaseConnect.currentChapterIdstudylanding,t=t;chapterNumber=CaseConnect.currentChapterNumberstudylanding,CaseConnect.currentChapterIdstudylanding=s,CaseConnect.currentbookIdstudylanding=t}"Student"===map.userRole?e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},classVO:{classId:CaseConnect.currentClassId},bookVO:{bookId:t},chapterVO:{chapterId:s}}:myProgressList||"My Progress"===$("#drpdwnClassProgressSelection option:selected").text()?e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},bookVO:{bookId:t},chapterVO:{chapterId:s}}:e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},classVO:{classId:CaseConnect.currentClassId},bookVO:{bookId:t},chapterVO:{chapterId:s}}}},response:function(e,t){if($("#study-nav-menu-mobile").modal("hide"),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{if($(".popover-issue-mcq").remove(),null!==e.classVOList)if(void 0!==e.classVOList){!e.classVOList.length>0&&(e.classVOList=[e.classVOList]);var s={bookId:CaseConnect.currentBookId,classCode:"-999",classDescription:"",classId:"-999",className:"My Progress",createdBy:"-999",createdDate:"2014-12-03 14:00:26.0",meetingTime:"9:00 AM",modifiedDate:"2014-12-03 14:00:26.0",section:"Trusts Section",semesterYear:"Second Sem"};e.classVOList.unshift(s)}else e.classVOList=[{bookId:CaseConnect.currentBookId,classCode:"-999",classDescription:"",classId:"-999",className:"My Progress",createdBy:"-999",createdDate:"2014-12-03 14:00:26.0",meetingTime:"9:00 AM",modifiedDate:"2014-12-03 14:00:26.0",section:"Trusts Section",semesterYear:"Second Sem"}];var a=e.chapterLearningObjectiveVO;if(LORightpanel=a,0!=CaseConnect.currentChapterNumberstudylanding||a.chapterVO.chapterNumber,null!==a){for(Array.isArray(a.learningObjectiveProgressVOList)||(a.learningObjectiveProgressVOList=[a.learningObjectiveProgressVOList]),i=0,j=a.learningObjectiveProgressVOList.length;i<j;i++){var n,r=a.learningObjectiveProgressVOList[i],o=r.totalCorrectAnswerInLearningObjective;n="Professor"!==map.userRole||myProgressList||void 0===CaseConnect.enrolledStudentsInCurrentClass?r.totalNumberOfQuestionInLearningObjective:void 0===CaseConnect.enrolledStudentsInCurrentClass?r.totalNumberOfQuestionInLearningObjective:r.totalNumberOfQuestionInLearningObjective*CaseConnect.enrolledStudentsInCurrentClass;var d=r.totalPartialCorrectInLearningObjective,l=r.totalWrongAnswerInLearningObjective,u=o/n*100,c=d/n*100,p=l/n*100,g=(n-o-d-l)/n*100;u=Math.round(u),c=Math.round(c),p=Math.round(p),g=Math.round(g),r.crrectAnswerPercentage=parseInt(u),r.partialCrrectAnswerPercentage=parseInt(c),r.wrongAnswerPercentage=parseInt(p),r.unansweredQuestionPercentage=parseInt(g)}null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(checkNewsFeedInApp(),expiryDate()),getMyRequestNoftificationCount(),void 0!==a.chapterVO?map.wk_conatiner.load("studylanding.html?v19893",function(){insideStudycenterPage=!0,$(window).trigger("resize"),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?"true"===CaseConnect.studyModalCasebookFlag&&welcomeStudyForCasebook():"studyaid"===CaseConnect.bookType&&("true"===CaseConnect.studyModalStudyaidFlag&&welcomeStudyForStudyaid(),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-landing-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams.")),(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),adminSuppressFunc();var t=Handlebars.getTemplate("studycenter-content")(a),s=($(this).find("#studycenter-container").append(t),Handlebars.getTemplate("studycenter-viewprogress")(e)),n=Handlebars.getTemplate("studycenter-chaptertitle")(a);$(this).find("#study-chapter-title-template").append(n),$(this).find("#study-chapter-title-template-mobile").append(n),$(this).find(".progressDropDown").append(s),$(this).find(".progressDropDownMobile").append(s),$(window).scrollTop(0),insideQuestionLO=!1,displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN();var r=document.documentElement;for(r.setAttribute("data-useragent",navigator.userAgent),r.setAttribute("data-platform",navigator.platform),navigator.userAgent.match(/Trident\/[6]/i)&&$(".bookshelf-doc-dropdown").css({position:"static","background-image":"none"}),$("#study-center-container").removeClass("study-container-inner").addClass("study-container"),$(".ereader-main-header-bookshelfred").show(),$(".back-to-studycenter-red").hide(),$(".study-header-mobile-regular").show(),$(".study-chapter-list-popover").css({width:"100%"}),$(".btn-group").show(),CaseConnect.currentBookId!==CaseConnect.bookData.bookId&&CaseConnect.bookTitle?($("#book-name").html(CaseConnect.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookTitle)):($("#book-name").html(CaseConnect.bookData.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle)),$("#chapter-name").html(a.chapterVO.navbarTitle),$(".study-popover-chapter-title").html(a.chapterVO.navbarTitle),$(".study-booktitle-mobile").html(CaseConnect.bookData.bookTitle),$(".ereader-main-header-title").html(CaseConnect.bookData.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle),a.chapterVO.chapterNumber,i=0,j=a.learningObjectiveProgressVOList.length;i<j;i++){var o=a.learningObjectiveProgressVOList[i];"0"!==o.totalNumberOfExplanatoryInLearningObjective&&"0"===o.totalNumberOfQuestionInLearningObjective&&$("#"+o.orderIndex+"_progress-set-holder").css("visibility","hidden")}"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md").show(),$("#study-aid-adds-xs").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md").hide(),$("#study-aid-adds-xs").hide(),$("#studycenter-ad-container-xs").hide()),$(window).trigger("resize"),Utility.hideSpinner()}):(Utility.hideSpinner(),alertMessagesModal(exceptionMsg.systemError))}else comingFromDropDown=!1,CaseConnect.currentClassEnrollmentCount="0",null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(checkNewsFeedInApp(),expiryDate()),getMyRequestNoftificationCount(),map.wk_conatiner.load("studylanding.html?v19893",function(){insideStudycenterPage=!0,$(window).trigger("resize"),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?"true"===CaseConnect.studyModalCasebookFlag&&welcomeStudyForCasebook():"studyaid"===CaseConnect.bookType&&("true"===CaseConnect.studyModalStudyaidFlag&&welcomeStudyForStudyaid(),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-landing-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams.")),(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),adminSuppressFunc();Handlebars.getTemplate("studycenter-chaptertitle");if($("#book-name").html(CaseConnect.bookData.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle),$(this).find("#studycenter-container").append("<p class='students-count-less'> Not enough students are enrolled in this class to show aggregated data </p>"),$(window).scrollTop(0),insideQuestionLO=!1,!e.chapterVO&&CaseConnect.currentChapterTitlestudylanding){var t=Handlebars.getTemplate("studycenter-viewprogress")(e),s=Handlebars.getTemplate("studycenter-chaptertitle")(e);$(this).find("#study-chapter-title-template").append(s),$(this).find("#study-chapter-title-template-mobile").append(s),$(this).find(".progressDropDown").append(t),$(this).find(".progressDropDownMobile").append(t),$("#chapter-name").html(CaseConnect.currentChapterTitlestudylanding),$(".study-popover-chapter-title").html(CaseConnect.currentChapterTitlestudylanding)}else if(e.chapterVO){t=Handlebars.getTemplate("studycenter-viewprogress")(e),s=Handlebars.getTemplate("studycenter-chaptertitle")(e);$(this).find("#study-chapter-title-template").append(s),$(this).find("#study-chapter-title-template-mobile").append(s),$(this).find(".progressDropDown").append(t),$(this).find(".progressDropDownMobile").append(t),$("#chapter-name").html(e.chapterVO.navbarTitle),$(".study-popover-chapter-title").html(CaseConnect.currentChapterTitlestudylanding)}CaseConnect.currentBookId!==CaseConnect.bookData.bookId&&CaseConnect.bookTitle?($("#book-name").html(CaseConnect.bookTitle),$(".study-booktitle-mobile").html(CaseConnect.bookTitle)):($("#book-name").html(CaseConnect.bookData.bookTitle),$(".study-booktitle-mobile").html(CaseConnect.bookTitle)),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN();var a=document.documentElement;a.setAttribute("data-useragent",navigator.userAgent),a.setAttribute("data-platform",navigator.platform),navigator.userAgent.match(/Trident\/[6]/i)&&$(".bookshelf-doc-dropdown").css({position:"static","background-image":"none"}),$(".back-to-studycenter-red").hide(),$(".study-header-mobile-regular").show(),$(".study-chapter-list-popover").css({width:"100%"}),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md").show(),$("#study-aid-adds-xs").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md").hide(),$("#study-aid-adds-xs").hide(),$("#studycenter-ad-container-xs").hide()),Utility.hideSpinner()})}h={},Handler.chapterList.request(h);var h={method:"POST",url:properties[properties.env]+"/learningObjectiveRetrievalService/getChapterAndSupplementListForStudy",data:h.data,handler:Handler.chapterList,target:null};Utility.fireRequest(h)}},Handler.learningObjectiveFromEreader={request:function(e){Utility.showSpinner();var t=CaseConnect.currentBookId;if(lastVisitedLearningObjectiveId="",lastVisitedQuestionType="","undefined"!=typeof lastVisitedNonEditableChapterId&&null!==lastVisitedNonEditableChapterId&&lastVisitedNonEditableChapterId&&(lastVisitedNonEditableChapterId=""),!CaseConnect.bookData&&CaseConnect.navigatingAwayFromNewBookshelf||null==CaseConnect.bookData&&CaseConnect.navigatingAwayFromNewBookshelf)for(var s=CaseConnect.navigatingAwayFromNewBookshelf,a=0;a<s.length;++a)if(s[a].bookId==CaseConnect.currentBookId){CaseConnect.bookData=s[a];break}if(void 0!==CaseConnect.currentBookId){if(""==CaseConnect.currentChapterId||"-999"==CaseConnect.currentChapterId||"chapter"!=CaseConnect.bookData.chapterType){CaseConnect.bookData.chapterType="chapter";var n="";t=t;chapterNumber="1",CaseConnect.currentChapterNumberstudylanding=chapterNumber,CaseConnect.currentChapterIdstudylanding=n,CaseConnect.currentbookIdstudylanding=t,CaseConnect.readToStudyFirstLo&&comingFromRtsToStudy?(CaseConnect.currentLearningObjId=CaseConnect.readToStudyFirstLo,CaseConnect.readToStudyFirstLo="",comingFromRtsToStudy=!1):(CaseConnect.currentLearningObjId="",comingFromRtsToStudy=!1)}else if(CaseConnect.bookData.chapterType="chapter",void 0===CaseConnect.currentChapterId){n="",t=t;chapterNumber="1",CaseConnect.currentChapterNumberstudylanding=chapterNumber,CaseConnect.currentChapterIdstudylanding=n,CaseConnect.currentbookIdstudylanding=t,CaseConnect.readToStudyFirstLo&&comingFromRtsToStudy?(CaseConnect.currentLearningObjId=CaseConnect.readToStudyFirstLo,CaseConnect.readToStudyFirstLo="",comingFromRtsToStudy=!1):(CaseConnect.currentLearningObjId="",comingFromRtsToStudy=!1)}else if("toc"===CaseConnect.currentPageNumber){n="",t=t;chapterNumber="1",CaseConnect.currentChapterNumberstudylanding=chapterNumber,CaseConnect.currentChapterIdstudylanding=n,CaseConnect.currentbookIdstudylanding=t,CaseConnect.readToStudyFirstLo&&comingFromRtsToStudy?(CaseConnect.currentLearningObjId=CaseConnect.readToStudyFirstLo,CaseConnect.readToStudyFirstLo="",comingFromRtsToStudy=!1):(CaseConnect.currentLearningObjId="",comingFromRtsToStudy=!1)}else{n=CaseConnect.currentChapterId,t=t;chapterNumber=CaseConnect.currentChapterNumber,chapterNumber&&(CaseConnect.currentChapterNumberstudylanding=chapterNumber),CaseConnect.currentChapterIdstudylanding=n,CaseConnect.currentbookIdstudylanding=t,lastVisitedLearningObjectiveId=CaseConnect.currentLearningObjId,CaseConnect.readToStudyFirstLo&&comingFromRtsToStudy?(CaseConnect.currentLearningObjId=CaseConnect.readToStudyFirstLo,CaseConnect.readToStudyFirstLo="",comingFromRtsToStudy=!1):(CaseConnect.currentLearningObjId="",comingFromRtsToStudy=!1)}"Student"===map.userRole?(""==CaseConnect.currentClassId&&(CaseConnect.currentClassId="-999"),e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},classVO:{classId:CaseConnect.currentClassId},bookVO:{bookId:t},chapterVO:{chapterId:n}}):reportSelection?(reportSelection=!1,!myProgressList&&CaseConnect.currentClassId.length>0?(comingFromDropDown=!0,e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:lastVisitedLearningObjectiveId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},classVO:{classId:CaseConnect.currentClassId},bookVO:{bookId:t},chapterVO:{chapterId:n}}):e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},bookVO:{bookId:t},chapterVO:{chapterId:n}}):!myProgressList&&CaseConnect.currentClassId.length>0&&!isNaN(CaseConnect.currentClassEnrollmentCount)&&parseInt(CaseConnect.currentClassEnrollmentCount)>=2?e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},classVO:{classId:CaseConnect.currentClassId},bookVO:{bookId:t},chapterVO:{chapterId:n}}:(myProgressList=!0,n="",comingFromDropDown=!1,e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},bookVO:{bookId:t},chapterVO:{chapterId:n}})}},response:function(data,status){if(localStorage.setItem("module",""),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),insideEreader="false",insideOutline="false",insideOutline=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,$(".ereader-visible").show(),lastVisitedLearningObjectiveId="",Handler.login.removeUnderlineStyle(),$("#"+selectedNoteId).popover("hide"),$("#note-save-confirmation-wrapper").remove(),"false"===data.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(data),Utility.hideSpinner();else{CaseConnect.casesFlag=data.casesFlag,CaseConnect.resourceFlag=data.resourceFlag,CaseConnect.newsFeedFlag=data.newsFeedFlag,"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),CaseConnect.studyModalCasebookFlag=data.casebookDisclaimerFlag,CaseConnect.studyModalStudyaidFlag=data.studyAidDisclaimerFlag,totalNumberOfEnrolledStudentsInCurrentClass=data.numberOfEnrolledStudent;var LOList=data.chapterLearningObjectiveVO;if(null!==LOList){if(CaseConnect.currentClassEnrollmentCount=2,null!==data.classVOList)if(void 0!==data.classVOList){!data.classVOList.length>0&&(data.classVOList=[data.classVOList]);var obj={bookId:CaseConnect.currentBookId,classCode:"-999",classDescription:"",classId:"-999",className:"My Progress",createdBy:"-999",createdDate:"2014-12-03 14:00:26.0",meetingTime:"9:00 AM",modifiedDate:"2014-12-03 14:00:26.0",section:"Trusts Section",semesterYear:"Second Sem"};data.classVOList.unshift(obj)}else data.classVOList=[{bookId:CaseConnect.currentBookId,classCode:"-999",classDescription:"",classId:"-999",className:"My Progress",createdBy:"-999",createdDate:"2014-12-03 14:00:26.0",meetingTime:"9:00 AM",modifiedDate:"2014-12-03 14:00:26.0",section:"Trusts Section",semesterYear:"Second Sem"}];for(LORightpanel=LOList,CaseConnect.enrolledStudentsInCurrentClass=data.numberOfEnrolledStudent,CaseConnect.currentChapterIdstudylanding=data.chapterLearningObjectiveVO.chapterVO.chapterId,CaseConnect.currentChapterId=data.chapterLearningObjectiveVO.chapterVO.chapterId,Array.isArray(LOList.learningObjectiveProgressVOList)||(LOList.learningObjectiveProgressVOList=[LOList.learningObjectiveProgressVOList]),i=0,j=LOList.learningObjectiveProgressVOList.length;i<j;i++){var learningObjectiveItem=LOList.learningObjectiveProgressVOList[i],crrectAnswerInLO=learningObjectiveItem.totalCorrectAnswerInLearningObjective,numberOfQuestionInLO;numberOfQuestionInLO="Professor"!==map.userRole||myProgressList||"My Progress"===$("#drpdwnClassProgressSelection option:selected").text()?learningObjectiveItem.totalNumberOfQuestionInLearningObjective:void 0===CaseConnect.enrolledStudentsInCurrentClass?learningObjectiveItem.totalNumberOfQuestionInLearningObjective:learningObjectiveItem.totalNumberOfQuestionInLearningObjective*CaseConnect.enrolledStudentsInCurrentClass;var partialCrrectAnswerInLO=learningObjectiveItem.totalPartialCorrectInLearningObjective,wrongAnswerInLO=learningObjectiveItem.totalWrongAnswerInLearningObjective,unansweredQuestionInLO=numberOfQuestionInLO-crrectAnswerInLO-partialCrrectAnswerInLO-wrongAnswerInLO,crrectAnswerPercentage=crrectAnswerInLO/numberOfQuestionInLO*100,partialCrrectAnswerPercentage=partialCrrectAnswerInLO/numberOfQuestionInLO*100,wrongAnswerPercentage=wrongAnswerInLO/numberOfQuestionInLO*100,unansweredQuestionPercentage=unansweredQuestionInLO/numberOfQuestionInLO*100;crrectAnswerPercentage=Math.round(crrectAnswerPercentage),partialCrrectAnswerPercentage=Math.round(partialCrrectAnswerPercentage),wrongAnswerPercentage=Math.round(wrongAnswerPercentage),unansweredQuestionPercentage=Math.round(unansweredQuestionPercentage),learningObjectiveItem.crrectAnswerPercentage=parseInt(crrectAnswerPercentage),learningObjectiveItem.partialCrrectAnswerPercentage=parseInt(partialCrrectAnswerPercentage),learningObjectiveItem.wrongAnswerPercentage=parseInt(wrongAnswerPercentage),learningObjectiveItem.unansweredQuestionPercentage=parseInt(unansweredQuestionPercentage)}if(void 0!==LOList.chapterVO)if(CaseConnect.currentChapterTitlestudylanding=LOList.chapterVO.navbarTitle,CaseConnect.currentChapterNumberstudylanding=LOList.chapterVO.chapterNumber,""===lastVisitedLearningObjectiveId&&comingFromDropDown&&(lastVisitedQuestionType=""),comingFromDropDown&&lastVisitedQuestionType&&lastVisitedLearningObjectiveId||!comingFromDropDown&&lastVisitedQuestionType&&lastVisitedLearningObjectiveId){var handler="loadStudyCenter",request={},reqData={};request.url="/assessmentRetrievalService/getQuestionForStudyCenterLearn",request.url=properties[properties.env]+request.url,request.method="POST",request.handler=eval("Handler."+handler),request.data=reqData,request.handler.request.apply(null,[request]),Utility.fireRequest(request)}else null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(checkNewsFeedInApp(),expiryDate()),getMyRequestNoftificationCount(),map.wk_conatiner.load("studylanding.html?v18453",function(){insideStudycenterPage=!0,$(window).trigger("resize"),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?"true"===CaseConnect.studyModalCasebookFlag&&welcomeStudyForCasebook():"studyaid"===CaseConnect.bookType&&("true"===CaseConnect.studyModalStudyaidFlag&&welcomeStudyForStudyaid(),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-landing-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams.")),(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),adminSuppressFunc();var e=Handlebars.getTemplate("studycenter-content")(LOList),t=($(this).find("#studycenter-container").append(e),Handlebars.getTemplate("studycenter-chaptertitle")(LOList));$(this).find("#study-chapter-title-template").append(t),$(this).find("#study-chapter-title-template-mobile").append(t);var s=Handlebars.getTemplate("studycenter-viewprogress")(data);$(this).find(".progressDropDown").append(s),$(this).find(".progressDropDownMobile").append(s),CaseConnect.currentBookId!==CaseConnect.bookData.bookId&&CaseConnect.bookTitle?($("#book-name").html(CaseConnect.bookTitle),$(".study-booktitle-mobile").html(CaseConnect.bookTitle)):($("#book-name").html(CaseConnect.bookData.bookTitle),$(".study-booktitle-mobile").html(CaseConnect.bookTitle)),"Student"!==map.userRole&&myProgressList&&void 0===CaseConnect.enrolledStudentsInCurrentClass&&$("#drpdwnClassProgressSelection").val("-999"),$("#study-center-container").removeClass("study-container-inner").addClass("study-container"),$(".ereader-main-header-bookshelfred").show(),$(".back-to-studycenter-red").hide(),$(".study-header-mobile-regular").show(),$(".study-chapter-list-popover").css({width:"100%"}),$(".btn-group").show(),$("#book-name").html(CaseConnect.bookData.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle),$("#chapter-name").html(LOList.chapterVO.navbarTitle),$(".study-popover-chapter-title").html(LOList.chapterVO.navbarTitle),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN(),$(window).scrollTop(0),insideQuestionLO=!1,LOList.chapterVO.chapterNumber,!isNaN(CaseConnect.currentClassEnrollmentCount)&&parseInt(CaseConnect.currentClassEnrollmentCount)<2&&(CaseConnect.currentClassId="-999"),myProgressList&&(CaseConnect.currentClassId="-999");var a=document.documentElement;for(a.setAttribute("data-useragent",navigator.userAgent),a.setAttribute("data-platform",navigator.platform),navigator.userAgent.match(/Trident\/[6]/i)&&$(".bookshelf-doc-dropdown").css({position:"static","background-image":"none"}),i=0,j=LOList.learningObjectiveProgressVOList.length;i<j;i++){var n=LOList.learningObjectiveProgressVOList[i];"0"!==n.totalNumberOfExplanatoryInLearningObjective&&"0"===n.totalNumberOfQuestionInLearningObjective&&$("#"+n.orderIndex+"_progress-set-holder").css("visibility","hidden")}"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md").hide(),$("#studycenter-ad-container-xs").hide()),$(window).trigger("resize"),Utility.hideSpinner()});else Utility.hideSpinner(),alertMessagesModal(exceptionMsg.systemError)}else comingFromDropDown=!1,CaseConnect.currentClassEnrollmentCount="0",null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(checkNewsFeedInApp(),expiryDate()),getMyRequestNoftificationCount(),map.wk_conatiner.load("studylanding.html?v19895",function(){insideStudycenterPage=!0,$(window).trigger("resize"),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?"true"===CaseConnect.studyModalCasebookFlag&&welcomeStudyForCasebook():"studyaid"===CaseConnect.bookType&&("true"===CaseConnect.studyModalStudyaidFlag&&welcomeStudyForStudyaid(),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-landing-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams.")),(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),adminSuppressFunc();Handlebars.getTemplate("studycenter-chaptertitle");if($("#book-name").html(CaseConnect.bookData.bookTitle),$(this).find("#studycenter-container").append("<p class='students-count-less'> Not enough students are enrolled in this class to show aggregated data </p>"),$(window).scrollTop(0),insideQuestionLO=!1,null!==data.classVOList)if(void 0!==data.classVOList){!data.classVOList.length>0&&(data.classVOList=[data.classVOList]);var e={bookId:CaseConnect.currentBookId,classCode:"-999",classDescription:"",classId:"-999",className:"My Progress",createdBy:"-999",createdDate:"2014-12-03 14:00:26.0",meetingTime:"9:00 AM",modifiedDate:"2014-12-03 14:00:26.0",section:"Trusts Section",semesterYear:"Second Sem"};data.classVOList.unshift(e)}else data.classVOList=[{bookId:CaseConnect.currentBookId,classCode:"-999",classDescription:"",classId:"-999",className:"My Progress",createdBy:"-999",createdDate:"2014-12-03 14:00:26.0",meetingTime:"9:00 AM",modifiedDate:"2014-12-03 14:00:26.0",section:"Trusts Section",semesterYear:"Second Sem"}];if(!data.chapterVO&&CaseConnect.currentChapterTitlestudylanding){var t=Handlebars.getTemplate("studycenter-viewprogress")(data),s=Handlebars.getTemplate("studycenter-chaptertitle")(data);$(this).find("#study-chapter-title-template").append(s),$(this).find("#study-chapter-title-template-mobile").append(s),$(this).find(".progressDropDown").append(t),$(this).find(".progressDropDownMobile").append(t),$("#chapter-name").html(CaseConnect.currentChapterTitlestudylanding),$(".study-popover-chapter-title").html(CaseConnect.currentChapterTitlestudylanding)}else if(data.chapterVO){t=Handlebars.getTemplate("studycenter-viewprogress")(data),s=Handlebars.getTemplate("studycenter-chaptertitle")(data);$(this).find("#study-chapter-title-template").append(s),$(this).find("#study-chapter-title-template-mobile").append(s),$(this).find(".progressDropDown").append(t),$(this).find(".progressDropDownMobile").append(t),$("#chapter-name").html(data.chapterVO.navbarTitle),$(".study-popover-chapter-title").html(CaseConnect.currentChapterTitlestudylanding)}CaseConnect.currentBookId!==CaseConnect.bookData.bookId&&CaseConnect.bookTitle?($("#book-name").html(CaseConnect.bookTitle),$(".study-booktitle-mobile").html(CaseConnect.bookTitle)):($("#book-name").html(CaseConnect.bookData.bookTitle),$(".study-booktitle-mobile").html(CaseConnect.bookData.bookTitle)),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN();var a=document.documentElement;a.setAttribute("data-useragent",navigator.userAgent),a.setAttribute("data-platform",navigator.platform),navigator.userAgent.match(/Trident\/[6]/i)&&$(".bookshelf-doc-dropdown").css({position:"static","background-image":"none"}),$(".back-to-studycenter-red").hide(),$(".study-header-mobile-regular").show(),$(".study-chapter-list-popover").css({width:"100%"}),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md").hide(),$("#studycenter-ad-container-xs").hide()),Utility.hideSpinner()})}enableCopyPaste(),request={},Handler.chapterList.request(request);var url=properties[properties.env]+"/learningObjectiveRetrievalService/getChapterAndSupplementListForStudy",request={method:"POST",url:url,data:request.data,handler:Handler.chapterList,target:null};Utility.fireRequest(request)}},Handler.learningObjectiveChapterlist={request:function(e){$("#study-nav-menu-mobile").modal("hide"),null!=saveClicked&&clearInterval(saveClicked);var t=CaseConnect.currentBookId;if(void 0!==CaseConnect.currentbookIdstudylanding){if(lastVisitedLearningObjectiveId="",""==CaseConnect.currentChapterIdstudylanding){if(0==questionpage){t=this.attr("bookId");var s=this.attr("chapterId");CaseConnect.currentLearningObjId="",CaseConnect.currentChapterNumberstudylanding=this.attr("chapterNumber"),CaseConnect.currentChapterTitlestudylanding=this.attr("chapterTitle"),CaseConnect.currentChapterIdstudylanding=this.attr("chapterId"),CaseConnect.currentbookIdstudylanding=t,chapterNumber=CaseConnect.currentChapterNumberstudylanding}if(1==questionpage)if(""==CaseConnect.currentChapterId){CaseConnect.currentLearningObjId="";s="92c49890-daff-11e3-bcbf-21f520d5c4bb",t=t;chapterNumber="1"}else{CaseConnect.currentLearningObjId="";s=CaseConnect.currentChapterId,t=t;chapterNumber=CaseConnect.currentChapterNumberstudylanding}}else if(0==questionpage){CaseConnect.currentLearningObjId="";t=this.attr("bookId"),s=this.attr("chapterId");CaseConnect.currentChapterNumberstudylanding=this.attr("chapterNumber"),chapterNumber=CaseConnect.currentChapterNumberstudylanding,CaseConnect.currentChapterIdstudylanding=this.attr("chapterId"),CaseConnect.currentbookIdstudylanding=t}else CaseConnect.currentLearningObjId="",t=CaseConnect.currentbookIdstudylanding,s=CaseConnect.currentChapterIdstudylanding,chapterNumber=CaseConnect.currentChapterNumberstudylanding;"Student"===map.userRole?e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},classVO:{classId:CaseConnect.currentClassId},bookVO:{bookId:t},chapterVO:{chapterId:s}}:"Professor"===map.userRole&&(!myProgressList&&"My Progress"!==$("#drpdwnClassProgressSelection option:selected").text()&&!isNaN(CaseConnect.currentClassEnrollmentCount)&&parseInt(CaseConnect.currentClassEnrollmentCount)<2?($("#drpdwnClassProgressSelection").val(-999),myProgressList=!0,s="",CaseConnect.currentClassId="-999",e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},bookVO:{bookId:t},chapterVO:{chapterId:s}}):myProgressList||"My Progress"===$("#drpdwnClassProgressSelection option:selected").text()?myProgressList||"My Progress"!==$("#drpdwnClassProgressSelection option:selected").text()?myProgressList&&"-999"===CaseConnect.currentClassId&&(e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},bookVO:{bookId:t},chapterVO:{chapterId:s}}):e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},bookVO:{bookId:t},chapterVO:{chapterId:s}}:e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_VIEWING_LANDING_PAGE",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},classVO:{classId:CaseConnect.currentClassId},bookVO:{bookId:t},chapterVO:{chapterId:s}})}},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),map.overlay.fadeOut(200),map.overlay.css("opacity","0.7"),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else if(CaseConnect.studyModalCasebookFlag=e.casebookDisclaimerFlag,CaseConnect.studyModalStudyaidFlag=e.studyAidDisclaimerFlag,CaseConnect.currentChapterId=CaseConnect.currentChapterIdstudylanding,void 0!==e.chapterLearningObjectiveVO){if(null!==e.classVOList)if(void 0!==e.classVOList){!e.classVOList.length>0&&(e.classVOList=[e.classVOList]);var s={bookId:CaseConnect.currentBookId,classCode:"-999",classDescription:"",classId:"-999",className:"My Progress",createdBy:"-999",createdDate:"2014-12-03 14:00:26.0",meetingTime:"9:00 AM",modifiedDate:"2014-12-03 14:00:26.0",section:"Trusts Section",semesterYear:"Second Sem"};e.classVOList.unshift(s)}else e.classVOList=[{bookId:CaseConnect.currentBookId,classCode:"-999",classDescription:"",classId:"-999",className:"My Progress",createdBy:"-999",createdDate:"2014-12-03 14:00:26.0",meetingTime:"9:00 AM",modifiedDate:"2014-12-03 14:00:26.0",section:"Trusts Section",semesterYear:"Second Sem"}];var a=e.chapterLearningObjectiveVO;if(null!==a){if(void 0!==a.chapterVO){for(void 0===a.chapterVO.chapterNumber&&(a.chapterVO.chapterNumber=chapterNumber),LORightpanel=a,Array.isArray(a.learningObjectiveProgressVOList)||(a.learningObjectiveProgressVOList=[a.learningObjectiveProgressVOList]),i=0,j=a.learningObjectiveProgressVOList.length;i<j;i++){var n=a.learningObjectiveProgressVOList[i],r=n.totalCorrectAnswerInLearningObjective,o=n.totalNumberOfQuestionInLearningObjective,d=n.totalWrongAnswerInLearningObjective;o="Professor"!==map.userRole||myProgressList||"My Progress"===$("#drpdwnClassProgressSelection option:selected").text()?n.totalNumberOfQuestionInLearningObjective:void 0===CaseConnect.enrolledStudentsInCurrentClass?n.totalNumberOfQuestionInLearningObjective:n.totalNumberOfQuestionInLearningObjective*CaseConnect.enrolledStudentsInCurrentClass;var l=n.totalPartialCorrectInLearningObjective,u=l/o*100,c=r/o*100,p=d/o*100,g=(o-r-l-d)/o*100;c=Math.round(c),u=Math.round(u),p=Math.round(p),g=Math.round(g),n.crrectAnswerPercentage=parseInt(c),n.partialCrrectAnswerPercentage=parseInt(u),n.wrongAnswerPercentage=parseInt(p),n.unansweredQuestionPercentage=parseInt(g)}CaseConnect.currentLearningObjId=a.learningObjectiveProgressVOList[0].learningObjId,null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(checkNewsFeedInApp(),expiryDate()),getMyRequestNoftificationCount(),map.wk_conatiner.load("studylanding.html?v19893",function(){insideStudycenterPage=!0,$(window).trigger("resize"),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?"true"===CaseConnect.studyModalCasebookFlag&&welcomeStudyForCasebook():"studyaid"===CaseConnect.bookType&&("true"===CaseConnect.studyModalStudyaidFlag&&welcomeStudyForStudyaid(),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-landing-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams.")),(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".hide-case-page-class").hide()),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),adminSuppressFunc();var t=Handlebars.getTemplate("studycenter-content")(a),s=($(this).find("#studycenter-container").append(t),Handlebars.getTemplate("studycenter-viewprogress")(e)),n=Handlebars.getTemplate("studycenter-chaptertitle")(a);$(this).find("#study-chapter-title-template").append(n),$(this).find("#study-chapter-title-template-mobile").append(n),$(this).find(".progressDropDown").append(s),$(this).find(".progressDropDownMobile").append(s),CaseConnect.currentBookId!==CaseConnect.bookData.bookId&&CaseConnect.bookTitle?($("#book-name").html(CaseConnect.bookTitle),$(".study-booktitle-mobile").html(CaseConnect.bookTitle)):($("#book-name").html(CaseConnect.bookData.bookTitle),$(".study-booktitle-mobile").html(CaseConnect.bookTitle)),$(".study-popover-chapter-title").html(a.chapterVO.navbarTitle),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN(),$(window).scrollTop(0),insideQuestionLO=!1;var r=document.documentElement;for(r.setAttribute("data-useragent",navigator.userAgent),r.setAttribute("data-platform",navigator.platform),navigator.userAgent.match(/Trident\/[6]/i)&&$(".bookshelf-doc-dropdown").css({position:"static","background-image":"none"}),$("#study-center-container").removeClass("study-container-inner").addClass("study-container"),$(".ereader-main-header-bookshelfred").show(),$(".back-to-studycenter-red").hide(),$(".study-header-mobile-regular").show(),$(".study-chapter-list-popover").css({width:"100%"}),$(".btn-group").show(),$("#book-name").html(CaseConnect.bookData.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle),i=0,j=a.learningObjectiveProgressVOList.length;i<j;i++){var o=a.learningObjectiveProgressVOList[i];"0"!==o.totalNumberOfExplanatoryInLearningObjective&&"0"===o.totalNumberOfQuestionInLearningObjective&&$("#"+o.orderIndex+"_progress-set-holder").css("visibility","hidden")}$(window).trigger("resize"),studyChapterListPopoverVisible&&($(".study-chapter-list-popover")[0].focus(),studyChapterListPopoverVisible=!1),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md").hide(),$("#studycenter-ad-container-xs").hide()),Utility.hideSpinner()})}}else Utility.hideSpinner(),alertMessagesModal(exceptionMsg.systemError)}}},Handler.loadExplanatory={request:function(e){var t="",s="";void 0===$(this).attr("questionType")?questionType="explanatory":questionType=$(this).attr("questionType"),t=void 0===$(this).attr("learningObjId")?CaseConnect.currentLearningObjId:$(this).attr("learningObjId"),s=void 0===$(this).attr("learningObjName")?CaseConnect.learningObjName:$(this).attr("learningObjName"),void 0===$(this).attr("explainertype")?explainertype=explainertype:explainertype=$(this).attr("explainertype");var a=CaseConnect.currentChapterIdstudylanding,n=CaseConnect.currentbookIdstudylanding;if(CaseConnect.questionType=questionType,CaseConnect.currentLearningObjId=t,CaseConnect.learningObjName=s,CaseConnect.currentUserId=localStorage.getItem("userId"),$("#learningObjId").val(t),1==explainertype)var i="STUDY_CENTER_LEARN_STREAMING_EXPLAINER_VIDEO";else if(2==explainertype)i="STUDY_CENTER_LEARN_STREAMING_EXPLAINER_AUDIO";else if(3==explainertype)i="STUDY_CENTER_LEARN_STREAMING_EXPLAINER_TEXT";e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:i,pageNavigatingFrom:"studycenter",pageNavigatingTo:"studycenter",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},questionVO:{questionType:questionType,learningObjectId:t,explainertype:explainertype,chapterId:a,bookId:n}},$("#page-loading-spinner").show()},response:function(e,t){Handler.loadExplanatory.processResponse(e,t),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut()},processResponse:function(e,t){if("false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),insideAssessment=!0,$(".study-sub-header-study").css("cursor","pointer"),0==loadPreviousQuestion&&(totalCorrectExplainer=0);var s=e.assessmentVO.countOfTotalQuestion;totalQuestionExplainer=parseInt(s);var a=e.assessmentVO.questionBankVOList;"object"==$.type(a)&&(a=[a]);a.totalQuestion=s;var n=JSPath.apply('.{.currentQuestionFlag == "1"}.questionNumber',a)[0];if("array"==$.type(n)&&0==n.length&&(n=1),"3"===explainertype)var i="Text";else if("2"===explainertype)i="Audio";else if("1"===explainertype)i="Video";var r=i.toLowerCase();if(0==loadPreviousQuestion){var o=0,d=0,l=0;for(o=0,d=LORightpanel.learningObjectiveProgressVOList.length;o<d;o++){var u=LORightpanel.learningObjectiveProgressVOList[o];if(u.learningObjId==CaseConnect.currentLearningObjId){var c=u.learningObjectiveExplainerResponseList;for(l=0;l<c.length;l++){var p=c[l];p.explainerType==r&&(totalCorrectExplainer=p.totalCorrectAnswer)}}}}loadPreviousQuestion=0,a.totalCorrect=totalCorrectExplainer,a.booktitle=CaseConnect.bookData.bookTitle,globalDataText=a,$("#link").load("explainer-content.html?v19893",function(){$("#learningObjectiveName").replaceWith("<div class='back'><h2>"+CaseConnect.learningObjName+"</h2></div>");var e=Handlebars.getTemplate("pagination-explainer")(a);$("#paginationContainer").html(e),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN();var t=JSPath.apply('.{.questionNumber == "'+n+'"}',globalDataText)[0],i=t.questionVO.questionType;if(globalQuestionId=t.questionVO.questionId,t.totalQuestion=s,"3"===explainertype)var r="Explanation";else if("2"===explainertype)r="Audio";else if("1"===explainertype)r="Video";$("#questionTitle").html(r),$("#questionTitle").attr("aria-label",r),void 0!==t.questionVO.studyAidVOList&&"object"==$.type(t.questionVO.studyAidVOList)&&(t.questionVO.studyAidVOList=[t.questionVO.studyAidVOList]);var o=CaseConnect.currentLearningObjId,l=templateArray.indexOf(i);templateArray[l];if(void 0!==t.questionVO.explainerLinkVOList){var u=t.questionVO.explainerLinkVOList;u=$.isArray(u)?u:$(u).toArray();var c=t.questionVO.questionText,p="";brightcovePlayer.height,brightcovePlayer.width,brightcovePlayer.playerID,brightcovePlayer.playerKey;if(0==c.length)for(var g=0;g<u.length;g++)p=u[g].spanid,u[g].expdetail,c+="";else for(g=0;g<u.length;g++)p=u[g].spanid,u[g].expdetail,c=uploadVideo(c,p,"");t.questionVO.questionText=c}var h=Handlebars.getTemplate("explainerQues")(t);for($("#questionContainer").html(h),"undefined"===$("#explainerQuestionText").html()?$("#explainerQuestionText").hide():$("#explainerQuestionText").show(),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN(),"staging"==properties.env&&$(".extId").removeClass("extId"),brightcove.createExperiences(),$("#rightpanel").removeClass("rightpanel-header-main").addClass("rightpanel"),$("#studycenter-empty-column").removeClass("col-md-1 col-sm-1"),$("#studycenter-container").parent().addClass("content-inner"),$("#studycenter-container").parent().addClass("col-md-10"),$("#studycenter-container").parent().removeClass("col-md-12"),$("#study-center-container").removeClass("study-container").addClass("study-container-inner"),$(".ereader-main-header-bookshelfred").hide(),$(".study-header-mobile-regular").hide(),$(".back-to-studycenter-red").show(),$(".study-chapter-list-popover").css({display:"inline-block"}),$(".study-link-mobile").hide(),$(".btn-group").hide(),Array.isArray(LORightpanel.learningObjectiveProgressVOList)||(LORightpanel.learningObjectiveProgressVOList=[LORightpanel.learningObjectiveProgressVOList]),g=0,d=LORightpanel.learningObjectiveProgressVOList.length;g<d;g++){var C=LORightpanel.learningObjectiveProgressVOList[g];if(o==C.learningObjId){for(var m=0,b=C,y=0;y<b.learningObjectiveResponseList.length;y++)b.learningObjectiveResponseList[y].totalQuestions>0&&(m+=1);4===m&&$(".questionsection-inner").css("min-height","600px"),5===m&&$(".questionsection-inner").css("min-height","740px");h=Handlebars.getTemplate("right-panel")(C);$("#rightpanel").html(h),$("#rightpanel").removeClass("col-md-12"),$("#rightpanel").addClass("col-md-2 hidden-xs")}}$(window).trigger("resize");var v=Handlebars.getTemplate("study-footer-content")(t);if($("#studycenter-footer-content").html(v),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-footer-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams."),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md-container").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-container-xs")[0].innerHTML=""),void 0!==t.questionVO.studyAidAdVO&&null!=t.questionVO.studyAidAdVO&&null!=t.questionVO.studyAidAdVO.adImageS3FilePathMD&&null!=t.questionVO.studyAidAdVO.adImageS3FilePathMD&&"true"===t.questionVO.studyAidAdVO.showAd?($("#study-aid-adds-md").find("img").attr("src",t.questionVO.studyAidAdVO.adImageS3FilePathMD),$("#study-aid-adds-md").find("img").attr("alt",t.questionVO.studyAidAdVO.adImageAltTextMD),$("#study-aid-adds-md").find("a").attr("href",t.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-ex-xs").find("img").attr("src",t.questionVO.studyAidAdVO.adImageS3FilePathXS),$("#study-aid-adds-ex-xs").find("img").attr("alt",t.questionVO.studyAidAdVO.adImageAltTextXS),$("#study-aid-adds-ex-xs").find("a").attr("href",t.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-ex-xs").find("img").attr("width","320px")):($("#study-aid-adds-ex-xs").find("img").attr("src",""),$("#study-aid-adds-ex-xs").find("img").attr("alt",""),$("#study-aid-adds-ex-xs").find("img").attr("width",""),$("#study-aid-adds-ex-xs").find("a").attr("href",""),$("#study-aid-adds-md-container").hide(),$("#studycenter-ad-containers-xs").hide()),$(window).width()<768&&void 0!==t.questionVO.studyAidAdVO&&null!=t.questionVO.studyAidAdVO&&null!=t.questionVO.studyAidAdVO.adImageS3FilePathXS&&t.questionVO.studyAidAdVO.adImageS3FilePathXS,$("#wk_content").css("padding-bottom","0px"),$("#study-center-container").css("padding-bottom","0px"),"false"==$('ul.pagination a[id="anchor_'+n+'"]').parent().hasClass("green").toString()){O={},Handler.saveExplanatory.request(O);var O={method:"POST",url:properties[properties.env]+"/manageAssessmentService/saveQuestionResponse",data:O.data,handler:Handler.saveExplanatory,target:null};Utility.fireRequest(O),localStorage.getItem("userId")||CaseConnect.currentUserId,++totalCorrectExplainer,JSPath.apply('.{.questionNumber == "'+n+'"}.questionResponseVO',globalDataText)[0].status="correct",updateStatusInPagination(n,"correct")}$('ul.pagination a[id="anchor_'+n+'"]').parent().addClass("active"),t.totalQuestion==totalCorrectExplainer&&n==t.totalQuestion&&($("#nextbtn").hide(),$("#donebtn").show()),Utility.hideSpinner()})}},clickQuestionNumberExplainer:function(e){for(var t=$(e.target).attr("id").split("_")[1],s=(parseInt(globalDataText.totalQuestion),0);s<globalDataText.length;s++)"1"==globalDataText[s].currentQuestionFlag&&$('ul.pagination a[id="anchor_'+globalDataText[s].questionNumber+'"]').parent().removeClass("active"),globalDataText[s].currentQuestionFlag="0";var a=JSPath.apply('.{.questionNumber == "'+t+'"}',globalDataText)[0];a.currentQuestionFlag="1";var n=JSPath.apply('.{.currentQuestionFlag == "1"}.questionNumber',globalDataText)[0];$('ul.pagination a[id="anchor_'+n+'"]').parent().addClass("active");var i=a.questionVO.questionType;if(explainertype=a.questionVO.explainertype,globalQuestionId=a.questionVO.questionId,void 0!==a.questionVO.studyAidVOList&&"object"==$.type(a.questionVO.studyAidVOList)&&(a.questionVO.studyAidVOList=[a.questionVO.studyAidVOList]),"3"===explainertype)var r="Explanation";else if("2"===explainertype)r="Audio";else if("1"===explainertype)r="Video";$("#questionTitle").html(r),$("#questionTitle").attr("aria-label",r);var o=CaseConnect.currentLearningObjId,d=templateArray.indexOf(i);a.totalQuestion=totalQuestionExplainer;templateArray[d];if(void 0!==a.questionVO.explainerLinkVOList){var l=a.questionVO.explainerLinkVOList;l=$.isArray(l)?l:$(l).toArray();var u=a.questionVO.questionText;if(!new RegExp("<object","g").test(u)){var c="";brightcovePlayer.height,brightcovePlayer.width,brightcovePlayer.playerID,brightcovePlayer.playerKey;if(0==u.length)for(s=0;s<l.length;s++)c=l[s].spanid,l[s].expdetail,u+="";else for(s=0;s<l.length;s++)c=l[s].spanid,l[s].expdetail,u=uploadVideo(u,c,"")}a.questionVO.questionText=u}var p=Handlebars.getTemplate("explainerQues")(a);for($("#questionContainer").html(p),"undefined"===$("#explainerQuestionText").html()?$("#explainerQuestionText").hide():$("#explainerQuestionText").show(),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN(),"staging"==properties.env&&$(".extId").removeClass("extId"),brightcove.createExperiences(),$("#rightpanel").removeClass("rightpanel-header-main").addClass("rightpanel"),$("#studycenter-container").parent().addClass("content-inner"),$("#studycenter-container").parent().addClass("col-md-10"),$("#studycenter-container").parent().removeClass("col-md-12"),Array.isArray(LORightpanel.learningObjectiveProgressVOList)||(LORightpanel.learningObjectiveProgressVOList=[LORightpanel.learningObjectiveProgressVOList]),s=0,j=LORightpanel.learningObjectiveProgressVOList.length;s<j;s++){var g=LORightpanel.learningObjectiveProgressVOList[s];if(o==g.learningObjId){p=Handlebars.getTemplate("right-panel")(g);$("#rightpanel").html(p),$("#rightpanel").removeClass("col-md-12"),$("#rightpanel").addClass("col-md-2 hidden-xs")}}$(window).trigger("resize");var h=Handlebars.getTemplate("study-footer-content")(a);if($("#studycenter-footer-content").html(h),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-footer-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams."),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md-container").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-container-xs")[0].innerHTML=""),void 0!==a.questionVO.studyAidAdVO&&null!=a.questionVO.studyAidAdVO&&null!=a.questionVO.studyAidAdVO.adImageS3FilePathMD&&null!=a.questionVO.studyAidAdVO.adImageS3FilePathMD&&"true"===a.questionVO.studyAidAdVO.showAd?($("#study-aid-adds-md").find("img").attr("src",a.questionVO.studyAidAdVO.adImageS3FilePathMD),$("#study-aid-adds-md").find("img").attr("alt",a.questionVO.studyAidAdVO.adImageAltTextMD),$("#study-aid-adds-md").find("a").attr("href",a.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-ex-xs").find("img").attr("src",a.questionVO.studyAidAdVO.adImageS3FilePathXS),$("#study-aid-adds-ex-xs").find("img").attr("alt",a.questionVO.studyAidAdVO.adImageAltTextXS),$("#study-aid-adds-ex-xs").find("a").attr("href",a.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-ex-xs").find("img").attr("width","320px")):($("#study-aid-adds-ex-xs").find("img").attr("src",""),$("#study-aid-adds-ex-xs").find("img").attr("alt",""),$("#study-aid-adds-ex-xs").find("img").attr("width",""),$("#study-aid-adds-ex-xs").find("a").attr("href",""),$("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-containers-xs").hide()),$(window).width()<768&&void 0!==a.questionVO.studyAidAdVO&&null!=a.questionVO.studyAidAdVO&&null!=a.questionVO.studyAidAdVO.adImageS3FilePathXS&&a.questionVO.studyAidAdVO.adImageS3FilePathXS,$("#wk_content").css("padding-bottom","0px"),$("#study-center-container").css("padding-bottom","0px"),C={},"false"==$('ul.pagination a[id="anchor_'+n+'"]').parent().hasClass("green").toString()){Handler.saveExplanatory.request(C);var C={method:"POST",url:properties[properties.env]+"/manageAssessmentService/saveQuestionResponse",data:C.data,handler:Handler.saveExplanatory,target:null};Utility.fireRequest(C),++totalCorrectExplainer}a.totalQuestion==totalCorrectExplainer&&n==a.totalQuestion&&($("#nextbtn").hide(),$("#donebtn").show()),JSPath.apply('.{.questionNumber == "'+n+'"}.questionResponseVO',globalDataText)[0].status="correct",updateStatusInPagination(n,"correct")},handleDoneClick:function(e){t={},questionpage=1,Handler.learningObjectiveChapterlist.request(t);var t={method:"POST",url:properties[properties.env]+"/learningObjectiveRetrievalService/getLearningObjectiveAndProgressDetails",data:t.data,handler:Handler.learningObjectiveChapterlist,target:null};Utility.fireRequest(t),Utility.hideSpinner()}},Handler.handleNextClickExplainer=function(event){var nextQuestion=parseInt($("ul.pagination li.active > a").attr("id").split("_")[1])+1,totalQuestions=parseInt(globalDataText.totalQuestion);if(nextQuestion<=totalQuestions){var isExists=JSPath.apply('.{.questionNumber == "'+nextQuestion+'"}',globalDataText).length>0;if(isExists)$("ul.pagination a#anchor_"+nextQuestion).trigger("click");else{var ele=event.target,handler="loadStudyCenterForExtraQuestionExplainer",request={},data={},questionType=JSPath.apply('.{.questionNumber == "'+(nextQuestion-1)+'"}.questionVO.questionType',globalDataText)[0];request.url="/assessmentRetrievalService/getQuestionForStudyCenterLearn",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(event.target);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.startPoint=nextQuestion,request.questionType=questionType,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request),localStorage.getItem("userId")||CaseConnect.currentUserId}}else{var questionType=JSPath.apply('.{.questionNumber == "'+(nextQuestion-1)+'"}.questionVO.questionType',globalDataText)[0];nextQuestion=1;var isExists=JSPath.apply('.{.questionNumber == "'+nextQuestion+'"}',globalDataText).length>0;if(isExists)$("ul.pagination a#anchor_"+nextQuestion).trigger("click");else{loadPreviousQuestion=1;var ele=event.target,handler="loadExplanatory",request={},data={};request.url="/assessmentRetrievalService/getQuestionForStudyCenterLearn",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(event.target);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.startPoint=nextQuestion,request.questionType=questionType,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request)}}$(window).scrollTop(0),$(window).trigger("resize")},Handler.handlePrevClickExplainer=function(event){var prevQuestion=parseInt($("ul.pagination li.active > a").attr("id").split("_")[1])-1,isExists=JSPath.apply('.{.questionNumber == "'+prevQuestion+'"}',globalDataText).length>0;if(prevQuestion-1>=0){if(isExists)$("ul.pagination a#anchor_"+prevQuestion).trigger("click");else{var ele=event.target,handler="loadStudyCenterForExtraQuestionExplainer",request={},data={},questionType=JSPath.apply('.{.questionNumber == "'+(prevQuestion+1)+'"}.questionVO.questionType',globalDataText)[0];request.url="/assessmentRetrievalService/getQuestionForStudyCenterLearn",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(event.target);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.startPoint=prevQuestion,request.questionType=questionType,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request),localStorage.getItem("userId")||CaseConnect.currentUserId}$(window).trigger("resize")}},Handler.loadStudyCenterForExtraQuestionExplainer={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t=CaseConnect.currentLearningObjId,s=CaseConnect.currentChapterIdstudylanding,a=CaseConnect.currentbookIdstudylanding,n=e.questionType;if(CaseConnect.questionType=n,1==explainertype)var i="STUDY_CENTER_LEARN_STREAMING_EXPLAINER_VIDEO";else if(2==explainertype)i="STUDY_CENTER_LEARN_STREAMING_EXPLAINER_AUDIO";else if(3==explainertype)i="STUDY_CENTER_LEARN_STREAMING_EXPLAINER_TEXT";e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:i,pageNavigatingFrom:"studycenter",pageNavigatingTo:"studycenter",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},questionVO:{questionType:n,learningObjectId:t,explainertype:explainertype,chapterId:s,bookId:a,startPoint:e.startPoint,limit:"1"}},$("#page-loading-spinner").show()},response:function(e,t){Handler.loadStudyCenterForExtraQuestionExplainer.processResponse(e,t),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut()},processResponse:function(e,t){if("false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide();var s=parseInt(e.assessmentVO.questionBankVOList.questionNumber),a=parseInt(JSPath.apply('.{.currentQuestionFlag == "1"}.questionNumber',globalDataText)[0]);a<s?(globalDataText.splice(0,1),globalDataText.push(e.assessmentVO.questionBankVOList)):(globalDataText.pop(),globalDataText.splice(0,0,e.assessmentVO.questionBankVOList)),$("#link").load("explainer-content.html?v19893",function(){$("#learningObjectiveName").replaceWith("<div class='back'><h2>"+CaseConnect.learningObjName+"</h2></div>");var t=Handlebars.getTemplate("pagination-explainer")(globalDataText);$("#paginationContainer").html(t),$('ul.pagination a[id="anchor_'+s+'"]').parent().addClass("active"),$('ul.pagination a[id="anchor_'+a+'"]').parent().removeClass("active");var n=JSPath.apply('.{.questionNumber == "'+s+'"}',globalDataText)[0];n.currentQuestionFlag="1",void 0!==e.assessmentVO.questionBankVOList.questionVO.studyAidVOList&&"object"==$.type(n.questionVO.studyAidVOList)&&(n.questionVO.studyAidVOList=[n.questionVO.studyAidVOList]);var i=n.questionVO.questionType;if(globalQuestionId=n.questionVO.questionId,"3"===explainertype)var r="Explanation";else if("2"===explainertype)r="Audio";else if("1"===explainertype)r="Video";$("#questionTitle").html(r),$("#questionTitle").attr("aria-label",r);var o=CaseConnect.currentLearningObjId,d=parseInt(globalDataText.totalQuestion),l=templateArray.indexOf(i);if(n.totalQuestion=d,void 0!==n.questionVO.explainerLinkVOList){var u=n.questionVO.questionText,c=n.questionVO.explainerLinkVOList;c=$.isArray(c)?c:$(c).toArray();var p="";brightcovePlayer.height,brightcovePlayer.width,brightcovePlayer.playerID,brightcovePlayer.playerKey;if(0==u.length)for(var g=0;g<c.length;g++)p=c[g].spanid,c[g].expdetail,u+="";else for(g=0;g<c.length;g++)p=c[g].spanid,c[g].expdetail,u=uploadVideo(u,p,"");n.questionVO.questionText=u}templateArray[l];var h=Handlebars.getTemplate("explainerQues")(n);for($("#questionContainer").html(h),"undefined"===$("#explainerQuestionText").html()?$("#explainerQuestionText").hide():$("#explainerQuestionText").show(),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN(),brightcove.createExperiences(),"staging"==properties.env&&$(".extId").removeClass("extId"),$("#rightpanel").removeClass("rightpanel-header-main").addClass("rightpanel"),$("#studycenter-empty-column").removeClass("col-md-1 col-sm-1"),$("#study-center-container").removeClass("study-container").addClass("study-container-inner"),$(".ereader-main-header-bookshelfred").hide(),$(".study-header-mobile-regular").hide(),$(".back-to-studycenter-red").show(),$(".study-chapter-list-popover").css({display:"inline-block"}),$(".study-link-mobile").hide(),$(".btn-group").hide(),Array.isArray(LORightpanel.learningObjectiveProgressVOList)||(LORightpanel.learningObjectiveProgressVOList=[LORightpanel.learningObjectiveProgressVOList]),g=0,j=LORightpanel.learningObjectiveProgressVOList.length;g<j;g++){var C=LORightpanel.learningObjectiveProgressVOList[g];if(o==C.learningObjId){h=Handlebars.getTemplate("right-panel")(C);$("#rightpanel").html(h),$("#rightpanel").removeClass("col-md-12"),$("#rightpanel").addClass("col-md-2 hidden-xs")}}$(window).trigger("resize");var m=Handlebars.getTemplate("study-footer-content")(n);if($("#studycenter-footer-content").html(m),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-footer-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams."),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md-container").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-container-xs")[0].innerHTML=""),void 0!==n.questionVO.studyAidAdVO&&null!=n.questionVO.studyAidAdVO&&null!=n.questionVO.studyAidAdVO.adImageS3FilePathMD&&null!=n.questionVO.studyAidAdVO.adImageS3FilePathMD&&"true"===n.questionVO.studyAidAdVO.showAd?($("#study-aid-adds-md").find("img").attr("src",n.questionVO.studyAidAdVO.adImageS3FilePathMD),$("#study-aid-adds-md").find("img").attr("alt",n.questionVO.studyAidAdVO.adImageAltTextMD),$("#study-aid-adds-md").find("a").attr("href",n.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-ex-xs").find("img").attr("src",n.questionVO.studyAidAdVO.adImageS3FilePathXS),$("#study-aid-adds-ex-xs").find("img").attr("alt",n.questionVO.studyAidAdVO.adImageAltTextXS),$("#study-aid-adds-ex-xs").find("a").attr("href",n.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-ex-xs").find("img").attr("width","320px")):($("#study-aid-adds-ex-xs").find("img").attr("src",""),$("#study-aid-adds-ex-xs").find("img").attr("alt",""),$("#study-aid-adds-ex-xs").find("img").attr("width",""),$("#study-aid-adds-ex-xs").find("a").attr("href",""),$("#study-aid-adds-md-container").hide(),$("#studycenter-ad-containers-xs").hide()),$(window).width()<768&&void 0!==n.questionVO.studyAidAdVO&&null!=n.questionVO.studyAidAdVO&&null!=n.questionVO.studyAidAdVO.adImageS3FilePathXS&&n.questionVO.studyAidAdVO.adImageS3FilePathXS,$("#wk_content").css("padding-bottom","0px"),$("#study-center-container").css("padding-bottom","0px"),b={},"false"==$('ul.pagination a[id="anchor_'+s+'"]').parent().hasClass("green").toString()){Handler.saveExplanatory.request(b);var b={method:"POST",url:properties[properties.env]+"/manageAssessmentService/saveQuestionResponse",data:b.data,handler:Handler.saveExplanatory,target:null};Utility.fireRequest(b),localStorage.getItem("userId")||CaseConnect.currentUserId,++totalCorrectExplainer}totalQuestionExplainer==totalCorrectExplainer&&s==totalQuestionExplainer&&($("#nextbtn").hide(),$("#donebtn").show()),JSPath.apply('.{.questionNumber == "'+s+'"}.questionResponseVO',globalDataText)[0].status="correct",updateStatusInPagination(s,"correct"),Utility.hideSpinner(),$(window).trigger("resize")})}}},Handler.loadStudyCenter={request:function(e){if(CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.questionType="",comingFromDropDown){if(comingFromDropDown&&!myProgressList)if("Internet Explorer"===CaseConnect.browserName)if($(this)&&$(this).attr("questiontype")){t=$(this)[0].getAttribute("questiontype")?$(this)[0].getAttribute("questiontype"):$("#questionType").val(),s=$(this)[0].getAttribute("learningobjid")?$(this)[0].getAttribute("learningobjid"):CaseConnect.currentLearningObjId,a=$(this)[0].getAttribute("learningobjname")?$(this)[0].getAttribute("learningobjname"):CaseConnect.learningObjName;CaseConnect.learningObjName=a}else{t=lastVisitedQuestionType;if(""===(s=lastVisitedLearningObjectiveId)){t="";lastVisitedQuestionType=""}}else if($(this[0])&&$(this[0]).attr("questiontype")){t=$(this)[0].getAttribute("questiontype")?$(this)[0].getAttribute("questiontype"):$("#questionType").val(),s=$(this)[0].getAttribute("learningobjid")?$(this)[0].getAttribute("learningobjid"):CaseConnect.currentLearningObjId,a=$(this)[0].getAttribute("learningobjname")?$(this)[0].getAttribute("learningobjname"):CaseConnect.learningObjName;CaseConnect.learningObjName=a}else{t=lastVisitedQuestionType;if(""===(s=lastVisitedLearningObjectiveId)){t="";lastVisitedQuestionType=""}}else if(comingFromDropDown&&myProgressList&&lastVisitedLearningObjectiveId||!comingFromDropDown&&myProgressList&&lastVisitedLearningObjectiveId)s=lastVisitedLearningObjectiveId,t=lastVisitedQuestionType}else if(void 0===lastVisitedLearningObjectiveId||""===lastVisitedLearningObjectiveId){var t=$(this)[0].getAttribute("questiontype")?$(this)[0].getAttribute("questiontype"):$("#questionType").val(),s=$(this)[0].getAttribute("learningobjid")?$(this)[0].getAttribute("learningobjid"):CaseConnect.currentLearningObjId,a=$(this)[0].getAttribute("learningobjname")?$(this)[0].getAttribute("learningobjname"):CaseConnect.learningObjName;CaseConnect.learningObjName=a}else if(void 0!==lastVisitedLearningObjectiveId&&void 0!==$(this)[0].getAttribute||""!==lastVisitedLearningObjectiveId&&void 0!==$(this)[0].getAttribute){var t=$(this)[0].getAttribute("questiontype")?$(this)[0].getAttribute("questiontype"):$("#questionType").val(),s=$(this)[0].getAttribute("learningobjid")?$(this)[0].getAttribute("learningobjid"):CaseConnect.currentLearningObjId,a=$(this)[0].getAttribute("learningobjname")?$(this)[0].getAttribute("learningobjname"):CaseConnect.learningObjName;CaseConnect.learningObjName=a}else s=lastVisitedLearningObjectiveId,t=lastVisitedQuestionType;$("#learningObjId").val(s),CaseConnect.currentLearningObjId=s,void 0!==lastVisitedLearningObjectiveId&&""!==lastVisitedLearningObjectiveId?CaseConnect.currentLearningObjId=lastVisitedLearningObjectiveId:lastVisitedLearningObjectiveId=CaseConnect.currentLearningObjId;var n=CaseConnect.currentChapterIdstudylanding,i=CaseConnect.currentbookIdstudylanding;"Professor"===map.userRole?(myProgressList||$("#drpdwnClassProgressSelection option:selected").text(),e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_GET_QUESTIONS",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},questionVO:{classId:CaseConnect.currentClassId,questionType:t,learningObjectId:s,chapterId:n,bookId:i}}):e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_GET_QUESTIONS",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},questionVO:{questionType:t,learningObjectId:s,chapterId:n,bookId:i}},$("#page-loading-spinner").show()},response:function(e,t){Handler.loadStudyCenter.processResponse(e,t),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),void 0!==CaseConnect.newsFeedFlag&&"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),$(window).scrollTop(0),$(window).trigger("resize"),$(".modal").modal("hide"),$("body").removeClass("modal-open"),$(".modal-backdrop").remove()},processResponse:function(e,t){if("false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{insideAssessment=!0,$(".study-sub-header-study").css("cursor","pointer"),$(".mce-tooltip").remove(),$("#issueContainer").length>0&&$("#issueContainer span.highlight").length>0&&$("#issueContainer span.highlight").popover("destroy"),qList=[],subQList=[],$(".popover-issue-mcq").remove(),totalNumberOfQuestionsInLO=e.assessmentVO.countOfTotalQuestion,questionDetailsOfLO=e.assessmentVO.questionBankVOList;var s=e.assessmentVO.questionBankVOList;"object"==$.type(s)&&(s=[s]);var a=s[0].questionVO.questionType;"clustermcq"==a?a="multichoice":"clusterhypo"==a&&(a="hypothetical");var n=CaseConnect.currentLearningObjId,i=JSPath.apply('.{.learningObjId == "'+n+'"}.learningObjectiveResponseList.{.questionType == "'+a+'"}',LORightpanel.learningObjectiveProgressVOList)[0],r=i.totalCorrectAnswer,o=i.totalPartialCorrect,d=i.totalWrongAnswer,l=i.totalUnAnswered,u=i.totalQuestions;s.totalQuestion=u;var c=JSPath.apply('.{.currentQuestionFlag == "1"}.questionNumber',s);"array"==$.type(c)&&0==c.length&&(c=1);for(var p=0;p<s.length;p++){if(s[p].totalQuestion=u,"clusterhypo"==(a=s[p].questionVO.questionType)||"clustermcq"==a)for(var g=s[p].questionVO.subQuestionVOList,h=0;h<g.length;h++)g[h].totalSubQuestions=g.length;"object"==$.type(s[p].questionVO.studyAidVOList)&&(s[p].questionVO.studyAidVOList=[s[p].questionVO.studyAidVOList]),"object"==$.type(s[p].questionVO.studyReferenceVOList)&&(s[p].questionVO.studyReferenceVOList=[s[p].questionVO.studyReferenceVOList])}s.totalCorrect=r,s.totalPartialCorrect=o,s.totalIncorrect=d,s.totalUnanswered=l,totalUnansweredInClass=l,globalData=s,tinymce&&tinymce.remove("textarea"),$("#studycenter-container").load("studycontent.html?v19893",function(){var e=CaseConnect.currentLearningObjId;$("#study-center-container").removeClass("study-container").addClass("study-container-inner"),$("#studycenter-empty-column").removeClass("col-md-1 col-sm-1"),$("#studycenter-container").removeClass("col-md-11 col-sm-11").addClass("col-md-12 col-sm-12"),$(".ereader-main-header-bookshelfred").hide(),insideQuestionLO=!0,$(".study-header-mobile-regular").hide(),$(".back-to-studycenter-red").show(),$(".study-chapter-list-popover").css({display:"inline-block"}),$(".study-link-mobile").hide(),$(".btn-group").hide(),$("#chapterNumber").html(LORightpanel.chapterVO.chapterNumber),LORightpanel.chapterVO.chapterNumber,$("#chapterName").html(LORightpanel.chapterVO.chapterTitle),$(".questionsection-inner .back> h2").html(CaseConnect.learningObjName),$(".questionsection-inner .back> h2").attr("aria-label",CaseConnect.learningObjName);var t=Handlebars.getTemplate("pagination")(s);$("#paginationContainer").html(t),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN();var a=JSPath.apply('.{.questionNumber == "'+c+'"}',globalData)[0],n=a.questionVO.questionType;$("#questionTitle").html(questionTitleArr[n]),$("#questionTitle").attr("aria-label",questionTitleArr[n]);var i=templateArray.indexOf(n),r=templateArray[i],o=Handlebars.getTemplate(r)(a);for($("#questionContainer").html(o),displayEndorseTooltipContent(),appendQueryString(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN(),"staging"==properties.env&&$(".extId").removeClass("extId"),$("#rightpanel").removeClass("rightpanel-header-main").addClass("rightpanel"),$("#studycenter-container").parent().addClass("content-inner"),$("#studycenter-container").parent().addClass("col-md-10"),$("#studycenter-container").parent().removeClass("col-md-12"),$(window).width()<768&&($("#study-chapter-title-template-mobile").remove(),"undefined"!=typeof insideQuestionLO&&insideQuestionLO?($(".study-landing-page-header-mobile").hide(),$(".study-landing-page-header-mobile").css("display","none"),$(".study-content-page-header-mobile").show()):($(".study-landing-page-header-mobile").show(),$(".study-landing-page-header-mobile").css("display","inline-block"),$(".study-content-page-header-mobile").hide())),Array.isArray(LORightpanel.learningObjectiveProgressVOList)||(LORightpanel.learningObjectiveProgressVOList=[LORightpanel.learningObjectiveProgressVOList]),p=0,h=LORightpanel.learningObjectiveProgressVOList.length;p<h;p++){var d=LORightpanel.learningObjectiveProgressVOList[p];if(e==d.learningObjId){o=Handlebars.getTemplate("right-panel")(d);$("#rightpanel").html(o),$("#rightpanel").removeClass("col-md-12"),$("#rightpanel").addClass("col-md-2 hidden-xs")}}$(window).trigger("resize");var l=$("#rightpanel canvas"),u=n;"clustermcq"==u?u="multichoice":"clusterhypo"==u&&(u="hypothetical");for(var p=0;p<l.length;p++)if($(l[p]).attr("questiontype")==u){$(l[p]).parent().hide();break}rightpanelcontent();var g=Handlebars.getTemplate("bottom-container")(a);$("#bottomContainer").html(g);var C=Handlebars.getTemplate("study-footer-content")(a);$("#studycenter-footer-content").html(C),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-footer-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams."),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md-container").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-container-xs")[0].innerHTML=""),void 0!==a.questionVO.studyAidAdVO&&null!=a.questionVO.studyAidAdVO&&null!=a.questionVO.studyAidAdVO.adImageS3FilePathMD&&null!=a.questionVO.studyAidAdVO.adImageS3FilePathMD&&"true"===a.questionVO.studyAidAdVO.showAd?($("#study-aid-adds-md").find("img").attr("src",a.questionVO.studyAidAdVO.adImageS3FilePathMD),$("#study-aid-adds-md").find("img").attr("alt",a.questionVO.studyAidAdVO.adImageAltTextMD),$("#study-aid-adds-md").find("a").attr("href",a.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-xs").find("img").attr("src",a.questionVO.studyAidAdVO.adImageS3FilePathXS),$("#study-aid-adds-xs").find("img").attr("alt",a.questionVO.studyAidAdVO.adImageAltTextXS),$("#study-aid-adds-xs").find("a").attr("href",a.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-xs").find("img").attr("width","320px")):($("#study-aid-adds-xs").find("img").attr("src",""),$("#study-aid-adds-xs").find("img").attr("alt",""),$("#study-aid-adds-xs").find("img").attr("width",""),$("#study-aid-adds-xs").find("a").attr("href",""),$("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-containers-xs").hide());var m=$(window).width();void 0!==a.questionVO.studyAidAdVO&&(m<768&&null!=a.questionVO.studyAidAdVO.adImageS3FilePathXS&&a.questionVO.studyAidAdVO.adImageS3FilePathXS,$("#wk_content").css("padding-bottom","0px"),$("#study-center-container").css("padding-bottom","0px")),$('ul.pagination a[id="anchor_'+c+'"]').parent().addClass("active"),"1"===c.toString()?($("span#prev").attr("disabled","disabled"),$(".study-pagination-prev-large").css("cursor","default"),$("span#prev").css("color","#ccc"),$("span#prev").removeAttr("data-handler")):($("span#prev").removeAttr("disabled"),$(".study-pagination-prev-large").css("cursor","pointer"),$("span#prev").css("color","#666"),$("span#prev").attr("data-handler","handlePrevClick")),"clustermcq"==n?Handler.loadStudyCenter.processQuestionResponseclustermcq():Handler.loadStudyCenter.processQuestionResponse(),handleDoneButton(JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0]),null!=saveClicked&&clearInterval(saveClicked),"essay"==n||"hypothetical"==n?saveClicked=setInterval(function(){$("#saveBtn").trigger("click")},18e4):"clusterhypo"==n&&(saveClicked=setInterval(autoSaveClusterHypo,18e4)),"essay"!=n&&"hypothetical"!=n||$(window).scrollTop(0),lastVisitedQuestionType=n,loadStudyQuestionImagesFromCDN(),Utility.hideSpinner()})}},enableSubmit:function(e){$("#submitBtn").removeAttr("disabled")},enableSubmitClustermcq:function(e){var t=$(e.target).attr("name").split("_")[1];$("#submitBtn_"+t).removeAttr("disabled")},clickQuestionNumber:function(e){qList=[],subQList=[];for(var t=$(e.target),s=t.attr("id").split("_")[1],a=0;a<globalData.length;a++)globalData[a].currentQuestionFlag="0";tinymce.remove("textarea");var n=JSPath.apply('.{.questionNumber == "'+s+'"}',globalData)[0];n.currentQuestionFlag="1";var i=n.questionVO.questionType;$("#questionTitle").html(questionTitleArr[i]),$("#questionTitle").attr("aria-label",questionTitleArr[i]);var r=templateArray.indexOf(i),o=templateArray[r],d=Handlebars.getTemplate(o)(n);$("#questionContainer").html(d),displayEndorseTooltipContent(),appendQueryString(),displayEndorseTooltipStudent(),$(".question-number-for-total").focus(),"staging"==properties.env&&$(".extId").removeClass("extId");var l=Handlebars.getTemplate("bottom-container")(n);$("#bottomContainer").html(l);var u=Handlebars.getTemplate("study-footer-content")(n);$("#studycenter-footer-content").html(u),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-footer-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams."),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md-container").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-container-xs")[0].innerHTML=""),void 0!==n.questionVO.studyAidAdVO&&null!=n.questionVO.studyAidAdVO&&null!=n.questionVO.studyAidAdVO.adImageS3FilePathMD&&null!=n.questionVO.studyAidAdVO.adImageS3FilePathMD&&"true"===n.questionVO.studyAidAdVO.showAd?($("#study-aid-adds-md").find("img").attr("src",n.questionVO.studyAidAdVO.adImageS3FilePathMD),$("#study-aid-adds-md").find("img").attr("alt",n.questionVO.studyAidAdVO.adImageAltTextMD),$("#study-aid-adds-md").find("a").attr("href",n.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-xs").find("img").attr("src",n.questionVO.studyAidAdVO.adImageS3FilePathXS),$("#study-aid-adds-xs").find("img").attr("alt",n.questionVO.studyAidAdVO.adImageAltTextXS),$("#study-aid-adds-xs").find("a").attr("href",n.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-xs").find("img").attr("width","320px")):($("#study-aid-adds-xs").find("img").attr("src",""),$("#study-aid-adds-xs").find("img").attr("alt",""),$("#study-aid-adds-xs").find("img").attr("width",""),$("#study-aid-adds-xs").find("a").attr("href",""),$("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-containers-xs").hide());var c=$(window).width();c<768&&void 0!==n.questionVO.studyAidAdVO?c<768&&null!=n.questionVO.studyAidAdVO&&c<768&&null!=n.questionVO.studyAidAdVO.adImageS3FilePathXS&&null!=n.questionVO.studyAidAdVO.adImageS3FilePathXS&&($("#wk_content").css("padding-bottom","0px"),$("#study-center-container").css("padding-bottom","0px")):($("#wk_content").css("padding-bottom","0px"),$("#study-center-container").css("padding-bottom","0px")),$("ul.pagination li").removeClass("active"),t.parent().addClass("active"),s===totalNumberOfQuestionsInLO?($("span#next").attr("disabled","disabled"),$("span#next").removeAttr("data-handler"),$("span#next").css("color","#ccc"),$(".study-pagination-next-large").css("cursor","default"),e.stopPropagation()):($("span#next").removeAttr("disabled","disabled"),$("span#next").attr("data-handler","handleNextClick"),$(".study-pagination-next-large").css("cursor","pointer"),$("span#next").css("color","#666")),"1"===s?($("span#prev").attr("disabled","disabled"),$(".study-pagination-prev-large").css("cursor","default"),$("span#prev").css("color","#ccc"),$("span#prev").removeAttr("data-handler")):($("span#prev").removeAttr("disabled"),$(".study-pagination-prev-large").css("cursor","pointer"),$("span#prev").css("color","#666"),$("span#prev").attr("data-handler","handlePrevClick")),"essay"==i||"hypothetical"==i?(null!=saveClicked&&clearInterval(saveClicked),saveClicked=setInterval(function(){$("#saveBtn").trigger("click")},18e4)):"clusterhypo"==i&&(null!=saveClicked&&clearInterval(saveClicked),saveClicked=setInterval(autoSaveClusterHypo,18e4)),"clustermcq"==i?Handler.loadStudyCenter.processQuestionResponseclustermcq():Handler.loadStudyCenter.processQuestionResponse(),loadStudyQuestionImagesFromCDN(),setTimeout(function(){$(window).scrollTop(0),$(window).trigger("resize")},300)},processQuestionResponse:function(){var e=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0],t=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO',globalData)[0],s=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionType',globalData)[0],a=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.contentType',globalData)[0];if("flashcard"!=s||"correct"!=e.status&&"incorrect"!=e.status||$("#btnFlagHideShow").trigger("click"),$(".popover-issue-mcq").remove(),e.attemptedAnswerVOList)if("essay"==s||"hypothetical"==s||"issuespotting"==s){JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO',globalData)[0];if(""!=e.attemptedAnswerVOList.responseText){if($('label[for="'+s+'Editor"]').hide(),"issuespotting"==s){var n=e.attemptedAnswerVOList.responseText.split("|||||"),i=n[0].split(","),r=n[1],o=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList.{.questionType == "order"}',globalData)[0].subAnswerVOList,d=[];$("#issueContainer span.issue").addClass("issueVisited");for(var l=0;l<i.length;l++)for(var u=0;u<o.length;u++)if(i[l]==o[u].issueId){d.push(o[u].issueText);var c="";1==o.length&&(c=$('<li class="issue-list-item" tabindex="0" issueid="'+o[u].issueId+'" correctorder="'+o[u].correctOrder+'"><span class="arrange-issue"><span class="text-lable">'+o[u].issueText+"</span></span></li>")),c=1==e.attemptedAnswerVOList.saveFlag?$('<li class="issue-list-item" tabindex="0" issueid="'+o[u].issueId+'" correctorder="'+o[u].correctOrder+'"><button type="button" tabindex="0" class="uparrow" onClick="swapWithPrev(this);" ontouchstart="swapWithPrev(this);"></button><span class="arrange-issue"><span class="text-lable">'+o[u].issueText+'</span></span><button type="button" tabindex="0" class="downarrow" onClick="swapWithNext(this);" ontouchstart="swapWithNext(this);"></button></li>'):$('<li class="issue-list-item" tabindex="0" issueid="'+o[u].issueId+'" correctorder="'+o[u].correctOrder+'"><button type="button" tabindex="0" class="uparrow"></button><span class="arrange-issue"><span class="text-lable">'+o[u].issueText+'</span></span><button type="button" tabindex="0" class="downarrow"></button></li>'),$("#issueOrderContainer ul.sortable").append(c);break}$("#tinymceContent").val(r),setTimeout(function(){null!=tinyMCE.get(s+"Editor")&&tinyMCE.get(s+"Editor").setContent(r)},1e3),setTimeout(function(){$(window).scrollTop(0)},300);var p=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList.{.questionType == "essay"}',globalData)[0].questionText;$("#essayQuestionText").html(p),$("#issueOrderContainer").show(),$("#issueDescContainer").show(),$("#btnContainer").show()}else $("#tinymceContent").val(e.attemptedAnswerVOList.responseText),setTimeout(function(){null!=tinyMCE.get(s+"Editor")&&tinyMCE.get(s+"Editor").setContent(e.attemptedAnswerVOList.responseText)},1e3),setTimeout(function(){$(window).scrollTop(0)},300);$("#submitBtn").removeAttr("disabled")}if(0==e.attemptedAnswerVOList.saveFlag||"correct"==e.status||"incorrect"==e.status||"partial"==e.status){null!=saveClicked&&clearInterval(saveClicked),$("#submitBtn").hide(),$("#saveBtn").hide(),$("#skipBtn").hide(),$("#nextBtn").show(),$("#dvThumbs").show();var g="",h="";h="issuespotting"==s?JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList.{.questionType == "essay"}',globalData)[0].generalFeedback:JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.generalFeedback',globalData)[0],setTimeout(function(){tinyMCE.get(s+"Editor").getBody().setAttribute("contenteditable",!1),$("#"+s+"Container .mce-toolbar button").off("click").on("click",function(e){e.stopPropagation()})},1e3),g="essay"==s||"issuespotting"==s?"Model Answer":"Answer";var C=$('<div><div class="clear" style="padding:0px;"></div><h1 tabindex="0" aria-label='+g+">"+g+'</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+h+"</div>");""!=$.trim(h)&&$(".rationalWrapper").html(C),$("#dvLike").show(),$("#lastSaveTime").css("visibility","hidden")}else{var m=e.attemptedAnswerVOList.lastSaveTime;m=getDateTime(new Date(retriveLocalTimeFromUTC(m))),"issuespotting"==s&&($(".sortable").sortable(),null!=saveClicked&&clearInterval(saveClicked),saveClicked=setInterval(function(){$("#saveBtn").trigger("click")},18e4)),$("#lastSaveTime").html("Last saved on "+m).css("visibility","visible")}}else if("clusterhypo"==s){var b=e.attemptedAnswerVOList,y=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList',globalData);"object"==$.type(b)&&(b=[b]);for(var v=0;v<b.length;v++){var O=b[v].subQuestionId,I=$('div[subquestionId="'+O+'"]').attr("id").split("_")[1];if($('label[for="hypoEditor_'+I+'"]').hide(),""!=b[v].subResponseText&&(null!=tinyMCE.get("hypoEditor_"+I)&&tinyMCE.get("hypoEditor_"+I).setContent(b[v].subResponseText),$("#tinymceContent_"+I).val(b[v].subResponseText),$("#submitBtn_"+I).removeAttr("disabled")),"correct"==b[v].status||"incorrect"==b[v].status){$("#submitBtn_"+I).attr("isClicked","true").hide(),$("#saveBtn_"+I).hide(),tinyMCE.get("hypoEditor_"+I).getBody().setAttribute("contenteditable",!1),$("#hypoContainer_"+I+" .mce-toolbar button").off("click").on("click",function(e){e.stopPropagation()});h=y[I].generalFeedback,C=$('<div><div class="clear" style="padding:0px;"></div><h1 aria-label="Answer" tabindex="0">Answer</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+h+"</div>");$("#rationale_"+I).html(C),$("#lastSaveTime_"+I).css("visibility","hidden"),$("#dvThumbs_"+I).show(),"correct"==b[v].status?($("#dvThumbs_"+I+' span[type="thumbsUp"]').removeClass("gray-thumbsUp").addClass("green-thumbsUp"),$("#dvThumbs_"+I).find("div[isClickedThumbs]").attr("isClickedThumbs","true"),$("#thumbStatus_"+I).val("1")):"incorrect"==b[v].status&&($("#dvThumbs_"+I+' span[type="thumbsDown"]').removeClass("gray-thumbsDown").addClass("red-thumbsDown"),$("#dvThumbs_"+I).find("div[isClickedThumbs]").attr("isClickedThumbs","true"),$("#thumbStatus_"+I).val("0"))}else{m=b[v].lastSaveTime;m=getDateTime(new Date(retriveLocalTimeFromUTC(m))),$("#lastSaveTime_"+I).html("Last saved on "+m).css("visibility","visible")}}$('button[id^="submitBtn"]:hidden').length==y.length&&($("#skipBtn").hide(),$("#nextBtn").show(),$("#dvThumbs").show(),$("#dvLike").show(),$("div[id^=lastSaveTime]").css("visibility","hidden"))}else{if("Multianswer"==a){var f=(w=e.attemptedAnswerVOList.optionNumber).split(","),V=[];for(v=0;v<f.length;v++)V[v]=parseInt(f[v]);for(v=0;v<V.length;v++){(T=$('input[name="optionsCheckbox"][value="'+(V[v]-1)+'"]')).attr("checked","checked")}$('input[name="optionsCheckbox"]').parent().addClass("disableLabel"),$('input[name="optionsCheckbox"]').attr("disabled","disabled");var q=t.answerVOList;for(v=0;v<q.length;v++)"1.0"==q[v].fraction&&($('input[name="optionsCheckbox"][value="'+v+'"]').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),$('input[name="optionsCheckbox"][value="'+v+'"]').parent().removeClass("disableLabel")),"1.0"!=q[v].fraction&&$('input[name="optionsCheckbox"][value="'+v+'"]').is(":checked")&&$('input[name="optionsCheckbox"][value="'+v+'"]').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-incorrect glyphicon glyphicon-remove-circle' aria-label='incorrect'></span>")}else if("Multianswer"!==a){var T,w=e.attemptedAnswerVOList.optionNumber;if((T=$('input:radio[name="optionsRadios"][value="'+(w-1)+'"]')).attr("checked","checked"),$('input:radio[name="optionsRadios"]').parent().addClass("disableLabel"),$('input:radio[name="optionsRadios"]').attr("disabled","disabled"),"correct"==e.status)T.parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),T.parent().removeClass("disableLabel");else if("incorrect"==e.status){T.parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-incorrect").before("<span class='radio-custom-incorrect glyphicon glyphicon-remove-circle' aria-label='incorrect'></span>");var k=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.answerVOList',globalData),A=0;for(l=0;l<k.length;l++)if("1.0"==k[l].fraction){A=l;break}$('input:radio[name="optionsRadios"][value="'+A+'"]').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),$('input:radio[name="optionsRadios"][value="'+A+'"]').parent().removeClass("disableLabel")}}$("#submitBtn").hide();h="";if("incorrect"==e.status?void 0!==(h=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.incorrectFeedback',globalData)[0])&&""==$.trim(h)&&(h=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.generalFeedback',globalData)[0]):h=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.generalFeedback',globalData)[0],void 0!==h&&""!=$.trim(h)){g="Rationale for Correct Answer",C=$('<div><div class="clear" style="padding:0px;"></div><h1 tabindex="0" aria-label="Rationale for Correct Answer">'+g+'</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+h+"</div>");$(".rationalWrapper").html(C)}$("#skipBtn").hide(),$("#nextBtn").show(),$("#dvLike").show()}else if("issuespotting"==s){var L=$("#issueContainer span.issue").first();$("#issueContainer span.issue").each(function(){$(this).attr("data-html","true").attr("data-container",".container-left-desktop-fix-studyland").attr("data-placement","bottom").attr("rel","popover")}),$("#issueContainer span.issue").popover({template:'<div class="popover popover-issue-mcq" aria-hidden="true" tabindex="0" role="dialog"><div class="arrow issuespoting-arrow"></div><div class="popover-content issuespoting-inner-popover" tabindex="0"></div></div>',trigger:"manual",content:function(){return $("#popover-content").html()}}),$("#questionText").focusout(function(e){document.addEventListener("focus",function(e){var t=document.getElementsByClassName("popover popover-issue-mcq")[0];null!=t&&(t.contains(e.target)||(e.stopPropagation(),t.focus()))},!0)}),highlightIssue(L)}handleDoneButton(e)},flipFlashCardAnswer:function(){var e=parseInt(globalData.totalQuestion),t=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0];if("Show Answer"==$("#btnFlagHideShow").html())$(window).trigger("resize"),$("#btnFlagHideShow").html("Hide Answer"),$("#flagAnswer").show(),$("#skipBtn").hide(),1!=e||"incorrect"!=t.status&&"correct"!=t.status?$("#nextBtn").show():($("#skipBtn").hide(),$("#nextBtn").hide(),$("#doneBtn").show()),$("#dvThumbs").show(),$(".flag-container-mobile-nextbtn").css("display","none !important"),$("#dvLike").show();else{if($("#btnFlagHideShow").html("Show Answer"),$(window).trigger("resize"),$("#flagAnswer").hide(),1!=e||"incorrect"!=t.status&&"correct"!=t.status)$("#skipBtn").show(),$(window).trigger("resize"),$(window).width()<768?$(".flag-container-mobile-nextbtn").css("display","inline-block !important"):$(".flag-container-mobile-nextbtn").css("display","none !important");else $("#skipBtn").hide(),$("#nextBtn").hide(),$("#doneBtn").show(),$(".flag-container-mobile-nextbtn").css("display","none !important");$("#nextBtn").hide(),$("#dvThumbs").hide(),$("#dvLike").hide()}handleDoneButton(t)},processQuestionResponseclustermcq:function(){var e=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO.attemptedAnswerVOList',globalData),t=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList',globalData);if(e&&0!=e.length){for(var s=0;s<e.length;s++){var a=e[s].subOptionNumber,n=t[s].questionId,i="",r=$('input:radio[name="optionsRadios_'+n+'"][value="'+(a-1)+'"]');if(r.attr("checked","checked"),$('input:radio[name="optionsRadios_'+n+'"]').parent().addClass("disableLabel"),$('input:radio[name="optionsRadios_'+n+'"]').attr("disabled","disabled"),"correct"==e[s].status)r.parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),r.parent().removeClass("disableLabel");else if("incorrect"==e[s].status){r.parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-incorrect").before("<span class='radio-custom-incorrect glyphicon glyphicon-remove-circle' aria-label='incorrect'></span>");for(var o=JSPath.apply(".subAnswerVOList",t[s]),d=0,l=0;l<o.length;l++)if("1.0"==o[l].fraction){d=l;break}$('input:radio[name="optionsRadios_'+n+'"][value="'+d+'"]').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),r.parent().removeClass("disableLabel")}if($("#submitBtn_"+n).hide(),"incorrect"==e[s].status?void 0!==(i=t[s].incorrectFeedback)&&""==$.trim(i)&&(i=t[s].generalFeedback):i=t[s].generalFeedback,void 0!==i&&""!=$.trim(i)){var u=$('<div><div class="clear" style="padding:0px;"></div><h1 tabindex="0" aria-label="Rationale for Correct Answer">Rationale for Correct Answer</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+i+"</div>");$(".rationalWrapper_"+n).html(u)}handleDoneButton(JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0])}$("#dvLike").show()}}},Handler.submitResponse={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t=$("#questionText").attr("questionnumber"),s=JSPath.apply('.{.questionNumber == "'+t+'"}.questionVO',globalData)[0],a=s.answerVOList,n=s.questionType,i=s.questionId,r=$("#learningObjId").val(),o=s.contentType;if("Multianswer"==o){var d=[],l=[],u=[],c=[],p=[],g=0;$.each($("input[name='optionsCheckbox']:checked"),function(){var e=$(this).val();d.push($(this).val()),l.push($(a[e])[0].answer),u.push($(this).val()),c.push($(a[e])[0].fraction)});for(var h=0;h<a.length;h++)"1.0"==a[h].fraction&&p.push($(a[h])[0].fraction);for(h=0;h<c.length;h++)"1.0"==c[h]&&g++;if(0==g)var C="0";else if(g==c.length&&g==p.length)C="1";else C="2";for(h=0;h<u.length;h++)u[h]=parseInt(u[h])+1;u=u.toString(),l=l.toString();var m=CaseConnect.currentChapterIdstudylanding;e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{questionType:n,questionId:i,optionNumber:u,answerVOList:[{responseText:l}],grade:C,learningObjectId:r,chapterId:m,questionNumber:t,multiAnswer:1}}}}else if("Multianswer"!==o){var b=$('input:radio[name="optionsRadios"]:checked').val(),y=a[b].answer,v=parseInt(b)+1;C="1.0"==a[b].fraction?"1":"0",m=CaseConnect.currentChapterIdstudylanding;e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{questionType:n,questionId:i,optionNumber:v,answerVOList:[{responseText:y}],grade:C,learningObjectId:r,chapterId:m,questionNumber:t}}}}$("#page-loading-spinner").show()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=$("#questionText").attr("questionnumber"),a=JSPath.apply('.{.questionNumber == "'+s+'"}.questionResponseVO',globalData)[0],n=JSPath.apply('.{.questionNumber == "'+s+'"}.questionVO',globalData)[0],i="",r=n.answerVOList,o=n.contentType;if("Multianswer"==o){var d=[],l=[],u=[],c=[],p=[],g=0;t="incorrect";$.each($("input[name='optionsCheckbox']:checked"),function(){var e=$(this).val();d.push($(this).val()),l.push($(r[e])[0].answer),u.push($(this).val()),c.push($(r[e])[0].fraction)});for(var h=0;h<u.length;h++)u[h]=parseInt(u[h])+1;$('input[name="optionsCheckbox"]').parent().addClass("disableLabel"),$('input[name="optionsCheckbox"]').attr("disabled","true");for(h=0;h<r.length;h++)"1.0"==r[h].fraction&&($('input[name="optionsCheckbox"][value="'+h+'"]').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),$('input[name="optionsCheckbox"][value="'+h+'"]').parent().removeClass("disableLabel")),"1.0"!=r[h].fraction&&$('input[name="optionsCheckbox"][value="'+h+'"]').is(":checked")&&$('input[name="optionsCheckbox"][value="'+h+'"]').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-incorrect glyphicon glyphicon-remove-circle' aria-label='incorrect'></span>");for(h=0;h<r.length;h++)"1.0"==r[h].fraction&&p.push($(r[h])[0].fraction);for(h=0;h<c.length;h++)"1.0"==c[h]&&g++;if(0==g){t="incorrect"}else if(g==c.length&&g==p.length){t="correct"}else{t="partial"}$("#submitBtn").hide(),u=u.toString(),a.attemptedAnswerVOList={optionNumber:u};var C=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionType',globalData)[0];if($("#submitBtn").hide(),"incorrect"==t?void 0!==(i=n.incorrectFeedback)&&""==$.trim(i)&&(i=n.generalFeedback):i="partial"==t&&void 0!==n.partiallyCorrectFeedback&&""!=$.trim(n.partiallyCorrectFeedback)?n.partiallyCorrectFeedback:n.generalFeedback,void 0!==i&&""!=$.trim(i)){var m="Rationale for Correct Answer",b=$('<div><div class="clear" style="padding:0px;"></div><h1 tabindex="0"  aria-label="Rationale for Correct Answer">'+m+'</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+i+"</div>");$(".rationalWrapper").html(b)}a.status=t,"clustermcq"==C?C="multichoice":"clusterhypo"==C&&(C="hypothetical");var y=CaseConnect.currentLearningObjId,v=JSPath.apply('.{.learningObjId == "'+y+'"}.learningObjectiveResponseList.{.questionType == "'+C+'"}',LORightpanel.learningObjectiveProgressVOList)[0];"correct"==a.status?(++v.totalCorrectAnswer,--v.totalUnAnswered):"incorrect"==a.status?(++v.totalWrongAnswer,--v.totalUnAnswered):"partial"==a.status&&(++v.totalPartialCorrect,--v.totalUnAnswered),handleDoneButton(JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0]),updateStatusInPagination(s,t),loadStudyQuestionImagesFromCDN(),$("#dvLike").show(),Utility.hideSpinner(),$(window).trigger("resize")}else if("Multianswer"!==o){var O=$('input:radio[name="optionsRadios"]:checked').val();t="incorrect";$('input:radio[name="optionsRadios"]').parent().addClass("disableLabel"),$('input:radio[name="optionsRadios"]').attr("disabled","disabled");for(h=0;h<r.length;h++)"1.0"==r[h].fraction&&($('input:radio[name="optionsRadios"][value="'+h+'"]').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),$('input:radio[name="optionsRadios"][value="'+h+'"]').parent().removeClass("disableLabel")),h==O&&("1.0"==r[h].fraction?(t="correct",$('input:radio[name="optionsRadios"]:checked').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),$('input:radio[name="optionsRadios"][value="'+h+'"]').parent().removeClass("disableLabel")):$('input:radio[name="optionsRadios"]:checked').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-incorrect").before("<span class='radio-custom-incorrect glyphicon glyphicon-remove-circle' aria-label='incorrect'></span>"));C=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionType',globalData)[0];if($("#submitBtn").hide(),"incorrect"==t?void 0!==(i=n.incorrectFeedback)&&""==$.trim(i)&&(i=n.generalFeedback):i=n.generalFeedback,void 0!==i&&""!=$.trim(i)){m="Rationale for Correct Answer",b=$('<div><div class="clear" style="padding:0px;"></div><h1 tabindex="0"  aria-label="Rationale for Correct Answer">'+m+'</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+i+"</div>");$(".rationalWrapper").html(b)}a.attemptedAnswerVOList={optionNumber:parseInt(O)+1},a.status=t,"clustermcq"==C?C="multichoice":"clusterhypo"==C&&(C="hypothetical");y=CaseConnect.currentLearningObjId,v=JSPath.apply('.{.learningObjId == "'+y+'"}.learningObjectiveResponseList.{.questionType == "'+C+'"}',LORightpanel.learningObjectiveProgressVOList)[0];"correct"==a.status?(++v.totalCorrectAnswer,--v.totalUnAnswered):"incorrect"==a.status?(++v.totalWrongAnswer,--v.totalUnAnswered):"partial"==a.status&&(++v.totalPartialCorrect,--v.totalUnAnswered),handleDoneButton(JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0]),updateStatusInPagination(s,t),loadStudyQuestionImagesFromCDN(),$("#dvLike").show(),Utility.hideSpinner()}$(window).trigger("resize")}}},Handlebars.registerHelper("ifEquals",function(e,t,s){return e===t?s.fn(this):s.inverse(this)}),Handlebars.registerHelper("ifSelectedClass",function(e,t,s){return e===CaseConnect.currentClassId?"selected":""}),Handlebars.registerHelper("getUnAnsweredInClass",function(e,t,s,a){var n=1;return void 0!==totalNumberOfEnrolledStudentsInCurrentClass&&(n=totalNumberOfEnrolledStudentsInCurrentClass),n-(parseInt(e)+parseInt(t)+parseInt(s))}),Handlebars.registerHelper("ifProf",function(e,t,s){return"Professor"===map.userRole?s.fn(this):s.inverse(this)}),Handlebars.registerHelper("ifStud",function(e,t,s){return"Student"===map.userRole?s.fn(this):s.inverse(this)}),Handlebars.registerHelper("showClassResult",function(e,t,s){return"Professor"===map.userRole?s.fn(this):s.inverse(this)}),Handlebars.registerHelper("showProfInfoBar",function(e,t,s){return"Professor"===map.userRole?s.fn(this):s.inverse(this)}),Handlebars.registerHelper("convertNumberToString",function(e,t,s){return"uppercase"==t?numberToCharacterMap[parseInt(e)+1].toUpperCase():"insights"==t?numberToCharacterMap[parseInt(e)]:numberToCharacterMap[parseInt(e)+1]}),Handlebars.registerHelper("showBorder",function(e,t,s){return e+1==t?"":'<div class="clear" style="padding:0px;"></div><div class="border-div"></div>'}),Handlebars.registerHelper("if",function(e,t){return e?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("convertToPercent",function(e,t,s){return 100*(e/t)}),Handlebars.registerHelper("setWidth",function(e,t){return e>0&&e<=20?e+=10:e>21&&e<=39?e-=4:e>40&&e<=50?e-=21:e>51&&(e-=30),e}),Handlebars.registerHelper("displayVerticalOne",function(e,t){return 0!=e?"|":""}),Handlebars.registerHelper("displayVerticalTwo",function(e,t,s){return 0!=e||0!=t?"|":""}),Handlebars.registerHelper("correct",function(e,t){return Math.round(e)}),Handlebars.registerHelper("correctunanswered",function(e,t,s,a){var n=100-(e+t+s);return Math.round(n)}),Handlebars.registerHelper("calculateClassPercentage",function(e,t,s,a){var n=parseInt(e),i=parseInt(t);totalQuestionsForAnActivity=i;var r=100*(n/(i*("Professor"===map.userRole?myProgressList||"My Progress"===$("#drpdwnClassProgressSelection option:selected").text()?1:void 0!==CaseConnect.enrolledStudentsInCurrentClass?parseInt(CaseConnect.enrolledStudentsInCurrentClass):1:1)));return Math.round(r)}),Handlebars.registerHelper("calculateClassUnAnsPercentageForEachLO",function(e,t,s,a,n){var i=parseInt(e),r=parseInt(t),o=(s=parseInt(s),parseInt(a)*getStudentCount()),d=i/o;d*=100,d=Math.round(d);var l=s/o;l*=100,l=Math.round(l);var u=r/o;return u*=100,100-((u=Math.round(u))+d+l)}),Handlebars.registerHelper("angleBrackets",function(e,t){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">")}),Handlebars.registerHelper("replaceNbsp",function(e,t){return e.replace(/&nbsp;/g," ")}),Handlebars.registerHelper("tableOfContents",function(e,t){return"Table Of Content"==e&&(e="Table of Contents"),e}),Handlebars.registerHelper("incorrect",function(e,t,s,a){var n=Math.round(e),i=Math.round(t),r=Math.round(s);return n>0&&i>0&&r>0&&(r=100-(n+i)),n>0&&i>0&&0==r?i=100-n:0==n&&i>0&&r>0&&(i=100-r),i}),Handlebars.registerHelper("unanswered",function(e,t,s,a){var n=Math.round(e),i=Math.round(t),r=Math.round(s);return n>0&&i>0&&r>0?r=100-(n+i):0==n&&i>0&&r>0?i=100-r:n>0&&0==i&&r>0&&(r=100-n),n>0&&i>0&&0==r&&(i=100-n),r}),Handlebars.registerHelper("unanswered",function(e,t,s,a){var n=Math.round(e),i=Math.round(t),r=Math.round(s);return n>0&&i>0&&r>0&&(r=100-(n+i)),n>0&&i>0&&0==r&&(i=100-n),r}),Handler.saveEndorseQuestion=function(event){var ele=event.target,handler="saveEndorseQuestionForLO",request={},data={};request.url="/manageAssessmentService/endorseQuestion",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(event.target);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request),localStorage.getItem("userId")||CaseConnect.currentUserId},Handler.saveEndorseQuestionForLO={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t,s=$('input:radio[name="endorseQuestion"]:checked').val(),a=$("#questionText").attr("questionId");a||(a=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionId',globalData)[0]),"yes"===s&&(t=1),"no"===s&&(t=0),"neutral"===s&&(t=2),e.data={userVO:{userId:map.userId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_PROFESSOR_ENDORSE_QUESTION",pageNavigatingFrom:"StudyCenter",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentBookId,lastReadChapterId:CaseConnect.currentChapterId,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO,userRole:map.userRole,userRoleId:map.userRoleId},questionVO:{questionId:a,endorseQuestionFlag:t}},$("#page-loading-spinner").show()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=$("#questionText").attr("questionid");s||(s=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionId',globalData)[0]);var a="";void 0===CaseConnect.questionType?a=JSPath.apply('.{.questionVO.questionId == "'+s+'"}.questionResponseVO',globalData)[0]:"explanatory"==CaseConnect.questionType&&(a=JSPath.apply('.{.questionVO.questionId == "'+s+'"}.questionResponseVO',globalDataText)[0]);var n=$('input:radio[name="endorseQuestion"]:checked').val();void 0===a&&(a={}),"yes"==n?a.endorseQuestionFlag="1":"no"==n?a.endorseQuestionFlag="0":"neutral"==n&&(a.endorseQuestionFlag="2"),Utility.hideSpinner()}}},Handler.saveLikeUnlikeStatus=function(event){var ele=event.target,handler="likeQuestionResponse",request={},data={};request.url="/manageAssessmentService/saveLikeUnlikeStatus",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(event.target);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request),localStorage.getItem("userId")||CaseConnect.currentUserId},Handler.likeQuestionResponse={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t=$("#questionText").attr("questionId");t||(t=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionId',globalData)[0]);var s="0";"yes"==$('input:radio[name="likeQuestion"]:checked').val()&&(s="1"),e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_LIKE_UNLIKE_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{questionId:t,likeQuestionFlag:s}}},$("#page-loading-spinner").show()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=$("#questionText").attr("questionid");s||(s=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionId',globalData)[0]);var a="";void 0===CaseConnect.questionType?a=JSPath.apply('.{.questionVO.questionId == "'+s+'"}.questionResponseVO',globalData)[0]:"explanatory"==CaseConnect.questionType&&(a=JSPath.apply('.{.questionVO.questionId == "'+s+'"}.questionResponseVO',globalDataText)[0]);var n=$('input:radio[name="likeQuestion"]:checked').val();void 0===a&&(a={}),a.likeQuestionFlag="yes"==n?"1":"0",Utility.hideSpinner()}}},Handler.updateFlagStatus={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t=$("#questionId").val(),s=$("#questionType").val(),a=$("#learningObjId").val(),n=$("#flagVal").val();n="false"==n||0==n?"1":"0",e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_FLAG_UNFLAG_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{questionType:s,questionId:t,learningObjectId:a,flagValue:n}}},$("#page-loading-spinner").show()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=parseInt(JSPath.apply('.{.currentQuestionFlag == "1"}.questionNumber',globalData)[0]),a=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0];a.questionId;"false"==$("#flagVal").val()?($(".flag").html('<a href="#" class="flag-later-element" data-handler="updateFlagStatus" data-action="/manageAssessmentService/saveFlagUnflagStatus"><img class="flagimage" src="img/LargeFlag.png" data-handler="updateFlagStatus" data-action="/manageAssessmentService/saveFlagUnflagStatus"/><span class="unflagtext"  data-handler="updateFlagStatus" data-action="/manageAssessmentService/saveFlagUnflagStatus">Unflag</span></a>'),$("#flagVal").val("true"),a.flagged="true",$("ul.pagination a#anchor_"+s).append('<div class="smallflag"><img src="img/SmallFlag.png"></div>'),$(".flag a").focus()):($(".flag").html('<a href="#" class="flag-later-element" data-handler="updateFlagStatus" data-action="/manageAssessmentService/saveFlagUnflagStatus"><img class="flagimage" src="img/GreyLargeFlag.png" data-handler="updateFlagStatus" data-action="/manageAssessmentService/saveFlagUnflagStatus"/><span class="flagtext"  data-handler="updateFlagStatus" data-action="/manageAssessmentService/saveFlagUnflagStatus">Flag for later</span></a>'),$("#flagVal").val("false"),a.flagged="false",$("ul.pagination a#anchor_"+s+" >.smallflag").remove(),$(".flag a").focus()),Utility.hideSpinner()}}},Handler.handleNextClick=function(event){var nextQuestion=parseInt($("ul.pagination li.active > a").attr("id").split("_")[1])+1,totalQuestions=parseInt(globalData.totalQuestion);$("span#prev").removeAttr("disabled"),$(".study-pagination-prev-large").css("cursor","pointer"),$("span#prev").css("color","#666"),$("span#prev").attr("data-handler","handlePrevClick");var windowWidth=$(window).width();if(nextQuestion<=totalQuestions){$("span#next").removeAttr("disabled"),$(".study-pagination-next-large").css("cursor","pointer");var isExists=JSPath.apply('.{.questionNumber == "'+nextQuestion+'"}',globalData).length>0;if(isExists){if($("ul.pagination a#anchor_"+nextQuestion).trigger("click"),windowWidth<768){if("none"===$("#anchor_"+nextQuestion).parent().css("display")){var firstQuestionInList=nextQuestion-5;$("#anchor_"+firstQuestionInList).parent().css("display","none"),$("#anchor_"+nextQuestion).parent().css("display","inline")}$(".study-pagination-prev-xs").hide(),$(".study-pagination-prev-large").show()}}else{var ele=event.target,handler="loadStudyCenterForExtraQuestion",request={},data={},questionType=JSPath.apply('.{.questionNumber == "'+(nextQuestion-1)+'"}.questionVO.questionType',globalData)[0];"clustermcq"==questionType?questionType="multichoice":"clusterhypo"==questionType&&(questionType="hypothetical"),request.url="/assessmentRetrievalService/getQuestionForStudyCenterLearn",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(event.target);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.startPoint=nextQuestion,request.questionType=questionType,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request),localStorage.getItem("userId")||CaseConnect.currentUserId}nextQuestion===totalQuestions?($("span#next").attr("disabled","disabled"),$("span#next").removeAttr("data-handler"),$("span#next").css("color","#ccc"),$(".study-pagination-next-large").css("cursor","default"),event.stopPropagation()):($("span#next").removeAttr("disabled","disabled"),$("span#next").attr("data-handler","handleNextClick"),$(".study-pagination-next-large").css("cursor","pointer"),$("span#next").css("color","#666"))}else{var questionType=JSPath.apply('.{.questionNumber == "'+(nextQuestion-1)+'"}.questionVO.questionType',globalData)[0];nextQuestion=1;var isExists=JSPath.apply('.{.questionNumber == "'+nextQuestion+'"}',globalData).length>0;if(isExists)$("ul.pagination a#anchor_"+nextQuestion).trigger("click");else{var ele=event.target,handler="loadStudyCenter",request={},data={};"clustermcq"==questionType?questionType="multichoice":"clusterhypo"==questionType&&(questionType="hypothetical"),request.url="/assessmentRetrievalService/getQuestionForStudyCenterLearn",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(event.target);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.startPoint=nextQuestion,request.questionType=questionType,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request)}}$(window).scrollTop(0),$(window).trigger("resize")},Handler.handlePrevClick=function(event){var prevQuestion=parseInt($("ul.pagination li.active > a").attr("id").split("_")[1])-1,isExists=JSPath.apply('.{.questionNumber == "'+prevQuestion+'"}',globalData).length>0;$("span#next").removeAttr("disabled","disabled"),$("span#next").attr("data-handler","handleNextClick"),$(".study-pagination-next-large").css("cursor","pointer"),$("span#next").css("color","#666");var windowWidth=$(window).width();if(prevQuestion-1>=0)if(prevQuestion-1==0?($("span#prev").attr("disabled","disabled"),$(".study-pagination-prev-large").css("cursor","default"),$("span#prev").css("color","#ccc"),$("span#prev").removeAttr("data-handler")):($("span#prev").removeAttr("disabled"),$(".study-pagination-prev-large").css("cursor","pointer"),$("span#prev").css("color","#666"),$("span#prev").attr("data-handler","handlePrevClick")),isExists){if($("ul.pagination a#anchor_"+prevQuestion).trigger("click"),windowWidth<768){var nextToPrevQues=prevQuestion-1;if("none"===$("#anchor_"+prevQuestion).parent().css("display")){var lastQuestionInList=prevQuestion+5;$("#anchor_"+lastQuestionInList).parent().css("display","none"),$("#anchor_"+prevQuestion).parent().css("display","inline")}}}else{var ele=event.target,handler="loadStudyCenterForExtraQuestion",request={},data={},questionType=JSPath.apply('.{.questionNumber == "'+(prevQuestion+1)+'"}.questionVO.questionType',globalData)[0];"clustermcq"==questionType?questionType="multichoice":"clusterhypo"==questionType&&(questionType="hypothetical"),request.url="/assessmentRetrievalService/getQuestionForStudyCenterLearn",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(event.target);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.startPoint=prevQuestion,request.questionType=questionType,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request),localStorage.getItem("userId")||CaseConnect.currentUserId}$(window).scrollTop(0)},Handler.loadStudyCenterForExtraQuestion={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t=e.questionType,s=CaseConnect.currentLearningObjId,a=CaseConnect.currentChapterIdstudylanding,n=CaseConnect.currentbookIdstudylanding;CaseConnect.questionType="",e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_GET_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},questionVO:{questionType:t,learningObjectId:s,chapterId:a,bookId:n,startPoint:e.startPoint,limit:"1"}},"Professor"===map.userRole&&(e.data.questionVO.classId=CaseConnect.currentClassId),$("#page-loading-spinner").show()},response:function(e,t){Handler.loadStudyCenterForExtraQuestion.processResponse(e,t),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut()},processResponse:function(e,t){if("false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide();var s=e.assessmentVO.questionBankVOList;"object"==$.type(s.questionVO.studyAidVOList)&&(s.questionVO.studyAidVOList=[s.questionVO.studyAidVOList]),"object"==$.type(s.questionVO.studyReferenceVOList)&&(s.questionVO.studyReferenceVOList=[s.questionVO.studyReferenceVOList]),"object"==$.type(s)&&(s=[s]),"clustermcq"==(h=s[0].questionVO.questionType)?h="multichoice":"clusterhypo"==h&&(h="hypothetical");for(var a=CaseConnect.currentLearningObjId,n=JSPath.apply('.{.learningObjId == "'+a+'"}.learningObjectiveResponseList.{.questionType == "'+h+'"}',LORightpanel.learningObjectiveProgressVOList)[0],i=n.totalCorrectAnswer,r=n.totalPartialCorrect,o=n.totalWrongAnswer,d=n.totalUnAnswered,l=n.totalQuestions,u=parseInt(e.assessmentVO.questionBankVOList.questionNumber),c=parseInt(JSPath.apply('.{.currentQuestionFlag == "1"}.questionNumber',globalData)[0]),p=parseInt(e.assessmentVO.questionBankVOList.questionNumber),g=0;g<globalData.length;g++)globalData[g].currentQuestionFlag="0";e.assessmentVO.questionBankVOList.totalQuestion=l,e.assessmentVO.questionBankVOList.currentQuestionFlag="1",c<u?(globalData.splice(0,1),globalData.push(e.assessmentVO.questionBankVOList)):(globalData.pop(),globalData.splice(0,0,e.assessmentVO.questionBankVOList));for(g=0;g<globalData.length;g++){var h;if("clusterhypo"==(h=globalData[g].questionVO.questionType)||"clustermcq"==h)for(var C=globalData[g].questionVO.subQuestionVOList,m=0;m<C.length;m++)C[m].totalSubQuestions=C.length}globalData.totalCorrect=i,globalData.totalPartialCorrect=r,globalData.totalIncorrect=o,globalData.totalUnanswered=d,tinymce.remove("textarea"),$("#studycenter-container").load("studycontent.html?v19893",function(){$("#study-center-container").removeClass("study-container").addClass("study-container-inner"),$("#studycenter-empty-column").removeClass("col-md-1 col-sm-1"),$("#studycenter-container").removeClass("col-md-11 col-sm-11").addClass("col-md-12 col-sm-12"),$(".ereader-main-header-bookshelfred").hide(),$(".study-header-mobile-regular").hide(),$(".back-to-studycenter-red").show(),$(".study-chapter-list-popover").css({display:"inline-block"}),$(".study-link-mobile").hide(),insideQuestionLO=!0,$(window).width()<768&&($("#study-chapter-title-template-mobile").remove(),"undefined"!=typeof insideQuestionLO&&insideQuestionLO?($(".study-landing-page-header-mobile").hide(),$(".study-landing-page-header-mobile").css("display","none"),$(".study-content-page-header-mobile").show()):($(".study-landing-page-header-mobile").show(),$(".study-landing-page-header-mobile").css("display","inline-block"),$(".study-content-page-header-mobile").hide())),LORightpanel.chapterVO.chapterNumber,$("#chapterName").html(LORightpanel.chapterVO.navbarTitle),$(".questionsection-inner .back> h2").html(CaseConnect.learningObjName),$(".questionsection-inner .back> h2").attr("aria-label",CaseConnect.learningObjName),$(".btn-group").hide();var e=Handlebars.getTemplate("pagination")(globalData);$("#paginationContainer").html(e),displayEndorseTooltipContent(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN();var t=JSPath.apply('.{.currentQuestionFlag == "1"}',globalData)[0],s=t.questionVO.questionType;$("#questionTitle").html(questionTitleArr[s]),$("#questionTitle").attr("aria-label",questionTitleArr[s]);var a=templateArray.indexOf(s),n=templateArray[a],i=Handlebars.getTemplate(n)(t);$("#questionContainer").html(i),displayEndorseTooltipContent(),appendQueryString(),displayEndorseTooltipStudent(),loadStudyQuestionImagesFromCDN(),"staging"==properties.env&&$(".extId").removeClass("extId");var r=Handlebars.getTemplate("bottom-container")(t);$("#bottomContainer").html(r);var o=Handlebars.getTemplate("study-footer-content")(t);$("#studycenter-footer-content").html(o),"studyaid"===CaseConnect.bookType&&$("#right-panel-text-footer-page").html("The study center includes all the questions from your study aid chapters in interactive format to give you extra practice for class and exams."),"casebook"===CaseConnect.bookType||"coursebook"===CaseConnect.bookType?($("#study-aid-adds-md-container").show(),$("#studycenter-ad-container-xs").show()):($("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-container-xs")[0].innerHTML=""),void 0!==t.questionVO.studyAidAdVO&&null!=t.questionVO.studyAidAdVO&&null!=t.questionVO.studyAidAdVO.adImageS3FilePathMD&&null!=t.questionVO.studyAidAdVO.adImageS3FilePathMD&&"true"===t.questionVO.studyAidAdVO.showAd?($("#study-aid-adds-md").find("img").attr("src",t.questionVO.studyAidAdVO.adImageS3FilePathMD),$("#study-aid-adds-md").find("img").attr("alt",t.questionVO.studyAidAdVO.adImageAltTextMD),$("#study-aid-adds-md").find("a").attr("href",t.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-xs").find("img").attr("src",t.questionVO.studyAidAdVO.adImageS3FilePathXS),$("#study-aid-adds-xs").find("img").attr("alt",t.questionVO.studyAidAdVO.adImageAltTextXS),$("#study-aid-adds-xs").find("a").attr("href",t.questionVO.studyAidAdVO.externalURL),$("#study-aid-adds-xs").find("img").attr("width","320px")):($("#study-aid-adds-xs").find("img").attr("src",""),$("#study-aid-adds-xs").find("img").attr("alt",""),$("#study-aid-adds-xs").find("img").attr("width",""),$("#study-aid-adds-xs").find("a").attr("href",""),$("#study-aid-adds-md-container").hide(),$("#studycenter-ad-container-xs").hide(),$("#studycenter-ad-containers-xs").hide()),$(window).width()<768&&void 0!==t.questionVO.studyAidAdVO&&null!=t.questionVO.studyAidAdVO&&null!=t.questionVO.studyAidAdVO.adImageS3FilePathXS&&t.questionVO.studyAidAdVO.adImageS3FilePathXS,$("#wk_content").css("padding-bottom","0px"),$("#study-center-container").css("padding-bottom","0px"),$('ul.pagination a[id="anchor_'+p+'"]').parent().addClass("active"),Handler.loadStudyCenter.processQuestionResponse(),null!=saveClicked&&clearInterval(saveClicked),"essay"==s||"hypothetical"==s?saveClicked=setInterval(function(){$("#saveBtn").trigger("click")},18e4):"clusterhypo"==s&&(saveClicked=setInterval(autoSaveClusterHypo,18e4)),u===parseInt(totalNumberOfQuestionsInLO)?($("span#next").attr("disabled","disabled"),$("span#next").removeAttr("data-handler"),$(".study-pagination-next-large").css("cursor","default"),$("span#next").css("color","#ccc")):($("span#next").removeAttr("disabled","disabled"),$("span#next").attr("data-handler","handleNextClick"),$(".study-pagination-next-large").css("cursor","pointer"),$("span#next").css("color","#666")),1===u?($("span#prev").attr("disabled","disabled"),$(".study-pagination-prev-large").css("cursor","default"),$("span#prev").css("color","#ccc"),$("span#prev").removeAttr("data-handler")):($("span#prev").removeAttr("disabled"),$(".study-pagination-prev-large").css("cursor","pointer"),$("span#prev").css("color","#666"),$("span#prev").attr("data-handler","handlePrevClick")),$(window).trigger("resize"),Utility.hideSpinner()}),$(window).scrollTop(0)}}},Handler.thumbsUpDown={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t=$("#questionId").val(),s=$("#questionType").val(),a=CaseConnect.currentLearningObjId,n=$("#questionText").attr("questionnumber"),i=$("#status").val();e.data="hypothetical"==s||"clusterhypo"==s||"essay"==s?{userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{questionType:s,questionId:t,grade:i}}}:{userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{questionType:s,questionId:t,optionNumber:"",learningObjectId:a,studyCenterFlag:"",chapterId:"",questionNumber:n,answerVOList:[{responseText:""}],grade:i}}},$("#page-loading-spinner").show()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=parseInt(JSPath.apply('.{.currentQuestionFlag == "1"}.questionNumber',globalData)[0]),a=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0],n=(JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionId',globalData)[0],JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionType',globalData)[0]);"clustermcq"==n?n="multichoice":"clusterhypo"==n&&(n="hypothetical");var i=CaseConnect.currentLearningObjId,r=JSPath.apply('.{.learningObjId == "'+i+'"}.learningObjectiveResponseList.{.questionType == "'+n+'"}',LORightpanel.learningObjectiveProgressVOList)[0];"not attempted"==a.status&&"1"==$("#status").val()?(++r.totalCorrectAnswer,--r.totalUnAnswered):"not attempted"==a.status&&"0"==$("#status").val()?(++r.totalWrongAnswer,--r.totalUnAnswered):"partial"==a.status&&"2"==$("#status").val()?(++r.totalPartialCorrect,--r.totalUnAnswered):"essay"!=n&&"hypothetical"!=n&&"issuespotting"!=n||("not graded"==a.status&&"1"==$("#status").val()?(++r.totalCorrectAnswer,--r.totalUnAnswered):"not graded"==a.status&&"0"==$("#status").val()&&(++r.totalWrongAnswer,--r.totalUnAnswered)),"correct"==a.status&&"0"==$("#status").val()?(--r.totalCorrectAnswer,++r.totalWrongAnswer):"incorrect"==a.status&&"1"==$("#status").val()&&(++r.totalCorrectAnswer,--r.totalWrongAnswer),"0"==$("#status").val()?($('#dvThumbs span[type="thumbsDown"]').removeClass("gray-thumbsDown").addClass("red-thumbsDown"),$('#dvThumbs span[type="thumbsUp"]').removeClass("green-thumbsUp").addClass("gray-thumbsUp"),a.status="incorrect",$("#dvLike input:radio").removeAttr("disabled","disabled")):"1"==$("#status").val()?($('#dvThumbs span[type="thumbsDown"]').removeClass("red-thumbsDown").addClass("gray-thumbsDown"),$('#dvThumbs span[type="thumbsUp"]').removeClass("gray-thumbsUp").addClass("green-thumbsUp"),a.status="correct",$("#dvLike input:radio").removeAttr("disabled","disabled")):($('#dvThumbs span[type="thumbsDown"]').removeClass("red-thumbsDown").addClass("gray-thumbsDown"),$('#dvThumbs span[type="thumbsUp"]').removeClass("green-thumbsUp").addClass("gray-thumbsUp"),a.status="not attempted"),updateStatusInPagination(s,a.status),handleDoneButton(a),Utility.hideSpinner()}}},Handler.checkSubmitStatus=function(event){var current=event.target,questionNum=$("#questionText").attr("questionnumber"),subQuestionVOList=JSPath.apply('.{.questionNumber == "'+questionNum+'"}.questionVO.subQuestionVOList',globalData),questionId=JSPath.apply('.{.questionNumber == "'+questionNum+'"}.questionVO.questionId',globalData)[0],parentNode=$("#questionContainer input:radio:checked").parent().parent().parent().parent(),questionResponseVO=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0],attemptedAnswerVOList=[];if($(current).attr("isclicked","true"),parentNode.siblings(".submitBtnClusterMCQ").find('button[isclicked="true"]').length!=subQuestionVOList.length){$(current).removeAttr("data-action");var currentindex=$(current).attr("submitIndex"),rationale="",questionId=subQuestionVOList[currentindex].questionId,ansOptions=subQuestionVOList[currentindex].subAnswerVOList,optionSelectedVal=$('input:radio[name="optionsRadios_'+questionId+'"]:checked').val(),status="incorrect";$('input:radio[name="optionsRadios_'+questionId+'"]').parent().addClass("disableLabel"),$('input:radio[name="optionsRadios_'+questionId+'"]').attr("disabled","disabled");for(var i=0;i<ansOptions.length;i++)"1.0"==ansOptions[i].fraction&&($('input:radio[name="optionsRadios_'+questionId+'"][value="'+i+'"]').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),$('input:radio[name="optionsRadios_'+questionId+'"][value="'+i+'"]').parent().removeClass("disableLabel")),i==optionSelectedVal&&("1.0"==ansOptions[i].fraction?(status="correct",$('input:radio[name="optionsRadios_'+questionId+'"]:checked').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),$('input:radio[name="optionsRadios_'+questionId+'"][value="'+i+'"]').parent().removeClass("disableLabel")):$('input:radio[name="optionsRadios_'+questionId+'"]:checked').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-incorrect").before("<span class='radio-custom-incorrect glyphicon glyphicon-remove-circle' aria-label='incorrect'></span>"));if($("#submitBtn_"+questionId).hide(),"incorrect"==status?(rationale=subQuestionVOList[currentindex].incorrectFeedback,void 0!==rationale&&""==$.trim(rationale)&&(rationale=subQuestionVOList[currentindex].generalFeedback)):rationale=subQuestionVOList[currentindex].generalFeedback,void 0!==rationale&&""!=$.trim(rationale)){var rationaleContent=$('<div><h1 tabindex="0" aria-label="Rationale for Correct Answer">Rationale for Correct Answer</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+rationale+"</div>");$(".rationalWrapper_"+questionId).html(rationaleContent)}}else{for(var j=0;j<subQuestionVOList.length;j++){var rationale="",questionId=subQuestionVOList[j].questionId,ansOptions=subQuestionVOList[j].subAnswerVOList,optionSelectedVal=$('input:radio[name="optionsRadios_'+questionId+'"]:checked').val(),status="incorrect";$('input:radio[name="optionsRadios_'+questionId+'"]').parent().addClass("disableLabel"),$('input:radio[name="optionsRadios_'+questionId+'"]').attr("disabled","disabled");for(var i=0;i<ansOptions.length;i++)"1.0"==ansOptions[i].fraction&&($('input:radio[name="optionsRadios_'+questionId+'"][value="'+i+'"]').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),$('input:radio[name="optionsRadios_'+questionId+'"][value="'+i+'"]').parent().removeClass("disableLabel")),i==optionSelectedVal&&("1.0"==ansOptions[i].fraction?(status="correct",$('input:radio[name="optionsRadios_'+questionId+'"]:checked').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-correct").before("<span class='radio-custom-correct glyphicon glyphicon-ok-circle' aria-label='correct'></span>"),$('input:radio[name="optionsRadios_'+questionId+'"][value="'+i+'"]').parent().removeClass("disableLabel")):$('input:radio[name="optionsRadios_'+questionId+'"]:checked').parent().parent().parent().removeClass("radio-custom-unanswered").addClass("radio-custom-incorrect").before("<span class='radio-custom-incorrect glyphicon glyphicon-remove-circle' aria-label='incorrect'></span>"));if("incorrect"==status?(rationale=subQuestionVOList[j].incorrectFeedback,void 0!==rationale&&""==$.trim(rationale)&&(rationale=subQuestionVOList[j].generalFeedback)):rationale=subQuestionVOList[j].generalFeedback,void 0!==rationale&&""!=$.trim(rationale)){var rationaleContent=$('<div><h1 tabindex="0" aria-label="Rationale for Correct Answer">Rationale for Correct Answer</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+rationale+"</div>");$(".rationalWrapper_"+questionId).html(rationaleContent)}$("#submitBtn_"+questionId).hide(),attemptedAnswerVOList.push({status:status,subOptionNumber:parseInt(optionSelectedVal)+1});var questionType=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.questionType',globalData)[0];"clustermcq"==questionType?questionType="multichoice":"clusterhypo"==questionType&&(questionType="hypothetical")}for(var countofCorrectAns=0,countofPartialCorrectAns=0,j=0;j<attemptedAnswerVOList.length&&"incorrect"!=attemptedAnswerVOList[j].status;j++)"partial"==attemptedAnswerVOList[j].status?++countofPartialCorrectAns:++countofCorrectAns;countofCorrectAns==attemptedAnswerVOList.length?questionResponseVO.status="correct":countofPartialCorrectAns==attemptedAnswerVOList.length?questionResponseVO.status="partial":questionResponseVO.status="incorrect";var learningObjId=CaseConnect.currentLearningObjId,specificLOResponse=JSPath.apply('.{.learningObjId == "'+learningObjId+'"}.learningObjectiveResponseList.{.questionType == "'+questionType+'"}',LORightpanel.learningObjectiveProgressVOList)[0];"correct"==questionResponseVO.status?(++specificLOResponse.totalCorrectAnswer,--specificLOResponse.totalUnAnswered):"incorrect"==questionResponseVO.status?(++specificLOResponse.totalWrongAnswer,--specificLOResponse.totalUnAnswered):"partial"==questionResponseVO.status&&(++specificLOResponse.totalPartialCorrect,--specificLOResponse.totalUnAnswered),questionResponseVO.attemptedAnswerVOList=attemptedAnswerVOList,updateStatusInPagination(questionNum,questionResponseVO.status);var ele=current,handler="submitClusterMCQ",request={},data={};request.url="/manageAssessmentService/saveQuestionResponse",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(current);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request),localStorage.getItem("userId")||CaseConnect.currentUserId}},Handler.submitClusterMCQ={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t=$("#questionText").attr("questionnumber"),s=JSPath.apply('.{.questionNumber == "'+t+'"}.questionVO',globalData)[0],a=s.questionType,n=s.questionId,i=[],r=[],o=[],d=[],l="0",u=0,c=$("#learningObjId").val(),p=CaseConnect.currentChapterIdstudylanding,g=s.subQuestionVOList;$("#questionText input:radio:checked").each(function(){var e=""+(parseInt($(this).val())+1);i.push(e),r.push($.trim($(this).parent().text())),o.push($(this).attr("name").split("_")[1])});for(var h=0;h<o.length;h++)u+=parseInt(g[h].subAnswerVOList[i[h]-1].fraction),d.push({subQuestionId:o[h],responseText:r[h],optionNumber:i[h]});u==o.length&&(l="1"),e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{questionType:a,questionId:n,optionNumber:"",learningObjectId:c,studyCenterFlag:"1",answerVOList:d,grade:l,chapterId:p,questionNumber:t}}},$("#page-loading-spinner").show()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0];$("#dvLike").show(),handleDoneButton(s),Utility.hideSpinner()}}},Handler.submitTextResponse={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t=$("#questionText").attr("questionnumber"),s=JSPath.apply('.{.questionNumber == "'+t+'"}.questionVO',globalData)[0],a=s.questionType,n=s.questionId,i=tinyMCE.get(a+"Editor").getContent();if("issuespotting"==a){var r=[];$("#issueOrderContainer ul.sortable > li").each(function(){r.push($(this).attr("issueid"))}),i=r.join(",")+"|||||"+i}var o=0;"saveBtn"==$(this).attr("id")?(o=1,"essay"!=a&&"hypothetical"!=a&&"issuespotting"!=a||(null!=saveClicked&&clearInterval(saveClicked),saveClicked=setInterval(function(){$("#saveBtn").trigger("click")},18e4))):null!=saveClicked&&clearInterval(saveClicked),e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{answerVOList:[{responseText:i,questionId:n}],saveFlag:o}}},$("#page-loading-spinner").show()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=$(this).attr("id"),a=$("#questionText").attr("questionnumber"),n=JSPath.apply('.{.questionNumber == "'+a+'"}.questionVO',globalData)[0],i=JSPath.apply('.{.questionNumber == "'+a+'"}.questionResponseVO',globalData)[0],r=n.questionType,o=0,d=tinyMCE.get(r+"Editor").getContent();if("issuespotting"==r){var l=[];$("#issueOrderContainer ul.sortable > li").each(function(){l.push($(this).attr("issueid"))}),d=l.join(",")+"|||||"+d}"saveBtn"==s&&(o=1);var u=e.assessmentVO.lastSaveTime;if(i.attemptedAnswerVOList={lastSaveTime:u,responseText:d,saveFlag:o},u=getDateTime(new Date(retriveLocalTimeFromUTC(u))),i.status="not graded","submitBtn"==s){$("#dvLike").show(),$("#submitBtn").hide(),$("#saveBtn").hide(),tinyMCE.get(r+"Editor").getBody().setAttribute("contenteditable",!1),$("#"+r+"Container .mce-toolbar button").off("click").on("click",function(e){e.stopPropagation()}),handleDoneButton(JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0]),$("#dvThumbs").show();var c="",p="";c="essay"==(r=n.questionType)||"issuespotting"==r?"Model Answer":"Answer",p="issuespotting"==r?JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList.{.questionType == "essay"}',globalData)[0].generalFeedback:n.generalFeedback;var g=$('<div><div class="clear" style="padding: 0px;"></div><h1 tabindex="0" aria-label='+c+">"+c+'</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+p+"</div>");""!=$.trim(p)&&$(".rationalWrapper").html(g),loadStudyQuestionImagesFromCDN(),$("#lastSaveTime").css("visibility","hidden"),updateStatusInPagination(a,t),"issuespotting"==r&&($(".sortable").sortable("destroy"),$(".sortable > li > span").removeAttr("onclick"))}else $("#lastSaveTime").html("Last saved on "+u).css("visibility","visible");Utility.hideSpinner(),$(window).trigger("resize"),tinyMCE.focus()}}},Handler.submitClusterResponse={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");var t=$(this).attr("id");t.indexOf("submitBtn")>-1&&$(this).attr("isClicked","true");var s=t.split("_")[1],a=$("#questionText_"+s).attr("subquestionid"),n=$("#questionText_"+s).attr("parentid"),i=tinyMCE.get("hypoEditor_"+s).getContent(),r=0;t.indexOf("saveBtn")>-1&&(r=1,null!=saveClicked&&clearInterval(saveClicked),saveClicked=setInterval(autoSaveClusterHypo,18e4)),$("div[id^=questionText]").length==$("div[id^=dvThumbs]:visible").length+1&&null!=saveClicked&&clearInterval(saveClicked),e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{parent:n,answerVOList:[{responseText:i,questionId:a}],saveFlag:r}}},$("#page-loading-spinner").show()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=$(this).attr("id"),a=s.split("_")[1],n=$("#questionText_"+a).attr("subquestionid"),i=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0],r=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList',globalData),o=0,d=tinyMCE.get("hypoEditor_"+a).getContent();s.indexOf("saveBtn")>-1&&(o=1);var l=e.assessmentVO.lastSaveTime,u={lastSaveTime:l,subResponseText:d,status:"not graded",saveFlag:o,subQuestionId:n,index:a};l=getDateTime(new Date(retriveLocalTimeFromUTC(l))),i.attemptedAnswerVOList||(i.attemptedAnswerVOList=[]),"object"==$.type(i.attemptedAnswerVOList)&&(i.attemptedAnswerVOList=[i.attemptedAnswerVOList]);for(var c=0;c<i.attemptedAnswerVOList.length;c++)if(i.attemptedAnswerVOList[c].subQuestionId==u.subQuestionId){i.attemptedAnswerVOList.splice(c,1);break}if(i.attemptedAnswerVOList.push(u),s.indexOf("submitBtn")>-1){if($('button[isClicked="true"]').length==r.length)$("#dvLike").show(),$('div[id^="lastSaveTime"]').css("visibility","hidden"),handleDoneButton(JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0]),$("#dvThumbs").show();tinyMCE.get("hypoEditor_"+a).getBody().setAttribute("contenteditable",!1),$("#hypoContainer_"+a+" .mce-toolbar button").off("click").on("click",function(e){e.stopPropagation()}),$("#submitBtn_"+a).hide(),$("#saveBtn_"+a).hide();var p=r[a].generalFeedback,g=$('<div><div class="clear" style="padding:0px;"></div><h1 tabindex="0" aria-label="Answer">Answer</h1></div><div tabindex="0" id="question-rational-text" aria-labelledby="question-rational-text">'+p+"</div>");$("#rationale_"+a).html(g),$("#lastSaveTime_"+a).css("visibility","hidden"),$("#dvThumbs_"+a).show()}else $("#lastSaveTime_"+a).html("Last saved on "+l).css("visibility","visible");Utility.hideSpinner(),$(window).scrollTop(0)}}},Handler.saveExplanatory={request:function(e){var t=$("#learningObjId").val(),s=globalQuestionId,a=CaseConnect.currentChapterIdstudylanding;e.data={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"studycenter",pageNavigatingTo:"studycenter",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{questionType:"explanatory",questionId:s,optionNumber:"",learningObjectId:t,studyCenterFlag:"1",answerVOList:[{responseText:" "}],grade:"1",chapterId:a}}}},response:function(e,t){(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status&&(alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner())}},Handler.issueSpotting={issueSpotSubmit:function(){var e=[],t={};(e=subQList.length>0?subQList:JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList{.subAnswerVOList.spanId == "'+issueSpottedId+'"}',globalData)).length>0&&(t=e[0]);for(var s=t.subAnswerVOList.issueMCQAnswerList,a=$('input:radio[name="optionsRadios"]:checked').val(),n=0;n<s.length;n++)if(n==a)if(1==parseInt(s[n].fraction)){e.length>1?(e.splice(0,1),subQList=e):subQList=[],$('input:radio[name="optionsRadios"]').parent().addClass("disableLabel"),$('input:radio[name="optionsRadios"]').attr("disabled","disabled"),$('input:radio[name="optionsRadios"][value="'+n+'"]').parent().removeClass("disableLabel"),$('.issuespoting-inner-popover input:radio[name="optionsRadios"][value="'+n+'"]').parent()[0].style.cssText="font-weight:bold !important";var i=t.subAnswerVOList.issueOrder;"array"!=$.type(i)&&(i=[i]);for(var r=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList.{.questionType == "order"}',globalData)[0].subAnswerVOList,o=[],d=0;d<i.length;d++)for(var l=0;l<r.length;l++)if(i[d]==r[l].issueId){if(o.push(r[l].issueText),0==$('#issueOrderContainer ul.sortable > li[issueid="'+r[l].issueId+'"]').length){var u="";u=1==r.length?$('<li class="issue-list-item" tabindex="0" issueid="'+r[l].issueId+'" correctorder="'+r[l].correctOrder+'"><span class="arrange-issue"><span class="text-lable">'+r[l].issueText+"</span></span></li>"):$('<li class="issue-list-item" tabindex="0" issueid="'+r[l].issueId+'" correctorder="'+r[l].correctOrder+'"><button type="button" tabindex="0" class="uparrow" onClick="swapWithPrev(this);" ontouchstart="swapWithPrev(this);"></button><span class="arrange-issue"><span class="text-lable">'+r[l].issueText+'</span></span><button type="button" tabindex="0" class="downarrow" onClick="swapWithNext(this);" ontouchstart="swapWithNext(this);"></button></li>'),$("#issueOrderContainer ul.sortable").append(u)}break}$(".sortable").sortable(),i.length>1?$(".popover-issue-mcq #feedback").html('<span class="correct">Issues Spotted: '+o.join(", ")+".</span>"):""!=$.trim(o.join(", "))?$(".popover-issue-mcq #feedback").html('<span class="correct">Issue Spotted: '+o.join(", ")+".</span>"):$(".popover-issue-mcq #feedback").html('<span class="correct">No issues here.</span>'),$(".popover-issue-mcq #nextBtn").show()}else $(".popover-issue-mcq #feedback").html('<span class="incorrect">Incorrect, try again.</span>')},handleNextClick:function(){var e=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList.{.questionType == "order"}',globalData)[0].subAnswerVOList;if(qList.length>0)$("#issueContainer span.highlight").popover("hide"),highlightIssue(t=$("#issueContainer span.issue.highlight"));else if($("#issueContainer span.highlight").popover("destroy"),$("#issueContainer span.issue:not(.issueVisited)").first().length>0){var t=$("#issueContainer span.issue:not(.issueVisited)").first();$("#issueContainer span.issue.highlight").removeClass("highlight"),highlightIssue(t)}else if(setTimeout(function(){document.activeElement.blur(),$("#issueOrderContainer").focus()},500),e.length==$("#issueOrderContainer ul.sortable > li").length){var s=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO.subQuestionVOList.{.questionType == "essay"}',globalData)[0].questionText;$("#essayQuestionText").html(s),$("#issueOrderContainer").show(),$("#issueDescContainer").show(),$("#btnContainer").show(),$("#issueContainer span.issue.highlight").removeClass("highlight"),null!=saveClicked&&clearInterval(saveClicked),saveClicked=setInterval(function(){$("#saveBtn").trigger("click")},18e4)}$(window).trigger("resize")}},Handler.thumbsUpDownClusterHypo=function(event){var current=event.target;$(current).parent().attr("isClickedThumbs","true");var questionNumberIndex=$(current).closest("div[id^=dvThumbs]").attr("id").split("_")[1],subQuestionId=$("#questionText_"+questionNumberIndex).attr("subquestionid"),parentQuestionId=$("#questionText_"+questionNumberIndex).attr("parentId");if("0"==$("#thumbStatus_"+questionNumberIndex).val()?($("#dvThumbs_"+questionNumberIndex+' span[type="thumbsDown"]').removeClass("gray-thumbsDown").addClass("red-thumbsDown"),$("#dvThumbs_"+questionNumberIndex+' span[type="thumbsUp"]').removeClass("green-thumbsUp").addClass("gray-thumbsUp"),$("#dvLike input:radio").removeAttr("disabled","disabled")):"1"==$("#thumbStatus_"+questionNumberIndex).val()?($("#dvThumbs_"+questionNumberIndex+' span[type="thumbsDown"]').removeClass("red-thumbsDown").addClass("gray-thumbsDown"),$("#dvThumbs_"+questionNumberIndex+' span[type="thumbsUp"]').removeClass("gray-thumbsUp").addClass("green-thumbsUp"),$("#dvLike input:radio").removeAttr("disabled","disabled")):($("#dvThumbs_"+questionNumberIndex+' span[type="thumbsDown"]').removeClass("red-thumbsDown").addClass("gray-thumbsDown"),$("#dvThumbs_"+questionNumberIndex+' span[type="thumbsUp"]').removeClass("green-thumbsUp").addClass("gray-thumbsUp")),$('div[isClickedThumbs="true"]').length==$("div[id^=questionText]").length){var ele=current,handler="thumbsUpDownClusterSave",request={},data={};request.url="/manageAssessmentService/saveQuestionResponse",request.url=properties[properties.env]+request.url,request.method=ele.getAttribute("data-method")||"POST",request.handler=eval("Handler."+handler);var $form=$(ele.form),$ele=$(current);if(null!=typeof $form){var fields=$form.serializeArray();jQuery.each(fields,function(e,t){data[t.name]=t.value})}request.data=data,$ele.form=$form,request.handler.request.apply($ele,[request]),request.target=$ele,Utility.fireRequest(request),(localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut()}},Handler.thumbsUpDownClusterSave={request:function(e){CaseConnect.currentUserId=localStorage.getItem("userId");for(var t=JSPath.apply('.{.currentQuestionFlag == "1"}.questionVO',globalData)[0],s=t.questionType,a=t.questionId,n=[],i=[],r=[],o="0",d=0,l=CaseConnect.currentChapterIdstudylanding,u=t.subQuestionVOList,c=0;c<u.length;c++)n.push(u[c].questionId),i.push($("#thumbStatus_"+c).val());for(var p=0;p<n.length;p++)d+=parseInt(i[p]),r.push({subQuestionId:n[p],subGrade:i[p]});d==n.length&&(o="1"),e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{questionType:s,questionId:a,optionNumber:"",learningObjectId:CaseConnect.currentLearningObjId,studyCenterFlag:"1",answerVOList:r,grade:o,chapterId:l}}},$("#page-loading-spinner").show()},response:function(e,t){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),"false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{Utility.hideSpinner();var s=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0],a=s.status;s.status="correct";for(var n=0;n<s.attemptedAnswerVOList.length;n++)$("#dvThumbs_"+n).find("span[type='thumbsUp']").hasClass("green-thumbsUp")?s.attemptedAnswerVOList[n].status="correct":$("#dvThumbs_"+n).find("span[type='thumbsDown']").hasClass("red-thumbsDown")&&(s.attemptedAnswerVOList[n].status="incorrect",s.status="incorrect");var i=CaseConnect.currentLearningObjId,r=JSPath.apply('.{.learningObjId == "'+i+'"}.learningObjectiveResponseList.{.questionType == "hypothetical"}',LORightpanel.learningObjectiveProgressVOList)[0],o=JSPath.apply('.{.currentQuestionFlag == "1"}.questionNumber',globalData)[0],d=$("#paginationContainer .pagination a#anchor_"+o).parent(),l=!1,u=!1;(d.hasClass("red")||d.hasClass("green"))&&(l=!0),a!=s.status&&(u=!0),"correct"==s.status?u&&(++r.totalCorrectAnswer,r.totalUnAnswered>0&&!l&&--r.totalUnAnswered,r.totalWrongAnswer>0&&--r.totalWrongAnswer):"incorrect"==s.status&&u&&(++r.totalWrongAnswer,r.totalUnAnswered>0&&!l&&--r.totalUnAnswered,r.totalCorrectAnswer>0&&--r.totalCorrectAnswer),updateStatusInPagination(o,s.status),handleDoneButton(s)}}},Handler.autoSaveClusterResponse={request:function(e){for(var t=[],s=$("div[id^=dvThumbs]:hidden"),a=$("#questionText_0").attr("parentid"),n=0;n<s.length;n++){var i=$(s[n]).attr("id").split("_")[1],r=tinyMCE.get("hypoEditor_"+i).getContent();""!=$.trim(r)&&t.push({questionId:$("#questionText_"+i).attr("subquestionid"),responseText:r})}e.data={userVO:{userId:CaseConnect.currentUserId,userActivityVO:{lastActivityCode:"STUDY_CENTER_LEARN_ANSWERING_QUESTIONS",pageNavigatingFrom:"StudyCenterQuestion",pageNavigatingTo:"StudyCenterQuestion",lastReadBookId:CaseConnect.currentbookIdstudylanding,lastReadChapterId:CaseConnect.currentChapterIdstudylanding,lastViewedLearningObjectId:CaseConnect.currentLearningObjId},sessionVO:map.sessionVO},assessmentVO:{questionVO:{parent:a,answerVOList:t,saveFlag:1}}},$("#page-loading-spinner").show()},response:function(e,t){if("false"===e.status)alertMessagesModal(exceptionMsg.systemError),sessionAuthFails(e),Utility.hideSpinner();else{var s=$("div[id^=dvThumbs]:hidden"),a=e.assessmentVO.lastSaveTime,n={},i=JSPath.apply('.{.currentQuestionFlag == "1"}.questionResponseVO',globalData)[0];i.attemptedAnswerVOList||(i.attemptedAnswerVOList=[]),"object"==$.type(i.attemptedAnswerVOList)&&(i.attemptedAnswerVOList=[i.attemptedAnswerVOList]);$("#questionText_0").attr("parentid");for(var r=0;r<s.length;r++){var o=$(s[r]).attr("id").split("_")[1],d=tinyMCE.get("hypoEditor_"+o).getContent();if(""!=$.trim(d)){for(var l=0;l<i.attemptedAnswerVOList.length;l++)if(i.attemptedAnswerVOList[l].subQuestionId==$("#questionText_"+o).attr("subquestionid")){i.attemptedAnswerVOList.splice(l,1);break}n={lastSaveTime:a,subResponseText:d,status:"not graded",saveFlag:1,subQuestionId:$("#questionText_"+o).attr("subquestionid")},i.attemptedAnswerVOList.push(n),a=getDateTime(new Date(retriveLocalTimeFromUTC(a))),$("#lastSaveTime_"+o).html("Last saved on "+a).css("visibility","visible")}}Utility.hideSpinner()}}},$(window).resize(function(e){var t=$(window).width();if(t<768&&("undefined"!=typeof insideQuestionLO&&insideQuestionLO?($(".study-landing-page-header-mobile").hide(),$(".study-landing-page-header-mobile").css("display",""),$(".study-content-page-header-mobile").show()):($(".study-landing-page-header-mobile").show(),$(".study-landing-page-header-mobile").css("display","inline-block"),$(".study-content-page-header-mobile").hide())),"Show Answer"==$("#btnFlagHideShow").html()?($(".flag-container-mobile-nextbtn").css("display","inline-block !important"),$(".flag-container-mobile-nextbtn").css("visibility","visible")):($(".flag-container-mobile-nextbtn").css("display","none !important"),$(".flag-container-mobile-nextbtn").css("visibility","hidden")),questionDetailsOfLO)if(t<768){for(var s=0;s<questionDetailsOfLO.length;s++)"1"===questionDetailsOfLO[s].currentQuestionFlag&&(questionDetailsOfLO[s].questionNumber,activeQuesNumIndex=s);if(activeQuesNumIndex<5)for(s=0;s<questionDetailsOfLO.length;s++)s>4&&$("#anchor_"+questionDetailsOfLO[s].questionNumber).parent().hide(),4===activeQuesNumIndex?($(".study-pagination-next-large").hide(),$(".study-pagination-next-xs").show()):($(".study-pagination-next-large").show(),$(".study-pagination-next-xs").hide()),$(".study-pagination-prev-large").show(),$(".study-pagination-prev-xs").hide();else if(activeQuesNumIndex>4)for(s=0;s<questionDetailsOfLO.length;s++)s<5&&$("#anchor_"+questionDetailsOfLO[s].questionNumber).parent().hide(),5===activeQuesNumIndex?($(".study-pagination-prev-large").hide(),$(".study-pagination-prev-xs").show()):($(".study-pagination-next-large").show(),$(".study-pagination-next-xs").hide()),$(".study-pagination-next-large").show(),$(".study-pagination-next-xs").hide()}else for(s=0;s<questionDetailsOfLO.length;s++)$("#anchor_"+questionDetailsOfLO[s].questionNumber).parent().show();if(LORightpanel)if(t<768)for(s=0,j=LORightpanel.learningObjectiveProgressVOList.length;s<j;s++){if((l=LORightpanel.learningObjectiveProgressVOList[s]).learningObjectiveResponseList.length>1){for(var a=0;a<l.learningObjectiveResponseList.length;a++)a%2==0&&0!==l.learningObjectiveResponseList[a].totalQuestions?$("#studyCentreVerticalRule_"+l.learningObjectiveResponseList[a].questionType+"_"+l.learningObjId).css("display","inline-block"):$("#studyCentreVerticalRule_"+l.learningObjectiveResponseList[a].questionType+"_"+l.learningObjId).css("display","none");for(var n=0;n<l.learningObjectiveResponseList.length;n++){var i=$("#practiceContent_"+parseInt(n)).find(".study-centre-vertical-rule").length;if(i>1)for(var r=0;r<i;r++)if($("#practiceContent_"+r).find(".study-centre-vertical-rule")[r]){var o=$("#practiceContent_"+r).find(".study-centre-vertical-rule")[r].getAttribute("index");if($("#practiceContent_"+r).find(".study-centre-vertical-rule")[r+1]){var d=$("#practiceContent_"+r).find(".study-centre-vertical-rule")[r+1].getAttribute("index");parseInt(d)!==parseInt(o)+1&&($("#practiceContent_"+r).find(".study-centre-vertical-rule")[r+1].style.display="none")}}}}}else for(s=0,j=LORightpanel.learningObjectiveProgressVOList.length;s<j;s++){var l;if((l=LORightpanel.learningObjectiveProgressVOList[s]).learningObjectiveResponseList.length>1)for(a=0;a<l.learningObjectiveResponseList.length;a++)$("#studyCentreVerticalRule_"+l.learningObjectiveResponseList[a].questionType+"_"+l.learningObjId).css("display","inline-block")}});
var alphabeticalLastNameCQPerf=[],lowestCQPerf=[],highestCQPerf=[],cqStudXlReport=[],cqStudDetailsXlReport=[],cqClassXlReport=[],maxChoiceCount=0,questionsList=0;function getClassTypeByClassCode(){$(".cqAnonymousEditBt").remove();var e=$(".redeemClassCode-input").val().trim();$("#page-loading-spinner").show();var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqClassCode:e};$.ajax({url:properties[properties.env]+"/manageCQ/getClassTypeByClassCode",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(e){if("true"===e.status){if(e.cqClassVO.cqClassType){var t=e.cqClassVO.cqClassType;if($(".getclassType").attr("cqClassType",t),localStorage.setItem("cqClassType",t),"standard"==e.cqClassVO.cqClassType)redeemClassCode(event);else{var a="Connected Quizzing for "+e.cqClassVO.cqTitle+" with Professor "+e.cqClassVO.professorFirstName+" "+e.cqClassVO.professorLastName+" requires your Anonymous ID.";$("#thankYouGetCQanonymousPopover .modal-thankYouGetCQanonymousPopoverHeader").html(a),e.cqClassVO.cqAnonymousId?$("#redeemAnonymousCode-inputId").val(e.cqClassVO.cqAnonymousId):$("#redeemAnonymousCode-inputId").val(""),$(".errorMesssageAnonymous").hide(),$("#thankYouGetCQanonymousPopover").modal("show"),$("#save-gotItBtns").hide(),$("#next-gotItBtns").show(),$("#page-loading-spinner").hide()}}}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),"bus.exception.class.code.has.been.already.used.by.you"==e.responseJSON.wkErrorCode?alertMessagesModal("You are already enrolled in this class. Please try a different class code."):"bus.exception.invalid.class.code"==e.responseJSON.wkErrorCode?alertMessagesModal("The class code you entered does not exist. Please check the code and try again."):"bus.exception.semester.end.date.has.past.for.class.code"==e.responseJSON.wkErrorCode?alertMessagesModal("This class is no longer in session. Please try a different class code."):alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function redeemClassCode(e,t){var a=$(".redeemClassCode-input").val().trim();$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:t,pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqClassVO:{cqClassCode:a,cqClassType:"standard"}};$.ajax({url:properties[properties.env]+"/manageCQ/redeemCQClassCode",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"===e.status){if(e.cqClassVO){$("#redeemClassCode-inputId").val("");var a=$(".creditClassCount").attr("creditCount");if(parseInt(a)-1!=0){$(".classCodeAddSection").show();var o=parseInt(a)-1;$(".creditClassCount").attr("creditcount",o),$(".creditClassCount").html(o+" Credit")}else $(".classCodeAddSection").hide(),$(".classCodeAddSection").html("");e.cqClassVO.pendingQPQuizCount&&("0"!==e.cqClassVO.pendingQPQuizCount?($(".cq-notification-cog-new").css("display","inline-block"),$(".cq-notification-cog-new sup").html(e.cqClassVO.pendingQPQuizCount)):($(".cq-notification-cog-new").css("display","none"),$(".cq-notification-cog-new sup").html(e.cqClassVO.pendingQPQuizCount)));var s=$(".classCodeAddSection").html();localStorage.setItem("classCodeAddSectionRefresh",s),"Bookshelf"!=t&&$("#okay-gotItBtns").attr("onclick","connectQuizStudentLanding('redeem',null)");var i="You've successfully redeemed Connected Quizzing for "+e.cqClassVO.cqTitle+" with Professor "+e.cqClassVO.professorFirstName+" "+e.cqClassVO.professorLastName;$("#thankYouGetCQPopover .modal-thankYouCQPopoverHeader").html(i),$("#thankYouGetCQPopover").modal("show")}if(e.cqProductVOList){$(".cq-title").parent().find(".student-book-author").remove(),"object"==$.type(e.cqProductVOList)&&(e.cqProductVOList=[e.cqProductVOList]);for(var r=0;r<e.cqProductVOList.length;r++)$(".cq-title").after('<div class="student-book-author" tabindex="0" onclick="connectQuizStudentLanding(true,null)"><p>'+e.cqProductVOList[r].cqTitle+"</p></div>")}$(".cq-productBook").attr("onclick","connectQuizStudentLanding(true,null)"),$(".student-book-title.cq-title").attr("onclick","connectQuizStudentLanding(true,null)"),$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),"bus.exception.class.code.has.been.already.used.by.you"==e.responseJSON.wkErrorCode?alertMessagesModal("You are already enrolled in this class. Please try a different class code."):"bus.exception.invalid.class.code"==e.responseJSON.wkErrorCode?alertMessagesModal("The class code you entered does not exist. Please check the code and try again."):"bus.exception.semester.end.date.has.past.for.class.code"==e.responseJSON.wkErrorCode?alertMessagesModal("This class is no longer in session. Please try a different class code."):alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function redeemAnonymousclassCode(e){var t=$(".redeemClassCode-input").val().trim(),a=$("#redeemAnonymousCode-inputId").val().trim(),o=$(".getclassType").attr("cqClassType");if(""===a||null==a)$(".errorMesssageAnonymous").show();else{$("#page-loading-spinner").show();var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqClassVO:{cqClassCode:t,cqAnonymousId:a,cqClassType:o}};$.ajax({url:properties[properties.env]+"/manageCQ/redeemCQClassCode",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(e){if("true"===e.status){if(e.cqClassVO){$("#redeemClassCode-inputId").val("");var t=$(".creditClassCount").attr("creditCount");if(parseInt(t)-1!=0){$(".classCodeAddSection").show();var a=parseInt(t)-1;$(".creditClassCount").attr("creditcount",a),$(".creditClassCount").html(a+" Credit")}else $(".classCodeAddSection").hide(),$(".classCodeAddSection").html("");e.cqClassVO.pendingQPQuizCount&&("0"!==e.cqClassVO.pendingQPQuizCount?($(".cq-notification-cog-new").css("display","inline-block"),$(".cq-notification-cog-new sup").html(e.cqClassVO.pendingQPQuizCount)):($(".cq-notification-cog-new").css("display","none"),$(".cq-notification-cog-new sup").html(e.cqClassVO.pendingQPQuizCount)));var o=$(".classCodeAddSection").html();localStorage.setItem("classCodeAddSectionRefresh",o),$("#okay-gotItBtns").attr("onclick","connectQuizStudentLanding('redeem',null)"),$("#thankYouGetCQanonymousPopover").modal("hide");var s="You've successfully redeemed Connected Quizzing for "+e.cqClassVO.cqTitle+" with Professor "+e.cqClassVO.professorFirstName+" "+e.cqClassVO.professorLastName;$("#thankYouGetCQPopover .modal-thankYouCQPopoverHeader").html(s),$("#okay-gotItBtns").attr("onclick","connectQuizStudentLanding('redeem',null)"),$("#thankYouGetCQPopover").modal("show"),$(".errorMesssageAnonymous").hide(),$("#page-loading-spinner").hide()}}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),"bus.exception.class.code.has.been.already.used.by.you"==e.responseJSON.wkErrorCode?alertMessagesModal("You are already enrolled in this class. Please try a different class code."):"bus.exception.invalid.class.code"==e.responseJSON.wkErrorCode?alertMessagesModal("The class code you entered does not exist. Please check the code and try again."):"bus.exception.semester.end.date.has.past.for.class.code"==e.responseJSON.wkErrorCode?alertMessagesModal("This class is no longer in session. Please try a different class code."):alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}}function getQpAuthenticationToken(e,t,a,o,s,i,r,n){var l={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_DASHBOARD_PAGE",pageNavigatingFrom:"BOOKSHELF",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}};$.ajax({url:properties[properties.env]+"/manageCQ/getQPToken",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(l)}).then(function(l){l.token&&(localStorage.setItem("authTokenCQ",l.token),e&&("preview"==e?previewQuestion(t,a,o,s):"PPIdentifierCreation"==e?createidentifierforPPQuiz(t,a,o,s,i):"PPinstanceCreation"==e?createidentifierforPPQuiz(t,a,o,s,i,r,n):createInstanceforQuiz(t,a,o,s)))},function(e){alertMessagesModal(e.responseJSON.errorMessg)})}function showAssignPopover(e,t){var a=$(e.currentTarget),o=a.attr("quiz-Identifier"),s=a.attr("quizId"),i=a.attr("publishResultInstantlyFlag"),r=(a.parent().attr("cqId"),a.parent().attr("classId")),n=a.parent().attr("id"),l=a.parent().attr("classname"),d=a.text();if($("#assignBtn").removeClass("firstAssign"),$("#assignBtn").removeClass("dblAssign"),$("#assignBtn").removeClass("rangeBoundpara"),"prof"==t){var c=a.attr("releaseoption");if("false"===i&&"date_range"===c)var p=a.attr("releaseDate"),u=a.attr("closeDate");l=$(".breadCrumbSection .studSemesterNames").html(),d=localStorage.getItem("quizName"),$(".errorMsgAssignQuiz").html("");var g,m,h,I=a.attr("quizEndDate"),v=(a.attr("assignedCount"),a.attr("completedCount"),a.attr("quizstartdate"));h=v;var S=a.attr("quizenddate");$(".semester-drpdwn").val();if(a.parent().find(".dueDate").length>0){var f=a.parent().find(".dueDate")[0].innerText;f&&((f=f.split("at"))[0].split(":")[1],f[1])}if(a.parent().find(".startDate").length>0){var C=a.parent().find(".startDate")[0].innerText;C&&(g=(C=C.split("at"))[0].split(":")[1],m=C[1])}if(a.hasClass("assigned")||a.hasClass("completed")){$("#myModalStart").modal("show");var b="",T="";"true"===localStorage.getItem("cqassistantFlag")?(b=$(".semester-drpdwnAssistant option:selected")[0].getAttribute("semesterenddate").split(" ")[0],T=$(".semester-drpdwnAssistant option:selected")[0].getAttribute("semesterstartdate").split(" ")[0]):(b=$(".semester-drpdwn option:selected")[0].getAttribute("semesterenddate").split(" ")[0],T=$(".semester-drpdwn option:selected")[0].getAttribute("semesterstartdate").split(" ")[0]);var y=moment().format().split("T")[0],O=Date.parse(T),R=Date.parse(y);Date.parse(b);R<O?$("#myModalStart #calenderSelectDueDatemyModalStart").datepicker({dateFormat:"MM dd, yy",minDate:moment(T).format("MMMM DD, YYYY"),maxDate:moment(b).format("MMMM DD, YYYY")}):$("#myModalStart #calenderSelectDueDatemyModalStart").datepicker({dateFormat:"MM dd, yy",minDate:moment().format("MMMM DD, YYYY"),maxDate:new Date(b)});for(var z="",P=1;P<13;P++)z+=P<10?"<option value=0"+P+">0"+P+"</option>":"<option value="+P+">"+P+"</option>";$("#myModalStart #calenderSelecteditDueTime").html(z);var k=(A=S.split(" "))[1].split(":");a.hasClass("completed")?($("#myModalStart #calenderSelectDueDatemyModalStart").datepicker().datepicker("setDate",""),$("#myModalStart #calenderSelecteditDueTime").val(""),$("#myModalStart #calenderSelecteditDueMins").val(""),$("#myModalStart #calenderSelecteditDueMeridian").val("")):($("#myModalStart #calenderSelectDueDatemyModalStart").datepicker().datepicker("setDate",moment(A[0]).format("MMMM DD, YYYY")),$("#myModalStart #calenderSelecteditDueTime").val(k[0]),$("#myModalStart #calenderSelecteditDueMins").val(k[1]),$("#myModalStart #calenderSelecteditDueMeridian").val(A[2])),$("#myModalStart #calenderSelectStartDate").val(g),$("#myModalStart #calenderSelectStartDate").attr("quizEditStartDate",h),$("#myModalStart #calenderSelectStartTime").val(m),$("#reassign").attr("quizId",s),$("#reassign").attr("classId",r),$("#reassign").attr("quizIdentifier",o),$("#rangedateBckbtn").removeClass("assign"),$("#rangedateBckbtn").addClass("reassign"),"false"===i?($("#reassign").attr("releaseDate",p),$("#reassign").attr("closeDate",u)):($("#reassign").removeAttr("releaseDate"),$("#reassign").removeAttr("closeDate")),$(".modalClassNameHeader").html(d+"<span> for </span><span class='classNameHeaderStyle'>"+l+"</span>"),localStorage.setItem("xlStartDate",a.attr("quizStartDate")),localStorage.setItem("xlEndDate",a.attr("quizEndDate")),null!=i&&null!=i?"true"==i?$("#myModalStart .quiz-res-dec .stud-sub").prop("checked",!0):"false"===i&&(void 0!==c?"date_range"===c?$("#myModalStart .quiz-res-dec .range-bound").prop("checked",!0):"quiz_end"===c&&$("#myModalStart .quiz-res-dec .after-quiz").prop("checked",!0):$("#myModalStart .quiz-res-dec .after-quiz").prop("checked",!0)):$("#myModalStart .quiz-res-dec .after-quiz").prop("checked",!0),$("#myModalStart").on("hide.bs.modal",function(){$(".ui-datepicker").remove()})}else{b="",T="";"true"===localStorage.getItem("cqassistantFlag")?(b=$(".semester-drpdwnAssistant option:selected")[0].getAttribute("semesterenddate").split(" ")[0],T=$(".semester-drpdwnAssistant option:selected")[0].getAttribute("semesterstartdate").split(" ")[0]):(b=$(".semester-drpdwn option:selected")[0].getAttribute("semesterenddate").split(" ")[0],T=$(".semester-drpdwn option:selected")[0].getAttribute("semesterstartdate").split(" ")[0]);y=moment().format().split("T")[0],O=Date.parse(T),R=Date.parse(y);if(Date.parse(b)<R)$("#mySemComplete").modal("show");else{$("#myModalForPropertyIntroduction").modal("show"),$("#startImmediately").prop("checked",!1),$("#myModalForPropertyIntroduction .errorMsgAssignQuiz").html(""),$("#startImmediately").removeClass("futureSem"),$("#myModalForPropertyIntroduction #calenderSelectDueDate").val(""),R<O?($("#modal-date-container #calenderSelectStartDate").datepicker({dateFormat:"MM dd, yy",minDate:moment(T).format("MMMM DD, YYYY"),maxDate:moment(b).format("MMMM DD, YYYY")}),$("#modal-date-container #calenderSelectDueDate").datepicker({dateFormat:"MM dd, yy",minDate:moment(T).format("MMMM DD, YYYY"),maxDate:moment(b).format("MMMM DD, YYYY")}),$("#startImmediately").addClass("futureSem"),a.hasClass("futureAssign")||$(".errorMsgAssignQuiz").html("<span class='err col-sm-3' style='margin-left: 12%;margin-top: 23px;'><span class='password-err-label'>This quiz will be scheduled to start at the beginning of the semester.</span></span>")):($("#modal-date-container #calenderSelectStartDate").datepicker({dateFormat:"MM dd, yy",minDate:moment().format("MMMM DD, YYYY"),maxDate:moment(b).format("MMMM DD, YYYY")}),$("#modal-date-container #calenderSelectDueDate").datepicker({dateFormat:"MM dd, yy",minDate:moment().format("MMMM DD, YYYY"),maxDate:moment(b).format("MMMM DD, YYYY")}));for((new Date).getHours(),z="",P=1;P<13;P++)z+=P<10?"<option value=0"+P+">0"+P+"</option>":"<option value="+P+">"+P+"</option>";if($("#calenderSelectDueTime").html(z),$("#calenderSelectStartTime").html(z),$("#calenderSelectreleaseDueTime").html(z),$("#calenderSelectreleaseStartTime").html(z),$("#calenderSelectcloseDueTime").html(z),a.hasClass("futureAssign")){var Q=v.split(" "),V=Q[1].split(":");$("#myModalForPropertyIntroduction #calenderSelectStartDate").datepicker().datepicker("setDate",moment(Q[0]).format("MMMM DD, YYYY")),$("#myModalForPropertyIntroduction #calenderSelectStartTime").val(V[0]),$("#myModalForPropertyIntroduction #calenderSelectStartMins").val(V[1]),$("#myModalForPropertyIntroduction #calenderSelectRangeMins").val(V[1]),$("#myModalForPropertyIntroduction #calenderSelectStartMeridian").val(Q[2]);var A;k=(A=S.split(" "))[1].split(":");$("#myModalForPropertyIntroduction #calenderSelectDueDate").datepicker().datepicker("setDate",moment(A[0]).format("MMMM DD, YYYY")),$("#myModalForPropertyIntroduction #calenderSelectDueTime").val(k[0]),$("#myModalForPropertyIntroduction #calenderSelectDueMins").val(k[1]),$("#myModalForPropertyIntroduction #calenderSelectDueMeridian").val(A[2])}else $("#myModalForPropertyIntroduction #calenderSelectDueDate").datepicker().datepicker("setDate",""),$("#myModalForPropertyIntroduction #calenderSelectDueTime").val(""),$("#myModalForPropertyIntroduction #calenderSelectDueMins").val(""),$("#myModalForPropertyIntroduction #calenderSelectDueMeridian").val(""),$("#assignBtn").addClass("firstAssign"),$("#startImmediately").trigger("click");$(".modalClassNameHeader").html(d+"<span> for </span><span class='classNameHeaderStyle'>"+l+"</span>"),$("#assignBtn").attr("quizId",s),$("#assignBtn").attr("classId",r),$("#assignBtn").attr("quizIdentifier",o),$("#assignBtn").show(),$("#assignBtn").addClass("dblAssign"),$("#rangedateBckbtn").removeClass("reassign"),$("#rangedateBckbtn").addClass("assign"),$("#myModalForPropertyIntroduction").on("hide.bs.modal",function(){$(".ui-datepicker").remove()})}null!=i&&null!=i?"true"==i?$("#myModalForPropertyIntroduction .quiz-res-dec .stud-sub").prop("checked",!0):$("#myModalForPropertyIntroduction .quiz-res-dec .range-bound").prop("checked",!0):$("#myModalForPropertyIntroduction .quiz-res-dec .after-quiz").prop("checked",!0)}}else{$(".cqAnonymousEditBt").remove();var w=a.parent().attr("anonymousid").trim();if("anonymous"!==a.parent().attr("cqclasstype").trim()||""!==w&&void 0!==w){var q=a.attr("qpQuizInstanceURL"),L=(I=a.attr("quizEndDate"),a.attr("quizcloseEndDate"),compareTimeWithLocal(I)),M=L/1e3;if(M=L>0?"Time Left: "+(M=convertSecstoHrs(M)):"Time Left: 0m",a.hasClass("studQuizBtn"))$("#myModalQuizStart").modal("show"),$("#myModalQuizStart .modalClassNameHeaderQuizTest").html(d),$("#myModalQuizStart .cQuizDateTextStyles.dueDate").html(a.parent().find(".dueDate")[0].innerHTML),$("#myModalQuizStart .cQuizDateTextStyles.timeLeft").html(M),$("#startBtns").attr("quizId",s),null!=q&&null!=q&&""!=q?($("#startBtns").text("Continue"),$("#startBtns").attr("onclick","showQuizFrame('"+q+"','stud')")):($("#startBtns").text("Start"),$("#startBtns").attr("onclick","createInstanceforQuiz('"+o+"',"+n+","+r+")"));else if("completed"==a.attr("quizstatus")){var N=a.parent().find(".completedDate")[0].innerHTML.split("Due:")[1],B=a.attr("instanceId"),E=a.parent().attr("classid");if($("#myModalQuizSummary").modal("show"),$("#myModalQuizSummary .cQuizDateTextStyles.detailedText").remove(),$("#myModalQuizSummary .modalClassNameHeaderQuizTest").html(d),$("#myModalQuizSummary .cQuizDateTextStyles.dueDate").html(a.parent().find(".dueDate")[0].innerHTML),$("#myModalQuizSummary .cQuizDateTextStyles.timeLeft").html("Submitted: "+N),$(".modalClassNameHeaderQuizTestSummary").html(d),$("#myModalQuizSummary .cQuizViewResultsStyles").html("View Results:"),$("#summaryBtns").show(),"true"==i)$("#detailedBtns").attr("onclick","getDetailedResults('"+o+"',"+B+","+E+")"),$("#detailedBtns").show();else if("false"==i&&"undefined"!==a.attr("releaseOption")&&""!==a.attr("releaseOption")){if("undefined"!==(c=a.attr("releaseOption")))if("date_range"===c){p=a.attr("releaseResultDate");if("undefined"!==(u=a.attr("closeResultDate"))){var D=u.split(" ")[0],F=u.split(" ")[1].split(":")[0],x=u.split(" ")[1].split(":")[1],j=moment.tz.guess();moment.tz(D+" "+F+":"+x,j);compareTimeWithLocal(u)>0?($("#detailedBtns").attr("onclick","getDetailedResults('"+o+"',"+B+","+E+")"),$("#detailedBtns").show()):($("#detailedBtns").hide(),$("#summaryDetailBtns").after('<p class="cQuizDateTextStyles detailedText" style="margin-bottom: 15px;">The timeframe to view your detailed results has been closed by your professor. </p>'))}if("undefined"!==p)if(compareTimeWithLocal(p)>0){var _=convetTimeESTAppend(p);_.replace('<span class="timeShowLoc">').replace("</span>"),$("#detailedBtns").hide(),$("#summaryDetailBtns").after('<p class="cQuizDateTextStyles detailedText" style="margin-bottom: 15px;">Your detailed results will be available on '+_+".</p>")}}else"quiz_end"===c&&("Time Left: 0m"==M?($("#detailedBtns").attr("onclick","getDetailedResults('"+o+"',"+B+","+E+")"),$("#detailedBtns").show()):($("#detailedBtns").hide(),$("#summaryDetailBtns").after('<p class="cQuizDateTextStyles detailedText" style="margin-bottom: 15px;">Detailed Results will post on '+a.parent().find(".dueDate")[0].innerHTML.split("Due:")[1]+"</p>")))}else"Time Left: 0m"==M?($("#detailedBtns").attr("onclick","getDetailedResults('"+o+"',"+B+","+E+")"),$("#detailedBtns").show()):($("#detailedBtns").hide(),$("#summaryDetailBtns").after('<p class="cQuizDateTextStyles detailedText" style="margin-bottom: 15px;">Detailed Results will post on '+a.parent().find(".dueDate")[0].innerHTML.split("Due:")[1]+"</p>"));$("#summaryBtns").attr("onclick","showQuizFrame('"+q+"','stud')")}else $("#myModalQuizSummary").modal("show"),$("#myModalQuizSummary .cQuizDateTextStyles.detailedText").remove(),$("#myModalQuizSummary .modalClassNameHeaderQuizTestSummary").html(d),$("#myModalQuizSummary .cQuizDateTextStyles.dueDate").html(a.parent().find(".dueDate")[0].innerHTML),$("#myModalQuizSummary .cQuizDateTextStyles.timeLeft").html(M),$("#myModalQuizSummary .cQuizViewResultsStyles").html("View Results: Not Submitted"),$("#detailedBtns").hide(),$("#summaryBtns").hide()}else{var U="Connected Quizzing for "+$("#"+r).attr("cqtitle")+" with Professor "+$("#"+r).attr("professorusername")+" requires your Anonymous ID";$("#thankYouGetCQanonymousPopover .modal-thankYouGetCQanonymousPopoverHeader").html(U),$("#redeemAnonymousCode-inputId").val(""),$("#redeemAnonymousCode-inputId").attr("cqClassId",r),$("#thankYouGetCQanonymousPopover").modal("show"),$(".errorMesssageAnonymous").hide(),$("#save-gotItBtns").show(),$("#next-gotItBtns").hide()}}}function endQuizPopover(e){$("#myModalStart").modal("hide"),$("#myModalEndQuizPopup").modal("show"),$("#myModalEndQuizPopup #yesBtnEndQuiz").attr("onclick","endQuiz("+e+")")}function endQuizNoPopover(){$("#myModalEndQuizPopup").modal("hide")}function convert24to12hrs(e){return(e=e.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[e]).length>1&&((e=e.slice(1))[5]=+e[0]<12?" AM":" PM",e[0]=+e[0]%12||12),e.join("")}function startImmediatley(e){if($(e.currentTarget).prop("checked")){var t=moment.tz.guess(),a=moment.tz(new Date,t).format().split("T");$("#myModalForPropertyIntroduction #calenderSelectStartDate").datepicker().datepicker("setDate",moment().format("MMMM DD, YYYY")),$("#myModalForPropertyIntroduction #calenderSelectRangeDate").datepicker().datepicker("setDate",moment().format("MMMM DD, YYYY"));var o=convert24to12hrs((a=a[1].split(":"))[0]+":"+a[1]);(o=o.split(":"))[0]<10&&(o[0]="0"+o[0]);var s=o[1].split(" ");$("#myModalForPropertyIntroduction #calenderSelectStartTime").val(o[0]),$("#myModalForPropertyIntroduction #calenderSelectStartMins").val(s[0]),$("#myModalForPropertyIntroduction #calenderSelectRangeMins").val(s[0]),$("#myModalForPropertyIntroduction #calenderSelectStartMeridian").val(s[1]),$("#startImmediately").hasClass("futureSem")&&$(".errorMsgAssignQuiz").html("<span class='err col-sm-3' style='margin-left: 12%;margin-top: 23px;'><span class='password-err-label'>This quiz will be scheduled to start at the beginning of the semester.</span></span>")}else $("#myModalForPropertyIntroduction .errorMsgAssignQuiz").html("")}function unchkStartImmediatley(){$("#startImmediately").prop("checked",!1)}function triggerDate(e){$("#"+e).datepicker("show"),"calenderSelectStartDate"==e?unchkStartImmediatley():"calenderSelectRangeDate"==e&&unchkStartImmediatley()}function assignQuiz(e){var t=$(e.currentTarget).attr("quizId"),a=$(e.currentTarget).attr("classId"),o=$(e.currentTarget).attr("publishResultInstantlyFlag"),s=$(e.currentTarget).attr("resultoption"),i=$(".btn-sec").attr("id").split("-")[1],r=$("#"+t).attr("quiz-identifier"),n=$(e.currentTarget).attr("estTime"),l=$(e.currentTarget).attr("startTime"),d=$(".semester-drpdwn").val();if("date_range"===s){var c=$(e.currentTarget).attr("releaseEstDate"),p=$(e.currentTarget).attr("closeEstDate");"undefined"===p.split("-")[0]&&(p="01-01-3000 12:00:00 AM")}$("#page-loading-spinner").show();var u={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:r,cqClassId:a,qpProductId:i,lastViewedCQSemesterId:d},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{id:t,assigned:!0,qpQuizIdentifier:r,publishResultInstantlyFlag:o,quizStartDate:l,quizEndDate:n},cqClassVO:{cqClassId:a}};"false"==o&&("quiz_end"==s?(u.qpQuizVO.releaseOption="quiz_end",u.qpQuizVO.releaseDate=n):"date_range"==s&&(u.qpQuizVO.releaseOption="date_range",u.qpQuizVO.releaseDate=c,u.qpQuizVO.closeDate=p)),$.ajax({url:properties[properties.env]+"/manageCQ/assignQuiz",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(u)}).then(function(e){if($("#page-loading-spinner").hide(),"true"===e.status){if($("#"+t).removeAttr("releaseoption"),$("#"+t).removeAttr("releasedate"),$("#"+t).removeAttr("closedate"),$("#myModalAssignPopup").modal("hide"),e.qpQuizVO){if($("#"+t).attr("quizstartdate",convertStartTimeFunc(e.qpQuizVO.quizStartDate)),$("#"+t).attr("quizenddate",convertStartTimeFunc(e.qpQuizVO.quizEndDate)),$("#"+t).attr("assignedcount",e.qpQuizVO.assignedCount),$("#"+t).attr("completedcount",e.qpQuizVO.completedCount),$("#"+t).attr("publishResultInstantlyFlag",o),"false"===o)if("date_range"===s){var a=dateFormatConversion(c),i=dateFormatConversion(p);$("#"+t).attr("releaseoption",s),$("#"+t).attr("releasedate",convertStartTimeFunc(a)),"3000"===p.split(" ")[0].split("-")[2]?$("#"+t).attr("closedate",""):$("#"+t).attr("closedate",convertStartTimeFunc(i))}else"quiz_end"===s&&($("#"+t).attr("releaseoption",s),$("#"+t).attr("releasedate",convertStartTimeFunc(e.qpQuizVO.quizEndDate)));var r=compareTimeWithLocal(e.qpQuizVO.quizEndDate),n=r/1e3,l=compareTimeWithLocal(e.qpQuizVO.quizStartDate);r>0&&(n="Due: "+convetTimeESTAppend(e.qpQuizVO.quizEndDate));var d="Due: "+convetTimeESTAppend(e.qpQuizVO.quizStartDate);checkQuiz(t,r,l,d,n,e.qpQuizVO.assignedCount,e.qpQuizVO.completedCount,!0),$("#"+t).after('<div class="dueDate" style="display:none">'+n+"</div>"),$("#"+t).after('<div class="startDate" style="display:none">'+d+"</div>"),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),$(".breadCrumbSection.startEnd").show()}}else $(window).trigger("resize"),$("#page-loading-spinner").hide(),$("#themis-loading-spinner-refresh").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function endQuiz(e){var t=$(".btn-sec").attr("classid"),a=$(".btn-sec").attr("id").split("-")[1],o=$("#"+e).attr("quiz-identifier"),s=$(".semester-drpdwn").val();$("#page-loading-spinner").show();var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:o,cqClassId:t,qpProductId:a,lastViewedCQSemesterId:s},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{id:e}};$.ajax({url:properties[properties.env]+"/manageCQ/endQuiz",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(t){if($("#page-loading-spinner").hide(),"true"===t.status){if($("#myModalEndQuizPopup").modal("hide"),$("#"+e).removeClass("assigned"),$("#"+e).addClass("completed"),$("#"+e).html("Reopen Quiz"),$("#endQuizBtnStart").remove(),$("#cancelQuiz").remove(),$("#"+e).removeAttr("releaseoption"),$("#"+e).removeAttr("releasedate"),$("#"+e).removeAttr("closedate"),$("#reassign").removeAttr("releaseDate"),$("#reassign").removeAttr("closeDate"),t.qpQuizVO){$("#"+e).attr("quizenddate",convertStartTimeFunc(t.qpQuizVO.quizEndDate)),$("#"+e).parent().find(".dueDate").remove();var a="Due: "+convetTimeESTAppend(t.qpQuizVO.quizEndDate);$("#"+e).after('<div class="dueDate" style="display:none">'+a+"</div>");var o=(a=a.split("at"))[0].split(":")[1],s=a[1];$(".breadCrumbSection.startEnd .cQuizClassNames").html("Completed: "+o+" at "+s),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),localStorage.setItem("startDateEndDate",$(".breadCrumbSection.startEnd").html())}var i=$(".completedBtnGroup .completedBtn").html();i.length>0&&(i=i.replace("In Progress","Completed"),$(".completedBtnGroup .completedBtn").html(i),$(".completedBtnGroup").css("background","#dadada"),localStorage.setItem("progresString",i))}else $(window).trigger("resize"),$("#page-loading-spinner").hide(),$("#themis-loading-spinner-refresh").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function connectQuizProfLanding(e,t){if(localStorage.removeItem("qpUrlProf"),null!=e&&null!=e&&localStorage.setItem("eulaValidationCheck",e.currentTarget.getAttribute("eulaFlag")),"true"===localStorage.getItem("eulaValidationCheck")){if($("[rel=popover]").popover("hide"),map.overlay.fadeOut(200),e)var a=e.currentTarget.attributes;return $("#eula-validation-modal").modal("show"),$(a).each(function(){var e=this.name,t=this.value;$("#btn-eula-accept").attr(e,t)}),$(".eula-text-container").load("endUserLisenceAggrement.html"),void $("#eula-validation-modal button").removeAttr("id","class").removeAttr("style").attr({id:"btn-eula-accept",class:"btn btn-default popover-common-btn ereader-btn-custom-gradient",onClick:"saveEulaValidationStatus(event,true)"})}$("#page-loading-spinner").show();var o="";t&&(o="true"==t?$(".semester-drpdwn").val():t);var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_DASHBOARD",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}};t&&(s.cqSemesterVO={semesterId:o},s.userVO.userActivityVO.lastViewedCQSemesterId=o),$.ajax({url:properties[properties.env]+"/manageCQ/getCQClassBySemesterId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(e){if("true"===e.status){if(localStorage.removeItem("qpUrlProf"),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insidePracticePerfect=!1,insideCQuizzing=!0,e.cqClassVOList){var a=e.cqClassVOList;"object"==$.type(a)&&(a=[a]);for(var s=0;s<a.length;s++)"object"==$.type(a[s].classQuizVOList)&&(a[s].classQuizVOList=[a[s].classQuizVOList]),"object"==$.type(a[s].cqClassAssistantVOList)&&(a[s].cqClassAssistantVOList=[a[s].cqClassAssistantVOList]),a[s].classQuizVOList&&(a[s].totalQuizzes=a[s].classQuizVOList.length);for(var s in a){var i=0;if(a[s].cqClassAssistantVOList){var r="",n="";for(var l in a[s].cqClassAssistantVOList){var d=a[s].cqClassAssistantVOList[l];"Professor"===d.ccUserRole?r+="Professor "+d.firstName+" "+d.lastName+", ":"Student"===d.ccUserRole&&(n+="Assistant "+d.firstName+" "+d.lastName+", ")}a[s].assistantMessage="Teaching with "+r+n,a[s].assistantMessage=a[s].assistantMessage.replace(/,\s*$/,"")}if(a[s].classQuizVOList){for(var c in a[s].classQuizVOList)"completed"===a[s].classQuizVOList[c].scheduleStatus&&i++;a[s].totalCompletedQuizzes=i}}map.wk_conatiner.load("connectQuizProfessor-landing.html?v16",function(){getSemesterBySchoolId(a[0].semesterId);var e=Handlebars.getTemplate("connect-Quiz-landing")(a);$("#cQuiz-course-admin-progress").html(e),adjustLeftNavHeight(),"Professor"===map.userRole&&$(".contactAssessmentSpecialistId").show()})}else map.wk_conatiner.load("connectQuizProfessor-landing.html?v16",function(){t?getSemesterBySchoolId(o):($(".semester-drpdwn").html("<option value='-999'>Select a Semester</option>"),getSemesterBySchoolId(-999)),"Professor"===map.userRole&&$(".contactAssessmentSpecialistId").show(),adjustLeftNavHeight()});Utility.hideSpinner()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function previewQuestion(e,t,a){if(null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ")||""==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("preview",e,t,a),!0;$("#page-loading-spinner").show();fetch(properties.quizzingPlatform+"/api/tests/"+e+"/preview?productId="+t,{method:"GET",headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(o){o&&(8006===o.code?getQpAuthenticationToken("preview",e,t,a):($("#myModalForPropertyIntroduction").modal("hide"),showQuizFrame(o,"prof",a))),Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}function getSemesterBySchoolId(e){localStorage.getItem("schoolId");$("#page-loading-spinner").show();var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_DASHBOARD",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqSemesterVO:{schoolId:localStorage.getItem("schoolId")}};$.ajax({url:properties[properties.env]+"/manageCQ/getActiveSemesterForProfessor",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(t){if("true"==t.status){if(t.cqSemesterVOList){var a=t.cqSemesterVOList;"object"==$.type(a)&&(a=[a]);for(var o="",s=0;s<a.length;s++)o+="<option value='"+a[s].semesterId+"' semesterStartDate='"+a[s].semesterStartDate+"' semesterEndDate='"+a[s].semesterEndDate+"'>"+a[s].semesterName+"</option>";$(".semester-drpdwn").html(o),$(".semester-drpdwn").val(e),$(".timeLeftShow").each(function(){"Completed"==$(this).html()&&$(this).prev(".btn-primary").removeClass("studQuizBtn").removeClass("quizAssignYesBtn").addClass("quizStartYesBtn")})}$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.systemError)})}function connectQuizStudentLanding(e,t){if(localStorage.removeItem("qpUrlProf"),"true"===localStorage.getItem("cqassistantFlag")&&"dropdown"===e&&localStorage.setItem("assistantSemId",$(".semester-drpdwnAssistant").val()),$.isNumeric(t)){var a=t;localStorage.setItem("assistantSemId",a)}else{if(null!=t&&null!=t&&localStorage.setItem("eulaValidationCheck",t.currentTarget.getAttribute("eulaFlag")),"true"===localStorage.getItem("eulaValidationCheck")){if($("[rel=popover]").popover("hide"),map.overlay.fadeOut(200),t)var o=t.currentTarget.attributes;return $("#eula-validation-modal").modal("show"),$(o).each(function(){var e=this.name,t=this.value;$("#btn-eula-accept").attr(e,t)}),$(".eula-text-container").load("endUserLisenceAggrement.html"),void $("#eula-validation-modal button").removeAttr("id","class").removeAttr("style").attr({id:"btn-eula-accept",class:"btn btn-default popover-common-btn ereader-btn-custom-gradient",onClick:"saveEulaValidationStatus(event,true,"+e+")"})}if("redeem"!=e){var s=$(".classCodeAddSection").html();null!=localStorage.getItem("classCodeAddSectionRefresh")&&null!=localStorage.getItem("classCodeAddSectionRefresh")||localStorage.setItem("classCodeAddSectionRefresh",s)}}$("#page-loading-spinner").show();var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}};$.ajax({url:properties[properties.env]+"/manageCQ/getStudentCQDashboard",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(t){if("true"===t.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insidePracticePerfect=!1,insideCQuizzing=!0,t.cqClassVOList){var o=t.cqClassVOList;"object"==$.type(o)&&(o=[o]),"true"===localStorage.getItem("cqassistantFlag")?map.wk_conatiner.load("connectQuizStudent-landing.html?v5",function(){for(var t=0;t<o.length;t++)o[t].qpQuizVOList&&"object"==$.type(o[t].qpQuizVOList)&&(o[t].qpQuizVOList=[o[t].qpQuizVOList]),o[t].cqClassAssistantVOList&&"object"==$.type(o[t].cqClassAssistantVOList)&&(o[t].cqClassAssistantVOList=[o[t].cqClassAssistantVOList]);for(var t in o)if(o[t].cqClassAssistantVOList){var s="",i="";for(var r in o[t].cqClassAssistantVOList){var n=o[t].cqClassAssistantVOList[r];"Professor"===n.ccUserRole?s+="Professor "+n.lastName+", ":"Student"===n.ccUserRole&&(i+="Assistant "+n.lastName+", ")}o[t].professorUserName+=", "+s+i,o[t].professorUserName=o[t].professorUserName.replace(/,\s*$/,"")}var l=localStorage.getItem("classCodeAddSectionRefresh");null!=l&&null!=l&&"undefined"!=l&&($(".classCodeAddSectionHeaderpart").html(l),$(".add-classCode").attr("onclick","getClassTypeByClassCode()")),$("#assistantRoleBtnPlate").show();var d=Handlebars.getTemplate("student-connect-Quiz-landing")(o);$("#studCQuiz-course-admin-progress").removeClass("noEnrolled"),$("#studCQuiz-course-admin-progress").html(d),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),$(".timeLeftShow").each(function(){"Not Submitted"==$(this).html()&&($(this).prev(".btn-primary").removeClass("studQuizBtn").removeClass("quizAssignYesBtn").addClass("studQuizCompleteBtn").addClass("quizStartYesBtn"),$(this).prev(".btn-primary").attr("quizStatus","ended"))}),($.isNumeric(a)||"dropdown"===e)&&$("#classAssistantBtn").trigger("click"),ConnectQuizSetSection(),adjustLeftNavHeight()}):map.wk_conatiner.load("connectQuizStudent-landing.html?v5",function(){for(var e=0;e<o.length;e++)o[e].qpQuizVOList&&("object"==$.type(o[e].qpQuizVOList)&&(o[e].qpQuizVOList=[o[e].qpQuizVOList]),o[e].cqClassAssistantVOList&&"object"==$.type(o[e].cqClassAssistantVOList)&&(o[e].cqClassAssistantVOList=[o[e].cqClassAssistantVOList]));for(var e in o)if(o[e].cqClassAssistantVOList){var t="",a="";for(var s in o[e].cqClassAssistantVOList){var i=o[e].cqClassAssistantVOList[s];"Professor"===i.ccUserRole?t+="Professor "+i.lastName+", ":"Student"===i.ccUserRole&&(a+="Assistant "+i.lastName+", ")}o[e].professorUserName+=", "+t+a,o[e].professorUserName=o[e].professorUserName.replace(/,\s*$/,"")}var r=localStorage.getItem("classCodeAddSectionRefresh");null!=r&&null!=r&&"undefined"!=r&&($(".classCodeAddSectionHeaderpart").html(r),$(".add-classCode").attr("onclick","getClassTypeByClassCode()"));var n=Handlebars.getTemplate("student-connect-Quiz-landing")(o);$("#studCQuiz-course-admin-progress").removeClass("noEnrolled"),$("#studCQuiz-course-admin-progress").html(n),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),$(".timeLeftShow").each(function(){"Not Submitted"==$(this).html()&&($(this).prev(".btn-primary").removeClass("studQuizBtn").removeClass("quizAssignYesBtn").addClass("studQuizCompleteBtn").addClass("quizStartYesBtn"),$(this).prev(".btn-primary").attr("quizStatus","ended"))}),ConnectQuizSetSection(),adjustLeftNavHeight()})}else map.wk_conatiner.load("connectQuizStudent-landing.html?v4",function(){"true"===localStorage.getItem("cqassistantFlag")&&($("#assistantRoleBtnPlate").show(),$("#studCQuiz-course-admin-progress").html("Redeem an access code to add classes you are enrolled in."),$("#studCQuiz-course-admin-progress").addClass("noEnrolled"));var t=localStorage.getItem("classCodeAddSectionRefresh");null!=t&&null!=t&&"undefined"!=t&&($(".classCodeAddSectionHeaderpart").html(t),$(".add-classCode").attr("onclick","getClassTypeByClassCode()")),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),"true"===localStorage.getItem("cqassistantFlag")&&($.isNumeric(a)||"dropdown"===e)&&$("#classAssistantBtn").trigger("click"),ConnectQuizSetSection(),adjustLeftNavHeight()});$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function createInstanceforQuiz(e,t,a){if($("#myModalQuizStart").modal("hide"),null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ")||""==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("instanceCreation",e,t,a),!0;var o="/api/tests/identifier/"+e+"/instances?clientUserId="+map.userId;$("#page-loading-spinner").show(),fetch(properties.quizzingPlatform+o,{method:"POST",body:JSON.stringify({productId:t,externalContext:{productType:"cq"}}),headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(o){o?8006===o.code?getQpAuthenticationToken("instanceCreation",e,t,a):(getInstanceID(o,e,a),showQuizFrame(o,"stud"),Utility.hideSpinner()):Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}function getInstanceID(e,t,a){var o="/api/tests/identifier/"+t+"/instances?clientUserId="+map.userId+"&sort=-id";fetch(properties.quizzingPlatform+o,{method:"GET",body:JSON.stringify(),headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(o){o?(o.instances.length>0&&postInstanceUrlToCC(e,t,a,o.instances[0].id),Utility.hideSpinner()):Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}function postInstanceUrlToCC(e,t,a,o){var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"Bookshelf",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:t,qpQuizInstanceURL:e,instanceId:o,qpAuthToken:localStorage.getItem("authTokenCQ")},cqClassVO:{cqClassId:a}};$.ajax({url:properties[properties.env]+"/manageCQ/postUserQuizInstance",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(e){"true"===e.status&&$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function loadProfResultSummary(e,t,a,o){$("#page-loading-spinner").show();var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,cqClassId:t,qpProductId:o,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t}};$.ajax({url:properties[properties.env]+"/manageCQ/getOverallResultForClass",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(e){if("true"===e.status){if(e.cqClassVO&&e.cqClassVO.cqClassType&&localStorage.setItem("cqClassType",e.cqClassVO.cqClassType),e.cqResultVO){if(e.cqResultVO.assignedCount&&e.cqResultVO.completedCount){var t="",a=e.cqResultVO.completedCount,o=e.cqResultVO.assignedCount,s=localStorage.getItem("cqQuizButtonClass");"quizAssignYesBtn"===s?t="In Progress: "+a+"/"+o+" Submissions":"quizStartYesBtn"===s&&(t="Completed: "+a+"/"+o+" Submissions"),$(".completedBtnGroup .completedBtn").html(t)}var i=Handlebars.getTemplate("professor-quizDetailedResults")(e.cqResultVO);$("#profCQuiz-detailedResult-progress").html(i)}$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function getTopicResultsForClass(e,t,a,o){$("#page-loading-spinner").show();var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,cqClassId:t,qpProductId:o,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t,qpProductId:o}};$.ajax({url:properties[properties.env]+"/manageCQ/getTopicResultsForClass",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(e){if("true"===e.status){if(e.qpQuestionVOList||e.qpTopicVOList){if(e.qpQuestionVOList){"object"==$.type(e.qpQuestionVOList)&&(e.qpQuestionVOList=[e.qpQuestionVOList]);for(var t=0;t<e.qpQuestionVOList.length;t++)"object"==$.type(e.qpQuestionVOList[t].choiceVOList)&&(e.qpQuestionVOList[t].choiceVOList=[e.qpQuestionVOList[t].choiceVOList]);cqClassXlReport=e.qpQuestionVOList}else cqClassXlReport=[];if(e.qpTopicVOList){"object"==$.type(e.qpTopicVOList)&&(e.qpTopicVOList=[e.qpTopicVOList]);for(var a=0;a<e.qpTopicVOList.length;a++)"object"==$.type(e.qpTopicVOList[a].associatedQuestionVOList)&&(e.qpTopicVOList[a].associatedQuestionVOList=[e.qpTopicVOList[a].associatedQuestionVOList])}var o=Handlebars.getTemplate("professor-quizTopicResults")(e);$("#profCQuiz-TopicResult-progress").html(o)}if(maxChoiceCount=parseInt(e.maxChoiceCount),e.userSettingsVO)"topicView"==e.userSettingsVO.cqResultDisplayOption?($(".cqTopicperformance").show(),$(".cqQuizcenterOrder").hide(),$("#cqquestionOrder").val("topicView")):($(".cqQuizcenterOrder").show(),$(".cqTopicperformance").hide(),$("#cqquestionOrder").val("questionView"));else $("#cqquestionOrder").val("topicView");$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function updateCQResultView(e){var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},userSettingsVO:{cqResultDisplayOption:e}};"Student"==localStorage.getItem("userRole")?(t.userVO.userActivityVO.lastActivityCode="CQ_STUDENT_RESULT_SUMMARY_PAGE",t.userVO.userActivityVO.instanceId=localStorage.getItem("instanceID"),t.userVO.userActivityVO.cqClassId=localStorage.getItem("classID"),t.userVO.userActivityVO.qpQuizIdentifier=localStorage.getItem("quizIdentifier")):t.userVO.userActivityVO.lastActivityCode="CQ_PROFESSOR_RESULT_SUMMARY_PAGE",$.ajax({url:properties[properties.env]+"/manageCQ/updateCQResultView",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(e){e.status},function(e){Utility.handleSessionAuthentication(e.responseJSON)&&alertMessagesModal(e.responseJSON.errorMessg)})}function getAllStudentsScore(e,t,a,o){$("#page-loading-spinner").show();var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,cqClassId:t,qpProductId:o,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t}};$.ajax({url:properties[properties.env]+"/manageCQ/getAllStudentsScore",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(a){if("true"===a.status){if($("#anonymousResultMessage").hide(),a.cqResultVOList){"object"==$.type(a.cqResultVOList)&&(a.cqResultVOList=[a.cqResultVOList]),alphabeticalLastNameCQPerf=a.cqResultVOList,lowestCQPerf=a.cqResultVOList,kendoInCQSummaryPage(),$("#profCQuiz-studResult-progress").show(),$(".overAllPerformanceClass-parent").show(),$(".stud-ClassName-ResultSection").remove(),"anonymous"===localStorage.getItem("cqClassType")&&$("#anonymousResultMessage").show();var s=Handlebars.getTemplate("professor-quizStudentResults")(a.cqResultVOList);$("#profCQuiz-studResult-progress .orderingPercentageSection").after(s),adjustLeftNavHeight(),$(".prof-expandResults").attr("onclick","getDetailedResultForStudent(event,'"+e+"','"+t+"','"+o+"')")}else alphabeticalLastNameCQPerf=[],$("#profCQuiz-studResult-progress").hide(),$(".overAllPerformanceClass-parent").hide(),highestCQPerf=[],lowestCQPerf=[];$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function getDetailedResultForStudent(e,t,a,o){var s=$(e.currentTarget).attr("instanceId"),i=$(e.currentTarget).attr("userId");if("Expand Results"==$(e.currentTarget).html()?$(e.currentTarget).html("Collapse Results"):$(e.currentTarget).html("Expand Results"),$("#prof-student-detailed"+i).children().length>0);else{$("#page-loading-spinner").show();var r={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:t,instanceId:s,qpProductId:o,cqClassId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:t,instanceId:s},cqClassVO:{cqClassId:a},userSearchVO:{userId:i}};$.ajax({url:properties[properties.env]+"/manageCQ/getDetailedResultForStudent",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(r)}).then(function(e){if("true"===e.status){if(e.qpQuestionVOList||e.qpTopicVOList){if(e.qpQuestionVOList&&"object"==$.type(e.qpQuestionVOList)&&(e.qpQuestionVOList=[e.qpQuestionVOList]),e.qpTopicVOList){"object"==$.type(e.qpTopicVOList)&&(e.qpTopicVOList=[e.qpTopicVOList]);for(var t=0;t<e.qpTopicVOList.length;t++)"object"==$.type(e.qpTopicVOList[t].associatedQuestionVOList)&&(e.qpTopicVOList[t].associatedQuestionVOList=[e.qpTopicVOList[t].associatedQuestionVOList])}var a=Handlebars.getTemplate("professor-detailedStudentsResults")(e);$("#prof-student-detailed"+i).html(a),"topicView"==$("#cqquestionOrder").val()?($(".cqTopicperformance").show(),$(".cqQuizcenterOrder").hide()):($(".cqQuizcenterOrder").show(),$(".cqTopicperformance").hide()),adjustLeftNavHeight()}$("#page-loading-spinner").hide()}},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}}function profDetailedResultPage(e,t,a,o){var s=$(e.currentTarget),i=s.attr("quiz-Identifier"),r=s.attr("quizId"),n=s.parent().attr("cqId"),l=s.parent().attr("classId"),d=s.parent().attr("id"),c=s.parent().attr("classname"),p=s.text(),u=s.attr("publishResultInstantlyFlag"),g=s.parent().attr("cqClassType"),m=s.attr("schedulestatus");localStorage.setItem("cqClassType",g),localStorage.setItem("quizName",p);s.attr("quizEndDate");var h,I,v,S,f,C=s.attr("assignedCount"),b=s.attr("completedCount"),T=(t=s.attr("quizstartdate"),s.attr("quizenddate")),y=$(".semester-drpdwn").val();if(s.parent().find(".dueDate").length>0){var O=s.parent().find(".dueDate")[0].innerText;S=O,O&&(O=O.split("at"),a=O[0].split(":")[1],h=O[1])}if(s.parent().find(".startDate").length>0){var R=s.parent().find(".startDate")[0].innerText;f=R,R&&((R=R.split("at"))[0].split(":")[1],I=R[1])}var z=s.attr("resultreleaseoption"),P="",k="";if("false"===u&&"date_range"===z&&"completed"!==m&&(P=s.attr("releasedateresult"),k=s.attr("closingdateresult")),"true"===localStorage.getItem("cqassistantFlag")){y=$(".semester-drpdwnAssistant").val();var Q=$(".semester-drpdwnAssistant:selected").text(),V=$("#classCodeInput"+l).val();localStorage.setItem("semName",Q),localStorage.setItem("classCode",V),localStorage.setItem("semId",y);var A=$(".semester-drpdwnAssistant option:selected").val(),w=$(".viewingPortAssistant").html();localStorage.setItem("semDropdown",A),localStorage.setItem("semList",w),$(".container-left-desktop-fix-cq").remove(),map.wk_conatiner.load("connectQuizProfessor-landing.html?v15",function(){$("#cQuiz-landing-content-area").remove(),$(".cquizHeaderContainer").after('<div id="res-prof-sam" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding"></div>'),$(".viewingPort").html(w),$(".semester-drpdwnAssistant option").removeAttr("selected").filter("[value="+A+"]").attr("selected",!0),$("#res-prof-sam").load("professor-QuizDetailedResult-landing.html?v26552",function(){if($(".backToQuiz a").attr("onclick","connectQuizStudentLanding('back',"+y+")"),$(".proff-ResultClassName-header").html(p),$(".breadCrumbSection .studSemesterNames").html(c),$(".btn-sec").attr("cqId",n),$(".btn-sec").attr("classId",l),$(".btn-sec").attr("id","qp-"+d),$("#studentSimulation").attr("classId",l),$("#studentSimulation").attr("quizIdentifier",i),$("#studentSimulation").attr("qpId",d),previewQuestionPrint(i,l,y,d),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("quizIdentifier",i),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("classId",l),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("semId",y),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("qpId",d),s.hasClass("quizAssignYesBtn"))localStorage.setItem("cqQuizButtonClass","quizAssignYesBtn"),v="In Progress: "+b+"/"+C+" Submissions",$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+dateModification(t)+" at "+I),$(".completedBtnGroup .completedBtn").html(v),$(".completedBtnGroup").css("background","#A6D1EB"),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+a+" at "+h),$(".breadCrumbSection.startEnd").show(),$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="endQuizBtnStart" class="btn btn-md btn-primary cq-prof-result-btn end-quiz ellipsis" onclick="endQuizPopover('+r+')">End Quiz</button><button id="'+r+'" class="btn btn-md btn-primary cq-prof-result-btn assigned ellipsis">Edit Assignment Details</button>'),$("#"+r).attr("quiz-identifier",i),$("#"+r).attr("onclick","showAssignPopover(event,'prof')"),$("#"+r).attr("quizid",r),$("#"+r).attr("completedCount",b),$("#"+r).attr("assignedCount",C),$("#"+r).attr("quizstartdate",t),$("#"+r).attr("quizenddate",T),"false"===u&&"date_range"===z&&($("#"+r).attr("releaseOption",z),$("#"+r).attr("releaseDate",P),$("#"+r).attr("closeDate",k)),$("#"+r).attr("publishResultInstantlyFlag",u),$("#"+r).after('<div class="dueDate" style="display:none">'+S+"</div>"),$("#"+r).after('<div class="startDate" style="display:none">'+f+"</div>"),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").trigger("click"),$(".preview-page").hide(),localStorage.setItem("xlStartDate",s.attr("quizStartDate")),localStorage.setItem("xlEndDate",s.attr("quizEndDate"));else if(s.hasClass("quizStartYesBtn"))localStorage.setItem("cqQuizButtonClass","quizStartYesBtn"),v="Completed: "+b+"/"+C+" Submissions",$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+dateModification(t)+" at "+I),$(".completedBtnGroup .completedBtn").html(v),$(".completedBtnGroup").css("background","#dadada"),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Completed: "+a+" at "+h),$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="'+r+'" class="btn btn-md btn-primary cq-prof-result-btn completed ellipsis">Reopen Quiz</button>'),$(".breadCrumbSection.startEnd").show(),$("#"+r).attr("quiz-identifier",i),$("#"+r).attr("onclick","showAssignPopover(event,'prof')"),$("#"+r).attr("quizid",r),$("#"+r).attr("completedCount",b),$("#"+r).attr("assignedCount",C),$("#"+r).attr("quizstartdate",t),$("#"+r).attr("quizenddate",T),"false"===u&&"date_range"===z&&($("#"+r).attr("releaseOption",z),$("#"+r).attr("releaseDate",P),$("#"+r).attr("closeDate",k)),$("#"+r).attr("publishResultInstantlyFlag",u),$("#"+r).after('<div class="dueDate" style="display:none">'+S+"</div>"),$("#"+r).after('<div class="startDate" style="display:none">'+f+"</div>"),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").trigger("click"),$(".preview-page").hide(),localStorage.setItem("xlStartDate",s.attr("quizStartDate")),localStorage.setItem("xlEndDate",s.attr("quizEndDate"));else if(s.hasClass("quizFutureBtn"))$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Starts: "+dateModification(t)+" at "+I),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+a+" at "+h),$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="cancelQuiz" class="btn btn-md btn-primary cq-prof-result-btn cancel ellipsis" onclick="cancelQuiz(event)">Cancel Quiz</button><button id="'+r+'" class="btn btn-md btn-primary cq-prof-result-btn futureAssign ellipsis">Edit Assignment Details</button>'),$(".breadCrumbSection.startEnd").show(),$("#"+r).attr("quiz-identifier",i),$("#"+r).attr("onclick","showAssignPopover(event,'prof')"),$("#"+r).attr("quizid",r),$("#"+r).attr("completedCount",b),$("#"+r).attr("assignedCount",C),$("#"+r).attr("quizstartdate",t),$("#"+r).attr("quizenddate",T),"false"===u&&"date_range"===z&&($("#"+r).attr("releaseOption",z),$("#"+r).attr("releaseDate",P),$("#"+r).attr("closeDate",k)),$("#"+r).attr("publishResultInstantlyFlag",u),$("#"+r).after('<div class="dueDate" style="display:none">'+S+"</div>"),$("#"+r).after('<div class="startDate" style="display:none">'+f+"</div>"),$(".preview-page").show();else{$(".breadCrumbSection .studSemesterNames").html(c),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results").hide(),$(".breadCrumbSection.startEnd").hide();var e=$(".semester-drpdwnAssistant option:selected")[0].getAttribute("semesterenddate").split(" ")[0],o=moment().format().split("T")[0],g=Date.parse(o);Date.parse(e)<g||($("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="'+r+'" class="btn btn-md btn-primary cq-prof-result-btn unassigned ellipsis">Assign to Class</button>'),$("#"+r).attr("quiz-identifier",i),$("#"+r).attr("onclick","showAssignPopover(event,'prof')"),$("#"+r).attr("quizid",r)),$(".preview-page").show()}localStorage.setItem("quizNameString",p),localStorage.setItem("classNameString",$(".breadCrumbSection .studSemesterNames").html()),localStorage.setItem("progresString",v),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),localStorage.setItem("startDateEndDate",$(".breadCrumbSection.startEnd").html()),adjustLeftNavHeight()})})}else{if("true"===localStorage.getItem("cqassistantFlag"))y=$(".semester-drpdwnAssistant").val(),Q=$(".semester-drpdwnAssistant option:selected").text();else y=$(".semester-drpdwn").val(),Q=$(".semester-drpdwn option:selected").text();V=$("#classCodeInput"+l).val();localStorage.setItem("semName",Q),localStorage.setItem("classCode",V),localStorage.setItem("semId",y),insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!0,insidePracticePerfect=!1,$("#cQuiz-landing-content-area").remove(),$(".cquizHeaderContainer").after('<div id="res-prof-sam" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding"></div>'),$("#res-prof-sam").load("professor-QuizDetailedResult-landing.html?v29172",function(){if($(".backToQuiz a").attr("onclick","connectQuizProfLanding(null,"+y+")"),$(".proff-ResultClassName-header").html(p),$(".breadCrumbSection .studSemesterNames").html(c),$(".btn-sec").attr("cqId",n),$(".btn-sec").attr("classId",l),$(".btn-sec").attr("id","qp-"+d),$("#studentSimulation").attr("classId",l),$("#studentSimulation").attr("quizIdentifier",i),$("#studentSimulation").attr("qpId",d),previewQuestionPrint(i,l,y,d),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("quizIdentifier",i),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("classId",l),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("semId",y),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").attr("qpId",d),s.hasClass("quizAssignYesBtn"))localStorage.setItem("cqQuizButtonClass","quizAssignYesBtn"),v="In Progress: "+b+"/"+C+" Submissions",$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+dateModification(t)+" at "+I),$(".completedBtnGroup .completedBtn").html(v),$(".completedBtnGroup").css("background","#A6D1EB"),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+a+" at "+h),$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="endQuizBtnStart" class="btn btn-md btn-primary cq-prof-result-btn end-quiz ellipsis" onclick="endQuizPopover('+r+')">End Quiz</button><button id="'+r+'" class="btn btn-md btn-primary cq-prof-result-btn assigned ellipsis">Edit Assignment Details</button>'),$("#"+r).attr("quiz-identifier",i),$("#"+r).attr("onclick","showAssignPopover(event,'prof')"),$("#"+r).attr("quizid",r),$("#"+r).attr("completedCount",b),$("#"+r).attr("assignedCount",C),$("#"+r).attr("quizstartdate",t),$("#"+r).attr("quizenddate",T),"false"===u&&"date_range"===z&&($("#"+r).attr("releaseOption",z),$("#"+r).attr("releaseDate",P),$("#"+r).attr("closeDate",k)),$("#"+r).attr("publishResultInstantlyFlag",u),$("#"+r).after('<div class="dueDate" style="display:none">'+S+"</div>"),$("#"+r).after('<div class="startDate" style="display:none">'+f+"</div>"),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").trigger("click"),$(".preview-page").hide(),localStorage.setItem("xlStartDate",s.attr("quizStartDate")),localStorage.setItem("xlEndDate",s.attr("quizEndDate"));else if(s.hasClass("quizStartYesBtn"))localStorage.setItem("cqQuizButtonClass","quizStartYesBtn"),v="Completed: "+b+"/"+C+" Submissions",$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+dateModification(t)+" at "+I),$(".completedBtnGroup .completedBtn").html(v),$(".completedBtnGroup").css("background","#dadada"),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Completed: "+a+" at "+h),$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="'+r+'" class="btn btn-md btn-primary cq-prof-result-btn completed ellipsis">Reopen Quiz</button>'),$("#"+r).attr("quiz-identifier",i),$("#"+r).attr("onclick","showAssignPopover(event,'prof')"),$("#"+r).attr("quizid",r),$("#"+r).attr("completedCount",b),$("#"+r).attr("assignedCount",C),$("#"+r).attr("quizstartdate",t),$("#"+r).attr("quizenddate",T),"false"===u&&"date_range"===z&&($("#"+r).attr("releaseOption",z),$("#"+r).attr("releaseDate",P),$("#"+r).attr("closeDate",k)),$("#"+r).attr("publishResultInstantlyFlag",u),$("#"+r).after('<div class="dueDate" style="display:none">'+S+"</div>"),$("#"+r).after('<div class="startDate" style="display:none">'+f+"</div>"),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results a").trigger("click"),$(".preview-page").hide(),localStorage.setItem("xlStartDate",s.attr("quizStartDate")),localStorage.setItem("xlEndDate",s.attr("quizEndDate"));else if(s.hasClass("quizFutureBtn"))$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Starts: "+dateModification(t)+" at "+I),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+a+" at "+h),$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="cancelQuiz" class="btn btn-md btn-primary cq-prof-result-btn cancel ellipsis" onclick="cancelQuiz(event)">Cancel Quiz</button><button id="'+r+'" class="btn btn-md btn-primary cq-prof-result-btn futureAssign ellipsis">Edit Assignment Details</button>'),$("#"+r).attr("quiz-identifier",i),$("#"+r).attr("onclick","showAssignPopover(event,'prof')"),$("#"+r).attr("quizid",r),$("#"+r).attr("completedCount",b),$("#"+r).attr("assignedCount",C),$("#"+r).attr("quizstartdate",t),$("#"+r).attr("quizenddate",T),"false"===u&&"date_range"===z&&($("#"+r).attr("releaseOption",z),$("#"+r).attr("releaseDate",P),$("#"+r).attr("closeDate",k)),$("#"+r).attr("publishResultInstantlyFlag",u),$("#"+r).after('<div class="dueDate" style="display:none">'+S+"</div>"),$("#"+r).after('<div class="startDate" style="display:none">'+f+"</div>"),$(".preview-page").show();else{$(".breadCrumbSection .studSemesterNames").html(c),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results").hide(),$(".breadCrumbSection.startEnd").hide();var e=$(".semester-drpdwn option:selected")[0].getAttribute("semesterenddate").split(" ")[0],o=moment().format().split("T")[0],g=Date.parse(o);Date.parse(e)<g||($("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="'+r+'" class="btn btn-md btn-primary cq-prof-result-btn unassigned ellipsis">Assign to Class</button>'),$("#"+r).attr("quiz-identifier",i),$("#"+r).attr("onclick","showAssignPopover(event,'prof')"),$("#"+r).attr("quizid",r)),$(".preview-page").show()}localStorage.setItem("quizNameString",p),localStorage.setItem("classNameString",$(".breadCrumbSection .studSemesterNames").html()),localStorage.setItem("progresString",v),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),localStorage.setItem("startDateEndDate",$(".breadCrumbSection.startEnd").html()),adjustLeftNavHeight()})}}function previewQuestionPrint(e,t,a,o){$("#page-loading-spinner").show();var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,cqClassId:t,qpProductId:o,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t,qpProductId:o}};$.ajax({url:properties[properties.env]+"/manageCQ/getCQPreviewByQuizIdentifier",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(e){if("true"===e.status){if(e.qpQuestionVOList){"object"==$.type(e.qpQuestionVOList)&&(e.qpQuestionVOList=[e.qpQuestionVOList]);for(var t=0;t<e.qpQuestionVOList.length;t++)"object"==$.type(e.qpQuestionVOList[t].choiceVOList)&&(e.qpQuestionVOList[t].choiceVOList=[e.qpQuestionVOList[t].choiceVOList]);var a=Handlebars.getTemplate("professor-preview")(e);$(".preview-page").html(a)}$("#page-loading-spinner").hide()}$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}current_progress=0;var cancelQuizReqData="";function cancelQuiz(e){var t=$(".btn-sec").attr("classid"),a=$(".btn-sec").attr("id").split("-")[1],o=$(".futureAssign").attr("quiz-identifier"),s=$(".futureAssign").attr("id"),i=$(".semester-drpdwn").val(),r={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:o,cqClassId:t,qpProductId:a,lastViewedCQSemesterId:i},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqClassVO:{cqClassId:t},qpQuizVO:{id:s,qpQuizIdentifier:o}};$("#myModalCancelPopup").modal("show"),cancelQuizReqData=r,$("#myModalCancelPopup #yesBtn").attr("onclick","cancelQuizServ()")}function cancelQuizServ(){$("#myModalCancelPopup").modal("hide");var e=cancelQuizReqData;$("#page-loading-spinner").show(),$.ajax({url:properties[properties.env]+"/manageCQAdmin/cancelQuiz",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(t){if("true"===t.status){$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results").hide(),$(".breadCrumbSection.startEnd").hide();var a=e.qpQuizVO.id,o=e.qpQuizVO.qpQuizIdentifier;$("#profCQuiz-detailedResult-content-area .btn-sec").html('<button id="'+a+'" class="btn btn-md btn-primary cq-prof-result-btn unassigned ellipsis">Assign to Class</button>'),$("#"+a).attr("quiz-identifier",o),$("#"+a).attr("onclick","showAssignPopover(event,'prof')"),$("#"+a).attr("quizid",a),$(".preview-page").show(),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),localStorage.setItem("startDateEndDate",$(".breadCrumbSection.startEnd").html()),$(".breadCrumbSection.startEnd .cQuizprofessorNames").html(""),$(".breadCrumbSection.startEnd .cQuizClassNames").html(""),$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function getDetailedResults(e,t,a){var o=$("#myModalQuizSummary .cQuizDateTextStyles.dueDate").html();$("#myModalQuizSummary").modal("hide"),$(".modal-backdrop").remove(),$("#page-loading-spinner").show();var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,instanceId:t,cqClassId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e,instanceId:t},cqClassVO:{cqClassId:a}};$.ajax({url:properties[properties.env]+"/manageCQ/getStudentOverallResult",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(s){"true"===s.status&&(s.qpQuizVO?(localStorage.setItem("cqtitle",$("#"+a).attr("cqtitle")),localStorage.setItem("professorusername",$("#"+a).attr("professorusername")),loadStudDetailedPage(s.qpQuizVO,e,t,a,o,s.qpQuizVO.strCompletedDate),$("#page-loading-spinner").hide()):$("#page-loading-spinner").hide())},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function getStudentResultSummary(e,t,a){$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,instanceId:t,cqClassId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e,instanceId:t},cqClassVO:{cqClassId:a}};$.ajax({url:properties[properties.env]+"/manageCQ/getStudentResultSummary",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"===e.status)if(e.qpQuestionVOList||e.qpTopicVOList){if(e.qpQuestionVOList){"object"==$.type(e.qpQuestionVOList)&&(e.qpQuestionVOList=[e.qpQuestionVOList]);for(var t=0;t<e.qpQuestionVOList.length;t++)"object"==$.type(e.qpQuestionVOList[t].choiceVOList)&&(e.qpQuestionVOList[t].choiceVOList=[e.qpQuestionVOList[t].choiceVOList]);cqClassXlReport=e.qpQuestionVOList}else cqClassXlReport=[];if(e.qpTopicVOList){"object"==$.type(e.qpTopicVOList)&&(e.qpTopicVOList=[e.qpTopicVOList]);for(var a=0;a<e.qpTopicVOList.length;a++)"object"==$.type(e.qpTopicVOList[a].associatedQuestionVOList)&&(e.qpTopicVOList[a].associatedQuestionVOList=[e.qpTopicVOList[a].associatedQuestionVOList])}var o=Handlebars.getTemplate("student-quizResultSummary")(e);if($("#studCQuiz-detailedResult-progress .timeSpentResultShowIpad").after(o),e.userSettingsVO)"topicView"==e.userSettingsVO.cqResultDisplayOption?($(".cqTopicperformance").show(),$(".cqQuizcenterOrder").hide(),$("#cqquestionOrder").val("topicView")):($(".cqQuizcenterOrder").show(),$(".cqTopicperformance").hide(),$("#cqquestionOrder").val("questionView"));else $("#cqquestionOrder").val("topicView");for(a=0;a<e.qpTopicVOList.length;a++)if(e.qpTopicVOList[a].associatedQuestionVOList)for(var s=0;s<e.qpTopicVOList[a].associatedQuestionVOList.length;s++){var i=e.qpTopicVOList[a].associatedQuestionVOList[s].questionIdentifier;if(e.qpTopicVOList[a].associatedQuestionVOList[s].choiceIndex&&"false"==e.qpTopicVOList[a].associatedQuestionVOList[s].correct){var r=parseInt(e.qpTopicVOList[a].associatedQuestionVOList[s].choiceIndex)-1;$($(".cqTopicperformance #question"+i+" .optionalAnswersContext")[r]).after('<div class="glypicWrongGroup display-inline-block"><a class="glypicStyleWrong" href="#/" style="" aria-label="Incorrect"><span class="glyphicon glyphicon-remove"></span></a></div>')}}for(a=0;a<cqClassXlReport.length;a++){i=cqClassXlReport[a].questionIdentifier;var n=cqClassXlReport[a].choiceIndex;if(n&&"false"==cqClassXlReport[a].correct){r=parseInt(n)-1;$($(".cqQuizcenterOrder #questionQorder"+i+" .optionalAnswersContext")[r]).after('<div class="glypicWrongGroup display-inline-block"><a class="glypicStyleWrong" href="#/" aria-label="Incorrect" style=""><span class="glyphicon glyphicon-remove"></span></a></div>')}}adjustLeftNavHeight(),$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain,$("#page-loading-spinner").hide()})}function loadStudDetailedPage(e,t,a,o,s,i){var r=$(".modalClassNameHeaderQuizTestSummary").html(),n=$("#"+o+".breadCrumbSection").html();insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!0,insidePracticePerfect=!1;var l=convetTimeESTAppend(i);map.wk_conatiner.load("student-QuizDetailedResult-landing.html?v2",function(){var i=Handlebars.getTemplate("student-quizDetailedResults")(e);$("#studCQuiz-detailedResult-progress").html(i),$(".stud-ResultClassName-header").html(r),$(".sem-profName-ClassName .detailedResultsDueDate").html(s),$(".sem-profName-ClassName .submittedBtnGroup").html("Submitted: "+l),$(".breadCrumbSection").html(n),$(".breadCrumbSection").attr("id",o),$(".breadCrumbSection").attr("cqClassId",o),$(".breadCrumbSection").attr("cqtitle",localStorage.getItem("cqtitle")),$(".breadCrumbSection").attr("professorusername",localStorage.getItem("professorusername")),localStorage.setItem("classNameString",$(".breadCrumbSection").html()),localStorage.setItem("quizNameString",r),localStorage.setItem("submittedDate",$(".sem-profName-ClassName .submittedBtnGroup").html()),localStorage.setItem("dueDate",s),"Student"===map.userRole&&($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")),localStorage.setItem("instanceID",a),localStorage.setItem("classID",o),localStorage.setItem("quizIdentifier",t),getStudentResultSummary(t,a,o),adjustLeftNavHeight()})}function expandAllQuestions(e,t){"Expand All Questions"==$(e.currentTarget).html()?($(e.currentTarget).html("Collapse All Questions"),$("#"+t+" .answersFieldSection").addClass("in"),$(".rationaleContext").css("height","auto"),$("#"+t+" .answersFieldSection").show(),$("#"+t+" .ellipseText").addClass("nonEllipseText").removeClass("ellipsis").removeClass("ellipseText")):($(e.currentTarget).html("Expand All Questions"),$("#"+t+" .answersFieldSection").removeClass("in"),$("#"+t+" .answersFieldSection").hide(),$("#"+t+" .nonEllipseText").addClass("ellipseText").addClass("ellipsis").removeClass("nonEllipseText")),adjustLeftNavHeight()}function expandselectedQuestion(e){var t=$(e.currentTarget).parent().find(".prof-questionBreakDown")[0];$(t).hasClass("ellipseText")?($($(t).attr("data-target")).css("height","auto"),$($(t).attr("data-target")).css("display","inline-block"),$($(t).attr("data-target")).show(),$(t).removeClass("ellipseText").addClass("nonEllipseText").removeClass("ellipsis")):($(t).removeClass("nonEllipseText").addClass("ellipseText").addClass("ellipsis"),$($(t).attr("data-target")).hide()),adjustLeftNavHeight()}function expandselectedQuestionStudWhole(e){if(13==e.keyCode){var t=$(e.currentTarget).find(".cQuizAttemptedQuestion")[0];$(t).hasClass("ellipseText")?($($(t).attr("data-target")).css("height","auto"),$($(t).attr("data-target")).show(),$(t).removeClass("ellipseText").addClass("nonEllipseText").removeClass("ellipsis")):($(t).removeClass("nonEllipseText").addClass("ellipseText").addClass("ellipsis"),$($(t).attr("data-target")).hide()),adjustLeftNavHeight()}}function expandselectedQuestionStud(e){var t=$(e.currentTarget).parent().find(".cQuizAttemptedQuestion")[0];$(t).hasClass("ellipseText")?($($(t).attr("data-target")).css("height","auto"),$($(t).attr("data-target")).show(),$(t).removeClass("ellipseText").addClass("nonEllipseText").removeClass("ellipsis")):($(t).removeClass("nonEllipseText").addClass("ellipseText").addClass("ellipsis"),$($(t).attr("data-target")).hide()),adjustLeftNavHeight()}function expandselectedQuestionCheckSymbol(e){var t=e.currentTarget;$(t).hasClass("ellipseText")?($($(t).prev(".cQuizAttemptedQuestion").attr("data-target")).css("height","auto"),$($(t).attr("data-target")).show(),$(t).removeClass("ellipseText").addClass("nonEllipseText").removeClass("ellipsis"),$(t).prev(".cQuizAttemptedQuestion").removeClass("ellipseText").addClass("nonEllipseText").removeClass("ellipsis")):($(t).removeClass("nonEllipseText").addClass("ellipseText").addClass("ellipsis"),$(t).prev(".cQuizAttemptedQuestion").removeClass("nonEllipseText").addClass("ellipseText").addClass("ellipsis"),$($(t).attr("data-target")).hide()),adjustLeftNavHeight()}function showQuizFrame(e,t,a,o,s){if($("#myModalQuizStart").modal("hide"),$(".modal-backdrop").remove(),null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ")||""==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("continueCreation",e,t,a),!0;insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1;var i="",r="";"pp"==t&&s&&(i=$(s.currentTarget).hasClass("boxCoverModal")?$(s.currentTarget).find(".vidTakeName").html():$(s.currentTarget).parent().parent().find(".vidTakeName").html(),r=$(s.currentTarget).attr("instanceId")),map.wk_conatiner.load("quizPage.html?v8",function(){var n=localStorage.getItem("quizName");if(null!=n&&null!=n&&$(".questionTitleSection").html(n),"true"===localStorage.getItem("cqassistantFlag")&&"undefined"!==localStorage.getItem("cqassistantFlag")&&null!==localStorage.getItem("cqassistantFlag")&&$(".questionTitleSection").hide(),"prof"==t)$(".container-left-desktop-fix-cq").removeClass("container-left-desktop-fix-pp"),$(".cqDashBoardBtnSection #backToDashboard").attr("onclick","connectQuizProfLanding(null,"+a+")"),$(".cqDashBoardBtnSection").show(),$(".cqDashBoardBtnSection-header").attr("style","display:block"),$(".ppDashBoardBtnSection").hide(),$(".ppDashBoardBtnSection-header").attr("style","display:none !important"),$(".pp-header-Container").hide(),$(".userClassNameStyles").hide(),$("#copyrestricted").hide(),$("#copyCQrestricted").show(),insideCQuizzing=!0,insidePracticePerfect=!1;else if("pp"==t){$(".pp-header-Container").show();var l=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect<sup class='pp-mainHeaderTM'>TM</sup> "+l),$(".pp-holder-name .subjectAreaName").html(l),$("#copyrestricted").show(),"video"==a?($(".questionTitleSection").hide(),$(".ppDashBoardBtnSection #backToDashboard").html("Back to Video"),$(".ppDashBoardBtnSection #backToDashboard").attr("onclick","getAllVideoTracker('"+o+"')"),$("#reviewResultsModalSection #yesRetakeBtn").attr("onclick","getVideoQuizProgress()")):($(".questionTitleSection").hide(),$(".ppDashBoardBtnSection #backToDashboard").html("Back to Quiz Center"),$(".ppDashBoardBtnSection #backToDashboard").addClass("pp-quizAttemptBtn"),$(".ppDashBoardBtnSection #backToDashboard").attr("onclick","quizPage()"),$("#reviewResultsModalSection #yesRetakeBtn").attr("onclick","quizCenterProgressLazyLoad()")),s&&($(".userClassNameStyles").html(i),$(".ppDashBoardBtnSection #progressBtn").attr("instanceId",r),$(".ppDashBoardBtnSection #progressBtn").show()),$(".cqDashBoardBtnSection").hide(),$(".cqDashBoardBtnSection-header").attr("style","display:none !important"),$(".ppDashBoardBtnSection").show(),$(".ppDashBoardBtnSection-header").attr("style","display:block"),insideCQuizzing=!1,insidePracticePerfect=!0}else $(".cqDashBoardBtnSection #backToDashboard").attr("onclick","connectQuizStudentLanding(true,null)"),$(".container-left-desktop-fix-cq").removeClass("container-left-desktop-fix-pp"),$(".cqDashBoardBtnSection").show(),$(".cqDashBoardBtnSection-header").attr("style","display:block"),$(".ppDashBoardBtnSection").hide(),$(".ppDashBoardBtnSection-header").attr("style","display:none !important"),$(".pp-header-Container").hide(),$(".titleContent").hide(),$("#copyCQrestricted").show(),$("#copyrestricted").hide(),insideCQuizzing=!0,insidePracticePerfect=!1;$("form#previewQuiz #engineURL").val(e),$("form#previewQuiz #accessToken").val(localStorage.getItem("authTokenCQ")),document.getElementById("previewQuiz").action=e,document.getElementById("previewQuiz").submit(),adjustLeftNavHeight()})}function expandAllQuestionsBreakDown(e,t){var a=$(e.currentTarget).text();document.getElementsByClassName("cQuizAttemptedQuestion");"Expand question breakdown"===a?($("#"+t).show(),$(e.currentTarget).text("Collapse question breakdown")):($(e.currentTarget).text("Expand question breakdown"),$("#"+t).hide()),adjustLeftNavHeight()}function sortingFunct(e){var t=$(e.currentTarget).val(),a=$(".prof-expandResults").attr("onclick"),o=[];o="lowestPerformance"==t?lowestCQPerf:"highestPerformance"==t?lowestCQPerf.slice().reverse():alphabeticalLastNameFunc(alphabeticalLastNameCQPerf),$("#profCQuiz-studResult-progress .stud-ClassName-ResultSection").remove();var s=Handlebars.getTemplate("professor-quizStudentResults")(o);$("#profCQuiz-studResult-progress .orderingPercentageSection").after(s),$(".prof-expandResults").attr("onclick",a),adjustLeftNavHeight()}function convertSecstoHrs(e){var t,a,o=parseInt(e),s="";return o<60?s="0m":o>=60&&o<3600?s=parseInt(o/60)+"m":o>=3600&&o<86400?(t=parseInt(o/3600),o=parseInt(o%3600),s=t+"h "+parseInt(o/60)+"m"):o>=86400&&(a=parseInt(o/86400),o=parseInt(o%86400),t=parseInt(o/3600),o=parseInt(o%3600),s=a+"d "+t+"h "+parseInt(o/60)+"m"),s}function compareTimeWithLocal(e){var t=moment.tz(e,"America/New_York").clone().tz(moment.tz.guess()),a=moment.tz(moment.tz.guess());return t.diff(a)}function compareDateWithcurrentDate(e){var t=moment.tz(e,"America/New_York").clone().tz(moment.tz.guess()),a=moment.tz(moment.tz.guess());return moment.utc(moment(t)).diff(moment(a)).toLocaleString().replace("-","").replace(/\D/g,"")}function kendoInCQSummaryPage(){var e=0,t=0,a=0,o=0,s=0,i=0,r=0,n=0,l=0,d=0;if(lowestCQPerf.length>0){$(".overAllPerformanceClass-parent").show(),$.each(lowestCQPerf,function(c,p){var u=Math.round(p.score);u>=0&&u<=9?e++:u>=10&&u<=19?t++:u>=20&&u<=29?a++:u>=30&&u<=39?o++:u>=40&&u<=49?s++:u>=50&&u<=59?i++:u>=60&&u<=69?r++:u>=70&&u<=79?n++:u>=80&&u<=89?l++:u>=90&&u<=100&&d++});var c=Math.max(e,t,a,o,s,i,r,n,l,d),p=c<=5?5:5*Math.ceil(c/5),u=[{category:"0-9%",score:e},{category:"10-19%",score:t},{category:"20-29%",score:a},{category:"30-39%",score:o},{category:"40-49%",score:s},{category:"50-59%",score:i},{category:"60-69%",score:r},{category:"70-79%",score:n},{category:"80-89%",score:l},{category:"90-100%",score:d}];$("#overAllPerformanceChart").kendoChart({title:{text:""},dataSource:{data:u},series:[{field:"score",color:"#ea8f00",opacity:1,name:"",highlight:{visible:!1}}],tooltip:{visible:!0,shared:!0,template:"Number of Students: #: value #"},seriesDefaults:{overlay:{gradient:null}},layers:[{type:"shape",style:{stroke:{color:"#ea8f00",width:4,opacity:.5}}}],categoryAxis:{field:"category",labels:{rotation:{angle:45}},majorGridLines:{visible:!1},name:"category",title:{text:"Scores",font:"13px fira-sans, sans-serif",color:"#000",margin:{top:10}}},valueAxis:{field:"score",min:0,max:p,majorUnit:Math.ceil(p/5),width:3,name:"Scores",title:{text:"Number of Students",font:"10px fira-sans, sans-serif",margin:{top:6,right:2}}},majorTicks:{visible:!0}}),$(window).on("resize",function(){kendo.resize($("#overAllPerformanceChart"))})}else $(".overAllPerformanceClass-parent").hide()}function contactAssessmentSpecialist(){$("#errorMsgNot").html(""),$("#errorMsgNotEmail").html(""),"Professor"===map.userRole?($("#myModalAssesmentSpecilaist").modal("show"),$(".phone-inputField").val(""),$(".email-inputField").val(""),$(".addMessagesInput").val(""),$("input:checkbox.checkBox-style").removeAttr("checked")):window.open("https://support.wklegaledu.com/hc/en-us/categories/360002135031-Connected-Quizzing","_blank")}function validateEmailConcierge(){var t=$(".phone-inputField").val().trim(),a=$(".email-inputField").val().trim(),o=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,s=$(".addMessagesInput").val().trim();if($("#errorMsgNot").html(""),$("#errorMsgNotEmail").html(""),""==t||""==a||!o.test(a))return""==t&&$("#errorMsgNot").html("<span class='err col-sm-3' style='margin-left: 0px;margin-top: 24px;'><span class='password-err-label'>Please enter a phone number.</span></span>"),""==a&&$("#errorMsgNotEmail").html("<span class='err col-sm-3' style='margin-left: 2px;margin-top: 24px;'><span class='password-err-label'>Please enter an email address.</span></span>"),o.test(a)||$("#errorMsgNotEmail").html("<span class='err col-sm-3' style='margin-left:2px;margin-top: 24px;'><span class='password-err-label loginErrMsg'>Please enter a valid email address.</span></span>"),e.preventDefault(),!1;for(var i=[],r=$(".checkBox-style"),n=0;n<r.length;n++)r[n].checked&&i.push($(r[n]).next(".checkBox-content-style").html());$("#errorMsgNot").html(""),$("#errorMsgNotEmail").html(""),$("#myModalAssesmentSpecilaist").modal("hide"),$("#myModalThankyouPopup").modal("show");var l={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},userProfVO:{email:a,phoneNum:t,conciergeMessages:i,message:s}};$.ajax({url:properties[properties.env]+"/manageCQ/contactMeNotify",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(l)}).then(function(e){e.status},function(e){$("#page-loading-spinner").hide(),$("#myModalAssesmentSpecilaist").modal("hide")})}function excelSheetReportServiceCQ(e,t,a,o){var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:e,qpProductId:o,cqClassId:t,lastViewedCQSemesterId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:e},cqClassVO:{cqClassId:t}};$.ajax({url:properties[properties.env]+"/manageCQ/getAllStudentsResultForReportGeneration",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(e){if("true"===e.status)if(e.cqResultVOList){"object"==$.type(e.cqResultVOList)&&(e.cqResultVOList=[e.cqResultVOList]);for(var t=0;t<e.cqResultVOList.length;t++)"object"==$.type(e.cqResultVOList[t].questionLevelScore)&&(e.cqResultVOList[t].questionLevelScore=[e.cqResultVOList[t].questionLevelScore]);cqStudXlReport=e.cqResultVOList}else cqStudXlReport=[]},function(e){alertMessagesModal(e.responseJSON.errorMessg),$("#page-loading-spinner").hide()})}function fetchCrctAnsOption(e){switch(e){case 0:return"A";case 1:return"B";case 2:return"C";case 3:return"D";case 4:return"E";case 5:return"F";case 6:return"G";case 7:return"H";case 8:return"I";case 9:return"J";case 10:return"K";case 11:return"L";case 12:return"M";case 13:return"N";case 14:return"O";case 15:return"P";case 16:return"Q";case 17:return"R";case 18:return"S";case 19:return"T";case 20:return"U";case 21:return"V";case 22:return"W";case 23:return"X";case 24:return"Y";case 25:return"Z";default:return"N/A"}}function fetchCrctAnsCQ(e){for(var t="",a=0;a<e.length;a++)if("true"==e[a].correct){t=a;break}return fetchCrctAnsOption(t)}function checkCrct(e,t,a){return"true"==e?t?{value:pickChoiceID(a),hAlign:"center"}:{value:"correct",hAlign:"center"}:t?{value:pickChoiceID(a),hAlign:"center",background:"#FFCCCC",color:"#9C0006"}:{value:"incorrect",hAlign:"center",background:"#FFCCCC",color:"#9C0006"}}function cqXLReportDownload(){var e={color:"#000000",size:1},t=$(".avgscr").text().split("%"),a=($(".classCodeInput").text(),$(".highscr").text().split("%")),o=$(".lowscr").text().split("%");""==t[0]&&(t[0]=0),""==a[0]&&(a[0]=0),""==o[0]&&(o[0]=0);var s=$(".proff-ResultClassName-header").text(),i=$(".prof-timeResultDetails")[0].innerText.replace("m"," minutes"),r=$(".studSemesterNames").text(),n=$(".completedBtn").text().split(" ");n=n[n.length-2].split("/");var l=dateXlFormat(localStorage.getItem("xlStartDate")),d=dateXlFormat(localStorage.getItem("xlEndDate")),c=($(".gradiant-button").css("background-color","red"),cqStudXlReport.slice().sort(function(e,t){if(void 0!==e.firstName&&void 0!==t.firstName)return c1=e.firstName.toLowerCase(),c2=t.firstName.toLowerCase(),c1<c2?-1:c1>c2?1:0})),p=0;c.length>0&&(p=c[0].questionLevelScore.length);for(var u=moment(Date()).format("MM/DD/YYYY hh:mm A"),g=moment(Date()).format("MMDDYYYY"),m=new kendo.data.DataSource({type:"odata",schema:{model:{fields:{StringVal:{type:"string"},Numbering:{type:"string"}}}}}),h=[{cells:[{value:"Professor Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("firstName")+" "+localStorage.getItem("lastName"),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Total Enrolled Students",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[1]),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e}]},{cells:[{value:"Institution",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("schoolName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Total Submitted Quizzes",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[0]),borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,hAlign:"left"}]},{cells:[{value:"Semester",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("semName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Average score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(t[0]),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Class Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:r,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Highest Score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(a[0]),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:s,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Lowest score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(o[0]),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Start Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:l,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Average time spent",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:i,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz End Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:d,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Date Report Generated",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:u,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{},{},{},{background:"#E7E6E6",borderBottom:e,borderTop:e},{value:"Percent of Students Selecting each Answer",borderBottom:e,borderTop:e,colspan:4,background:"#E7E6E6"},{background:"#E7E6E6",borderBottom:e,borderTop:e},{background:"#E7E6E6",borderBottom:e,borderTop:e}]},{cells:[{value:"Question Number",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0},{value:"Topic",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0},{value:"% Students answered correctly",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0}],height:40}],I=0;I<maxChoiceCount;I++)h[h.length-1].cells.push({value:"Option "+fetchCrctAnsOption(I)+" (%)",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0});h[h.length-1].cells.push({value:"No Answer (%)",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e,borderRight:e,bold:!0}),h[h.length-1].cells.push({value:"Correct Answer",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,bold:!0});var v=[{cells:[{value:"Professor Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("firstName")+" "+localStorage.getItem("lastName"),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Total Enrolled Students",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[1]),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e}]},{cells:[{value:"Institution",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("schoolName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Total Submitted Quizzes",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[0]),borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,hAlign:"left"}]},{cells:[{value:"Semester",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("semName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Average score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:t[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Class Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:r,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Highest Score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:a[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:s,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Lowest score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:o[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Start Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:l,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Average time spent",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:i,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz End Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:d,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Date Report Generated",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:u,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{},{},{},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{value:"Question Results",borderBottom:e,borderTop:e,colspan:p,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"}]},"anonymous"===localStorage.getItem("cqClassType")?{cells:[{value:"Student ID",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"Score(%)",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:"Time Spent",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]}:{cells:[{value:"Last Name",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"First Name",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"Score(%)",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:"Time Spent",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]}],S=[{cells:[{value:"Professor Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("firstName")+" "+localStorage.getItem("lastName"),hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Total Enrolled Students",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[1]),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e}]},{cells:[{value:"Institution",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("schoolName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Total Submitted Quizzes",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:parseInt(n[0]),borderBottom:e,borderLeft:e,borderRight:e,borderTop:e,hAlign:"left"}]},{cells:[{value:"Semester",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:localStorage.getItem("semName"),borderBottom:e,borderLeft:e,hAlign:"left",borderRight:e,borderTop:e},{},{value:"Average score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:t[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Class Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:r,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Highest Score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:a[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Name",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:s,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Lowest score (%)",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:o[0],hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz Start Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:l,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{},{value:"Average time spent",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:i,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Quiz End Date",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:d,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{value:"Date Report Generated",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:u,hAlign:"left",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]},{cells:[{},{},{},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{value:"Question Results",borderBottom:e,borderTop:e,colspan:p,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"},{borderBottom:e,borderTop:e,background:"#E7E6E6"}]},"anonymous"===localStorage.getItem("cqClassType")?{cells:[{value:"Student ID",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"Score(%)",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:"Time Spent",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]}:{cells:[{value:"Last Name",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"First Name",hAlign:"center",borderBottom:e,borderLeft:e,borderTop:e},{value:"Score(%)",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e},{value:"Time Spent",hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e}]}];m.fetch(function(){for(var t=cqClassXlReport,a=0;a<t.length;a++){if(h.push({cells:[{value:parseInt(t[a].ordinalNumber),hAlign:"center"},{value:$("#questionCollapese"+t[a].questionIdentifier).attr("subtitle"),hAlign:"left"},{value:roundToOne(t[a].correctPercentage),hAlign:"center"}]}),t[a].choiceVOList)for(var o=0;o<maxChoiceCount;o++)t[a].choiceVOList[o]&&t[a].choiceVOList[o].userResponsePercentage?h[h.length-1].cells.push({value:roundToOne(t[a].choiceVOList[o].userResponsePercentage),hAlign:"center"}):h[h.length-1].cells.push({value:"0",hAlign:"center"});h[h.length-1].cells.push({value:roundToOne(t[a].unansweredPercentage),hAlign:"center"}),h[h.length-1].cells.push({value:fetchCrctAnsCQ(t[a].choiceVOList),hAlign:"center"})}for(var i=1;i<=p;i++)v[9].cells.push({value:i,hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e});for(var r=0;r<c.length;r++)if("anonymous"===localStorage.getItem("cqClassType")?void 0!==c[r].firstName?v.push({cells:[{value:c[r].firstName,hAlign:"center"},{value:$("#prof-expandResults"+c[r].userId).parent().find(".bgclrForStudResult").html().trim().replace("%",""),hAlign:"center"},{value:$("#prof-expandResults"+c[r].userId).parent().find(".stud-timeSpentQuizTaken").html().split(":")[1].trim().replace("m"," minutes"),hAlign:"center"}]}):v.push({cells:[{value:"Student has not entered ID",hAlign:"center"},{value:$("#prof-expandResults"+c[r].userId).parent().find(".bgclrForStudResult").html().trim().replace("%",""),hAlign:"center"},{value:$("#prof-expandResults"+c[r].userId).parent().find(".stud-timeSpentQuizTaken").html().split(":")[1].trim().replace("m"," minutes"),hAlign:"center"}]}):v.push({cells:[{value:c[r].lastName,hAlign:"center"},{value:c[r].firstName,hAlign:"center"},{value:$("#prof-expandResults"+c[r].userId).parent().find(".bgclrForStudResult").html().trim().replace("%",""),hAlign:"center"},{value:$("#prof-expandResults"+c[r].userId).parent().find(".stud-timeSpentQuizTaken").html().split(":")[1].trim().replace("m"," minutes"),hAlign:"center"}]}),p>0)for(o=0;o<c[r].questionLevelScore.length;o++)v[v.length-1].cells.push(checkCrct(c[r].questionLevelScore[o].correct));for(var n=1;n<=p;n++)S[9].cells.push({value:n,hAlign:"center",borderBottom:e,borderLeft:e,borderRight:e,borderTop:e});for(var l=0;l<c.length;l++)if("anonymous"===localStorage.getItem("cqClassType")?void 0!==c[l].firstName?S.push({cells:[{value:c[l].firstName,hAlign:"center"},{value:$("#prof-expandResults"+c[l].userId).parent().find(".bgclrForStudResult").html().trim().replace("%",""),hAlign:"center"},{value:$("#prof-expandResults"+c[l].userId).parent().find(".stud-timeSpentQuizTaken").html().split(":")[1].trim().replace("m"," minutes"),hAlign:"center"}]}):S.push({cells:[{value:"Student has not entered ID",hAlign:"center"},{value:$("#prof-expandResults"+c[l].userId).parent().find(".bgclrForStudResult").html().trim().replace("%",""),hAlign:"center"},{value:$("#prof-expandResults"+c[l].userId).parent().find(".stud-timeSpentQuizTaken").html().split(":")[1].trim().replace("m"," minutes"),hAlign:"center"}]}):S.push({cells:[{value:c[l].lastName,hAlign:"center"},{value:c[l].firstName,hAlign:"center"},{value:$("#prof-expandResults"+c[l].userId).parent().find(".bgclrForStudResult").html().trim().replace("%",""),hAlign:"center"},{value:$("#prof-expandResults"+c[l].userId).parent().find(".stud-timeSpentQuizTaken").html().split(":")[1].trim().replace("m"," minutes"),hAlign:"center"}]}),p>0)for(var d=0;d<c[l].questionLevelScore.length;d++)S[S.length-1].cells.push(checkCrct(c[l].questionLevelScore[d].correct,!0,c[l].questionLevelScore[d].choiceIndex));var u=new kendo.ooxml.Workbook({sheets:[{columns:[{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0}],title:"By_Class",rows:h},{columns:[{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0}],title:"By_Student_Summary",rows:v},{columns:[{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0}],title:"By_Student_Details",rows:S}]});kendo.saveAs({dataURI:u.toDataURL(),fileName:localStorage.getItem("lastName")+"_"+localStorage.getItem("classCode")+"_"+s+"_"+g+".xlsx"})})}function checkChoiceColor(e){if(e){var t=e.toString().split(".")[1];if(1===t.length&&"0"===t)var a=e.toString().split(".")[0];else a=parseFloat(e).toFixed(1);return 0==parseFloat(a)?{value:parseFloat(e),hAlign:"center"}:parseFloat(a)>=50?{value:parseFloat(a),hAlign:"center",background:"#C6EFCE",color:"#006100"}:{value:parseFloat(a),hAlign:"center",background:"#FFCCCC",color:"#9C0006"}}return""}function dateXlFormat(e){return e.split(" ")[0].split("-")[1]+"/"+e.split(" ")[0].split("-")[2]+"/"+e.split(" ")[0].split("-")[0]+" "+e.split(" ")[1].split("/")+" "+e.split(" ")[2].split("/")+" "+e.split(" ")[3].split("/")}function cancelEditDate(){$(".editDateContainer").hide(),$(".hideWhileEdit").show()}function reAssignQuiz(e){var t=$(e.currentTarget).attr("quizId"),a=$(e.currentTarget).attr("classId"),o=$(e.currentTarget).attr("estTime"),s=$(e.currentTarget).attr("startTime"),i=$(e.currentTarget).attr("publishResultInstantlyFlag"),r=$(".btn-sec").attr("id").split("-")[1],n=$("#"+t).attr("quiz-identifier"),l=$(".semester-drpdwn").val(),d=$(e.currentTarget).attr("resultoption");if("date_range"===d){var c=$(e.currentTarget).attr("releaseEstDate"),p=$(e.currentTarget).attr("closeEstDate");"undefined"===p.split("-")[0]&&(p="01-01-3000 12:00:00 AM")}$("#page-loading-spinner").show();var u={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_PROFESSOR_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",qpQuizIdentifier:n,cqClassId:a,qpProductId:r,lastViewedCQSemesterId:l},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{id:t,assigned:!0,qpQuizIdentifier:n,publishResultInstantlyFlag:i,notifyEmail:!0,quizEndDate:o,quizStartDate:s},cqClassVO:{cqClassId:a}};"false"==i&&("quiz_end"==d?(u.qpQuizVO.releaseOption="quiz_end",u.qpQuizVO.releaseDate=o):"date_range"==d&&(u.qpQuizVO.releaseOption="date_range",u.qpQuizVO.releaseDate=c,u.qpQuizVO.closeDate=p)),$.ajax({url:properties[properties.env]+"/manageCQ/updateAssignedQuizDate",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(u)}).then(function(e){if($("#page-loading-spinner").hide(),"true"===e.status){$("#"+t).removeAttr("releaseoption"),$("#"+t).removeAttr("releasedate"),$("#"+t).removeAttr("closedate"),$("#myModalAssignPopup").modal("hide");var a=dateFormatConversion(s),r=dateFormatConversion(o);if($("#"+t).attr("quizstartdate",convertStartTimeFunc(a)),$("#"+t).attr("quizenddate",convertStartTimeFunc(r)),$("#"+t).attr("publishResultInstantlyFlag",i),"false"===i)if("date_range"===d){var n=dateFormatConversion(c),l=dateFormatConversion(p);$("#"+t).attr("releaseoption",d),$("#"+t).attr("releasedate",convertStartTimeFunc(n)),"3000"===p.split(" ")[0].split("-")[2]?$("#"+t).attr("closedate",""):$("#"+t).attr("closedate",convertStartTimeFunc(l))}else"quiz_end"===d&&($("#"+t).attr("releaseoption",d),$("#"+t).attr("releasedate",convertStartTimeFunc(r)));$("#"+t).parent().find(".dueDate").remove(),$("#"+t).parent().find(".startDate").remove();var u=compareTimeWithLocal(r),g=compareTimeWithLocal(a),m="Due: "+convetTimeESTAppend(r),h="Due: "+convetTimeESTAppend(a);checkQuiz(t,u,g,h,m,null,null,!0),$("#"+t).after('<div class="dueDate" style="display:none">'+m+"</div>"),$("#"+t).after('<div class="startDate" style="display:none">'+h+"</div>");var I=$(".completedBtnGroup .completedBtn").html();I.length>0&&(I=I.replace("Completed","In Progress"),$(".completedBtnGroup .completedBtn").html(I),$(".completedBtnGroup").css("background","#A6D1EB"),localStorage.setItem("progresString",I)),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML)}else $(window).trigger("resize"),$("#page-loading-spinner").hide(),$("#themis-loading-spinner-refresh").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function dateFormatConversion(e){var t="",a=e.split(" "),o=a[0].split("-");t=o[2]+"-"+o[0]+"-"+o[1]+" ";var s=a[1].split(":"),i=s[0],r=s[1];return"PM"==a[a.length-1]?(12==i||(i=parseInt(i)+12),24==i&&(i=0)):12==i&&(i="00"),t+(i+":")+r+":00.0"}function convertStartTimeFunc(e){var a=moment.tz(e,"America/New_York");t=a.clone().tz(moment.tz.guess());var o,s,i=a.clone().tz(moment.tz.guess()).format("z"),r=t.format().split("T"),n=r[1].split(":");(t=r[0],null!=n&&null!=n)?(n[0]>12?(meridian="PM",(o=n[0]-12)<10&&(o="0"+o),s=n[1]):"12"==n[0]?(meridian="PM",o="12",s=n[1]):(meridian="AM",o="00"==n[0]?"12":n[0],s=n[1]),t=t+" "+o+":"+s+" "+meridian+" "+i):t+=" ";return t}function convetTimeESTAppend(e){var t,a,o=moment.tz(e,"America/New_York"),s=o.clone().tz(moment.tz.guess()),i=o.clone().tz(moment.tz.guess()).format("z"),r=s.format().split("T"),n=r[1].split(":");(s=dateModification(r[0]),null!=n&&null!=n)?(n[0]>12?(meridian="PM",t=n[0]-12,a=n[1]):"12"==n[0]?(meridian="PM",t="12",a=n[1]):(meridian="AM",a=n[1],t="00"==n[0]?"12":n[0]),s=s+' <span class="timeShowLoc"> at '+t+":"+a+" "+meridian+" "+i+"</span>"):s+=" ";return s}function checkQuiz(e,t,a,o,s,i,r,n){var l=(s=s.split("at"))[0].split(":")[1],d=s[1],c=(o=o.split("at"))[0].split(":")[1],p=o[1];a>0?($("#"+e).removeClass("unassigned"),$("#"+e).removeClass("assigned"),$("#"+e).removeClass("completed"),$("#"+e).addClass("futureAssign"),$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Starts: "+c+" at "+p),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+l+" at "+d),null!=r&&null!=i&&(n="In Progress: "+r+"/"+i+" Submissions",$(".completedBtnGroup .completedBtn").html(n),$(".completedBtnGroup").css("background","#A6D1EB")),"cancelQuiz"!=$(".btn-sec button")[0].id&&$("#"+e).before('<button id="cancelQuiz" class="btn btn-md btn-primary cq-prof-result-btn cancel ellipsis" onclick="cancelQuiz(event)">Cancel Quiz</button>'),$("#"+e).html("Edit Assignment Details"),$("#endQuizBtnStart").remove()):a<=0&&t>0?($("#"+e).removeClass("unassigned"),$("#"+e).addClass("assigned"),$("#"+e).removeClass("completed"),$("#"+e).removeClass("futureAssign"),null!=r&&null!=i&&(n="In Progress: "+r+"/"+i+" Submissions",$(".completedBtnGroup .completedBtn").html(n),$(".completedBtnGroup").css("background","#A6D1EB")),"endQuizBtnStart"!=$(".btn-sec button")[0].id&&$("#"+e).before('<button id="endQuizBtnStart" class="btn btn-md btn-primary cq-prof-result-btn end-quiz ellipsis" onclick="endQuizPopover('+e+')">End Quiz</button>'),$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+c+" at "+p),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Ends: "+l+" at "+d),$("#"+e).html("Edit Assignment Details"),$("#cancelQuiz").remove()):t<0&&($("#"+e).removeClass("unassigned"),$("#"+e).removeClass("assigned"),$("#"+e).addClass("completed"),$("#"+e).removeClass("futureAssign"),null!=r&&null!=i&&(n="Completed: "+r+"/"+i+" Submissions",$(".completedBtnGroup .completedBtn").html(n),$(".completedBtnGroup").css("background","#dadada")),$(".breadCrumbSection.startEnd .cQuizprofessorNames").html("Assigned: "+c+" at "+p),$(".breadCrumbSection.startEnd .cQuizClassNames").html("Completed: "+l+" at "+d),$("#"+e).html("Reopen Quiz"),$("#endQuizBtnStart").remove(),$("#cancelQuiz").remove()),localStorage.setItem("startDateEndDate",$(".breadCrumbSection.startEnd").html()),localStorage.setItem("btn-sec",$("#profCQuiz-detailedResult-content-area .btn-sec")[0].outerHTML),localStorage.setItem("progresString",$(".completedBtnGroup .completedBtn").html()),$("#profCQuiz-detailedResult-content-area .nav-tabs-topics-students .nav-item.view-results").show()}function captchaLoginVerify(){$("#recaptchaLogin").next(".error-label").remove();var e=$('[name ="g-recaptcha-response"]').val();$("#page-loading-spinner").show();var t={};t.url=properties[properties.env]+"/manageUserService/userAuthentication";var a=$("#login_email").val().trim(),o=$("#login_password").val().trim();t.data={email:a,password:o,responseCaptcha:e},Handler.login.request(t),t.method="POST",t.handler=Handler.login,Utility.fireRequest(t)}function captchaRegisterVerify(){$("#recaptchaLogin").next(".error-label").remove();var e=$('[name ="g-recaptcha-response"]').val();$("#page-loading-spinner").show();var t={};t.url=properties[properties.env]+"/manageUserService/userOneStepRegistration";var a=$("#reg_firstName").val().trim(),o=$("#reg_lastName").val().trim(),s=$("#reg_email").val().trim(),i=$("#reg_confirmEmail").val().trim(),r=$("#reg_password").val().trim(),n=$("#reg_confirmPassword").val().trim(),l=$("#user-country-name").val().trim(),d=$("#user-school-location").val().trim(),c=$("#user-school-name").val().trim();t.data={firstName:a,lastName:o,email:s,confirmEmail:i,password:r,confirmPassword:n,country:l,schoolLocation:d,schoolName:c,responseCaptcha:e},Handler.createAccount.request(t),t.method="POST",t.handler=Handler.createAccount,Utility.fireRequest(t)}function ppLandingpage(e){var t="",a="",o="",s="",i="",r="";if(null!=e&&null!=e&&(localStorage.setItem("eulaValidationCheck",e.currentTarget.getAttribute("eulaFlag")),t=$(e.currentTarget).attr("bookid"),a=$(e.currentTarget).attr("ppsubjectareatagid"),o=$(e.currentTarget).attr("bookTitle"),localStorage.setItem("ppsubjectareatagid",a),localStorage.setItem("ppProductTitle",o),s=$(e.currentTarget).attr("qpquestiontypeidentifier"),i=$(e.currentTarget).attr("qpquestiontype"),localStorage.setItem("qpquestiontypeidentifier",s),localStorage.setItem("qpquestiontype",i),r=$(e.currentTarget).attr("qpParentMetadataIdentifier"),localStorage.setItem("qpParentMetadataIdentifier",r)),"true"===localStorage.getItem("eulaValidationCheck")){if($("[rel=popover]").popover("hide"),map.overlay.fadeOut(200),e)var n=e.currentTarget.attributes;return $("#eula-validation-modal").modal("show"),$(n).each(function(){var e=this.name,t=this.value;$("#btn-eula-accept").attr(e,t)}),$(".eula-text-container").load("endUserLisenceAggrement.html"),void $("#eula-validation-modal button").removeAttr("id","class").removeAttr("style").attr({id:"btn-eula-accept",class:"btn btn-default popover-common-btn ereader-btn-custom-gradient",onClick:"saveEulaValidationStatus(event,true)"})}$("#video").attr("subTopictagId",$(".userClassNameStyles").attr("subTopictagId"));document.getElementById("video");insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,closeOverlayInMobile("pp-nav-menu-mobile"),$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open"),map.wk_conatiner.load("practicePerfectLandingPage.html?v6",function(){getPPTopicsBySATagId(t);var e=localStorage.getItem("ppProductTitle");localStorage.setItem("ppProductId",t),$(".ereader-main-header-title").html("PracticePerfect<sup class='pp-mainHeaderTM'>TM</sup> "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").show(),$("#copyrestricted").hide(),$(".searchInput").val(""),getFeaturedVideo(),getRecentlyWatchedVideo()})}function vidChange(){"interactive"==$("#ppVideoFormat").val()?localStorage.getItem("interactiveVideoPath")?$("#videoPlayed iframe").attr("src",localStorage.getItem("interactiveVideoPath")):alertMessageContent("It doesnt have a interactive video"):localStorage.getItem("continuousVideoPath")?$("#videoPlayed iframe").attr("src",localStorage.getItem("continuousVideoPath")):alertMessageContent("It doesnt have a continuous video")}function searchPP(e){var t=!1,a=localStorage.getItem("ppProductId"),o=(JSON.parse(localStorage.getItem("ppProductVo")),localStorage.getItem("schoolId"),$(".searchInput").val().trim());if(e?(13!=e.keyCode&&"touchstart"!==e.type&&"click"!==e.type||(t=!0),localStorage.setItem("ppSearch",o)):t=!0,t)if(-1===stopWords.indexOf(o)){$(".no-search").remove(),$("#page-loading-spinner").show();var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_SEARCH_RESULTS_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId"),ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),lastSearchKeyword:o},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppProductVO:{searchKeyword:o,productId:a}};$.ajax({url:properties[properties.env]+"/managePP/searchPPVideos",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(s)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,$("#ppLanding-top").hide(),$(".allVideosText").html("Search Results"),e.ppTopicVOList){var t=e.ppTopicVOList;"object"==$.type(t)&&(t=[t]);for(var a=0;a<t.length;a++)"object"==$.type(t[a].ppSubTopicVOList)&&(t[a].ppSubTopicVOList=[t[a].ppSubTopicVOList]);$("#subVideoSection").show(),$("#btnContainer").show();var o=Handlebars.getTemplate("pp-video-resluts")(e);$("#subVideoSection").html(o),$(".grid-view").css("border-bottom","1px solid #007AC3"),$(".list-view").css("border-bottom",""),$(".videosGroupContainer").show()}else $(".videosGroupContainer").show(),$("#subVideoSection").hide(),$("#btnContainer").hide(),$(".vidSectionContainer").after('<div class="no-search col-lg-12 col-md-12 col-xs-12 no-padding"><div class="error-msg pp-secSub-name col-lg-12 col-md-12 col-xs-12 no-padding">There are no videos that match your search.</div><a href="#/" onclick="ppLandingpage()">Back to Video Library</a><div class="display-inline-block col-lg-12 col-md-12 col-xs-12 no-padding pp-borderLine"></div></div>');$("#page-loading-spinner").hide(),$(window).trigger("resize")}else $("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.systemError)})}else alertMessagesModal(exceptionMsg.enterValidSearch)}function getAllVideoTracker(e){var t=localStorage.getItem("ppProductId"),a=$("#ppVideoFormat").val();JSON.parse(localStorage.getItem("ppProductVo")),localStorage.getItem("schoolId");$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_LANDING_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId"),ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppSubTopicTagId:e},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppSubTopicVO:{subTopictagId:e,modeType:a},ppProductVO:{productId:t}};$.ajax({url:properties[properties.env]+"/managePP/getPPVideoTracker",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"==e.status){var t,a,o,s;if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppSubTopicVO)e.ppSubTopicVO.continuousVideoPath?(o=e.ppSubTopicVO.continuousVideoPath,localStorage.setItem("continuousVideoPath",o)):o=null,e.ppSubTopicVO.interactiveVideoPath?(s=e.ppSubTopicVO.interactiveVideoPath,localStorage.setItem("interactiveVideoPath",s)):s=null,t=e.ppSubTopicVO.subTopictagId,a=e.ppSubTopicVO.totalQuestions?e.ppSubTopicVO.totalQuestions:void 0,map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var i=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect<sup class='pp-mainHeaderTM'>TM</sup> "+i),$(".pp-holder-name .subjectAreaName").html(i),$("#pp-video-search-sec").hide(),$("#copyrestricted").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("pp-videoPage.html?v26",function(){e.ppSubTopicVO.modeType?"interactive"==e.ppSubTopicVO.modeType?null==s||null==s?($("#videoPlayed iframe").attr("src",o),$("#ppVideoFormat").val("continuous"),$("#ppVideoFormat option")[0].style.display="none",$("#ppVideoFormat option[value='interactive']").remove()):($("#videoPlayed iframe").attr("src",s),$("#ppVideoFormat").val("interactive")):($("#videoPlayed iframe").attr("src",o),$("#ppVideoFormat").val("continuous"),null!=s&&null!=s||($("#ppVideoFormat option")[0].style.display="none",$("#ppVideoFormat option[value='interactive']").remove())):s?($("#videoPlayed iframe").attr("src",s),$("#ppVideoFormat").val("interactive")):($("#videoPlayed iframe").attr("src",o),$("#ppVideoFormat").val("continuous"),$("#ppVideoFormat option")[0].style.display="none",$("#ppVideoFormat option[value='interactive']").remove()),e.ppSubTopicVO.customerFacingSubTopicName&&($(".userClassNameStyles").html(e.ppSubTopicVO.customerFacingSubTopicName),$(".userClassNameStyles").attr("subTopictagId",e.ppSubTopicVO.subTopictagId)),a?($("#practiceMode").attr("onclick",'createidentifierforPPQuiz("video",false,"'+t+'","'+a+'")'),$("#gradedMode").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t+'","'+a+'")')):$(".vidSecContiner").html('<div class="display-inline-block col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding"><div class="display-inline-block no-quiz">There is no quiz for this video.</div></div>'),$(".practiceResultLink").hide(),$(".gradedResultLink").hide();var i=localStorage.getItem("ppProductTitle");if($(".ereader-main-header-title").html("PracticePerfect<sup class='pp-mainHeaderTM'>TM</sup> "+i),$("#pp-container-hide").show(),$(".no-search").remove(),e.ppQuizResultVOList){"object"==$.type(e.ppQuizResultVOList)&&(e.ppQuizResultVOList=[e.ppQuizResultVOList]);for(var r=0;r<e.ppQuizResultVOList.length;r++)"true"==e.ppQuizResultVOList[r].isGraded?"true"==e.ppQuizResultVOList[r].isCompleted?($(".gradedResultLink").show(),$(".gradedResultLink").attr("instanceid",e.ppQuizResultVOList[r].instanceId),$(".gradedResultLink").attr("onclick","getResultSummaryByInstanceId(event,'video')"),$("#gradedMode").attr("evtClick",'createInstanceforPPQuiz("'+e.ppQuizResultVOList[r].quizIdentifier+'","video",true,"'+t+'","'+a+'",300)'),$("#gradedMode").attr("onclick","retakeQuizFun(event)"),$("#gradedMode").html("Retake Graded Mode"),$("#gradedMode").addClass("pp-quizAttemptBtn"),$("#gradedMode").parent().addClass("pp-quizAttemptBtn")):($(".gradedResultLink").hide(),e.ppQuizResultVOList[r].instanceURL?($("#gradedMode").html("Continue Graded Mode"),$("#gradedMode").addClass("pp-quizAttemptBtn"),$("#gradedMode").parent().addClass("pp-quizAttemptBtn"),$("#gradedMode").attr("onclick",'showQuizFrame("'+e.ppQuizResultVOList[r].instanceURL+'","pp","video","'+t+'",event)'),$("#gradedMode").attr("instanceId",e.ppQuizResultVOList[r].instanceId)):($("#gradedMode").html("Graded Mode"),$("#gradedMode").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t+'","'+a+'")'))):"true"==e.ppQuizResultVOList[r].isCompleted?($(".practiceResultLink").show(),$(".practiceResultLink").attr("instanceid",e.ppQuizResultVOList[r].instanceId),$(".practiceResultLink").attr("onclick","getResultSummaryByInstanceId(event,'video')"),$("#practiceMode").attr("evtClick",'createInstanceforPPQuiz("'+e.ppQuizResultVOList[r].quizIdentifier+'","video",false,"'+t+'","'+a+'",300)'),$("#practiceMode").attr("onclick","retakeQuizFun(event)"),$("#practiceMode").html("Retake Practice Mode"),$("#practiceMode").addClass("pp-quizAttemptBtn"),$("#practiceMode").parent().addClass("pp-quizAttemptBtn")):($(".practiceResultLink").hide(),e.ppQuizResultVOList[r].instanceURL?($("#practiceMode").html("Continue Practice Mode"),$("#practiceMode").addClass("pp-quizAttemptBtn"),$("#practiceMode").parent().addClass("pp-quizAttemptBtn"),$("#practiceMode").attr("onclick",'showQuizFrame("'+e.ppQuizResultVOList[r].instanceURL+'","pp","video","'+t+'",event)'),$("#practiceMode").attr("instanceId",e.ppQuizResultVOList[r].instanceId)):($("#practiceMode").html("Practice Mode"),$("#practiceMode").attr("onclick",'createidentifierforPPQuiz("video",false,"'+t+'","'+a+'")')))}e.ppSubTopicVO.continuousTimeSpent?localStorage.setItem("resumePlayContinuous",e.ppSubTopicVO.continuousTimeSpent):localStorage.setItem("resumePlayContinuous",0),e.ppSubTopicVO.interactiveTimeSpent?localStorage.setItem("resumePlayInteractive",e.ppSubTopicVO.interactiveTimeSpent):localStorage.setItem("resumePlayInteractive",0),$(window).trigger("resize")})});$("#page-loading-spinner").hide(),$(window).trigger("resize")}else $("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.systemError)})}function checkList(e,t,a){if(0==e)return!0;var o=$("#ppVideoFormat").val(),s=e/t*100;if(0!==parseInt(s)){var i=localStorage.getItem("schoolId"),r=(JSON.parse(localStorage.getItem("ppProductVo")),{userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"Bookshelf",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:i,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppSubTopicVO:{subTopictagId:a,timeSpent:e,modeType:o,completionProgress:parseInt(s)}});$.ajax({url:properties[properties.env]+"/managePP/updatePPVideoTimeTracker",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(r)}).then(function(e){"true"==e.status&&(localStorage.setItem("latestSubTopicID",a),localStorage.setItem("percentileVal",parseInt(s)),$(".redbar-"+a+" .vidProgressCalc span").css("width",parseInt(s)+"%"),$(".redbar-"+a+" .vidProgCalc-list").css("stroke-dasharray",parseInt(s)+",999"))},function(e){})}}function progressbarLoading(e){closeOverlayInMobile("pp-nav-menu-mobile"),$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open");var t=localStorage.getItem("firstName");$("#video").hide(),$("#video").attr("subTopictagId",$(".userClassNameStyles").attr("subTopictagId")),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v15",function(){$(".userClassNameStyles").html(t+"'s progress"),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show(),e?"videoQuiz"==e?getVideoQuizProgress():getQuizCenterProgress():getTopicsForConfidencePage()})}function updateExpandBtn(e){$(e);"Expand"==$(e).html()?$(e).html("Collapse"):$(e).html("Expand")}function expandAllPPProgress(e){e?($(".progress-bar-container.collapse").addClass("in"),$(".progress-bar-container.collapse").css("height","auto"),$(".pp-progresbar-expandBtn").html("Collapse")):($(".progress-bar-container.collapse").removeClass("in"),$(".progress-bar-container.collapse").css("height","0px"),$(".pp-progresbar-expandBtn").html("Expand"))}function expandAllPPresSum(e){e?($(".answersFieldSection.collapse").addClass("in"),$(".answersFieldSection.collapse").css("height","auto"),$(".ppQuizAttemptedQuestion").html("Collapse")):($(".answersFieldSection.collapse").removeClass("in"),$(".answersFieldSection.collapse").css("height","0px"),$(".ppQuizAttemptedQuestion").html("Expand"))}function getprogressbarTemplate(){var e=$("#ppVideoFormat").val();"1"==e?getTopicsForConfidencePage():"2"==e?getQuizCenterProgress():getVideoQuizProgress()}function getTopicsForConfidencePage(){var e=localStorage.getItem("schoolId"),t=localStorage.getItem("ppProductId");JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_CONFIDENCE_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppProductVO:{productId:t}};$.ajax({url:properties[properties.env]+"/managePP/getTopicsForConfidencePage",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppTopicVOList){"object"==$.type(e.ppTopicVOList)&&(e.ppTopicVOList=[e.ppTopicVOList]);for(var t=0;t<e.ppTopicVOList.length;t++)e.ppTopicVOList[t].ppSubTopicVOList&&"object"==$.type(e.ppTopicVOList[t].ppSubTopicVOList)&&(e.ppTopicVOList[t].ppSubTopicVOList=[e.ppTopicVOList[t].ppSubTopicVOList]);var a=Handlebars.getTemplate("confidenceDashboard")(e);$("#practicePerfect-progressContainer").html(a);var o=localStorage.getItem("firstName");$(".userClassNameStyles").html(o+"'s progress");var s=localStorage.getItem("ppProductTitle");$(".pp-confidenceLevelTitle .subjectAreaName").html(s),$("#view-more-parent").hide(),$("#copyrestricted").hide(),$("#ppVideoFormat").val(1),getConfidenceLevel(),lateScore(),$("#page-loading-spinner").hide()}else{a=Handlebars.getTemplate("confidenceDashboard")(e);$("#practicePerfect-progressContainer").html(a);o=localStorage.getItem("firstName");$(".userClassNameStyles").html(o+"'s progress");s=localStorage.getItem("ppProductTitle");$(".pp-confidenceLevelTitle .subjectAreaName").html(s),getConfidenceLevel()}$(window).trigger("resize")}$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getConfidenceLevel(){var e=localStorage.getItem("schoolId");JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_CONFIDENCE_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")};$.ajax({url:properties[properties.env]+"/managePP/getConfidenceLevel",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(e){if("true"==e.status)if(e.ppConfidenceLevel){var t=142-142*Math.round(e.ppConfidenceLevel)/100;$(".confidenceChartProgress").css("stroke-dashoffset",t),$(".confidenceProgressPerc span").html(e.ppConfidenceLevel+"%"),$("#page-loading-spinner").hide()}else $(".confidenceChartProgress").css("stroke-dashoffset",142),$(".confidenceProgressPerc span").html("0%");$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getQuizCenterProgress(e){var t=localStorage.getItem("ppProductId");$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open");var a=localStorage.getItem("schoolId");JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_QUIZ_CENTER_PROGRESS_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:a,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppQuizResultVO:{perPage:5,page:e},ppProductVO:{productId:t}};o.ppQuizResultVO.page=null!=e&&null!=e?e:"1",$.ajax({url:properties[properties.env]+"/managePP/getQuizCenterProgress",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(t){if("true"==t.status)if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,t.ppQuizResultVOList){"object"==$.type(t.ppQuizResultVOList)&&(t.ppQuizResultVOList=[t.ppQuizResultVOList]);for(var a=0;a<t.ppQuizResultVOList.length;a++)t.ppQuizResultVOList[a].ppSubTopicVOList&&"object"==$.type(t.ppQuizResultVOList[a].ppSubTopicVOList)&&(t.ppQuizResultVOList[a].ppSubTopicVOList=[t.ppQuizResultVOList[a].ppSubTopicVOList]);var o=Handlebars.getTemplate("quizCenterProgress")(t);if(null!=e&&null!=e)$("#practicePerfect-progressContainer").append(o);else{$("#practicePerfect-progressContainer").html(o),$("#hide-page-concept").html('<div class=" col-xs-8 col-md-8 col-sm-8 col-lg-8 no-padding practice-perfect-message-group"><div class="practice-perfect-message">Your progress on all quizzes built in the Quiz Center</div><div class=" col-xs-8 col-md-8 col-sm-8 col-lg-8 no-padding practice-perfect-message-group"></div></div><div class=" col-xs-4 col-md-4 col-sm-4 col-lg-4 no-padding pp-expandCollapseGroup pull-right"><a href="#/" onclick="expandAllPPProgress(true)"><span class="pp-expandAll" >Expand All</span></a> <span class="pp-pipeLine">|</span> <a href="#/" onclick="expandAllPPProgress(false)"><span class="pp-collapseAll">Collapse All</span></a></div>')}var s=localStorage.getItem("firstName");$(".userClassNameStyles").html(s+"'s progress"),$("#copyrestricted").hide(),$("#ppVideoFormat").val(2),$("#page-loading-spinner").hide(),parseInt(t.totalPages)>1?(null!=e&&null!=e||(e="1"),parseInt(e)<parseInt(t.totalPages)?($("#view-more-parent").show(),$("#view-more-parent button").attr("onclick","getQuizCenterProgress("+(parseInt(e)+1)+")")):$("#view-more-parent").hide()):$("#view-more-parent").hide(),$(window).trigger("resize")}else{s=localStorage.getItem("firstName");$(".userClassNameStyles").html(s+"'s progress"),$("#practicePerfect-progressContainer").html('You havent built any quizzes. Visit the <a href="#/" onclick="quizPage()">Quiz Center</a> to get started.'),$("#view-more-parent").hide(),$(".container-left-desktop-fix-pp").css("overflow","unset"),$("#ppVideoFormat").val(2),$(window).trigger("resize")}$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getVideoQuizProgress(e){$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open");JSON.parse(localStorage.getItem("ppProductVo"));var t=localStorage.getItem("schoolId");$("#page-loading-spinner").show();var a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_QUIZ_PROGRESS_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",lastReadPageNum:"",themisSubjectAreaId:"",themisProductId:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:t,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")};$.ajax({url:properties[properties.env]+"/managePP/getVideoQuizProgress",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(a)}).then(function(e){"true"===e.status&&(e.ppQuizResultVOList?("object"==$.type(e.ppQuizResultVOList)&&(e.ppQuizResultVOList=[e.ppQuizResultVOList]),map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var t=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect<sup class='pp-mainHeaderTM'>TM</sup> "+t),$(".pp-holder-name .subjectAreaName").html(t),$("#pp-video-search-sec").hide(),$("#copyrestricted").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v15",function(){var t=localStorage.getItem("firstName");$(".userClassNameStyles").html(t+"'s progress");var a=Handlebars.getTemplate("videoQuizProgress")(e);$("#practicePerfect-progressContainer").html(a),$("#view-more-parent").hide(),$("#ppVideoFormat").val(3),$(window).trigger("resize")})}),$("#page-loading-spinner").hide()):map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect<sup>TM</sup> for "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){var e=localStorage.getItem("firstName");$(".userClassNameStyles").html(e+"'s progress"),$("#practicePerfect-progressContainer").html("There is no progress to see in your Video Quiz Progress"),$("#ppVideoFormat").val(3)})})),$(window).trigger("resize"),$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function lateScore(){for(var e=$(".late-score"),t=0;t<e.length;t++){var a=$(e[t]).attr("data-parent");$("#"+a).removeClass("confi-progressBar").addClass("gradient-progressBar")}}function getFeaturedVideo(e){var t=localStorage.getItem("ppProductId"),a=localStorage.getItem("schoolId");JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:a,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppProductVO:{productId:t}};$.ajax({url:properties[properties.env]+"/managePP/getFeaturedVideo",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppSubTopicVO){var t=e.ppSubTopicVO;$("#featuredVideo").addClass("redbar-"+t.subTopictagId),$("#featuredVideo").attr("onclick","getAllVideoTracker('"+t.subTopictagId+"')"),$(".featuredVideoGroup .featured-video-title").html(t.customerFacingSubTopicName),$(".featuredVideoGroup .featured-video-title").attr("onclick","getAllVideoTracker('"+t.subTopictagId+"')"),$(".featuredVideoGroup #featuredVideo img.hidden-xs").attr("src",t.continuousPreviewPath),$(".featuredVideoGroup #featuredVideo img.visible-xs").attr("src",t.continuousThumbnailPath),(e.ppSubTopicVO.totalQuestions?e.ppSubTopicVO.totalQuestions:void 0)&&(t.instanceId?t.incompleteQuizInstanceURL?($(".featuredVideoGroup .take-review-quiz").html("<span id='retakeQuiz'>Continue Quiz</span>"),$(".featuredVideoGroup .take-review-quiz #retakeQuiz").attr("onclick",'showQuizFrame("'+t.incompleteQuizInstanceURL+'","pp","video","'+t.subTopictagId+'",event)'),$(".featuredVideoGroup .take-review-quiz #retakeQuiz").attr("instanceId",t.incompleteQuizInstanceId)):($(".featuredVideoGroup .take-review-quiz").html("<span id='reviewQuiz'>Review Quiz</span> | <span id='retakeQuiz'>Retake Quiz</span>"),$(".featuredVideoGroup .take-review-quiz #retakeQuiz").attr("evtClick","createInstanceforPPQuiz('"+t.gradedQuizIdentifier+"','video',true,'"+t.subTopictagId+"',15,300)"),$(".featuredVideoGroup .take-review-quiz #retakeQuiz").attr("onclick","retakeQuizFun(event)"),$(".featuredVideoGroup .take-review-quiz #reviewQuiz").attr("instanceid",t.instanceId),$(".featuredVideoGroup .take-review-quiz #reviewQuiz").attr("onclick","getResultSummaryByInstanceId(event,'video')")):t.incompleteQuizInstanceURL?($(".featuredVideoGroup .take-review-quiz").html("<span id='takeQuiz'>Continue Quiz</span>"),$(".featuredVideoGroup .take-review-quiz #takeQuiz").attr("onclick",'showQuizFrame("'+t.incompleteQuizInstanceURL+'","pp","video","'+t.subTopictagId+'",event)'),$(".featuredVideoGroup .take-review-quiz #takeQuiz").attr("instanceId",t.incompleteQuizInstanceId)):($(".featuredVideoGroup .take-review-quiz").html("<span id='takeQuiz'>Take Quiz</span>"),$(".featuredVideoGroup .take-review-quiz #takeQuiz").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t.subTopictagId+'","'+t.totalQuestions+'")'))),t.videoCompletionProgress?$("#featuredVideo .video-progressBar span").css("width",t.videoCompletionProgress+"%"):$("#featuredVideo .video-progressBar span").css("width","0%")}$("#page-loading-spinner").hide(),$(window).trigger("resize")}else $("#page-loading-spinner").hide(),$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(exceptionMsg.systemError)})}function getRecentlyWatchedVideo(){var e=localStorage.getItem("ppProductId"),t=localStorage.getItem("schoolId"),a=(JSON.parse(localStorage.getItem("ppProductVo")),{userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:t,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppProductVO:{productId:e}});$.ajax({url:properties[properties.env]+"/managePP/getRecentlyWatchedVideo",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if($(".errormsg-empty").remove(),"true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppSubTopicVOList){var t=e.ppSubTopicVOList;"object"==$.type(t)&&(t=[t]),t.length>0&&(t[0]?($(".recentWatched1").show(),$(".recentWatched1").addClass("redbar-"+t[0].subTopictagId),$(".recentWatched1 .video-title").html(t[0].customerFacingSubTopicName),$(".recentWatched1 .video-title").attr("onclick","getAllVideoTracker('"+t[0].subTopictagId+"')"),$(".recentWatched1 img").attr("src",t[0].continuousThumbnailPath),$(".recentWatched1 .recently-watched").attr("onclick","getAllVideoTracker('"+t[0].subTopictagId+"')"),t[0].totalQuestions&&(t[0].instanceId?t[0].incompleteQuizInstanceURL?($(".recentWatched1 .take-review-quiz").html("<span id='retakeQuiz'>Continue Quiz</span>"),$(".recentWatched1 .take-review-quiz #retakeQuiz").attr("onclick",'showQuizFrame("'+t[0].incompleteQuizInstanceURL+'","pp","video","'+t[0].subTopictagId+'",event)'),$(".recentWatched1 .take-review-quiz #retakeQuiz").attr("instanceId",t[0].incompleteQuizInstanceId)):($(".recentWatched1 .take-review-quiz").html("<span id='reviewQuiz'>Review Quiz</span> | <span id='retakeQuiz'>Retake Quiz</span>"),$(".recentWatched1 .take-review-quiz #retakeQuiz").attr("evtClick","createInstanceforPPQuiz('"+t[0].gradedQuizIdentifier+"','video',true,'"+t[0].subTopictagId+"','"+t[0].totalQuestions+"',300)"),$(".recentWatched1 .take-review-quiz #retakeQuiz").attr("onclick","retakeQuizFun(event)"),$(".recentWatched1 .take-review-quiz #reviewQuiz").attr("instanceid",t[0].instanceId),$(".recentWatched1 .take-review-quiz #reviewQuiz").attr("onclick","getResultSummaryByInstanceId(event,'video')")):t[0].incompleteQuizInstanceURL?($(".recentWatched1 .take-review-quiz").html("<span id='takeQuiz'>Continue Quiz</span>"),$(".recentWatched1 .take-review-quiz #takeQuiz").attr("onclick",'showQuizFrame("'+t[0].incompleteQuizInstanceURL+'","pp","video","'+t[0].subTopictagId+'",event)'),$(".recentWatched1 .take-review-quiz #takeQuiz").attr("instanceId",t[0].incompleteQuizInstanceId)):($(".recentWatched1 .take-review-quiz").html("<span id='takeQuiz'>Take Quiz</span>"),$(".recentWatched1 .take-review-quiz #takeQuiz").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t[0].subTopictagId+'","'+t[0].totalQuestions+'")'))),t[0].videoCompletionProgress?$(".recentWatched1 .recentlyWatchedVideo-progressBar span").css("width",t[0].videoCompletionProgress+"%"):$(".recentWatched1 .recentlyWatchedVideo-progressBar span").css("width","0%")):$(".recentWatched1").hide(),t[1]?($(".recentWatched2").show(),$(".recentWatched2").addClass("redbar-"+t[1].subTopictagId),$(".recentWatched2 .video-title").html(t[1].customerFacingSubTopicName),$(".recentWatched2 .video-title").attr("onclick","getAllVideoTracker('"+t[1].subTopictagId+"')"),$(".recentWatched2 img").attr("src",t[1].continuousThumbnailPath),$(".recentWatched2 .recently-watched").attr("onclick","getAllVideoTracker('"+t[1].subTopictagId+"')"),t[1].totalQuestions&&(t[1].instanceId?t[1].incompleteQuizInstanceURL?($(".recentWatched2 .take-review-quiz").html("<span id='retakeQuiz'>Continue Quiz</span>"),$(".recentWatched2 .take-review-quiz #retakeQuiz").attr("onclick",'showQuizFrame("'+t[1].incompleteQuizInstanceURL+'","pp","video","'+t[1].subTopictagId+'",event)'),$(".recentWatched2 .take-review-quiz #retakeQuiz").attr("instanceId",t[1].incompleteQuizInstanceId)):($(".recentWatched2 .take-review-quiz").html("<span id='reviewQuiz'>Review Quiz</span> | <span id='retakeQuiz'>Retake Quiz</span>"),$(".recentWatched2 .take-review-quiz #retakeQuiz").attr("evtClick","createInstanceforPPQuiz('"+t[1].gradedQuizIdentifier+"','video',true,'"+t[1].subTopictagId+"','"+t[1].totalQuestions+"',300)"),$(".recentWatched2 .take-review-quiz #retakeQuiz").attr("onclick","retakeQuizFun(event)"),$(".recentWatched2 .take-review-quiz #reviewQuiz").attr("instanceid",t[1].instanceId),$(".recentWatched2 .take-review-quiz #reviewQuiz").attr("onclick","getResultSummaryByInstanceId(event,'video')")):t[1].incompleteQuizInstanceURL?($(".recentWatched2 .take-review-quiz").html("<span id='takeQuiz'>Continue Quiz</span>"),$(".recentWatched2 .take-review-quiz #takeQuiz").attr("onclick",'showQuizFrame("'+t[1].incompleteQuizInstanceURL+'","pp","video","'+t[1].subTopictagId+'",event)'),$(".recentWatched2 .take-review-quiz #takeQuiz").attr("instanceId",t[1].incompleteQuizInstanceId)):($(".recentWatched2 .take-review-quiz").html("<span id='takeQuiz'>Take Quiz</span>"),$(".recentWatched2 .take-review-quiz #takeQuiz").attr("onclick",'createidentifierforPPQuiz("video",true,"'+t[1].subTopictagId+'","'+t[1].totalQuestions+'")'))),t[1].videoCompletionProgress?$(".recentWatched2 .recentlyWatchedVideo-progressBar span").css("width",t[1].videoCompletionProgress+"%"):$(".recentWatched2 .recentlyWatchedVideo-progressBar span").css("width","0%")):$(".recentWatched2").hide()),$("#recenthide").show()}else $("#recenthide").show(),$(".recentWatched2").hide(),$(".recentWatched1").hide(),$(".recently-watched-section").append("<div class='errormsg-empty display-inline-block col-lg-12 col-md-12 col-sm-4 col-xs-6' style='margin-top: 21px'>You havent watched any videos yet.</div>");$("#page-loading-spinner").hide()}else $("#recenthide").hide(),$("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getPPTopicsBySATagId(e){var t=localStorage.getItem("schoolId");JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:t,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppProductVO:{productId:e}};$.ajax({url:properties[properties.env]+"/managePP/getPPTopicsBySATagId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(t){if("true"==t.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,t.ppTopicVOList){var a=t.ppTopicVOList;"object"==$.type(a)&&(a=[a]),localStorage.setItem("ppTopicVOList",JSON.stringify(a));for(var o=0;o<a.length;o++)"object"==$.type(a[o].ppSubTopicVOList)&&(a[o].ppSubTopicVOList=[a[o].ppSubTopicVOList]);var s=Handlebars.getTemplate("pp-video-resluts")(t);$("#subVideoSection").html(s);var i=localStorage.getItem("latestSubTopicID"),r=localStorage.getItem("percentileVal");null!=i&&null!=i&&null!=r&&null!=r&&($(".redbar-"+i+" .vidProgressCalc span").css("width",r+"%"),$(".redbar-"+i+" .vidProgCalc-list").css("stroke-dasharray",r+",999"),localStorage.removeItem("latestSubTopicID"),localStorage.removeItem("percentileVal")),$(".grid-view").css("border-bottom","1px solid #007AC3"),$(".list-view").css("border-bottom",""),$(".videosGroupContainer").show()}else $(".videosGroupContainer").hide(),localStorage.removeItem("ppTopicVOList");selectViewDet(t.ppProductVO.videoLayout),$(".allVideosText").attr("productId",e),$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function updateVideoLayoutSettings(e){var t=localStorage.getItem("ppProductId"),a=localStorage.getItem("schoolId");JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_VIDEO_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:a,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppProductVO:{productId:t,videoLayout:e}};$.ajax({url:properties[properties.env]+"/managePP/updateVideoLayoutSettings",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){"true"==e.status&&(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,$("#page-loading-spinner").hide()),$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function selectViewDet(e){"thumbnail_view"==e?($(".grid-view").css("border-bottom","1px solid #007AC3"),$(".list-view").css("border-bottom",""),$(".thumbnail-View").css("display","block"),$(".pp-list-view").css("display","none")):($(".list-view").css("border-bottom","1px solid #007AC3"),$(".grid-view").css("border-bottom",""),$(".thumbnail-View").css("display","none"),$(".pp-list-view").css("display","block")),updateVideoLayoutSettings(e),$(window).trigger("resize")}function getResultSummaryByInstanceId(e,t){if("true"===t)var a=e;else{$(e.currentTarget).attr("quizType"),$(e.currentTarget).attr("topicName"),$(e.currentTarget).html(),a=$(e.currentTarget).attr("instanceId");localStorage.setItem("instanceId",a)}var o=localStorage.getItem("schoolId");JSON.parse(localStorage.getItem("ppProductVo"));$("#resultLoadingModal").modal("show");var s={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",lastReadPageNum:"",themisSubjectAreaId:"",themisProductId:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:o,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),instanceId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppQuizResultVO:{instanceId:a}};$.ajax({url:properties[properties.env]+"/managePP/getResultSummaryByInstanceId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(s)}).then(function(e){if("true"===e.status){if(e.ppQuizResultVO)if("true"==e.ppQuizResultVO.isCompleted){var a=e.ppQuizResultVO;"object"==$.type(a)&&(a=[a]);for(var o=0;o<a.length;o++)a[o].QPQuestionVOList&&"object"==$.type(a[o].QPQuestionVOList)&&(a[o].QPQuestionVOList=[a[o].QPQuestionVOList]);if(null===a[0].QPQuestionVOList||void 0===a[0].QPQuestionVOList)setTimeout(function(){getResultSummaryByInstanceId(localStorage.getItem("instanceId"),"true")},1e4);else if(null!==a[0].QPQuestionVOList&&void 0!==a[0].QPQuestionVOList){var s=parseInt(a[0].totalQuestions);if(s!==(questionsList=a[0].QPQuestionVOList.length)){var i=questionsList/s*100;current_progress=Math.round(i),$("#ProgressPP").animate({width:current_progress+"%"},1e4),setTimeout(function(){getResultSummaryByInstanceId(localStorage.getItem("instanceId"),"true")},1e4)}else{var r=100-current_progress;$("#ProgressPP").animate({width:"+="+r+"%"},100,function(){$("#resultLoadingModal").modal("hide"),$("#ProgressPP").animate({width:"0%"}),current_progress=0,questionsList=0,$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v14",function(){var o=Handlebars.getTemplate("progress-dashboardpage")(a);$("#practicePerfect-progressContainer").html(o),$("#view-more-parent").hide(),$("#copyrestricted").show(),$("#practicePerfect-progressContainer").show(),$("#child-progress-container").hide();for(var s=0;s<a[0].QPQuestionVOList.length;s++){var i=a[0].QPQuestionVOList[s].questionIdentifier,r=a[0].QPQuestionVOList[s].correct;if(a[0].QPQuestionVOList[s].choiceIndex&&"false"===r){var n=parseInt(a[0].QPQuestionVOList[s].choiceIndex)-1,l=a[0].QPQuestionVOList[s].choiceVOList[n].choiceId;$("#question"+i+" #"+l).removeClass("result-block").addClass("result-blockRemove");var d=$("#question"+i+" #"+l).html();$("#question"+i+" #"+l).html('<span class=" ppTickposition glyphicon glyphicon-remove"></span>'+d),$("#question"+i+" #"+l+" .ppindex").addClass("ppglyp")}}if("video"==t?($(".backToVideoBtn").attr("onclick","getAllVideoTracker('"+a[0].ppSubTopicVO.subTopictagId+"')"),$(".backToVideoBtn").html("Back to Video"),$(".retakeBtnGroup").show(),$(".backRetakeGroup").css("float","left"),$(".yesRetakeBtn").attr("onclick","createInstanceforPPQuiz('"+a[0].quizIdentifier+"','video',true,'"+a[0].ppSubTopicVO.subTopictagId+"','"+a[0].ppSubTopicVO.totalQuestions+"',300)"),$(".retakeBtnGroup").show()):($(".backToVideoBtn").attr("onclick","quizPage()"),$(".backToVideoBtn").html("Back to Quiz Center"),$(".retakeBtnGroup").hide(),$(".backRetakeGroup").css("float","right")),e.ppVideoQuizResultVOList){"object"==$.type(e.ppVideoQuizResultVOList)&&(e.ppVideoQuizResultVOList=[e.ppVideoQuizResultVOList]);var c=$(".retakeBtnGroup button").attr("subtopictagid"),p=$(".retakeBtnGroup button").attr("totalquestions");for(s=0;s<e.ppVideoQuizResultVOList.length;s++)"true"==e.ppVideoQuizResultVOList[s].isGraded?"true"==e.ppVideoQuizResultVOList[s].isCompleted?($(".retakeBtnGroup button").html("Retake Graded Quiz"),$(".retakeBtnGroup button").attr("evtClick","createInstanceforPPQuiz('"+e.ppVideoQuizResultVOList[s].quizIdentifier+"','video',true,'"+c+"',"+p+",300)"),$(".retakeBtnGroup button").attr("onclick","retakeQuizFun(event)")):e.ppVideoQuizResultVOList[s].instanceURL?($(".retakeBtnGroup button").html("Continue Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","showQuizFrame('"+e.ppVideoQuizResultVOList[s].instanceURL+"','pp','video','"+c+"',event)"),$(".retakeBtnGroup button").attr("instanceId",e.ppVideoQuizResultVOList[s].instanceId)):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+c+"',"+p+")")):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+c+"',"+p+")"))}})})}}}else $("#resultLoadingModal").modal("hide")}else $("#resultLoadingModal").modal("hide");$(window).trigger("resize")},function(e){$("#resultLoadingModal").modal("hide"),alertMessagesModal(e.responseJSON.errorMessg)})}var aoiTopicVoList="";function quizPage(){closeOverlayInMobile("pp-nav-menu-mobile"),$(".modal-backdrop").remove(),$(".main-body").removeClass("modal-open"),$("#video").hide(),$("#video").attr("subTopictagId",$(".userClassNameStyles").attr("subTopictagId")),map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect<sup class='pp-mainHeaderTM'>TM</sup> "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$("#copyrestricted").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("area-of-improvement.html?v17",function(){getAreaOfImprovementTagId(),getAllSummativeQuizzes(),getActiveQuizzes(),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show()})})}function checkParent(e){for(var t=$(e.currentTarget).attr("parentId"),a=$("."+t+"-subtopic"),o=0,s=0;s<a.length;s++)a[s].checked&&o++;o==a.length?$("#"+t).prop("checked",!0):$("#"+t).prop("checked",!1),calcMaxQues()}function selectAllSubTopic(e){e.currentTarget.checked?$("."+e.currentTarget.id+"-subtopic").prop("checked",!0):$("."+e.currentTarget.id+"-subtopic").prop("checked",!1),calcMaxQues()}function selectAllTopics(e){$("#practicePerfect-buildYourOwnQuizContainer input:checkbox").prop("checked",e),calcMaxQues()}function calcMaxQues(){for(var e=$(".subTopTagId:checked"),t=0,a=0;a<e.length;a++)t+=parseInt($(e[a]).attr("totqu"));t<60?($("#maxQues").html(t),$("#maxQues-parent").show()):0==t?$("#maxQues-parent").hide():($("#maxQues").html("60"),$("#maxQues-parent").show())}function loadTopicsVOlist(){JSON.parse(localStorage.getItem("ppProductVo"));var e={lastActivityCode:"PP_BUILD_YOUR_OWN_QUIZ_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId"),ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")};Utility.saveLastActivity(e);var t={ppTopicVOList:JSON.parse(localStorage.getItem("ppTopicVOList"))};$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizTopics").hide(),$("#selectedQuizName").html("Build Your Own Quiz");var e=Handlebars.getTemplate("build-your-ownQuiz")(t);$("#practicePerfect-buildYourOwnQuizContainer").html(e),$(".hidden-quizzes-progress").hide(),$("#maxQues-parent").hide(),null!=t.ppTopicVOList&&null!=t.ppTopicVOList||$(".selectDeselectClassText").hide(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('Build Your Own Quiz','true')"),$("#pp-container-hide").show(),$(window).trigger("resize")})}function getAreaOfImprovementTagId(){var e=localStorage.getItem("schoolId"),t=(JSON.parse(localStorage.getItem("ppProductVo")),{userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:e,userActivityVO:{lastActivityCode:"PP_QUIZ_CENTER_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")});$.ajax({url:properties[properties.env]+"/managePP/getAreaOfImprovements",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(t)}).then(function(e){if("true"==e.status){if(e.ppTopicVOList){var t=e.ppTopicVOList;"object"==$.type(t)&&(t=[t]);for(var a=0;a<t.length;a++)"object"==$.type(t[a].ppSubTopicVOList)&&(t[a].ppSubTopicVOList=[t[a].ppSubTopicVOList]);aoiTopicVoList=t}else aoiTopicVoList="",$("#areahide").hide();$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function navQuizBuilding(e){JSON.parse(localStorage.getItem("ppProductVo"));var t=localStorage.getItem("schoolId"),a=$(e.currentTarget).attr("id"),o=$("."+a+"-subtopic"),s=$(e.currentTarget).attr("totalQuestions"),i=$(e.currentTarget).attr("quiztype"),r=$(e.currentTarget).find(".quiz-title").text(),n={lastActivityCode:"PP_SUMMATIVE_LANDING_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:t,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),qpQuizIdentifier:a};Utility.saveLastActivity(n);for(var l="",d=$(e.currentTarget).find(".topicList").html(),c=0;c<o.length;c++)c!=o.length-1?l+=o[c].getAttribute("subtopicid")+",":l+=o[c].getAttribute("subtopicid");$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizName").html(r+": "+d);var e=Handlebars.getTemplate("build-your-ownQuiz")("");$("#practicePerfect-buildYourOwnQuizContainer").html(e),$("#hideSummativeA").hide(),$("#practicePerfect-buildYourOwnQuizContainer").show(),$(".selectDeselectClassText").hide(),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('"+i+"','true','"+l+"',"+s+")"),$("#maxQues-parent").show(),$("#maxQues").html(s),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('"+i+"','true','"+l+"',"+s+")"),$(window).trigger("resize")})}function getAllSummativeQuizzes(){var e=localStorage.getItem("schoolId"),t=(JSON.parse(localStorage.getItem("ppProductVo")),{userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:e,userActivityVO:{lastActivityCode:"PP_QUIZ_CENTER_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")});$.ajax({url:properties[properties.env]+"/managePP/getAllSummativeQuizzes",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(t)}).then(function(e){if("true"==e.status){if("true"==e.hasPreviouslyWatchedVideos?$("#hidepreviouswatched").show():$("#hidepreviouswatched").hide(),e.ppQuizResultVOList){"object"==$.type(e.ppQuizResultVOList)&&(e.ppQuizResultVOList=[e.ppQuizResultVOList]);for(var t=0;t<e.ppQuizResultVOList.length;t++)"object"==$.type(e.ppQuizResultVOList[t].ppSubTopicVOList)&&(e.ppQuizResultVOList[t].ppSubTopicVOList=[e.ppQuizResultVOList[t].ppSubTopicVOList]);var a=Handlebars.getTemplate("getsummativequizzez")(e);$("#practicePerfect-getsummativequizzezContainer").html(a),$("#practicePerfect-getsummativequizzezContainer").show(),$("#practicePerfect-areaofimprovementContainer").hide(),$("#practicePerfect-summativeContainer").hide(),$("#practicePerfect-getsummativequizzezContainer").show()}$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function getActiveQuizzes(){var e=localStorage.getItem("schoolId");JSON.parse(localStorage.getItem("ppProductVo"));$("#page-loading-spinner").show();var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_QUIZ_CENTER_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:e,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")};$.ajax({url:properties[properties.env]+"/managePP/getActiveQuizzes",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(t)}).then(function(e){if("true"==e.status)if(e.ppQuizResultVOList){"object"==$.type(e.ppQuizResultVOList)&&(e.ppQuizResultVOList=[e.ppQuizResultVOList]),$("#activeQuiz-parent").show();var t=Handlebars.getTemplate("getActiveQuiz")(e);$("#activeQuiz").html(t),$("#practicePerfect-getsummativequizzezContainer").show(),$("#practicePerfect-areaofimprovementContainer").hide(),$("#practicePerfect-summativeContainer").hide(),$("#practicePerfect-getsummativequizzezContainer").show(),$("#page-loading-spinner").hide()}else $("#activeQuiz-parent").hide();$(window).trigger("resize"),$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function previouslyWatched(){var e=localStorage.getItem("ppProductId"),t=(JSON.parse(localStorage.getItem("ppProductVo")),localStorage.getItem("schoolId")),a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_PREVIOUSLY_WATCHED_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:t,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppProductVO:{productId:e}};$.ajax({url:properties[properties.env]+"/managePP/getPreviouslyWatchedVideos",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!0,e.ppTopicVOList){"object"==$.type(e.ppTopicVOList)&&(e.ppTopicVOList=[e.ppTopicVOList]);for(var t=0;t<e.ppTopicVOList.length;t++)e.ppTopicVOList[t].ppSubTopicVOList&&"object"==$.type(e.ppTopicVOList[t].ppSubTopicVOList)&&(e.ppTopicVOList[t].ppSubTopicVOList=[e.ppTopicVOList[t].ppSubTopicVOList]);$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizTopics").hide(),$("#selectedQuizName").html("Previously Watched");var t=Handlebars.getTemplate("build-your-ownQuiz")(e);$("#practicePerfect-buildYourOwnQuizContainer").html(t),$(".hidden-quizzes-progress").hide(),$(".selectDeselectClassText").hide(),$("#maxQues-parent").hide(),$("#pp-container-hide").show(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('Previously Watched','true')")})}$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide();$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)})}function loadAreaImprovements(){JSON.parse(localStorage.getItem("ppProductVo"));var e={lastActivityCode:"PP_AREA_OF_IMPROVEMENT_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId"),ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")};Utility.saveLastActivity(e);var t={ppTopicVOList:aoiTopicVoList};$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("build-your-quiz.html?v7",function(){$("#selectedQuizTopics").hide(),$("#selectedQuizName").html("Area for Improvement");var e=Handlebars.getTemplate("build-your-ownQuiz")(t);$("#practicePerfect-buildYourOwnQuizContainer").html(e),$(".selectDeselectClassText").hide(),$(".hidden-quizzes-progress").hide(),$("#pp-container-hide").show(),$("#maxQues-parent").hide(),$("#gradedMode").attr("onclick","createidentifierforPPQuiz('Areas for Improvement','true')"),$(window).trigger("resize")})}function getTypeVal(e,t){if("object"==$.type(t)&&(t=[t]),"Areas for Improvement"==e){for(var a="",o=0;o<t.length;o++)o!=t.length-1?a+=t[o].id+",":a+=t[o].id;return a}e="Build Your Own Quiz"==e||"Previously Watched"==e?"video":"Summative A"==e?"summativeA":"Summative B"==e?"summativeB":"video"==e?"video":"cumulative";for(o=0;o<t.length;o++)if(e==t[o].name)return t[o].id}function createidentifierforPPQuiz(e,t,a,o){JSON.parse(localStorage.getItem("ppProductVo"));var s=$("#qcErrorMessage"),i=300,r=!1,n=!1;if("string"==typeof t&&(t="true"===t),$("#qcErrorMessage").html(""),$("#ques-box").click(function(){$("#ques-box").prop("checked",!0),$("#qcErrorMessage").show(),$("#ques-max").prop("checked",!1)&&$("#qcErrorMessage").hide()}),$("#ques-max").click(function(){$("#ques-max").prop("checked",!0),$("#qcErrorMessage").show(),$("#ques-box").prop("checked",!1)&&$("#qcErrorMessage").hide()}),$("#time-box").click(function(){$("#time-box").prop("checked",!0),$("#qcErrorMessage").show(),$("#time-max").prop("checked",!1)&&$("#qcErrorMessage").hide()}),$("#time-max").click(function(){$("#time-max").prop("checked",!0),$("#qcErrorMessage").show(),$("#time-box").prop("checked",!1)&&$("#qcErrorMessage").hide()}),"Areas for Improvement"==e&&(r=!0),"video"==e)o=parseInt(o),n=!1;else{if("Summative A"!=e&&"Summative B"!=e&&"Cumulative"!=e){var l=$(".subTopTagId:checked");if($("#qcErrorMessage").show(),s.html(""),s.css("color","red"),!(l.length>0))return s.html("Please select at least one topic."),!0;a="";for(var d=0;d<l.length;d++)d!=l.length-1?a+=l[d].id+",":a+=l[d].id}var c=$(".numberOfQuesSection input:radio:checked"),p=$(".timeLimitSection input:radio:checked");if($("#qcErrorMessage").show(),s.html(""),s.css("color","red"),!(c.length>0))return s.html("Please select the number of questions"),$("#qcErrorMessage").show(),!0;if("ques-box"==(c=c.attr("id"))){if(""==$(".ques-box").val()||"0"==$(".ques-box").val())return $("#qcErrorMessage").show(),s.html("Please enter a valid number of questions."),!0;if("ques-box"!==c)s.html("");else{if(parseInt($(".ques-box").val())>parseInt($("#maxQues").html()))return $("#qcErrorMessage").show(),s.html("Please enter a valid number of questions."),!0;o=parseInt($(".ques-box").val()),s.html("")}}else o=parseInt($("#maxQues").html()),s.html("");if(!(p.length>0))return s.html("Please select the time limit section"),$("#qcErrorMessage").show(),!0;if(s.html(""),"time-box"==(p=p.attr("id"))){if(""==$(".time-box").val()||"0"==$(".time-box").val())return s.html("Please enter a time limit."),$("#qcErrorMessage").show(),!0;if(parseInt($(".time-box").val())>300)return $("#qcErrorMessage").show(),s.html("Please enter a time limit between 1 and 300 minutes."),!0;i=parseInt($(".time-box").val()),s.html(""),n=!0,s.html("")}else i=300,s.html("")}var u={id:localStorage.getItem("qpParentMetadataIdentifier"),metadataAssoc:a,additionalMetadataAssoc:[{id:localStorage.getItem("qpquestiontypeidentifier"),metadataAssoc:getTypeVal(e,JSON.parse(localStorage.getItem("qpquestiontype")))}],title:"offshoreTest"+map.userId+$.now(),clientUserId:map.userId,quizTime:i,testMode:t,numberOfQuestions:o,newQuestions:!1,gotWrong:r,quizType:"C",additionalTestModeSettings:{showTestTitle:!1,showItemTimeLimit:!1,showItemTimeSpent:!1,showTestTimeLimit:n,showTestTimeSpent:!0,showItems:!0,showCorrect:!1,showIncorrect:!1,showUnanswered:!1,showAnswer:!t},testSummaryDisplaySettings:{displayOption:3,predefinedText:"Your quiz was submitted successfully. To see how you did, check out your quiz results."},testSettings:{randomizeAnswer:!1,randomizeItem:!0,navigationType:2}};if(null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("PPIdentifierCreation",e,t,a,o),!0;var g="/api/tests?clientUserId="+map.userId;$("#page-loading-spinner").show(),fetch(properties.quizzingPlatform+g,{method:"POST",body:JSON.stringify(u),headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(s){s?(8006===s.code?getQpAuthenticationToken("PPIdentifierCreation",e,t,a,o):s.log_reference?alertMessagesModal(exceptionMsg.systemError):createInstanceforPPQuiz(s.testIdentifier,e,t,a,o,i),Utility.hideSpinner()):Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}function createInstanceforPPQuiz(e,t,a,o,s,i){if(null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("PPinstanceCreation",e,t,a,o,s,i),!0;var r="/api/tests/identifier/"+e+"/instances?clientUserId="+map.userId;$("#page-loading-spinner").show(),fetch(properties.quizzingPlatform+r,{method:"POST",body:JSON.stringify({externalContext:{productType:"pp"}}),headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(r){r?(8006===r.code?getQpAuthenticationToken("PPinstanceCreation",e,t,a,o,s,i):r.log_reference?alertMessagesModal(exceptionMsg.systemError):(postInstancePPUrlToCC(r,e,t,a,o,s,i),showQuizFrame(r,"pp",t,o)),Utility.hideSpinner()):Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}function postInstancePPUrlToCC(e,t,a,o,s,i,r){JSON.parse(localStorage.getItem("ppProductVo"));var n={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"Bookshelf",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},qpQuizVO:{qpQuizIdentifier:t,qpQuizInstanceURL:e,isGraded:o,quizType:a,subTopicTagId:s,totalQuestions:i,quizTiming:r},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")};$.ajax({url:properties[properties.env]+"/managePP/postPPQuizInstance",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(n)}).then(function(e){"true"===e.status&&(e.ppQuizResultVO&&("Summative A"==e.ppQuizResultVO.quizType?quizType="Comparative Quiz A":"Summative B"==e.ppQuizResultVO.quizType?quizType="Comparative Quiz B":"Cumulative"==e.ppQuizResultVO.quizType?quizType="Comparative Quiz: All Topics":quizType=e.ppQuizResultVO.quizType,"video"==e.ppQuizResultVO.quizType?$(".userClassNameStyles").html(e.ppQuizResultVO.customerFacingSubTopicName):$(".userClassNameStyles").html(quizType+": Quiz "+e.ppQuizResultVO.quizAttempt),e.ppQuizResultVO.instanceId&&($(".ppDashBoardBtnSection #progressBtn").attr("instanceId",e.ppQuizResultVO.instanceId),$(".ppDashBoardBtnSection #progressBtn").show())),$("#page-loading-spinner").hide()),$(window).trigger("resize")},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function retakeQuizFun(e){$("#retakingModalSection").modal("show"),$("#yesRetakeBtn").attr("onclick",$(e.currentTarget).attr("evtclick"))}function updateLastWatchedVideo(e){var t=$("#ppVideoFormat").val(),a=localStorage.getItem("schoolId"),o=(JSON.parse(localStorage.getItem("ppProductVo")),{userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"Bookshelf",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:a,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),ppSubTopicVO:{subTopictagId:e,modeType:t}});$.ajax({url:properties[properties.env]+"/managePP/updateLastWatchedVideo",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(t){"true"==t.status&&(localStorage.setItem("latestSubTopicID",e),$("#page-loading-spinner").hide(),$(window).trigger("resize"))},function(e){})}function getSummaryStatus(e,t){if("true"===t)var a=e;else{a=$(e.currentTarget).attr("instanceId");localStorage.setItem("instanceId",a)}var o=localStorage.getItem("schoolId");JSON.parse(localStorage.getItem("ppProductVo"));setTimeout(function(){var e={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"PP_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",lastReadPageNum:"",themisSubjectAreaId:"",themisProductId:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:o,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),instanceId:a},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},ppQuizResultVO:{instanceId:a}};$.ajax({url:properties[properties.env]+"/managePP/getPPQuizStatusByInstanceId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){if("true"===e.status)if(e.ppQuizResultVO)if("true"==e.ppQuizResultVO.isCompleted){$("#resultLoadingModal").modal("show");var t=e.ppQuizResultVO;"object"==$.type(t)&&(t=[t]);for(var s=0;s<t.length;s++)t[s].QPQuestionVOList&&"object"==$.type(t[s].QPQuestionVOList)&&(t[s].QPQuestionVOList=[t[s].QPQuestionVOList]);if(null===t[0].QPQuestionVOList||void 0===t[0].QPQuestionVOList)setTimeout(function(){getSummaryStatus(localStorage.getItem("instanceId"),"true")},1e4);else if(null!==t[0].QPQuestionVOList&&void 0!==t[0].QPQuestionVOList){var i=parseInt(t[0].totalQuestions);if(i!==(questionsList=t[0].QPQuestionVOList.length)){var r=questionsList/i*100;current_progress=Math.round(r),$("#ProgressPP").animate({width:current_progress+"%"},1e4),setTimeout(function(){getSummaryStatus(localStorage.getItem("instanceId"),"true")},1e4)}else{var n=100-current_progress;$("#ProgressPP").animate({width:"+="+n+"%"},1e3,function(){$("#resultLoadingModal").modal("hide"),$("#ProgressPP").animate({width:"0%"}),current_progress=0,questionsList=0;var s={lastActivityCode:"PP_RESULT_SUMMARY_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:"",themisSubjectAreaId:"",themisProductId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:o,ppSubjectAreaTagId:localStorage.getItem("ppsubjectareatagid"),instanceId:a};Utility.saveLastActivity(s),map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var a=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect<sup class='pp-mainHeaderTM'>TM</sup> "+a),$(".pp-holder-name .subjectAreaName").html(a),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v15",function(){var a=Handlebars.getTemplate("progress-dashboardpage")(t);$("#practicePerfect-progressContainer").html(a),$("#view-more-parent").hide(),$("#practicePerfect-progressContainer").show(),$("#child-progress-container").hide();for(var o=0;o<t[0].QPQuestionVOList.length;o++){var s=t[0].QPQuestionVOList[o].questionIdentifier;if("false"==t[0].QPQuestionVOList[o].correct){var i="";if(t[0].QPQuestionVOList[o].choiceId){i=t[0].QPQuestionVOList[o].choiceId,$("#question"+s+" #"+i).removeClass("result-block").addClass("result-blockRemove");var r=$("#question"+s+" #"+i).html();$("#question"+s+" #"+i).html('<span class=" ppTickposition glyphicon glyphicon-remove"></span>'+r),$("#question"+s+" #"+i+" .ppindex").addClass("ppglyp")}}}if("video"==t[0].quizType?($(".backToVideoBtn").attr("onclick","getAllVideoTracker('"+t[0].ppSubTopicVO.subTopictagId+"')"),$(".backToVideoBtn").html("Back to Video"),$(".retakeBtnGroup").show(),$(".backRetakeGroup").css("float","left"),$(".yesRetakeBtn").attr("onclick","createInstanceforPPQuiz('"+t[0].quizIdentifier+"','video',true,'"+t[0].ppSubTopicVO.subTopictagId+"','"+t[0].ppSubTopicVO.totalQuestions+"',300)"),$(".retakeBtnGroup").show()):($(".backToVideoBtn").attr("onclick","quizPage()"),$(".backToVideoBtn").html("Back to Quiz Center"),$(".retakeBtnGroup").hide(),$(".backRetakeGroup").css("float","right")),e.ppVideoQuizResultVOList){"object"==$.type(e.ppVideoQuizResultVOList)&&(e.ppVideoQuizResultVOList=[e.ppVideoQuizResultVOList]);var n=$(".retakeBtnGroup button").attr("subtopictagid"),l=$(".retakeBtnGroup button").attr("totalquestions");for(o=0;o<e.ppVideoQuizResultVOList.length;o++)"true"==e.ppVideoQuizResultVOList[o].isGraded?"true"==e.ppVideoQuizResultVOList[o].isCompleted?($(".retakeBtnGroup button").html("Retake Graded Quiz"),$(".retakeBtnGroup button").attr("evtClick","createInstanceforPPQuiz('"+e.ppVideoQuizResultVOList[o].quizIdentifier+"','video',true,'"+n+"',"+l+",300)"),$(".retakeBtnGroup button").attr("onclick","retakeQuizFun(event)")):e.ppVideoQuizResultVOList[o].instanceURL?($(".retakeBtnGroup button").html("Continue Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","showQuizFrame('"+e.ppVideoQuizResultVOList[o].instanceURL+"','pp','video','"+n+"',event)"),$(".retakeBtnGroup button").attr("instanceId",e.ppVideoQuizResultVOList[o].instanceId)):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+n+"',"+l+")")):($(".retakeBtnGroup button").html("Take Graded Quiz"),$(".retakeBtnGroup button").attr("onclick","createidentifierforPPQuiz('video','true','"+n+"',"+l+")"))}$(window).trigger("resize")})})})}}}else $("#reviewResultsModalSection").modal("show");else $("#resultLoadingModal").modal("hide");else $("#resultLoadingModal").modal("hide");$(window).trigger("resize")},function(e){$("#resultLoadingModal").modal("hide"),alertMessagesModal(e.responseJSON.errorMessg)})},1e3)}function quizCenterProgressLazyLoad(){map.wk_conatiner.load("practicePerfectLandingPage.html?v3",function(){var e=localStorage.getItem("ppProductTitle");$(".ereader-main-header-title").html("PracticePerfect<sup class='pp-mainHeaderTM'>TM</sup> "+e),$(".pp-holder-name .subjectAreaName").html(e),$("#pp-video-search-sec").hide(),$(".searchInput").val(""),$(".no-search").remove(),$("#pp-container-hide").load("practicePerfectUserProgress.html?v15",function(){getQuizCenterProgress()})})}function changeCQ(e,t){var a=$(e);if($("#profCQuiz-detailedResult-content-area .titleTab").removeClass("tab-selected active"),a.addClass("tab-selected active"),"preview"==t)$("#profCQuiz-detailedResult-content-area .preview-page").show(),$("#profCQuiz-detailedResult-content-area .view-progress-page").hide(),$("#profCQuiz-detailedResult-content-area .studentSimulation-page").hide();else if("studentSimulation"==t){$("#profCQuiz-detailedResult-content-area .studentSimulation-page").show(),$("#profCQuiz-detailedResult-content-area .preview-page").hide(),$("#profCQuiz-detailedResult-content-area .view-progress-page").hide(),createInstanceforQuizProfessor(o=$("#studentSimulation").attr("quizidentifier"),$("#studentSimulation").attr("qpid"),s=$("#studentSimulation").attr("classid"))}else if("results"==t){var o=a.attr("quizIdentifier"),s=a.attr("classId"),i=a.attr("semId"),r=a.attr("qpId");loadProfResultSummary(o,s,i,r),getTopicResultsForClass(o,s,i,r),getAllStudentsScore(o,s,i,r),excelSheetReportServiceCQ(o,s,i,r),$("#profCQuiz-detailedResult-content-area .preview-page").hide(),$("#profCQuiz-detailedResult-content-area .studentSimulation-page").hide(),$("#profCQuiz-detailedResult-content-area .view-progress-page").show()}}function cqquestionOrderdropdown(){var e=$("#cqquestionOrder").val();"topicView"==e?($(".cqTopicperformance").show(),$(".cqQuizcenterOrder").hide()):($(".cqQuizcenterOrder").show(),$(".cqTopicperformance").hide()),updateCQResultView(e)}function adminSuppressFunc(){CaseConnect.adminStudyFlag=localStorage.getItem("adminStudyFlag"),CaseConnect.adminOutlineFlag=localStorage.getItem("adminOutlineFlag"),CaseConnect.adminInsightsFlag=localStorage.getItem("adminInsightsFlag"),CaseConnect.adminNewsFlag=localStorage.getItem("adminNewsFlag"),"true"==CaseConnect.adminStudyFlag?$(".hide-study-page-class").show():($(".hide-study-page-class").hide(),$("#insights-study-center").parent().hide()),"true"==CaseConnect.adminOutlineFlag?$(".hide-outline-page-class").show():$(".hide-outline-page-class").hide(),"true"==CaseConnect.adminInsightsFlag?$(".hide-class-insights-class").show():$(".hide-class-insights-class").hide(),"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide()}function chatBot(){map.wk_conatiner.load("casebot.html?v3",function(){$(window).trigger("resize")})}function freeTrialcatalog(e){e&&window.history.pushState({page:""},null,properties.ui_domain);var t=localStorage.getItem("trialID");map.wk_conatiner.load("freeTrailCatalog.html?v4",function(){$("#ft-cateloglandingPage").show(),freeTrialBookList(t),$(window).trigger("resize")})}function freeTrialBookList(e){$("#page-loading-spinner").show();var t={userVO:{userActivityVO:{lastActivityCode:"FREETRIAL_PRODUCT_PAGE",pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf",ppSubTopicTagId:e},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")},userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId")},freeTrialId:e};$.ajax({url:properties[properties.env]+"/manageFreeAccess/sendAllTheProductsByTrialID",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(e){if("true"==e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!0,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!1,e.freeTrialVO){if(e.freeTrialVO.productBannerHeading?$("#bannerHead").html(e.freeTrialVO.productBannerHeading):$("#bannerHead").html(""),e.freeTrialVO.productBannerContent?$("#bannerCon").html(e.freeTrialVO.productBannerContent):$("#bannerCon").html(""),e.freeTrialVO.bookVOList){var t=e.freeTrialVO.bookVOList;"object"==$.type(t)&&(t=[t]);for(var a=0;a<t.length;a++)"object"==$.type(t[a].bookVOList)&&(t[a].bookVOList=[t[a].bookVOList]);var o=Handlebars.getTemplate("ft-book-list")(e.freeTrialVO);$("#ft-bookListBlock").html(o);new List("ft-cateloglandingPage",{valueNames:["ft-bookTitle","ft-bookAuthor","bookIsbn"],listClass:"search-freeTrail",searchClass:"bookListFilterSearch"});var s=9;$("#ft-bookListBlock .columnBooks").slice(0,s).show(),t.length>9?$("#loadMoreBookListBtn").show():$("#loadMoreBookListBtn").hide(),$("#loadMoreBookListBtn").on("click",function(e){e.preventDefault(),s+=6,$("#ft-bookListBlock .columnBooks").slice(0,s).slideDown(),$(".columnBooks").length<=s&&$("#loadMoreBookListBtn").hide()}),$("#page-loading-spinner").hide()}var i=0,r=0;e.freeTrialVO.userFreeCount&&(i=parseInt(e.freeTrialVO.userFreeCount)),e.freeTrialVO.productLimit&&(r=parseInt(e.freeTrialVO.productLimit)),i>=r?($("#ftRedeemLimitModal").modal("show"),$(".reddemedClass").html(`Redeemed: ${i}/${r}`)):$(".reddemedClass").html(`Redeemed: ${i}/${r}`);var n="",l="";if(e.freeTrialVO.metadataTitleTag&&(n=e.freeTrialVO.metadataTitleTag),e.freeTrialVO.metadataDiscription&&(l=e.freeTrialVO.metadataDiscription),""!=n||""!=l){var d="<meta name='"+n+"' content='"+l+"'>";$("head").append(d)}}$(window).trigger("resize"),null!=localStorage.getItem("userId")&&null!=localStorage.getItem("userId")||window.history.pushState({page:""},null,properties.ui_domain+"access"+localStorage.getItem("freeAccessLink"))}$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),"bus.exception.user.exceeded.free.trial.count"==e.responseJSON.wkErrorCode?$("#ftRedeemLimitModal").modal("show"):alertMessagesModal(e.responseJSON.errorMessg)})}function generateFreeTrialCheck(e){var t=$(e.currentTarget);if(void 0!==localStorage.getItem("userId")&&null!==localStorage.getItem("userId"))t.hasClass("single-logged-in")?validateFreeTrialProduct(t,"single"):validateFreeTrialProduct(t,"multiple");else{var a=t.attr("bookType"),o=t.attr("bookIsbn"),s=t.attr("bookId"),i=t.attr("trialid");localStorage.setItem("freeBookType",a),localStorage.setItem("freeBookIsbn",o),localStorage.setItem("freeBookId",s),localStorage.setItem("freetrialId",i),map.bookAccessCode="",window.history.pushState({page:"createAccount"},null,properties.ui_domain),map.wk_conatiner.load("createAccount.html?v5",function(){loadCountryListOnRegister(),$(window).scrollTop(0),Utility.hideSpinner()})}}function validateFreeTrialProduct(e,t){var a,o,s,i,r="";"single"==t||"multiple"==t?(r="single"==t?"FREETRIAL_HOME_PAGE":"FREETRIAL_PRODUCT_PAGE",a=e.attr("bookType"),o=e.attr("bookIsbn"),s=e.attr("bookId"),i=e.attr("trialid")):"bookshelf"==t&&(r="BOOKSHELF",s=localStorage.getItem("singleBookId"),a=localStorage.getItem("singleBookType"),o=localStorage.getItem("singleBookIsbn"),i=localStorage.getItem("singleTrailId"));var n={userVO:{userActivityVO:{lastActivityCode:r,pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf",ppSubTopicTagId:i,qpQuizIdentifier:localStorage.getItem("freeAccessLink")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")},userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId")},freeTrialVO:{trialId:i,productType:a,productId:s,productISBN:o}};$.ajax({url:properties[properties.env]+"/manageFreeAccess/redeemProductForFreeTrial",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(n)}).then(function(e){if("true"===e.status){insideStaticPage=!1,insideBookshelf=!0,insideNewsFeed=!1,insideCasesPage=!1,insideResourcePage=!1,insideStudycenterPage=!1,insideEreader=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,insideOutline=!1,insideGlobalSearchResult=!1,rssFeedSAList=null,rssFeedAllList=null;var t="";t="Professor"===map.userRole?"professorBookShelf.html?v2":"bookShelf.html?v2",window.history.pushState({page:"bookshelf"},null,properties.ui_domain),map.wk_conatiner.load(t,function(){Utility.showSpinner(),localStorage.removeItem("classCodeAddSectionRefresh"),CaseConnect.bookTitle="",$(".bookshelflink").hide(),$(".tutoriallink").hide(),CaseConnect.resourceFlag=!1;Handler.login.generateAddBookPopover(),Handler.login.generateAddProdToBookShelf(),Handler.addBook.response(e),$("#page-loading-spinner").hide()}),$("#page-loading-spinner").hide(),$(window).trigger("resize");Utility.saveLastActivity({lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader"})}localStorage.removeItem("singleBookId"),localStorage.removeItem("singleBookType"),localStorage.removeItem("singleBookIsbn"),localStorage.removeItem("singleTrailId")},function(e){$("#page-loading-spinner").hide(),"bus.exception.user.already.have.an.active.product"==e.responseJSON.wkErrorCode?$("#ftAlreadyExisting").modal("show"):"bus.exception.you.already.have.lifetime.access.to.this.product"==e.responseJSON.wkErrorCode?$("#ftAlreadyExisting").modal("show"):"bus.exception.user.exceeded.free.trial.count"==e.responseJSON.wkErrorCode?$("#ftRedeemLimitModal").modal("show"):"bus.exception.only.student.can.redeem.cq.code"==e.responseJSON.wkErrorCode?alertMessagesModal("It looks like you're trying to redeem a student access code with a professor account. To get set up with Connected Quizzing, contact the Quiz Concierge at <a href='mailto:concierge@wolterskluwer.com'>concierge@wolterskluwer.com</a>."):alertMessagesModal(e.responseJSON.errorMessg),localStorage.removeItem("singleBookId"),localStorage.removeItem("singleBookType"),localStorage.removeItem("singleBookIsbn"),localStorage.removeItem("singleTrailId")})}function searchFreeTrial(){if($("#bookListFilterSearch").val().length>0)$("ul.search-freeTrail li.columnBooks").show(),$("#loadMoreBookListBtn").hide();else{$("#ft-bookListBlock .columnBooks").hide(),$("#ft-bookListBlock .columnBooks").slice(0,9).show(),$("#loadMoreBookListBtn").show()}}function getFreeTrialCount(){var e={userVO:{userId:localStorage.getItem("userId"),userActivityVO:{lastActivityCode:"ADMIN_GENERATE_IP_REPORT",pageNavigatingFrom:"IPReport",pageNavigatingTo:"IPReport"},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")},userRole:"wkadmin"},freeTrialId:1};$.ajax({url:properties[properties.env]+"/manageBookService/getFreeTrialCount",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){e.status},function(e){$("#page-loading-spinner").hide(),"bus.exception.user.exceeded.free.trial.count"==e.responseJSON.wkErrorCode?$("#ftRedeemLimitModal").modal("show"):alertMessagesModal(e.responseJSON.errorMessg)})}function freeAccessLink(){var e={userVO:{userActivityVO:{lastActivityCode:"FREETRIAL_HOME_PAGE",pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf",qpQuizIdentifier:localStorage.getItem("freeAccessLink")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")},userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId")},freeTrialVO:{pageURL:localStorage.getItem("freeAccessLink")}};$.ajax({url:properties[properties.env]+"/manageFreeAccess/sendFreeAccessProductDetailsByURL",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){"true"===e.status&&e.freeTrialVO&&map.wk_conatiner.load("freeTrial-home.html",function(){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!0,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insideCQuizzing=!1,insidePracticePerfect=!1,"false"==e.freeTrialVO.activeFlag?($("#freeTrial-expiry").show(),$("#freeTrial-active").hide(),$("#freeTrial-404").hide(),e.freeTrialVO.expiredBannerHeading?$("#freeTrial-expiry #bannerHead").html(e.freeTrialVO.expiredBannerHeading):$("#freeTrial-expiry #bannerHead").html(""),e.freeTrialVO.expiredBannerContent?$("#freeTrial-expiry #bannerCon").html(e.freeTrialVO.expiredBannerContent):$("#freeTrial-expiry #bannerCon").html(""),e.freeTrialVO.expiredPageContent?$("#freeTrial-expiry #PageContent").html(e.freeTrialVO.expiredPageContent):$("#freeTrial-expiry #PageContent").html("")):($("#freeTrial-expiry").hide(),$("#freeTrial-active").show(),$("#freeTrial-404").hide(),e.freeTrialVO.bannerHeading?$("#freeTrial-active #bannerHead").html(e.freeTrialVO.bannerHeading):$("#freeTrial-active #bannerHead").html(""),e.freeTrialVO.bannerContent?$("#freeTrial-active #bannerCon").html(e.freeTrialVO.bannerContent):$("#freeTrial-active #bannerCon").html(""),e.freeTrialVO.pageContent?$("#freeTrial-active #PageContent").html(e.freeTrialVO.pageContent):$("#freeTrial-active #PageContent").html("")),localStorage.setItem("trialID",e.freeTrialVO.trialId),e.freeTrialVO.bookVOList)if("object"==$.type(e.freeTrialVO.bookVOList)&&(e.freeTrialVO.bookVOList=[e.freeTrialVO.bookVOList]),e.freeTrialVO.bookVOList.length>1)ftshowHideLoginResource(!0);else{ftshowHideLoginResource(!1),"ConnectedQuiz"==e.freeTrialVO.bookVOList[0].bookType?$(".singleProdBannerImg img").attr("src",properties.full_base_url+"img/bookshelf/CQ-cover.png"):"Themis"==e.freeTrialVO.bookVOList[0].bookType?$(".singleProdBannerImg img").attr("src",properties.full_base_url+"img/themis/MBE_bars.png"):$(".singleProdBannerImg img").attr("src",e.freeTrialVO.bookVOList[0].thumbnailImagePath),$(".singleProdBannerImg img").attr("alttext",e.freeTrialVO.bookVOList[0].bookTitle),$("#singleProdBannerContent").html(e.freeTrialVO.productBannerContent),$("#singleProdBannerHead").html(e.freeTrialVO.productBannerHeading);var t=e.freeTrialVO.bookVOList[0].bookId,a=e.freeTrialVO.bookVOList[0].bookType,o=e.freeTrialVO.bookVOList[0].bookISBN,s=e.freeTrialVO.trialId;$(".ftresource-single-logged #createAcc").attr("bookId",t),$(".ftresource-single-logged #createAcc").attr("bookType",a),$(".ftresource-single-logged #createAcc").attr("bookIsbn",o),$(".ftresource-single-logged #createAcc").attr("trialid",s),$(".ftresource-single-logged #accessNow").attr("bookId",t),$(".ftresource-single-logged #accessNow").attr("bookType",a),$(".ftresource-single-logged #accessNow").attr("bookIsbn",o),$(".ftresource-single-logged #accessNow").attr("trialid",s),localStorage.setItem("singleBookId",t),localStorage.setItem("singleBookType",a),localStorage.setItem("singleBookIsbn",o),localStorage.setItem("singleTrailId",s)}else ftshowHideLoginResource(!0);var i="",r="";if(e.freeTrialVO.metadataTitleTag&&(i=e.freeTrialVO.metadataTitleTag),e.freeTrialVO.metadataDiscription&&(r=e.freeTrialVO.metadataDiscription),""!=i||""!=r){var n="<meta name='"+i+"' content='"+r+"'>";$("head").append(n)}null!=localStorage.getItem("userId")&&null!=localStorage.getItem("userId")||window.history.pushState({page:""},null,properties.ui_domain+"access"+localStorage.getItem("freeAccessLink"))}),$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide(),Utility.handleSessionAuthentication(e.responseJSON)?"bus.exception.no.free.trial.product.found.with.the.given.url"==e.responseJSON.wkErrorCode?map.wk_conatiner.load("freeTrial-home.html",function(){$("#freeTrial-expiry").hide(),$("#freeTrial-active").hide(),$("#freeTrial-404").show(),null==localStorage.getItem("userId")||null==localStorage.getItem("userId")?window.history.pushState({page:""},null,properties.ui_domain+"access"+localStorage.getItem("freeAccessLink")):Handler.login.updateStatusBar()}):"bus.exception.requestVO.getFreeTrialVO().getPageURL().is.null"==e.responseJSON.wkErrorCode?map.wk_conatiner.load("freeTrial-home.html",function(){$("#freeTrial-expiry").hide(),$("#freeTrial-active").hide(),$("#freeTrial-404").show(),null==localStorage.getItem("userId")||null==localStorage.getItem("userId")?window.history.pushState({page:""},null,properties.ui_domain+"access"+localStorage.getItem("freeAccessLink")):Handler.login.updateStatusBar()}):alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain})}function loginFree(e){window.history.pushState({page:"login"},"CasebookConnect | Wolters Kluwer Legal Education",properties.ui_domain),window.location.href=e?"login?fts":"login?ft"}function staticLinksFree(e){window.history.pushState({page:""},"CasebookConnect | Wolters Kluwer Legal Education",properties.ui_domain),window.location.href=properties.ui_domain+""+e}function onLoadVideoTracker(){$("#video").css("visibility","visible");var e=document.getElementById("video");if(e.contentWindow){if(null!==e||void 0!==e){new MutationObserver(function(){checkList(e.contentWindow.videojs.getAllPlayers("wk_video")[0].currentTime(),e.contentWindow.videojs.getAllPlayers("wk_video")[0].duration(),$(".userClassNameStyles").attr("subTopictagId"))}).observe(e,{attributes:!0,childList:!0,subtree:!0})}var t=e.contentWindow.document.getElementsByClassName("vjs-big-play-button"),a=e.contentWindow.document.getElementsByClassName("vjs-poster"),o=localStorage.getItem("resumePlayInteractive"),s=localStorage.getItem("resumePlayContinuous");$(t).click(function(){updateLastWatchedVideo($(".userClassNameStyles").attr("subTopictagId")),"interactive"==$("#ppVideoFormat").val()?e.contentWindow.videojs.getAllPlayers("wk_video")[0].currentTime(o):e.contentWindow.videojs.getAllPlayers("wk_video")[0].currentTime(s)}),$(a).click(function(){updateLastWatchedVideo($(".userClassNameStyles").attr("subTopictagId")),"interactive"==$("#ppVideoFormat").val()?e.contentWindow.videojs.getAllPlayers("wk_video")[0].currentTime(o):e.contentWindow.videojs.getAllPlayers("wk_video")[0].currentTime(s)})}}function cqcompleteModal(){$("#myModalQuizSummary").modal("hide"),$(".modal-backdrop").remove(),$("#myModalQuizSummary").on("hidden.bs.modal",function(e){setTimeout(function(){$(".studQuizCompleteBtn").focus()},30)})}function editUrID(e){$(".cqAnonymousEditBt").remove();var t=$(e.currentTarget).parent().attr("cqClassId"),a=$("#"+t+" .editAnony .cqEditIcon").position();a=parseInt(a.left),$("#"+t).append('<div class="cqAnonymousEditBt"><a style="cursor:default;" href="#" id="clickEditBt" onclick="editUrIDmodal(event);" onmousedown="editUrIDmodal(event);" ontouchstart="editUrIDmodal(event);"><button type="button" class="enterNewAnonymousCode">Edit my ID</button></a>'),$("#"+t+" .cqAnonymousEditBt").css("margin-left",a+"px"),$("#"+t+" .enterNewAnonymousCode").attr("cqClassId",t),$("#clickEditBt").focus(),$("#clickEditBt").blur(function(){$(".cqAnonymousEditBt").remove()})}function editUrIDmodal(e){$(".errorMesssageAnonymous").hide();$(e.currentTarget).parent().parent().attr("id");var t=$(e.currentTarget).parent().parent().attr("cqTitle"),a=$(e.currentTarget).parent().parent().attr("professorUserName"),o=$(e.currentTarget).parent().parent().attr("cqClassId"),s=$('.breadCrumbSection[cqClassId="'+o+'"] .cqAnonymousId').attr("title");$("#redeemAnonymousCode-inputId").val(s);var i="Connected Quizzing for "+t+" with Professor "+a+" requires your Anonymous ID";$("#thankYouGetCQanonymousPopover .modal-thankYouGetCQanonymousPopoverHeader").html(i),$("#redeemAnonymousCode-inputId").attr("cqClassId",o),$("#thankYouGetCQanonymousPopover").modal("show"),$("#next-gotItBtns").hide(),$("#save-gotItBtns").show(),$("#page-loading-spinner").hide()}function updateUserAnonymousId(e){var t=$("#redeemAnonymousCode-inputId").attr("cqClassId"),a=$("#redeemAnonymousCode-inputId").val().trim();if(""===a||null==a)$(".errorMesssageAnonymous").show();else{$("#page-loading-spinner").show();var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqClassVO:{cqClassId:t,cqAnonymousId:a}};$.ajax({url:properties[properties.env]+"/manageCQ/updateUserAnonymousId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){"true"===e.status?($("#thankYouGetCQanonymousPopover").modal("hide"),$('.breadCrumbSection[cqClassId="'+t+'"] .cqAnonymousId').html("ID: "+a),$('.breadCrumbSection[cqClassId="'+t+'"] .editAnony #iconspl').show(),$('.cQuizButtons .cqButton[classId="'+t+'"]').attr("anonymousid",a),$('.breadCrumbSection[cqClassId="'+t+'"] .cqAnonymousId').attr("title",a),$("#page-loading-spinner").hide(),$(".errorMesssageAnonymous").hide(),$(".cqAnonymousEditBt").remove()):$("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#thankYouGetCQanonymousPopover").modal("hide"),$("#page-loading-spinner").hide(),"bus.exception.anonymous.id.already.used.by.current.user"==e.responseJSON.wkErrorCode?alertMessagesModal("You are already entered this anonymous id. Please enter different one"):(alertMessagesModal(e.responseJSON.errorMessg),$(".cqAnonymousEditBt").remove())):window.location=properties.ui_domain})}}function captchaLoginVerifyLTI(e){if($("#registerPageId").hasClass("enablereCaptcha")){$(".registerErrorMessage").html("");var t=$('[name ="g-recaptcha-response"]').val();$("#page-loading-spinner").show();var a={};a.url=properties[properties.env]+"/lti/createCCAccount";var o=$("#reg_firstName").val().trim(),s=$("#reg_lastName").val().trim(),i=$("#reg_email").val().trim(),r=$("#reg_confirmEmail").val().trim(),n=$("#reg_password").val().trim(),l=$("#reg_confirmPassword").val().trim(),d=$("#user-country-name").val().trim(),c=$("#user-school-location").val().trim(),p=$("#user-school-name").val().trim();a.data={firstnamelti:o,lastnamelti:s,email:i,cemail:r,pswlti:n,cltipsw:l,countrylti:d,schoolLocation:c,schoolName:p,responseCaptcha:t},Handler.createAccountLTI.request(a),a.method="POST",a.handler=Handler.createAccountLTI,Utility.fireRequest(a)}else if($("#loginPageId").hasClass("enablereCaptchaFromRegister")){$(".loginErrorMessage").html("");t=$('[name ="g-recaptcha-response"]').val();$("#page-loading-spinner").show(),(m={}).url=properties[properties.env]+"/manageUserService/userAuthentication";var u=$("#login_email").val().trim(),g=$("#login_password").val().trim();m.data={email:u,password:g,responseCaptcha:t},Handler.ltiLogin.request(m),m.method="POST",m.handler=Handler.ltiLogin,Utility.fireRequest(m),$("#loginPageId").removeClass("enablereCaptchaFromRegister")}else{$(".loginErrorMessage").html("");var m;t=$('[name ="g-recaptcha-response"]').val();$("#page-loading-spinner").show(),(m={}).url=properties[properties.env]+"/lti/mapLmsUser";u=$("#login_email").val().trim(),g=$("#login_password").val().trim();m.data={email:u,password:g,responseCaptcha:t},Handler.ltiMapUserLogin.request(m),m.method="POST",m.handler=Handler.ltiMapUserLogin,Utility.fireRequest(m)}}function connectQuizAssistantLanding(e,t){$("#page-loading-spinner").show();var a="";t&&(a="true"===t||"dropdown"===t?$(".semester-drpdwnAssistant").val():"back"===t?localStorage.getItem("assistantSemId"):t);var o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{lastActivityCode:"CQ_STUDENT_DASHBOARD_PAGE",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId")},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}};""!==a&&null!==a&&(o.cqSemesterVO={semesterId:a},o.userVO.userActivityVO.lastViewedCQSemesterId=a),$.ajax({url:properties[properties.env]+"/manageCQ/getCqAssitantClassBySemId",type:"POST",contentType:"application/json; charset=utf-8",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("true"===e.status){if(insideResourcePage=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideEreader=!1,insideStudy=!1,insideStaticPage=!1,insideCasesPage=!1,insideOutline=!1,insideBookshelf=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideThemisStudProfile=!1,insideAdminQuiz=!1,insidePracticePerfect=!1,insideCQuizzing=!0,e.cqSemesterVOList){var a=e.cqSemesterVOList,o="";for(var s in"object"==$.type(a)&&(a=[a]),a)a[s].semesterId&&a[s].semesterName&&(o+="<option value='"+a[s].semesterId+"' semesterStartDate='"+a[s].semesterStartDate+"' semesterEndDate='"+a[s].semesterEndDate+"'>"+a[s].semesterName+"</option>"),$(".semester-drpdwnAssistant").html(o)}if(e.cqClassVOList){var i=e.cqClassVOList;"object"==$.type(i)&&(i=[i]);for(s=0;s<i.length;s++)"object"==$.type(i[s].qpQuizVOList)&&(i[s].qpQuizVOList=[i[s].qpQuizVOList]),"object"==$.type(i[s].cqClassAssistantVOList)&&(i[s].cqClassAssistantVOList=[i[s].cqClassAssistantVOList]),i[s].qpQuizVOList&&(i[s].totalQuizzes=i[s].qpQuizVOList.length);for(var s in i){var r=0;if(i[s].cqClassAssistantVOList){var n="",l="";for(var d in i[s].cqClassAssistantVOList){var c=i[s].cqClassAssistantVOList[d];"Professor"===c.ccUserRole?n+="Professor "+c.firstName+" "+c.lastName+", ":"Student"===c.ccUserRole&&(l+="Assistant "+c.firstName+" "+c.lastName+", ")}i[s].assistantMessage="Teaching with "+n+l,i[s].assistantMessage=i[s].assistantMessage.replace(/,\s*$/,"")}if($(".semester-drpdwnAssistant").val(i[0].semesterId),i[s].qpQuizVOList){for(var p in i[s].qpQuizVOList)"completed"===i[s].qpQuizVOList[p].scheduleStatus&&r++;i[s].totalCompletedQuizzes=r}}var u=Handlebars.getTemplate("connect-Quiz-teachingAssistant")(i);$("#assistantRoleClasses").html(u),$("#profCQuiz-detailedResult-content-area").hide(),"Professor"===map.userRole&&$(".contactAssessmentSpecialistId").show(),"true"!==t&&"dropdown"!==t||adjustLeftNavHeight()}else adjustLeftNavHeight();localStorage.removeItem("assistantSemId"),$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function createInstanceforQuizProfessor(e,t,a){if(null==localStorage.getItem("authTokenCQ")||null==localStorage.getItem("authTokenCQ")||""==localStorage.getItem("authTokenCQ"))return getQpAuthenticationToken("instanceCreation",e,t,a),!0;var o=$("#studentSimulation").attr("qpUrlProf"),s=localStorage.getItem("qpUrlProf");if(null!=o&&null!=o&&""!=o);else if(null!=s&&null!=s&&""!=s)$("form#previewQuiz #engineURL").val(s),$("form#previewQuiz #accessToken").val(localStorage.getItem("authTokenCQ")),document.getElementById("previewQuiz").action=s,document.getElementById("previewQuiz").submit(),adjustLeftNavHeight(),$("#studentSimulation").attr("qpUrlProf",s);else{var i="/api/tests/identifier/"+e+"/instances?clientUserId="+map.userId;$("#page-loading-spinner").show(),fetch(properties.quizzingPlatform+i,{method:"POST",body:JSON.stringify({productId:t,externalContext:{productType:"professorSimulation"}}),headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(o){o?8006===o.code?getQpAuthenticationToken("instanceCreation",e,t,a):(getInstanceIDProf(o,e,a),$("#studentSimulation").attr("qpUrlProf",o),localStorage.setItem("qpUrlProf",o),Utility.hideSpinner()):Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}}function getInstanceIDProf(e,t,a){var o="/api/tests/identifier/"+t+"/instances?clientUserId="+map.userId+"&sort=-id";fetch(properties.quizzingPlatform+o,{method:"GET",body:JSON.stringify(),headers:{Accept:"application/json",Authorization:localStorage.getItem("authTokenCQ")}}).then(function(e){return e.json()}).then(function(t){t?(t.instances.length>0&&($("form#previewQuiz #engineURL").val(e),$("form#previewQuiz #accessToken").val(localStorage.getItem("authTokenCQ")),document.getElementById("previewQuiz").action=e,document.getElementById("previewQuiz").submit(),adjustLeftNavHeight()),Utility.hideSpinner()):Utility.hideSpinner()}).catch(function(e){$("#page-loading-spinner").hide()})}
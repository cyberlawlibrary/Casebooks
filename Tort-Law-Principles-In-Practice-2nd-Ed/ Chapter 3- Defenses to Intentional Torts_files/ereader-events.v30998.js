var currentTime,searchByPageNum,focusNavInEreader=!1,timeoutToScroll=!1,delayTimeToScroll=200,globalSearchKeyword="";function highLightedTextClick(){if(addingBrief)if(0===selectedNoteId.indexOf("note"))void 0===$("input#add-brief-label-box")[1]||""!==$("input#add-brief-label-box")[1].value||void 0==="textarea#add-brief-textarea"[1]||""!==$("textarea#add-brief-textarea")[1].value||$(".color-btns").hasClass("selectedColor")?(checkSaveBrief=!0,addBrief()):(addingBrief=!1,updatingBrief=!1,displayCommonAnnotationPopover=!1,$("#"+selectedNoteId).popover("hide"),addBriefPopoverShown=!1,clickedInsidePcaseForAnnot=!1,removeDummyTags()),$("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show();else{if($("input#add-brief-label-box").length>1||$("textarea#add-brief-textarea").length>1){var t=e.target;if("span"!==t.tagName.toLowerCase()&&"i"!==t.tagName.toLowerCase()&&"b"!==t.tagName.toLowerCase())if(""!==$("input#add-brief-label-box")[1].value||""!==$("textarea#add-brief-textarea")[1].value||$(".color-btns").hasClass("selectedColor"))$("#page-loading-spinner").show(),checkSaveBrief=!0,addBrief();else{if(addingBrief=!1,keepBriefPopoverVisible)"span"!==t.tagName.toLowerCase()&&(keepBriefPopoverVisible=!1);else{$("#"+selectedNoteId).popover("hide");for(var n=$('highlight[id^="note"]'),i=0;i<n.length;i++){var o=document.getElementById(n[i].id),a=document.createElement("span");a.innerHTML=o.innerHTML,a.normalize(),o.parentNode.replaceChild(a,o)}}"span"!==t.tagName.toLowerCase()&&(addBriefPopoverShown=!1),clickedInsidePcaseForAnnot=!1}}else closePopover();$("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show()}else if(highLightedTextClickFlag=!0,displayCommonAnnotationPopover&&($("#"+selectedNoteId).popover("hide"),displayCommonAnnotationPopover=!1,pCaseWithHeadingCitation=!1,pCaseWithHeadingOnly=!1,removeDummyTags()),updatingLink&&($("#"+selectedNoteId).popover("hide"),updatingLink=!1),linkIconId&&$("#"+linkIconId).popover("hide"),$(".ebook-fontsize").popover("hide"),$(".ebook-search").popover("hide"),$(".ereader-chapter-list").popover("hide"),$(".rTsIconPopover").popover("hide"),insideEreader&&$(document).popover("hide"),$("#note-save-confirmation-wrapper").remove(),highlightPopoverVisible=!0,displayCommonAnnotationPopover=!1,addingNote||updatingNote);else{var s,r="";window.getSelection?s=window.getSelection():void 0!==document.selection&&(s=document.selection),bodyRect=document.body.getBoundingClientRect();var l,d=s.anchorNode;if(void 0!==d)for(;!$(d.parentNode).hasClass("highlightedText");)void 0!==d.parentNode.id&&-1!=d.parentNode.id.indexOf("_")&&(r=d.parentNode.id,d.parentNode.id=d.parentNode.id.substring(0,d.parentNode.id.indexOf("_"))),d=d.parentNode;void 0!==d.parentNode.id&&-1!=d.parentNode.id.indexOf("_")?(r=d.parentNode.id,selectedNoteId=d.parentNode.id.substring(0,d.parentNode.id.indexOf("_")),indexedHighlight=!0):(selectedNoteId=d.parentNode.id,indexedHighlight=!1);for(var c=(l=null===document.getElementById(selectedNoteId)?document.getElementById(r):document.getElementById(selectedNoteId)).parentNode,h=l.parentNode;!$(c).hasClass("cc-section")&&null!==c;)c=c.parentNode;for(;!$(h).hasClass("cc-principal-case");){if(null===h){clickedInsidePcaseForAnnot=!1,insidePrincipalCase=!1;break}if($(h).hasClass("cc-principalCase-title")||$(h).hasClass("cc-principal-case-citation")){clickedInsidePcaseForAnnot=!1,insidePrincipalCase=!1;break}h=h.parentNode,clickedInsidePcaseForAnnot=!0,insidePrincipalCase=!0}if(null!==c?(annotationSectionId=c.id,c.getElementsByClassName("cc-section-title").length>0?annotationSectionTitle=removeTags(c.getElementsByClassName("cc-section-title")[0].innerHTML):annotationSectionTitle=""):(annotationSectionId="",annotationSectionTitle=""),selectedHighlightColor=d.parentNode.style.backgroundColor,changeHighlightImage(),null===document.getElementById(selectedNoteId)?element=document.getElementById(r):element=document.getElementById(selectedNoteId),rect=element.getBoundingClientRect(),yValue=rect.top,(m=$(".notesText")).length>0)for(var p=0;p<m.length;p++)m[p].id.substring(8,m[p].id.length)===selectedNoteId&&(updatingNote=!0);var u=$("span[id='"+selectedNoteId+"']"),g=$("highlight[id='"+selectedNoteId+"']");if(u&&u.length>0){if(h&&clickedInsidePcaseForAnnot){if(addedBriefFromAnnotation=!0,showAddBriefPopoverOnly(),$("textarea#add-brief-textarea").length>1){if(updatingNote=!1,addingBrief=!1,updatingBrief=!1,briefTextClickFlag=!1,addedBriefFromAnnotation=!0,addedBriefFromAnnotation&&selectedHighlightColor){colorCodeInput=selectedHighlightColor,convertRGBToHex(colorCodeInput);for(p=0;p<CaseConnect.preSetBriefLabelList.length;p++)CaseConnect.preSetBriefLabelList[p].colorCode===colorCodeInput&&(void 0!==CaseConnect.preSetBriefLabelList[p].labelName?$("input#add-brief-label-box")[1].value=CaseConnect.preSetBriefLabelList[p].labelName.replace(/&lt;/g,"<").replace(/&gt;/g,">"):$("input#add-brief-label-box")[1].value="")}var m=$(".notesText");for(p=0;p<m.length;p++)if(m[p].id.substring(8,m[p].id.length)===u[0].id){$("textarea#add-brief-textarea")[1].innerHTML=m[p].title,""===$("textarea#add-brief-textarea")[1].innerHTML?void 0!==$("button#color-blank-briefs")[1]&&$("button#color-blank-briefs")[1].setAttribute("disabled","disabled"):void 0!==$("button#color-blank-briefs")[1]&&$("button#color-blank-briefs")[1].removeAttribute("disabled"),$(".delete-btn").css("visibility","visible")[1];break}}}else showAddNotePopoverOnly();if($("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show(),$("textarea#add-note-textarea").length>1){m=$(".notesText");for(p=0;p<m.length;p++)if(m[p].id.substring(8,m[p].id.length)===u[0].id){$("textarea#add-note-textarea")[1].innerHTML=m[p].title,$(".delete-btn").css("visibility","visible")[1],void 0!==$("button#color-blank-notes")[1]&&$("button#color-blank-notes")[1].removeAttribute("disabled");break}}}else if(g&&g.length>0&&h&&clickedInsidePcaseForAnnot&&!addingBrief){if(h&&clickedInsidePcaseForAnnot&&(addedBriefFromAnnotation=!0,showAddBriefPopoverOnly(),$("textarea#add-brief-textarea").length>1)){if(updatingNote=!1,addingBrief=!1,updatingBrief=!1,briefTextClickFlag=!1,addedBriefFromAnnotation=!0,addedBriefFromAnnotation&&selectedHighlightColor){colorCodeInput=selectedHighlightColor,convertRGBToHex(colorCodeInput);for(p=0;p<CaseConnect.preSetBriefLabelList.length;p++)CaseConnect.preSetBriefLabelList[p].colorCode===colorCodeInput&&(void 0!==CaseConnect.preSetBriefLabelList[p].labelName?$("input#add-brief-label-box")[1].value=CaseConnect.preSetBriefLabelList[p].labelName.replace(/&lt;/g,"<").replace(/&gt;/g,">"):$("input#add-brief-label-box")[1].value="")}for(m=$(".notesText"),p=0;p<m.length;p++)if(m[p].id.substring(8,m[p].id.length)===u[0].id){$("textarea#add-brief-textarea")[1].innerHTML=m[p].title,""===$("textarea#add-brief-textarea")[1].innerHTML?void 0!==$("button#color-blank-briefs")[1]&&$("button#color-blank-briefs")[1].setAttribute("disabled","disabled"):void 0!==$("button#color-blank-briefs")[1]&&$("button#color-blank-briefs")[1].removeAttribute("disabled"),$(".delete-btn").css("visibility","visible")[1];break}}$("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show()}else h&&clickedInsidePcaseForAnnot&&!addingBrief?(showAddBriefPopoverOnly(),$("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show()):addingBrief||(showAddNotePopoverOnly(),$("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show())}}function highLightedTextOnEnter(e){if(13===e.keyCode){if(!0===highlightPopoverVisible)return $("#"+selectedNoteId).popover("hide"),highlightPopoverVisible=!1,void(updatingNote=!1);if(!0===addBriefPopoverShown&&($("#"+selectedNoteId).popover("hide"),addBriefPopoverShown=!1,updatingBrief=!1,clickedInsidePcaseForAnnot=!1,addedBriefFromAnnotation=!1),highLightedTextClickFlag=!0,displayCommonAnnotationPopover&&($("#"+selectedNoteId).popover("hide"),displayCommonAnnotationPopover=!1,pCaseWithHeadingCitation=!1,pCaseWithHeadingOnly=!1,removeDummyTags()),updatingLink&&($("#"+selectedNoteId).popover("hide"),updatingLink=!1),linkIconId&&$("#"+linkIconId).popover("hide"),$(".ebook-fontsize").popover("hide"),$(".ebook-search").popover("hide"),$(".ereader-chapter-list").popover("hide"),$(".rTsIconPopover").popover("hide"),insideEreader&&$(document).popover("hide"),$("#note-save-confirmation-wrapper").remove(),highlightPopoverVisible=!0,displayCommonAnnotationPopover=!1,addingNote||updatingNote);else{var t="",n=document.activeElement;if(-1!==n.className.indexOf("highlightedText"))-1!=n.id.indexOf("_")&&(t=n.id,n.id=n.id.substring(0,n.id.indexOf("_"))),n=n;else for(;!$(n.parentNode).hasClass("highlightedText");)-1!=n.parentNode.id.indexOf("_")&&(t=n.parentNode.id,n.parentNode.id=n.parentNode.id.substring(0,n.parentNode.id.indexOf("_"))),n=n.parentNode;-1!=n.id.indexOf("_")?(t=n.id,selectedNoteId=n.id.substring(0,n.id.indexOf("_")),indexedHighlight=!0):(selectedNoteId=n.id,indexedHighlight=!1);for(var i=(null===document.getElementById(selectedNoteId)?document.getElementById(t):document.getElementById(selectedNoteId)).parentNode;!$(i).hasClass("cc-section")&&null!==i;)i=i.parentNode;if(null!==i?(annotationSectionId=i.id,i.getElementsByClassName("cc-section-title").length>0?annotationSectionTitle=removeTags(i.getElementsByClassName("cc-section-title")[0].innerHTML):annotationSectionTitle=""):(annotationSectionId="",annotationSectionTitle=""),selectedHighlightColor=n.style.backgroundColor,changeHighlightImage(),null===document.getElementById(selectedNoteId)?element=document.getElementById(t):element=document.getElementById(selectedNoteId),rect=element.getBoundingClientRect(),yValue=rect.top,(s=$(".notesText")).length>0)for(var o=0;o<s.length;o++)s[o].id.substring(8,s[o].id.length)===selectedNoteId&&(updatingNote=!0);var a=$("span[id='"+selectedNoteId+"']");if(a&&a.length>0){if(showAddNotePopoverOnly(),$("textarea#add-note-textarea").length>1){var s=$(".notesText");for(o=0;o<s.length;o++)if(s[o].id.substring(8,s[o].id.length)===a[0].id){$("textarea#add-note-textarea")[1].innerHTML=s[o].title,$(".delete-btn").css("visibility","visible")[1],void 0!==$("button#color-blank-notes")[1]&&$("button#color-blank-notes")[1].removeAttribute("disabled");break}}}else showAddNotePopoverOnly();$("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show()}}}function colorBtnPressed(e,t){if(labelListIsClicked=!1,$("#brief-label-list ").css("display","none"),$("#brief-label-list li").css("display","none"),highLightColor=t,displayCommonAnnotationPopover&&(colorCodeInput=t),saveUserSettingForAnnotations(),insidePrincipalCase&&!pCaseWithHeadingCitation){var n=e.currentTarget.getAttribute("briefLabel"),i=e.currentTarget.getAttribute("colorcode");if(null===i&&(i=t),$(".highlight-color-yellow").removeClass("change-yellow-color selectedColor"),$(".highlight-color-green").removeClass("change-green-color selectedColor"),$(".highlight-color-blue").removeClass("change-blue-color selectedColor"),$(".highlight-color-pink").removeClass("change-pink-color selectedColor"),$(".highlight-color-orange").removeClass("change-orange-color selectedColor"),$(".highlight-color-purple").removeClass("change-purple-color selectedColor"),$(".save-brief-icon").css("visibility","visible")[1],updateBriefColorPallet(i),!displayCommonAnnotationPopover)return $("input#add-brief-label-box")[1].value=null!==n&&""!==n?n.replace(/&lt;/g,"<").replace(/&gt;/g,">"):"",colorCodeInput=i,void(briefTextClickFlag&&(updatingBrief=!0,addedBriefFromAnnotation=!1));null!==n&&""!==n?(briefLabelFromCommonPopover=n,colorCodeInput=i,checkSaveBrief=!0,addBrief()):(briefLabelFromCommonPopover="",colorCodeInput=i,checkSaveBrief=!0,addBrief())}else addingNote?0===selectedNoteId.indexOf("note")?""===$("textarea#add-note-textarea")[1].value?(selectedHighlightColor=t,changeHighlightImage(),$(".color-btns").hasClass("selectedColor")?(checkSaveHighlight=!0,saveHighlights()):(addingNote=!1,updatingNote=!1,highlightPopoverVisible=!1,displayCommonAnnotationPopover=!1,pCaseWithHeadingCitation=!1,pCaseWithHeadingOnly=!1,alreadyCalled=!1,$("#"+selectedNoteId).popover("hide"),$("#"+selectedNoteId).focus(),removeDummyTags())):(checkSaveHighlight=!0,saveHighlights()):""===$("textarea#add-note-textarea")[1].value?(selectedHighlightColor=t,changeHighlightImage(),$(".color-btns").hasClass("selectedColor")?(updateHighlightCalledFromPallets=!0,updateHighlight()):(addingNote=!1,updatingNote=!1,highlightPopoverVisible=!1,displayCommonAnnotationPopover=!1,pCaseWithHeadingCitation=!1,pCaseWithHeadingOnly=!1,alreadyCalled=!1,$("#"+selectedNoteId).popover("hide"),$("#"+selectedNoteId).focus(),removeDummyTags())):(selectedHighlightColor=t,updateHighlightCalledFromPallets=!0,updateHighlight()):highlightPalletsVisibleOnly?(0===selectedNoteId.indexOf("note")?(addingNote=!1,updatingNote=!1,displayCommonAnnotationPopover=!1,highlightPaletteOnly=!0,checkSaveHighlight=!0,saveHighlights()):(selectedHighlightColor=t,updateHighlightCalledFromPallets=!0,updateHighlight()),highlightPalletsVisibleOnly=!1):(selectedHighlightColor=t,updateHighlightCalledFromPallets=!0,updateHighlight())}function convertHexToRGB(e){return"#ede48c"===e?"rgb(237, 228, 140)":"#b5eb97"===e?"rgb(181, 235, 151)":"#ffd4a8"===e?"rgb(255, 212, 168)":"#aee6fe"===e?"rgb(174, 230, 254)":"#fec0ff"===e?"rgb(254, 192, 255)":"rgb(203, 190, 252)"}function convertRGBToHex(e){return"rgb(237, 228, 140)"===e?colorCodeInput="#ede48c":"rgb(181, 235, 151)"===e?colorCodeInput="#b5eb97":"rgb(255, 212, 168)"===e?colorCodeInput="#ffd4a8":"rgb(174, 230, 254)"===e?colorCodeInput="#aee6fe":"rgb(254, 192, 255)"===e?colorCodeInput="#fec0ff":"rgb(203, 190, 252)"===e?colorCodeInput="#cbbefc":void 0}function deleteHighlight(){updatingNote=!1,deleteCurrentHighlight(),closePopover(),"Android"==CaseConnect.deviceOS&&$("#notes-container").trigger("click")}function showPopoverAgain(){if(insidePrincipalCase){if(clickedInsidePcaseForAnnot){if(changeHighlightImage(),element=document.getElementById(selectedNoteId),rect=element.getBoundingClientRect(),yValue=rect.top,(t=$(".notesText")).length>0)for(var e=0;e<t.length;e++)t[e].id.substring(8,t[e].id.length)===selectedNoteId&&(addingBrief=!0);if((n=$("span[id='"+selectedNoteId+"']"))&&n.length>0&&(showAddBriefPopoverOnly(),$("textarea#add-brief-textarea").length>1)){var t=$(".notesText");for(e=0;e<t.length;e++)if(t[e].id.substring(8,t[e].id.length)===n[0].id){$("textarea#add-note-textarea")[1].innerHTML=t[e].title,$(".delete-btn").css("visibility","visible")[1];break}}}}else{var n;if(changeHighlightImage(),element=document.getElementById(selectedNoteId),rect=element.getBoundingClientRect(),yValue=rect.top,(t=$(".notesText")).length>0)for(e=0;e<t.length;e++)t[e].id.substring(8,t[e].id.length)===selectedNoteId&&(updatingNote=!0);if((n=$("span[id='"+selectedNoteId+"']"))&&n.length>0&&(showAddNotePopoverOnly(),$("textarea#add-note-textarea").length>1))for(t=$(".notesText"),e=0;e<t.length;e++)if(t[e].id.substring(8,t[e].id.length)===n[0].id){$("textarea#add-note-textarea")[1].innerHTML=t[e].title,$(".delete-btn").css("visibility","visible")[1];break}}$("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show()}function highlightPopoverDisplay(e){changeHighlightImage(),$("#"+e).popover({html:!0,placement:"auto bottom",container:"body",template:'<div class="popover ebook-custom-popover highlight-popover"><div class="arrow popover-arrow"></div><div class="popover-content note-popover-content popover-without-padding"></div></div>',content:function(){return $("#popover-change-color-content").html()}})}function initialiseKeyUpForNotePopover(){$(".notes-textarea").keyup(function(){var e=$("textarea#add-note-textarea")[1].value;""!==e?$(".save-note-icon").css("visibility","visible")[1]:""===e&&$(".save-note-icon").css("visibility","hidden")[1]}),$(".notes-textarea").on("onblur",function(){"Android"===CaseConnect.deviceOS&&"Chrome"===CaseConnect.browserName&&(document.querySelector('meta[name="viewport"]').content="width=device-width, initial-scale=1")}),$(".notes-textarea").on("paste",function(){setTimeout(function(){var e=$(".notes-textarea")[1].value;""===e?$(".save-note-icon").css("visibility","hidden")[1]:""!=e&&$(".save-note-icon").css("visibility","visible")[1]},0)})}function closePopover(){(insideEreader||insideCasesPage)&&(addingNote?0===selectedNoteId.indexOf("note")?""===$("textarea#add-note-textarea")[1].value?(addingNote=!1,updatingNote=!1,highlightPopoverVisible=!1,displayCommonAnnotationPopover=!1,alreadyCalled=!1,$("#"+selectedNoteId).popover("hide"),$("#"+selectedNoteId).focus(),removeDummyTags()):(checkSaveHighlight=!0,saveHighlights()):$("textarea#add-note-textarea").length>1?""===$("textarea#add-note-textarea")[1].value?(addNotePopoverHighlight(),addingNote=!1,$("#"+selectedNoteId).popover("hide"),highlightPopoverVisible=!1,alreadyCalled=!1):(checkSaveNote=!0,addNotes()):(addingNote=!1,$("#"+selectedNoteId).popover("hide"),highlightPopoverVisible=!1,alreadyCalled=!1):updatingNote?$("textarea#add-note-textarea").length>1?""===$("textarea#add-note-textarea")[1].value?(updatingNote=!1,deleteNotes()):updateNotes():(updatingNote=!1,alertMessageModalAppears||(deleteNotes(),alertMessageModalAppears=!1)):addingLink?0===selectedNoteId.indexOf("note")?void 0!==$("input#add-link-url")[1]?""===$("input#add-link-url")[1].value?(addingLink=!1,updatingLink=!1,displayCommonAnnotationPopover=!1,pCaseWithHeadingCitation=!1,pCaseWithHeadingOnly=!1,$("#"+selectedNoteId).popover("hide"),removeDummyTags()):saveCreatedLink():void 0!==$("input#add-link-url")[0]&&(""===$("input#add-link-url")[0].value?(addingLink=!1,updatingLink=!1,displayCommonAnnotationPopover=!1,pCaseWithHeadingCitation=!1,pCaseWithHeadingOnly=!1,$("#"+selectedNoteId).popover("hide"),removeDummyTags()):saveCreatedLink()):$("input#add-link-url").length>1?""===$("input#add-link-url")[1].value?(addNotePopoverHighlight(),addingLink=!1,$("#"+selectedNoteId).popover("hide"),alreadyCalled=!1):saveCreatedLink():(addingLink=!1,$("#"+selectedNoteId).popover("hide"),alreadyCalled=!1):updatingLink?$("input#add-link-url").length>1?""===$("input#add-link-url")[1].value?(updatingLink=!1,deleteLink()):updateLink():(updatingLink=!1,alertMessageModalAppears||(deleteLink(),alertMessageModalAppears=!1)):addingBrief?0===selectedNoteId.indexOf("note")?void 0===$("input#add-brief-label-box")[1]||""!==$("input#add-brief-label-box")[1].value||void 0==="textarea#add-brief-textarea"[1]||""!==$("textarea#add-brief-textarea")[1].value||$(".color-btns").hasClass("selectedColor")?(checkSaveBrief=!0,addBrief()):(addingBrief=!1,updatingBrief=!1,displayCommonAnnotationPopover=!1,pCaseWithHeadingCitation=!1,pCaseWithHeadingOnly=!1,$("#"+selectedNoteId).popover("hide"),addBriefPopoverShown=!1,clickedInsidePcaseForAnnot=!1,addedBriefFromAnnotation=!1,removeDummyTags()):$("input#add-brief-label-box").length>1||$("textarea#add-brief-textarea").length>1?""!==$("input#add-brief-label-box")[1].value||""!==$("textarea#add-brief-textarea")[1].value||$(".color-btns").hasClass("selectedColor")?(checkSaveBrief=!0,addBrief()):(addNotePopoverHighlight(),addingBrief=!1,$("#"+selectedNoteId).popover("hide"),addBriefPopoverShown=!1,clickedInsidePcaseForAnnot=!1,alreadyCalled=!1,addedBriefFromAnnotation=!1):(addingBrief=!1,$("#"+selectedNoteId).popover("hide"),addBriefPopoverShown=!1,alreadyCalled=!1):updatingBrief&&!addedBriefFromAnnotation?$("input#add-brief-label-box").length>1||$("textarea#add-brief-textarea").length>1?""!==$("input#add-brief-label-box")[1].value||""!==$("textarea#add-brief-textarea")[1].value||$(".color-btns").hasClass("selectedColor")?updateBrief():(updatingBrief=!1,$("#"+selectedNoteId).popover("hide")):(updatingBrief=!1,alertMessageModalAppears||($("#"+selectedNoteId).popover("hide"),alertMessageModalAppears=!1)):addedBriefFromAnnotation?migrateChapterHighlightsSingle():($("#"+selectedNoteId).popover("hide"),highlightPopoverVisible=!1,addBriefPopoverShown=!1,clickedInsidePcaseForAnnot=!1,alreadyCalled=!1,linkIconId&&$("#"+linkIconId).popover("hide"),"note0"===selectedNoteId&&removeDummyTags()))}function updatePageNoAndChapterName(){if(makingSpaceForpopoverToBeDisplayed)makingSpaceForpopoverToBeDisplayed=!1;else{if(alreadyCalled||(alreadyCalled=!0,displayCommonAnnotationPopover=!1,pCaseWithHeadingCitation=!1,pCaseWithHeadingOnly=!1,closePopover()),bookChapterSupplimentList||getChapterAndSupplementalList(),$(".rTsIconPopover").popover("hide"),$(document).popover("hide"),-1===CaseConnect.currentPageHtmlLocation.indexOf("toc")){for(var e=document.getElementsByClassName("cc-section-title"),t=document.getElementsByClassName("cc-pagenum-begin"),n=null,i=0;i<e.length;i++){if((o=$(".cc-section-title")[i].getBoundingClientRect().top-70+window.pageYOffset-topOffset)>0){if(0===i){for(n=$(".cc-section-title")[i];!$(n).hasClass("cc-section");)n=n.parentNode;currentSectionId=n.id,currentSectionTitle!==e[i].textContent&&(currentSectionTitle=removeTags(e[i].textContent)),currentSectionIndex=-1}else{for($(".ereader-section-title").html(removeTags(e[i-1].textContent)),currentSectionIndex=i-1,n=$(".cc-section-title")[i-1];!$(n).hasClass("cc-section");)n=n.parentNode;currentSectionId=n.id,currentSectionTitle!==e[i-1].textContent&&(currentSectionTitle=e[i-1].textContent)}break}if(i===e.length-1&&o<0){for($(".ereader-section-title").html(removeTags(e[i].textContent)),n=$(".cc-section-title")[i];!$(n).hasClass("cc-section");)n=n.parentNode;currentSectionId=n.id,currentSectionTitle!==e[i].textContent&&(currentSectionTitle=e[i].textContent),currentSectionIndex=i}}CaseConnect.currentSectionId=currentSectionId;for(i=0;i<t.length;i++){var o;if((o=document.getElementById(t[i].id).getBoundingClientRect().top-70+window.pageYOffset-topOffset)>0){0===i?(CaseConnect.currentPageNumber!==t[i].title&&(CaseConnect.currentPageNumber=t[i].title,saveActivityTimer&&clearTimeout(saveActivityTimer),saveActivityTimer=setTimeout(function(){saveUserLastActivity()},2e3)),$(".ereader-page-number").html(CaseConnect.currentPageNumber)):(t[i-1].title!==CaseConnect.currentPageNumber&&(CaseConnect.currentPageNumber=t[i-1].title,saveActivityTimer&&clearTimeout(saveActivityTimer),saveActivityTimer=setTimeout(function(){saveUserLastActivity()},2e3)),$(".ereader-page-number").html(CaseConnect.currentPageNumber));break}i===t.length-1&&o<0&&(CaseConnect.currentPageNumber!==t[i].title&&(CaseConnect.currentPageNumber=t[i].title,saveActivityTimer&&clearTimeout(saveActivityTimer),saveActivityTimer=setTimeout(function(){saveUserLastActivity()},2e3)),$(".ereader-page-number").html(CaseConnect.currentPageNumber))}$("#txtPageNum").val(CaseConnect.currentPageNumber),$("#txtPageNumMobile").val(CaseConnect.currentPageNumber)}else $("#txtPageNum").val(CaseConnect.currentPageNumber),$("#txtPageNumMobile").val(CaseConnect.currentPageNumber);var a=null,s=null;-1===CaseConnect.currentPageNumber.indexOf("C-")&&-1===CaseConnect.currentPageNumber.indexOf("c-")||(a=parseInt(CaseConnect.currentPageNumber.slice("2")),s=parseInt(CaseConnect.currentChapterEndPageNumber.slice("2")));var r=document.getElementById("ereader-scroller");if((-999!==parseInt(CaseConnect.nextChapterStartPageNumber)&&(CaseConnect.currentPageNumber===CaseConnect.currentChapterEndPageNumber||parseInt(CaseConnect.currentPageNumber)-1===parseInt(CaseConnect.currentChapterEndPageNumber)||parseInt(CaseConnect.currentPageNumber)+1===parseInt(CaseConnect.currentChapterEndPageNumber))||-999!==parseInt(CaseConnect.nextChapterStartPageNumber)&&null!==a&&(a===s||a-1===s||a+1===s)||$(r).scrollTop()+$(r).innerHeight()>=$(r)[0].scrollHeight)&&CaseConnect.currentChapterId!==bookChapterSupplimentList[bookChapterSupplimentList.length-1].chapterId){$(".next-chapter-footer").show();var l=$(window).height();$("#media-elements-column").height($(".ereader-content").height()+31);var d=$(window).width(),c=$("#ereader").height()+$(".ereader-green-block").height()+1;if(d<768){var h=$("#next-chapter-footer").height();heightWithHeader=c+parseInt(h),$("#next-chapter-footer").css({"padding-left":"0px","padding-right":"0px"})}else heightWithHeader=$("#header-wrapper").height()+$(".ereader-green-block").height()+1+$("#next-chapter-footer").height()+$(".content-top-menu").height()+1;"block"===$("#email-notification").css("display")?heightWithHeader+=$("#email-notification").height():heightWithHeader=heightWithHeader;heightWithHeader,$(".app-left-navigation").height(),$(".content-top-menu").height();$(".ereader-scroll-container").css("max-height",l-heightWithHeader),$(".ereader-scroll-container").css("height",l-heightWithHeader),navigator.userAgent.match(/(iPad|Android|iPhone)/)&&($(".ereader-scroll-container").css("height",l-heightWithHeader),$(".ereader-scroll-container").css("max-height",l-heightWithHeader));var p=0;p=($("#ereader-scroller").height()+$(".content-top-menu").height()+1).toString()+"px",$(".app-left-navigation").css("min-height",p)}else{$(".next-chapter-footer").hide();l=$(window).height();$("#media-elements-column").height($(".ereader-content").height()+31);d=$(window).width(),c=$("#ereader").height()+$(".ereader-green-block").height()+1;heightWithHeader=d<768?c:$("#header-wrapper").height()+$(".ereader-green-block").height()+1+$(".content-top-menu").height()+1,"block"===$("#email-notification").css("display")?heightWithHeader+=$("#email-notification").height():heightWithHeader=heightWithHeader;heightWithHeader,$(".app-left-navigation").height(),$(".content-top-menu").height();$(".ereader-scroll-container").css("max-height",l-heightWithHeader),$(".ereader-scroll-container").css("height",l-heightWithHeader),navigator.userAgent.match(/(iPad|Android|iPhone)/)&&($(".ereader-scroll-container").css("height",l-heightWithHeader),$(".ereader-scroll-container").css("max-height",l-heightWithHeader));p=0;p=($("#ereader-scroller").height()+$(".content-top-menu").height()+1).toString()+"px",$(".app-left-navigation").css("min-height",p)}}}function goBackToPreviousSection(){if(0===currentSectionIndex)(n=document.getElementById("ereader-scroller")).scrollTop=1;else if(-1===currentSectionIndex)alertMessagesModal(exceptionMsg.topMostSection);else{for(var e=document.getElementsByClassName("cc-section-title"),t=e[currentSectionIndex];!$(t).hasClass("cc-section");)t=t.parentNode;var n,i=document.getElementById(t.id);if((n=document.getElementById("ereader-scroller")).scrollTop<=i.offsetTop)if(0===currentSectionIndex)n.scrollTop=1;else{for(t=e[currentSectionIndex-1];!$(t).hasClass("cc-section");)t=t.parentNode;i=document.getElementById(t.id);currentSectionIndex-=1}n.scrollTop=i.offsetTop,updatePageNoAndChapterName()}}function changeFontSize(e){currentFontId=e,calculateFontSizeAndLineHeight(currentFontId),"ereader-textsize-default"===(e="ereader-"+e)?$(".ereader-content").removeAttr("id"):($(".ereader-content").removeAttr("id"),$(".ereader-content").attr("id",e)),reCalculateNotesOnRight(),reCalculateBriefOnRight(),reCalculateLinkOnLeft(),reCalculateRtSOnLeft()}function saveUserLastActivity(){var e={userVO:{userId:CaseConnect.currentUserId,userRole:CaseConnect.currentUserRole,userRoleId:CaseConnect.currentUserRoleId,userActivityVO:{lastActivityCode:"EREADER_READING_BOOK",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}};$.ajax({url:properties[properties.env]+"/activityTrackingService/saveUserLastActivity",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken)},function(e){sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function deromanize(e){var t,n=/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,i={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},o=0;if(!(e=e.toUpperCase())||!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return!1;for(;t=n.exec(e);)o+=i[t[0]];return o}function toRoman(e){for(var t="",n=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],i=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],o=0;o<=n.length;o++)for(;e%n[o]<e;)t+=i[o],e-=n[o];return t}function txtPageNumKeyDown(e){if(e.shiftKey)e.shiftKey&&9==e.keyCode||e.shiftKey&&67==e.keyCode||e.preventDefault();else{var t=e.keyCode,n=e.target.value;if(13==t){$("#"+selectedNoteId).popover("hide");var i=new RegExp("^(m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})|[idcxmlv])$"),o=new RegExp("^(M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})|[IDCXMLV])$");if(i.test(n)||o.test(n))if(deromanize(n)<50){if("block"===$(".ereader-sub-header-mobile").css("display")?currentPageNumb=$("#txtPageNumMobile").val():currentPageNumb=$("#txtPageNum").val(),gotoPageFnCald=!0,"block"===$(".ereader-sub-header-mobile").css("display"))var a=$("#txtPageNumMobile").val();else a=$("#txtPageNum").val();CaseConnect.goToPageTop="",handleGotoPage(a)}else alertMessagesModal(exceptionMsg.invalidPageNo);else if($(".ereader-sub-header-total-pages").html()&&parseInt(e.target.value)<=parseInt($(".ereader-sub-header-total-pages").html())||$(".ereader-sub-header-total-pages").html()&&(-1!==e.target.value.indexOf("C-")||-1!==e.target.value.indexOf("c-"))){if("block"===$(".ereader-sub-header-mobile").css("display")){a=$("#txtPageNumMobile").val();currentPageNumb=$("#txtPageNumMobile").val()}else{a=$("#txtPageNum").val();currentPageNumb=$("#txtPageNum").val()}gotoPageFnCald=!0,CaseConnect.goToPageTop="",handleGotoPage(a),e.preventDefault()}else alertMessagesModal(exceptionMsg.invalidPageNo);$(".ebook-search").popover("hide"),$(".ereader-chapter-list").popover("hide"),$("#ebook-toc").popover("hide"),$("#ebook-toc-mobile").popover("hide"),loadingAnnotationsFromTOC=!0,$(".ebook-fontsize").popover("hide"),$(".rTsIconPopover").popover("hide"),$(document).popover("hide")}else{if("Android"===CaseConnect.deviceOS)return;if(8==t||9==t)return;if(t<95){if(t<48&&e.preventDefault(),t>57){if(73==t||86==t||88==t||76==t||67==t||68==t||77==t)return;e.preventDefault()}}else if(t<96||t>105){if(-1!==CaseConnect.browserName.indexOf("Chrome")){if(189==t)return;e.preventDefault()}if(173==t||189==t)return;e.preventDefault()}}}}function showNotesHiglightpopover(e){var t;for($("#ereader-menu-popover-content div.notes-highlights-popover-content").html('<div id="notesSpinner" style="left:45px; position:absolute; display: none;"><img src="img/loading-spinner.gif" alt="Loading"/></div>'),fetchingAnnotationsForListing=!0,annotationListingChapterId=CaseConnect.currentChapterId,$("#notesSpinner").show(),$("button#nextChapterAnnotationArrow").css("visibility","visible "),$("button#previousChapterAnnotationArrow").css("visibility","visible"),$("button#previousChapterAnnotationArrow").attr("disabled",!0),$("button#nextChapterAnnotationArrow").attr("disabled",!0),t=0;t<bookAnnotateFileList.length;t++)if(bookAnnotateFileList[t].chapterId===annotationListingChapterId){t===bookAnnotateFileList.length-1?($("button#nextChapterAnnotationArrow").css("visibility","hidden"),$("button#nextChapterAnnotationArrow").attr("disabled","disabled")):($("button#nextChapterAnnotationArrow").css("visibility","visible "),$("button#nextChapterAnnotationArrow").removeAttr("disabled")),0===t?($("button#previousChapterAnnotationArrow").css("visibility","hidden"),$("button#previousChapterAnnotationArrow").attr("disabled","disabled")):($("button#previousChapterAnnotationArrow").css("visibility","visible"),$("button#previousChapterAnnotationArrow").removeAttr("disabled")),$("#annotationListChapterName")[0].innerHTML=bookAnnotateFileList[t].navbarTitle,$(".annotationListChapterName").html(bookAnnotateFileList[t].navbarTitle),$(".annotationListChapterName").attr("aria-label",bookAnnotateFileList[t].navbarTitle),$("#annotationListChapterName")[0].setAttribute("aria-label",bookAnnotateFileList[t].navbarTitle);break}fetchAnnotations(annotationListingChapterId),$("#ebook-toc").on("shown.bs.popover",function(){if("block"==$("#email-notification").css("display")){var e=$(".email-notification").height();$(".ereader-menu-popover-desktop").css("margin-top",e+10)}else"none"==$("#email-notification").css("display")&&$(".ereader-menu-popover-desktop").css("margin-top","10px")}),$("#ebook-toc-mobile").on("shown.bs.popover",function(){if(document.addEventListener("focus",function(e){var t=document.getElementsByClassName("ereader-menu-popover-mobile")[0];null!=t&&(t.contains(e.target)||(e.stopPropagation(),t.focus()))},!0),"block"==$("#email-notification").css("display")){var e=$(".email-notification").height();$(".ereader-menu-popover-desktop").css("margin-top",e+10)}else"none"==$("#email-notification").css("display")&&$(".ereader-menu-popover-desktop").css("margin-top","10px")}),focusNavInEreader=!0}function noteTextClicked(e){if("visible"!==$("#highlight-popover-notes").css("visibility")){$(".ebook-fontsize").popover("hide"),linkIconId&&$("#"+linkIconId).popover("hide"),displayCommonAnnotationPopover&&($("#"+selectedNoteId).popover("hide"),displayCommonAnnotationPopover=!1,pCaseWithHeadingCitation=!1,pCaseWithHeadingOnly=!1,removeDummyTags()),$(".ebook-search").popover("hide"),$(".rTsIconPopover").popover("hide"),$(document).popover("hide"),$(".ereader-chapter-list").popover("hide"),selectedNoteId=e.currentTarget.id,selectedNoteId=selectedNoteId.substring(13,selectedNoteId.length);for(var t=document.getElementById(selectedNoteId),n=t.parentNode,i=t.parentNode;!$(n).hasClass("cc-section")&&null!==n;)n=n.parentNode;for(;!$(i).hasClass("cc-principal-case");){if(null===i){clickedInsidePcaseForAnnot=!1,insidePrincipalCase=!1;break}if($(i).hasClass("cc-principalCase-title")||$(i).hasClass("cc-principal-case-citation")){clickedInsidePcaseForAnnot=!1,insidePrincipalCase=!1;break}i=i.parentNode,clickedInsidePcaseForAnnot=!0,insidePrincipalCase=!0}if(null!==n?(annotationSectionId=n.id,n.getElementsByClassName("cc-section-title").length>0?annotationSectionTitle=removeTags(n.getElementsByClassName("cc-section-title")[0].innerHTML):annotationSectionTitle=""):(annotationSectionId="",annotationSectionTitle=""),selectedHighlightColor=e.currentTarget.childNodes[0].style.backgroundColor,changeHighlightImage(),element=document.getElementById(selectedNoteId),rect=element.getBoundingClientRect(),yValue=rect.top,(s=$(".notesText")).length>0)for(var o=0;o<s.length;o++)s[o].id.substring(8,s[o].id.length)===selectedNoteId&&(updatingNote=!0);var a=$("span[id='"+selectedNoteId+"']");if(a&&a.length>0){if(i&&clickedInsidePcaseForAnnot){if(addedBriefFromAnnotation=!0,selectedHighlightColor=e.currentTarget.childNodes[0].style.backgroundColor,showAddBriefPopoverOnly(),$("textarea#add-brief-textarea").length>1){if(updatingNote=!1,addingBrief=!1,updatingBrief=!1,briefTextClickFlag=!1,addedBriefFromAnnotation=!0,addedBriefFromAnnotation&&selectedHighlightColor){colorCodeInput=selectedHighlightColor,convertRGBToHex(colorCodeInput);for(o=0;o<CaseConnect.preSetBriefLabelList.length;o++)CaseConnect.preSetBriefLabelList[o].colorCode===colorCodeInput&&(void 0!==CaseConnect.preSetBriefLabelList[o].labelName?$("input#add-brief-label-box")[1].value=CaseConnect.preSetBriefLabelList[o].labelName.replace(/&lt;/g,"<").replace(/&gt;/g,">"):$("input#add-brief-label-box")[1].value="")}var s=$(".notesText");for(o=0;o<s.length;o++)if(s[o].id.substring(8,s[o].id.length)===a[0].id){$("textarea#add-brief-textarea")[1].innerHTML=s[o].title,""===$("textarea#add-brief-textarea")[1].innerHTML?void 0!==$("button#color-blank-briefs")[1]&&$("button#color-blank-briefs")[1].setAttribute("disabled","disabled"):void 0!==$("button#color-blank-briefs")[1]&&$("button#color-blank-briefs")[1].removeAttribute("disabled"),$(".delete-btn").css("visibility","visible")[1];break}}}else showAddNotePopoverOnly(),$("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show();if($("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show(),$("textarea#add-note-textarea").length>1)for(s=$(".notesText"),o=0;o<s.length;o++)if(s[o].id.substring(8,s[o].id.length)===a[0].id){$("textarea#add-note-textarea")[1].innerHTML=s[o].title,""===$("textarea#add-note-textarea")[1].innerHTML?void 0!==$("button#color-blank-notes")[1]&&$("button#color-blank-notes")[1].setAttribute("disabled","disabled"):void 0!==$("button#color-blank-notes")[1]&&$("button#color-blank-notes")[1].removeAttribute("disabled"),$(".delete-btn").css("visibility","visible")[1];break}}else $("#"+selectedNoteId).popover("hide"),showAddNotePopoverOnly();noteTextClick=!0,$("button.copy-clipboard-true.copy-clip-button").show(),$("input.zero-clipboard-true.copy-clip-button").show()}}function reCalculateNotesOnRight(){var e,t,n,i;$(".highlightedText").each(function(){1===$("#notesDiv"+this.id).length&&($("#page-loading-spinner").show(),t=this.id,e=$("#notesDiv"+this.id).attr("title"),n=document.getElementById(this.id).getBoundingClientRect().top,i=$("#"+this.id).css("background-color"),$("#anchorElement"+this.id).remove(),displayNotesOnRight(e,t,n,i),$("#page-loading-spinner").hide())})}function displayNotesOnRight(e,t,n,i){$("#page-loading-spinner").show(),$("#anchorElement"+t)&&$("#anchorElement"+t).remove();$(".ereader-content").css("line-height");if(insideEreader)var o=document.getElementById("notes-container").getBoundingClientRect().top;if(insideCasesPage)o=document.getElementsByClassName("case-note-container")[0].getBoundingClientRect().top;var a=document.createElement("A");a.id="anchorElement"+t,a.setAttribute("onclick","noteTextClicked(event)"),a.setAttribute("href","#"),a.setAttribute("aria-label",e),a.style.color="#333333";var s=document.createElement("div");s.id="notesDiv"+t;var r=1,l=300;l=null!==localStorage.getItem("annotationListForChapter")?localStorage.getItem("annotationListForChapter").split(",").length:1e3,r=l<50?1:l>50&&l<150?800:1e3,insideCasesPage?e.length>50&&e.split(" ").length<5||e.length>40&&e.split(" ")[0].length>20||e.length>25&&e.split(" ")[0].length>20?(s.className="notesText overlapCheckClass hidden-xs hidden-md hidden-lg visible-sm ellipsis",s.style.width=$("#notes-container").width()+"px"):s.className="notesText overlapCheckClass hidden-xs hidden-md hidden-lg visible-sm":e.length>50&&e.split(" ").length<5||e.length>40&&e.split(" ")[0].length>20||e.length>25&&e.split(" ")[0].length>20?(s.className="notesText overlapCheckClass hidden-xs ellipsis",s.style.width=$("#notes-container").width()+"px"):s.className="notesText overlapCheckClass hidden-xs",s.style.top=n-o-2+"px",s.innerHTML=e,s.title=e;var d=document.createElement("span");d.id=t,d.className="notesSpanBlock",d.setAttribute("style","background-color:"+i+" !important; top:"+(n-o)+"px;");setTimeout(function(){if($(window).width()<768)var n=$(".notesSpanBlock");else n=$(".notesText");setTimeout(function(){n.sort(function(e,t){return e.style.top>t.style.top?1:e.style.top<t.style.top?-1:0})},r);var i=0,o=0;if(setTimeout(function(){for(C=0;C<n.length;C++)o=n[C].offsetHeight+5,parseInt(n[C].style.top)==parseInt(s.style.top)?(i=parseInt(n[C].style.top),s.style.top=parseInt(n[C].style.top)-2+o+"px",d.style.top=parseInt(n[C].style.top)+o+"px",a.top=parseInt(n[C].style.top)+o+"px"):parseInt(n[C].style.top)<parseInt(s.style.top)+o&&parseInt(n[C].style.top)>parseInt(s.style.top)-o&&parseInt(n[C].style.top)>i&&(i=parseInt(n[C].style.top),s.style.top=parseInt(n[C].style.top)-2+o+"px",d.style.top=parseInt(n[C].style.top)+o+"px",a.top=parseInt(n[C].style.top)+o+"px");closePrintClicked&&$("#page-loading-spinner").hide()},r),a.appendChild(d),a.appendChild(s),insideEreader&&document.getElementById("notes-container").appendChild(a),insideCasesPage&&""!==e&&document.getElementsByClassName("case-note-container")[0].appendChild(a),null!==document.getElementById("notesDiv"+t)){var l=document.getElementById("notesDiv"+t).getBoundingClientRect(),c=null;for(o=0,C=0;C<n.length;C++)o=n[C].offsetHeight+5,c=document.getElementById(n[C].id).getBoundingClientRect(),l.right<c.left||l.left>c.right||l.bottom<c.top||l.top>c.bottom||(c.top<l.top?l.top-c.top-10<parseInt($("#"+n[C].id).css("line-height"))?document.getElementById(n[C].id).innerHTML.length>1&&$clamp(document.getElementById(n[C].id),{clamp:1}):document.getElementById(n[C].id).innerHTML.length>1&&$clamp(document.getElementById(n[C].id),{clamp:2}):c.top-l.top-10<parseInt($("#"+n[C].id).css("line-height"))?document.getElementById(n[C].id).innerHTML.length>1&&$clamp(document.getElementById(n[C].id),{clamp:1}):document.getElementById(n[C].id).innerHTML.length>1&&$clamp(document.getElementById(n[C].id),{clamp:2}));if(void 0!==localStorage.getItem("addNoteStartParaId")&&""!==localStorage.getItem("addNoteStartParaId")&&null!==localStorage.getItem("addNoteStartParaId")){var h=localStorage.getItem("addNoteStartParaId");if(localStorage.setItem("addNoteStartParaId",""),""!==h){var p=$("#"+h).find("highlight"),u="",g=0,m=0,b=1,f=parseInt($("#notesDiv"+t).css("line-height"));if(p.length>1){for(var C=1;C<p.length;C++)if(-1===p[C].id.indexOf("_")){u=p[C].id;break}""!==u&&($("#"+u),1)&&($("#"+u).offset(),g=$("#"+u).offset().top,(m=$("#"+t).offset().top)+$("#notesDiv"+t).height()>g&&(parseInt($("#"+t).attr("startOffset"))<parseInt($("#"+u).attr("startOffset"))&&(g-m>2*f?b=2:g-m>f&&(b=1),$("#notesDiv"+t).html().length>10&&$clamp(document.getElementById("notesDiv"+t),{clamp:b})),localStorage.setItem("addNoteStartParaId","")))}else if(localStorage.setItem("addNoteStartParaId",""),void 0!==localStorage.getItem("addNoteNextParaId")&&""!==localStorage.getItem("addNoteNextParaId")&&null!==localStorage.getItem("addNoteNextParaId")){var v=localStorage.getItem("addNoteNextParaId");if(localStorage.setItem("addNoteNextParaId",""),""!==v){p=$("#"+v).find("highlight"),u="",g=0,m=0,b=1,f=parseInt($("#notesDiv"+t).css("line-height"));if(p.length>0){for(C=0;C<p.length;C++)if(-1===p[C].id.indexOf("_")){u=p[C].id;break}$("#"+u),$("#"+u).offset(),g=$("#"+u).offset().top,(m=$("#"+t).offset().top)+$("#notesDiv"+t).height()>g&&($("#notesDiv"+t).parent().offset().top<$("#"+u).parent().offset().top&&(g-m>2*f?b=2:g-m>f&&(b=1),$("#notesDiv"+t).html().length>10&&$clamp(document.getElementById("notesDiv"+t),{clamp:b})),localStorage.setItem("addNoteNextParaId",""))}}}}}}},r),addingNote=!1,closePopover(),setTimeout(function(){checkBriefOverNoteForOverlap()},2e3)}function confirmDeleteNote(){"Android"==CaseConnect.deviceOS&&(CaseConnect.androidIssueKeypad=!0),updatingNote=!1,addingNote=!1,addingBrief=!1,updatingBrief=!1;for(var e=!1,t=$(".notesSpanBlock"),n=0;n<t.length;n++)if(t[n].id===selectedNoteId){e=!0;break}if(e){keepPopoverVisible=!0;var i=$("#popover-deletenote-content").clone(!0);$("#add-note-content-box").html(""),$("#add-note-content-box").append(i.html())}else addingNote=!1,$("#"+selectedNoteId).popover("hide")}function changeHighlightImage(){"#ede48c"===selectedHighlightColor||"rgb(237, 228, 140)"===selectedHighlightColor?($(".highlight-color-yellow").addClass("change-yellow-color selectedColor"),$(".highlight-color-green").removeClass("change-green-color selectedColor"),$(".highlight-color-blue").removeClass("change-blue-color selectedColor"),$(".highlight-color-pink").removeClass("change-pink-color selectedColor"),$(".highlight-color-orange").removeClass("change-orange-color selectedColor"),$(".highlight-color-purple").removeClass("change-purple-color selectedColor")):"#b5eb97"===selectedHighlightColor||"rgb(181, 235, 151)"===selectedHighlightColor?($(".highlight-color-green").addClass("change-green-color selectedColor"),$(".highlight-color-blue").removeClass("change-blue-color selectedColor"),$(".highlight-color-pink").removeClass("change-pink-color selectedColor"),$(".highlight-color-orange").removeClass("change-orange-color selectedColor"),$(".highlight-color-purple").removeClass("change-purple-color selectedColor"),$(".highlight-color-yellow").removeClass("change-yellow-color selectedColor")):"#aee6fe"===selectedHighlightColor||"rgb(174, 230, 254)"===selectedHighlightColor?($(".highlight-color-blue").addClass("change-blue-color selectedColor"),$(".highlight-color-pink").removeClass("change-pink-color selectedColor"),$(".highlight-color-orange").removeClass("change-orange-color selectedColor"),$(".highlight-color-purple").removeClass("change-purple-color selectedColor"),$(".highlight-color-yellow").removeClass("change-yellow-color selectedColor"),$(".highlight-color-green").removeClass("change-green-color selectedColor")):"#fec0ff"===selectedHighlightColor||"rgb(254, 192, 255)"===selectedHighlightColor?($(".highlight-color-pink").addClass("change-pink-color selectedColor"),$(".highlight-color-orange").removeClass("change-orange-color selectedColor"),$(".highlight-color-purple").removeClass("change-purple-color selectedColor"),$(".highlight-color-yellow").removeClass("change-yellow-color selectedColor"),$(".highlight-color-green").removeClass("change-green-color selectedColor"),$(".highlight-color-blue").removeClass("change-blue-color selectedColor")):"#ffd4a8"===selectedHighlightColor||"rgb(255, 212, 168)"===selectedHighlightColor?($(".highlight-color-orange").addClass("change-orange-color selectedColor"),$(".highlight-color-purple").removeClass("change-purple-color selectedColor"),$(".highlight-color-yellow").removeClass("change-yellow-color selectedColor"),$(".highlight-color-green").removeClass("change-green-color selectedColor"),$(".highlight-color-blue").removeClass("change-blue-color selectedColor"),$(".highlight-color-pink").removeClass("change-pink-color selectedColor")):"#cbbefc"===selectedHighlightColor||"rgb(203, 190, 252)"===selectedHighlightColor?($(".highlight-color-purple").addClass("change-purple-color selectedColor"),$(".highlight-color-yellow").removeClass("change-yellow-color selectedColor"),$(".highlight-color-green").removeClass("change-green-color selectedColor"),$(".highlight-color-blue").removeClass("change-blue-color selectedColor"),$(".highlight-color-pink").removeClass("change-pink-color selectedColor"),$(".highlight-color-orange").removeClass("change-orange-color selectedColor")):($(".highlight-color-yellow").removeClass("change-yellow-color selectedColor"),$(".highlight-color-green").removeClass("change-green-color selectedColor"),$(".highlight-color-blue").removeClass("change-blue-color selectedColor"),$(".highlight-color-pink").removeClass("change-pink-color selectedColor"),$(".highlight-color-orange").removeClass("change-orange-color selectedColor"),$(".highlight-color-purple").removeClass("change-purple-color selectedColor"))}function disableCopyPaste(){insideEreader=!0,insideNewsFeed=!1,insideClassInsightsPage=!1,insideStaticPage=!1,insideBookshelf=!1,insideCasesPage=!1,insideStudycenterPage=!1,insideResourcePage=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,$(".bookshelflink").show(),$(".tutoriallink").show(),$("#casebook-footer-wrapper").hide(),$(".content-wrapper").css("padding-bottom","0px"),$(".connections-logo").attr("data-action","/bookShelfRetrivalService/getBookList"),$(".connections-logo").attr("data-method","POST"),$(".connections-logo").attr("data-handler","goToBookShelf"),$(".connections-logo").parent().attr("data-action","/bookShelfRetrivalService/getBookList"),$(".connections-logo").parent().attr("data-method","POST"),$(".connections-logo").parent().attr("data-handler","goToBookShelf"),$("head meta[name=viewport]").remove(),$("head").prepend('<meta name="viewport" content="width=device-width, initial-scale=1,  user-scalable=1" />'),changePageFont(),searchBookText(),outlineSearchText(),casesSearchText()}function enableCopyPaste(){document.body.setAttribute("oncontextmenu","return true"),insideEreader=!1,linkIconId&&$("#"+linkIconId).popover("hide"),$("#ereader-nav-menu-mobile").modal("hide"),$("#casebook-footer-wrapper").show()}function goToAnnotation(e){$("#ebook-toc").popover("hide"),$("#ebook-toc-mobile").popover("hide"),loadingAnnotationsFromTOC=!0,clickedAnnotationIdFromListing=e.target.id.substring(16);var t=document.getElementById(clickedAnnotationIdFromListing);if(t){var n=document.getElementById("ereader-scroller");$("ol.epub-parenlistlcletter li").addClass("goToPageBug"),$("ol.epub-parenlistucletter li").addClass("goToPageBug"),$("ol.epub-parenlistdecimal li").addClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").addClass("goToPageBug"),$("ol.epub-ucletter li").addClass("goToPageBug"),$("ol.epub-lcletter li").addClass("goToPageBug"),$("ol.epub-ucroman li").addClass("goToPageBug"),$("ol.epub-lcroman li").addClass("goToPageBug"),$("ol.epub-decimal li").addClass("goToPageBug"),$(".epub-law-case-marker").addClass("goToPageBug"),$(".epub-law-heading-container").addClass("goToPageBug"),n.scrollTop=t.offsetTop,$("ol.epub-parenlistlcletter li").removeClass("goToPageBug"),$("ol.epub-parenlistucletter li").removeClass("goToPageBug"),$("ol.epub-parenlistdecimal li").removeClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").removeClass("goToPageBug"),$("ol.epub-ucletter li").removeClass("goToPageBug"),$("ol.epub-lcletter li").removeClass("goToPageBug"),$("ol.epub-ucroman li").removeClass("goToPageBug"),$("ol.epub-lcroman li").removeClass("goToPageBug"),$("ol.epub-decimal li").removeClass("goToPageBug"),$(".epub-law-case-marker").removeClass("goToPageBug"),$(".epub-law-heading-container").removeClass("goToPageBug"),updatePageNoAndChapterName()}else{loadingNewChapterFromAnnotationListing=!0;var i="";""!=e.target.getAttribute("annotationPageNumber")?i=e.target.getAttribute("annotationPageNumber"):(i=$(".annotationListChapterName").attr("strtPagenumber"),comingFromDiffChapterAnnotation=!0),CaseConnect.goToPageTop="",handleGotoPage(i)}}function getChapterList(){var e={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_READING_BOOK",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId}};$.ajax({url:properties[properties.env]+"/learningObjectiveRetrievalService/getChapterAndSupplementListForStudy",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),annotationListingChapterId=CaseConnect.currentChapterId,bookChapterList=e.chapterVOList},function(e){sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function fetchPreviousChapterAnnotations(){$("#ereader-menu-popover-content div.notes-highlights-popover-content").scrollTop(0),fetchingAnnotationsForListing=!0,comingFromAnnotationPrevNextBtn=!0,$("button#previousChapterAnnotationArrow").attr("disabled",!0),$("button#nextChapterAnnotationArrow").attr("disabled",!0),$("button#nextChapterAnnotationArrow").css("visibility","visible"),$("button#previousChapterAnnotationArrow").css("visibility","visible");var e=1;for(e=1;e<bookAnnotateFileList.length;e++)if(bookAnnotateFileList[e].chapterId===annotationListingChapterId){$("#ereader-menu-popover-content div.notes-highlights-popover-content").innerHTML="";var t=document.createElement("DIV");t.style.position="absolute",t.style.left="45px",t.id="notesSpinner",$("#ereader-menu-popover-content div.notes-highlights-popover-content").append(t);var n=document.createElement("IMG");n.src="img/loading-spinner.gif",n.alt="Loading",document.getElementById(t.id).appendChild(n),$("#annotationListChapterName")[0].innerHTML=bookAnnotateFileList[e-1].navbarTitle,$(".annotationListChapterName").html(bookAnnotateFileList[e-1].navbarTitle),$(".annotationListChapterName").attr("aria-label",bookAnnotateFileList[e-1].navbarTitle),$("#annotationListChapterName")[0].setAttribute("aria-label",bookAnnotateFileList[e-1].navbarTitle);for(var i=0;i<bookChapterSupplimentList.length;i++)bookAnnotateFileList[e-1].chapterId==bookChapterSupplimentList[i].chapterId&&$(".annotationListChapterName").attr("strtPagenumber",bookChapterSupplimentList[i].strStartPageNumber);fetchAnnotations(bookAnnotateFileList[e-1].chapterId),annotationListingChapterId=bookAnnotateFileList[e-1].chapterId,1===e&&$("button#previousChapterAnnotationArrow").css("visibility","hidden");break}}function fetchNextChapterAnnotations(){$("#notes-highlight").scrollTop(0),$("button#previousChapterAnnotationArrow").attr("disabled",!0),$("button#nextChapterAnnotationArrow").attr("disabled",!0),fetchingAnnotationsForListing=!0,comingFromAnnotationPrevNextBtn=!0;var e=0;for($("button#nextChapterAnnotationArrow").css("visibility","visible"),$("button#previousChapterAnnotationArrow").css("visibility","visible"),$("button#previousChapterAnnotationArrow").attr("disabled",!0),$("button#nextChapterAnnotationArrow").attr("disabled",!0),e=0;e<bookAnnotateFileList.length;e++)if(bookAnnotateFileList[e].chapterId===annotationListingChapterId){e===bookAnnotateFileList.length-2&&$("button#nextChapterAnnotationArrow").css("visibility","hidden"),$("#ereader-menu-popover-content div.notes-highlights-popover-content").innerHTML="",$(".notes-highlights-popover-content").html("");var t=document.createElement("DIV");t.style.position="absolute",t.style.left="45px",t.id="notesSpinner",$("#ereader-menu-popover-content div.notes-highlights-popover-content").append(t);var n=document.createElement("IMG");n.src="img/loading-spinner.gif",n.alt="Loading",document.getElementById(t.id).appendChild(n),$("#annotationListChapterName")[0].innerHTML=bookAnnotateFileList[e+1].navbarTitle,$(".annotationListChapterName").html(bookAnnotateFileList[e+1].navbarTitle),$(".annotationListChapterName").attr("aria-label",bookAnnotateFileList[e+1].navbarTitle),$("#annotationListChapterName")[0].setAttribute("aria-label",bookAnnotateFileList[e+1].navbarTitle),annotationListingChapterId=bookAnnotateFileList[e+1].chapterId;for(var i=0;i<bookChapterSupplimentList.length;i++)bookAnnotateFileList[e+1].chapterId==bookChapterSupplimentList[i].chapterId&&$(".annotationListChapterName").attr("strtPagenumber",bookChapterSupplimentList[i].strStartPageNumber);fetchAnnotations(bookAnnotateFileList[e+1].chapterId),e===bookAnnotateFileList.length-2&&$("button#nextChapterAnnotationArrow").css("visibility","hidden");break}}function searchValue(e){"searchByPage"===lastViewedSearchEreader?13!=e.keyCode&&"touchstart"!==e.type&&"click"!==e.type||($(".search-result").hide(),$("ul#searchAutoSuggestList").length>1&&($("ul#searchAutoSuggestList")[1].style.display="none"),""!=$(".popover-search-field")[1].value?(validateStopWords(lastViewedSearchEreader),e.preventDefault()):""===$(".popover-search-field")[1].value&&(alertMessagesModal(exceptionMsg.enterSearchTerm),e.preventDefault())):"searchBySection"===lastViewedSearchEreader&&(13!=e.keyCode&&"touchstart"!==e.type&&"click"!==e.type||($(".search-result").hide(),$("ul#searchAutoSuggestList").length>1&&($("ul#searchAutoSuggestList")[1].style.display="none"),""!=$(".popover-search-field")[1].value?(validateStopWords(lastViewedSearchEreader),e.preventDefault()):""===$(".popover-search-field")[1].value&&(searchInputTextboxIsEmpty=!0,$("#searchAutoSuggestList").html(""),alertMessagesModal(exceptionMsg.enterSearchTerm),e.preventDefault())))}function validateStopWords(e){if(insideEreader){var t=(n=$("input#search-text")[1].value.split(" ")).length;for($(".search-result").hide(),searchWords=0;searchWords<t&&-1!==stopWords.indexOf(n[searchWords]);searchWords++);searchWords!==t?"searchByPage"===e?searchResult():(searchResultBySection(),$(".search-result").hide(),$(".searchAutoSuggestList").hide(),$(".back-to-section-result").hide()):alertMessagesModal(exceptionMsg.enterValidSearch)}else if(insideCasesPage){e="";var n;t=(n=$("input#caseSearchTextbox")[1].value.split(" ")).length;for($(".case-search-count").hide(),searchWords=0;searchWords<t&&-1!==stopWords.indexOf(n[searchWords]);searchWords++);searchWords!==t?(caseSearchResult(),$(".case-search-count").hide(),$(".searchAutoSuggestList").hide()):alertMessagesModal(exceptionMsg.enterValidSearch)}}function searchResult(){if(""!==$(".popover-search-field")[1].value){$(".search-result-list li").remove(),$(".resultFound").html(""),$(".search-no-result-error").hide();var e=$(".popover-search-field")[1].value,t={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_SEARCH_BOOK_CONTENT",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},contentSearchVO:{bookId:CaseConnect.currentBookId,searchKeyWord:e}};$(".search-loading-spinner").show(),$(".search-by-section-tab").removeAttr("onclick")[1],$.ajax({url:properties[properties.env]+"/manageSearchService/searchTextInBook",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(t){void 0!==t.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",t.sessionAuthenticationToken);var n=[];if(t.contentSearchResultVOList&&(t.contentSearchResultVOList.length>0?n=t.contentSearchResultVOList:n.push(t.contentSearchResultVOList)),t.contentSearchResultVOList){var i=0;for($(".search-result").show(),i=0;i<n.length;i++){var o="";o=void 0!==n[i].selectedText?n[i].selectedText:void 0!==n[i].chapterTitle?n[i].chapterTitle:void 0!==n[i].aheadTitleCopy?n[i].aheadTitleCopy:void 0!==n[i].bheadTitleCopy?n[i].bheadTitleCopy:$(".popover-search-field").val(),1===n.length?($(".resultFound").html(i+1+" result found"),$(".resultFound").attr("aria-label",i+1+" result found"),$(".search-result-list").append('<li class="search-result-item list-style-none"><a href="#" id="searchElementSentence"  onClick="pageNavigationFromSearch(event)" currentpage='+n[i].pageNumber+' style="display:inline-block; width:100%"><div class="search-item-content"><div class="search-value search-result-list-value" id="searchValue">'+o+'</div><span class="search-count-by-section"></span></div><div class="search-book-text-page pull-right"><span class="search-item-page-no">'+n[i].pageNumber+"</span></div></a></li>")):1!==n.length&&($(".resultFound").html(i+1+" results found"),$(".resultFound").attr("aria-label",i+1+" results found"),$(".search-result-list").append('<li class="search-result-item list-style-none"><a href="#" id="searchElementSentence"  onClick="pageNavigationFromSearch(event)" currentpage='+n[i].pageNumber+' style="display:inline-block;width:100%"><div class="search-item-content"><div class="search-value search-result-list-value" id="searchValue">'+o+'</div><span class="search-count-by-section"></span></div><div class="search-book-text-page pull-right"><span class="search-item-page-no">'+n[i].pageNumber+"</span></div></a></li>"))}$("ul#searchAutoSuggestList").length>1&&($("ul#searchAutoSuggestList")[1].style.display="none"),$("#search-by-page-tab").focus()}t.contentSearchResultVOList||"true"!==t.status||($(".search-result").show(),$(".resultFound").html("No results found"),$(".resultFound").attr("aria-label","No results found")),$(".search-loading-spinner").hide(),$(".search-by-section-tab").attr("onclick","searchBySectionResults(event)")[0],$(".popover-search-field").val(e),searchedTextSaved=$(".popover-search-field")[1].value,searchResultListVisible=!0,sessionTimeOut()},function(e){sessionTimeOut(),sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain,$(".search-loading-spinner").hide(),$("#search-by-section-tab").attr("onclick","searchBySectionResults(event)")[1]})}else $(".search-result-list").html("")}function pageNavigationFromSearch(e){if(insideGlobalSearchResult){t=e.currentTarget.getAttribute("currentpage");CaseConnect.goToPageTop="",searchByPageNum=t,CaseConnect.currentBookIsbn=e.currentTarget.getAttribute("bookIsbn"),checkExpiredOnclickOfBook(e)}else if(sectionIdToBeRedirected=e.currentTarget.id.substr(9),$(".ebook-search").popover("hide"),document.getElementById(sectionIdToBeRedirected))$("#ereader-scroller").scrollTop(document.getElementById(sectionIdToBeRedirected).offsetTop),sectionIdToBeRedirected="";else{redirectingFromSearchBySection=!0;var t=e.currentTarget.getAttribute("currentpage");CaseConnect.goToPageTop="",searchByPageNum=t,handleGotoPage(t)}}function closeSearchText(){$(".cancel-search").hide(),$(".popover-search-field").val(""),$(".search-result-list").html(""),$(".resultFound").html(""),$(".search-result").hide(),$(".back-to-section-result").hide(),$(".search-no-result-error").hide(),$(".popover-search-field").addClass("search-field-background"),$("option.test").remove(),searchResultListVisible=!1}function calculateFontSizeAndLineHeight(e){var t="";t=(ereaderPrintClicked,".ereader-content"),"textsize-eleven"===e?($(".ccapp-chunkHeader").css({"font-size":"200%","line-height":"120%"}),$(t+" div:not([cc-font-xxsmall]) p").css({"font-size":"11px","line-height":"15px"}),$(t+" div:not([cc-font-xsmall]) p").css({"font-size":"11px","line-height":"15px"}),$(t+" div:not([cc-font-small]) p").css({"font-size":"11px","line-height":"15px"}),$(t+" div:not([cc-font-medium]) p").css({"font-size":"11px","line-height":"15px"}),$(t+" div:not([cc-font-large]) p").css({"font-size":"11px","line-height":"15px"}),$(t+" div:not([cc-font-xlarge]) p").css({"font-size":"11px","line-height":"15px"}),$(t).find(".cc-font-xxsmall p").css("font-size","8px"),$(t).find(".cc-font-xsmall p").css("font-size","9px"),$(t).find(".cc-font-xsmall").css("font-size","9px"),$(t).find(".cc-font-small p").css("font-size","10px"),$(t).find(".cc-font-small").css("font-size","10px"),$(t).find("#notes-container .notesText").css({"font-size":"11px","line-height":"15px"}),$(t).find("#notes-container .labelNoteWrapper").css({"font-size":"11px","line-height":"15px"}),$(t).find(".cc-font-medium h3 p").css({"font-size":"13px","line-height":"15px"}),$(t).find(".cc-font-medium").css({"font-size":"13px","line-height":"15px"}),$(t).find(".cc-font-large p").css({"font-size":"15px","line-height":"15px"}),$(t).find(".cc-font-large").css({"font-size":"15px","line-height":"15px"}),$(t).find(".cc-font-xlarge").css({"font-size":"19px","line-height":"25px"}),$(t).find(".cc-font-xlarge h2 p").css({"font-size":"19px","line-height":"25px"}),$(t).find(".cc-font-xlarge h3 p").css({"font-size":"19px","line-height":"25px"}),$(t).find(".cc-chapter-title h1 p").css({"font-size":"27px","line-height":"22px"}),$(t).find(".cc-chapter-title").css({"font-size":"27px","line-height":"22px"}),scrollTolastVisitedpage()):"textsize-thirteen"===e?($(".ccapp-chunkHeader").css({"font-size":"200%","line-height":"120%"}),$(t+" div:not([cc-font-xxsmall]) p").css({"font-size":"13px","line-height":"17px"}),$(t+" div:not([cc-font-xsmall]) p").css({"font-size":"13px","line-height":"17px"}),$(t+" div:not([cc-font-small]) p").css({"font-size":"13px","line-height":"17px"}),$(t+" div:not([cc-font-medium]) p").css({"font-size":"13px","line-height":"17px"}),$(t+" div:not([cc-font-large]) p").css({"font-size":"13px","line-height":"17px"}),$(t+" div:not([cc-font-xlarge]) p").css({"font-size":"13px","line-height":"17px"}),$(t).find(".cc-font-xxsmall p").css("font-size","9px"),$(t).find(".cc-font-xsmall").css("font-size","11px"),$(t).find(".cc-font-xsmall p").css("font-size","11px"),$(t).find(".cc-font-small").css("font-size","12px"),$(t).find(".cc-font-small p").css("font-size","12px"),$(t).find("#notes-container .notesText").css({"font-size":"13px","line-height":"17px"}),$(t).find("#notes-container .labelNoteWrapper").css({"font-size":"13px","line-height":"17px"}),$(t).find(".cc-font-medium").css({"font-size":"15px","line-height":"17px"}),$(t).find(".cc-font-medium h3 p").css({"font-size":"15px","line-height":"17px"}),$(t).find(".cc-font-large").css({"font-size":"17px","line-height":"17px"}),$(t).find(".cc-font-large p").css({"font-size":"17px","line-height":"17px"}),$(t).find(".cc-font-xlarge").css({"font-size":"21px","line-height":"27px"}),$(t).find(".cc-font-xlarge h2 p").css({"font-size":"21px","line-height":"27px"}),$(t).find(".cc-font-xlarge h3 p").css({"font-size":"21px","line-height":"27px"}),$(t).find(".cc-chapter-title h1 p").css({"font-size":"29px","line-height":"25px"}),scrollTolastVisitedpage()):"textsize-default"===e?($(".ccapp-chunkHeader").css({"font-size":"32px","line-height":"39px"}),$(t+" div:not([cc-font-xxsmall]) p").css({"font-size":"15px","line-height":"22px"}),$(t+" div:not([cc-font-xsmall]) p").css({"font-size":"15px","line-height":"22px"}),$(t+" div:not([cc-font-small]) p").css({"font-size":"15px","line-height":"22px"}),$(t+" div:not([cc-font-medium]) p").css({"font-size":"15px","line-height":"22px"}),$(t+" div:not([cc-font-large]) p").css({"font-size":"15px","line-height":"22px"}),$(t+" div:not([cc-font-xlarge]) p").css({"font-size":"15px","line-height":"22px"}),$(t).find(".cc-font-xxsmall p").css("font-size","10px"),$(t).find(".cc-font-xsmall").css("font-size","13px"),$(t).find(".cc-font-xsmall p").css("font-size","13px"),$(t).find(".cc-font-small").css("font-size","14px"),$(t).find(".cc-font-small p").css("font-size","14px"),$(t).find("#notes-container .notesText").css({"font-size":"15px","line-height":"22px"}),$(t).find("#notes-container .labelNoteWrapper").css({"font-size":"15px","line-height":"22px"}),$(t).find(".cc-font-medium").css({"font-size":"15px","line-height":"19px"}),$(t).find(".cc-font-medium h3 p").css({"font-size":"15px","line-height":"19px"}),$(t).find(".cc-font-large").css({"font-size":"17px","line-height":"19px"}),$(t).find(".cc-font-large p").css({"font-size":"17px","line-height":"19px"}),$(t).find(".cc-font-xlarge").css({"font-size":"23px","line-height":"29px"}),$(t).find(".cc-font-xlarge h2 p").css({"font-size":"23px","line-height":"29px"}),$(t).find(".cc-font-xlarge h3 p").css({"font-size":"23px","line-height":"29px"}),$(t).find(".cc-chapter-title").css({"font-size":"36px","line-height":"40px"}),$(t).find(".cc-chapter-title h1 p").css({"font-size":"36px","line-height":"40px"}),scrollTolastVisitedpage()):"textsize-seventeen"===e?($(".ccapp-chunkHeader").css({"font-size":"200%","line-height":"120%"}),$(".ereader-content div:not([cc-font-xxsmall]) p").css({"font-size":"17px","line-height":"19px"}),$(".ereader-content div:not([cc-font-xsmall]) p").css({"font-size":"17px","line-height":"19px"}),$(".ereader-content div:not([cc-font-small]) p").css({"font-size":"17px","line-height":"19px"}),$(".ereader-content div:not([cc-font-medium]) p").css({"font-size":"17px","line-height":"19px"}),$(".ereader-content div:not([cc-font-large]) p").css({"font-size":"17px","line-height":"19px"}),$(".ereader-content div:not([cc-font-xlarge]) p").css({"font-size":"17px","line-height":"19px"}),$(t).find(".cc-font-xxsmall p").css("font-size","12px"),$(t).find(".cc-font-xsmall").css("font-size","15px"),$(t).find(".cc-font-xsmall p").css("font-size","15px"),$(t).find(".cc-font-small").css("font-size","16px"),$(t).find(".cc-font-small p").css("font-size","16px"),$(t).find("#notes-container .notesText").css({"font-size":"17px","line-height":"19px"}),$(t).find("#notes-container .labelNoteWrapper").css({"font-size":"17px","line-height":"19px"}),$(t).find(".cc-font-medium").css({"font-size":"19px","line-height":"21px"}),$(t).find(".cc-font-medium h3 p").css({"font-size":"19px","line-height":"21px"}),$(t).find(".cc-font-large").css({"font-size":"21px","line-height":"21px"}),$(t).find(".cc-font-large p").css({"font-size":"21px","line-height":"21px"}),$(t).find(".cc-font-xlarge").css({"font-size":"26px","line-height":"31px"}),$(t).find(".cc-font-xlarge h2 p").css({"font-size":"26px","line-height":"31px"}),$(t).find(".cc-font-xlarge h3 p").css({"font-size":"26px","line-height":"31px"}),$(t).find(".cc-chapter-title").css({"font-size":"38px","line-height":"42px"}),$(t).find(".cc-chapter-title h1 p").css({"font-size":"38px","line-height":"42px"}),scrollTolastVisitedpage()):"textsize-nineteen"===e?($(".ccapp-chunkHeader").css({"font-size":"200%","line-height":"120%"}),$(t+" div:not([cc-font-xxsmall]) p").css({"font-size":"19px","line-height":"21px"}),$(t+" div:not([cc-font-xsmall]) p").css({"font-size":"19px","line-height":"21px"}),$(t+" div:not([cc-font-small]) p").css({"font-size":"19px","line-height":"21px"}),$(t+" div:not([cc-font-medium]) p").css({"font-size":"19px","line-height":"21px"}),$(t+" div:not([cc-font-large]) p").css({"font-size":"19px","line-height":"21px"}),$(t+" div:not([cc-font-xlarge]) p").css({"font-size":"19px","line-height":"21px"}),$(t).find(".cc-font-xxsmall p").css("font-size","14px"),$(t).find(".cc-font-xsmall").css("font-size","17px"),$(t).find(".cc-font-xsmall p").css("font-size","17px"),$(t).find(".cc-font-small").css("font-size","18px"),$(t).find(".cc-font-small p").css("font-size","18px"),$(t).find("#notes-container .notesText").css({"font-size":"19px","line-height":"21px"}),$(t).find("#notes-container .labelNoteWrapper").css({"font-size":"19px","line-height":"21px"}),$(t).find(".cc-font-medium").css({"font-size":"21px","line-height":"23px"}),$(t).find(".cc-font-medium h3 p").css({"font-size":"21px","line-height":"23px"}),$(t).find(".cc-font-large").css({"font-size":"23px","line-height":"23px"}),$(t).find(".cc-font-large p").css({"font-size":"23px","line-height":"23px"}),$(t).find(".cc-font-xlarge").css({"font-size":"28px","line-height":"33px"}),$(t).find(".cc-font-xlarge h2 p").css({"font-size":"28px","line-height":"33px"}),$(t).find(".cc-font-xlarge h3 p").css({"font-size":"28px","line-height":"33px"}),$(t).find(".cc-chapter-title").css({"font-size":"40px","line-height":"44px"}),$(t).find(".cc-chapter-title h1 p").css({"font-size":"40px","line-height":"44px"}),scrollTolastVisitedpage()):"textsize-twentyone"===e&&($(".ccapp-chunkHeader").css({"font-size":"200%","line-height":"120%"}),$(t+" div:not([cc-font-xxsmall]) p").css({"font-size":"21px","line-height":"25px"}),$(t+" div:not([cc-font-xsmall]) p").css({"font-size":"21px","line-height":"25px"}),$(t+" div:not([cc-font-small]) p").css({"font-size":"21px","line-height":"25px"}),$(t+" div:not([cc-font-medium]) p").css({"font-size":"21px","line-height":"25px"}),$(".ereader-content div:not([cc-font-large]) p").css({"font-size":"21px","line-height":"25px"}),$(t+" div:not([cc-font-xlarge]) p").css({"font-size":"21px","line-height":"25px"}),$(t).find(".cc-font-xxsmall p").css({"font-size":"16px","line-height":"20px"}),$(t).find(".cc-font-xsmall").css({"font-size":"19px","line-height":"20px"}),$(t).find(".cc-font-xsmall p").css({"font-size":"19px","line-height":"20px"}),$(t).find(".cc-font-small").css({"font-size":"20px","line-height":"22px"}),$(t).find(".cc-font-small p").css({"font-size":"20px","line-height":"22px"}),$(t).find(".cc-font-medium").css({"font-size":"23px","line-height":"25px"}),$(t).find(".cc-font-medium h3 p").css({"font-size":"23px","line-height":"25px"}),$(t).find(".cc-font-large").css({"font-size":"25px","line-height":"25px"}),$(t).find(".cc-font-large p").css({"font-size":"25px","line-height":"25px"}),$(t).find(".cc-font-xlarge").css({"font-size":"30px","line-height":"35px"}),$(t).find(".cc-font-xlarge h2 p").css({"font-size":"30px","line-height":"35px"}),$(t).find(".cc-font-xlarge h3 p").css({"font-size":"30px","line-height":"35px"}),$(t).find(".cc-chapter-title").css({"font-size":"42px","line-height":"46px"}),$(t).find(".cc-chapter-title h1 p").css({"font-size":"42px","line-height":"46px"}),$(t).find("#notes-container .notesText").css({"font-size":"21px","line-height":"25px"}),$(t).find("#notes-container .labelNoteWrapper").css({"font-size":"21px","line-height":"25px"}),scrollTolastVisitedpage())}function defaultFont(){var e="";e=(ereaderPrintClicked,".ereader-content"),$(".ccapp-chunkHeader").css({"font-size":"32px","line-height":"39px"}),$(e+" div:not([cc-font-xxsmall]) p").css({"font-size":"15px","line-height":"22px"}),$(e+" div:not([cc-font-xsmall]) p").css({"font-size":"15px","line-height":"22px"}),$(e+" div:not([cc-font-small]) p").css({"font-size":"15px","line-height":"22px"}),$(e+" div:not([cc-font-medium]) p").css({"font-size":"15px","line-height":"22px"}),$(e+" div:not([cc-font-large]) p").css({"font-size":"15px","line-height":"22px"}),$(e+" div:not([cc-font-xlarge]) p").css({"font-size":"15px","line-height":"22px"}),$(e).find(".cc-font-xxsmall p").css("font-size","10px"),$(e).find(".cc-font-xsmall").css("font-size","13px"),$(e).find(".cc-font-xsmall p").css("font-size","13px"),$(e).find(".cc-font-small").css("font-size","14px"),$(e).find(".cc-font-small p").css("font-size","14px"),$(e).find(".cc-font-medium").css({"font-size":"15px","line-height":"19px"}),$(e).find(".cc-font-medium h3 p").css({"font-size":"15px","line-height":"19px",margin:"0 0 10px 0"}),$(e).find(".cc-font-medium h2 .cc-font-medium h3").css({margin:"20px 0 10px 0"}),$(e).find(".cc-font-large").css({"font-size":"17px","line-height":"19px",margin:"0 0 10px 0"}),$(e).find(".cc-font-large h3").css({margin:"20px 0 10px 0"}),$(e).find(".cc-font-large p").css({"font-size":"17px","line-height":"19px",margin:"0 0 10px 0"}),$(e).find(".cc-font-large h2").css({margin:"20px 0 10px 0"}),$(e).find(".cc-font-xlarge").css({"font-size":"23px","line-height":"29px"}),$(e).find(".cc-section-title.cc-font-xlarge").css({"font-size":"23px","line-height":"29px",margin:"0 0 10px 0"}),$(e).find(".cc-pagenum-begin").css({"font-size":"10px","line-height":"22px"}),$(e).find(".cc-font-xlarge h2 p").css({"font-size":"23px","line-height":"29px",margin:"0 0 10px 0"}),$(e).find(".cc-font-xlarge h2").css({margin:"20px 0 10px 0"}),$(e).find(".cc-font-xlarge h3 p").css({"font-size":"23px","line-height":"29px",margin:"0 0 10px 0"}),$(e).find(".cc-chapter-title").css({"font-size":"36px","line-height":"40px"}),$(e).find(".cc-chapter-title h1").css({margin:"20px 0 10px 0"}),$(e).find(".cc-chapter-title h1 p").css({"font-size":"36px","line-height":"40px"}),$(e).find(".cc-principal-case p").css({"font-size":"15px","line-height":"22px",margin:"0 0 10px 0"}),$(e).find(".epub-table-container").css({"font-size":"15px"});var t=map.sessionVO;$(window).width()>767&&("Firefox"==t.browserName?($(".epub-image").find("img").css("max-width","103%"),$("#notes-container").css({"margin-top":"-44px","box-shadow":"initial","word-break":"break-all",height:"auto"}),$("#tab-section-container").css({"padding-left":"40px","min-width":"685px","max-width":"1500px","word-break":"normal",overflow:"visible",margin:"0"})):"Chrome"==t.browserName&&($(".epub-image").find("img").css("max-width","103%"),$("#notes-container").css({"margin-top":"0px","box-shadow":"initial","word-break":"break-all",height:"auto"}),$("#tab-section-container").css({"padding-left":"43px","min-width":"700px","max-width":"1500px","word-break":"normal",overflow:"visible",margin:"0"})))}function msgBoxCheck(){$(".dont-show-checkbox").is(":checked")?(ereaderAnnotationDisplay="false",saveEreaderMessageDisplayStatus()):ereaderAnnotationDisplay="true"}function alertMessagesModal(e){document.getElementById("annotation-error-content-text").innerHTML=e,$("#highlight-existing-error-lightbox").modal("show"),alertMessageModalAppears=!0}function saveUserSettingForAnnotations(){var e={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_SAVE_USER_SETTINGS",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},userSettingsVOList:[{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),prefferedFontSize:"3",prefferedFontStyle:"Times New Roman",prefferedLineSpacing:"5",prefferedHighlightColor:highLightColor,noteConfirmationDisplayCount:"2",createdBy:CaseConnect.currentUserId,modifiedBy:CaseConnect.currentUserId}]};$.ajax({url:properties[properties.env]+"/manageUserService/saveUserSettings",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),sessionTimeOut()},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function getUserSettingsForAnnotation(){var e={userVO:{userId:CaseConnect.currentUserId,userRole:CaseConnect.currentUserRole,userRoleId:CaseConnect.currentUserRoleId,userActivityVO:{lastActivityCode:"EREADER_READING_BOOK",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId,pageNumber:CaseConnect.currentPageNumber}};$.ajax({url:properties[properties.env]+"/bookContentRetrievalService/getBookContent",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){void 0!==e.sessionAuthenticationToken&&(localStorage.setItem("ChapterId",e.bookVO.chapterId),"true"==e.resourceFlag&&(CaseConnect.resourceFlag,e.resourceFlag,$(".resourceMenushow").removeClass("resourceMenuhide")),null!=e.hasPCaseAnnotation&&null!=e.hasPCaseAnnotation&&("true"==e.hasPCaseAnnotation?CaseConnect.hasPCaseAnnotation="true":CaseConnect.hasPCaseAnnotation="false"),void 0!==e.casesFlag&&(CaseConnect.casesFlag=e.casesFlag,"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide()),void 0!==e.newsFeedFlag&&"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),void 0!==e.labelVOList?(CaseConnect.preSetBriefLabelList=e.labelVOList,loadDataListInPopover()):(CaseConnect.preSetBriefLabelList="",loadDataListInPopover()),localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken)),highLightColor="#ede48c",searchedTextSaved=null,e.userSettingsVO&&e.status&&e.userSettingsVO.prefferedHighlightColor&&(highLightColor=e.userSettingsVO.prefferedHighlightColor)},function(e){sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function ereaderAssessmentIcons(){if(questionIdAttemptedInRhythmOfContent=[],$("#media-elements-column").html(""),"toc"!==CaseConnect.currentPageNumber){var e={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_FORMATIVE_ASSESSMENT_GET_QUESTIONS",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId},sessionVO:{appType:CaseConnect.appType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,deviceType:CaseConnect.deviceType,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},questionVO:{chapterId:CaseConnect.currentChapterId,bookId:CaseConnect.currentBookId}};$.ajax({url:properties[properties.env]+"/assessmentRetrievalService/getQuestionsForEreader",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){if(void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),"true"===e.status){var t=e.assessmentVO.eReaderQuestionVOList,n=t.length,i=!1;if(n>0)for(var o=0;o<n;o++){i=!1;var a=t[o];if(document.getElementById(a.sectionId)){yValue=document.getElementById(a.sectionId).getBoundingClientRect().bottom;var s=document.getElementById("media-elements-column").getBoundingClientRect().top;if(a.eReaderQuestionList[1].questionType){var r=a.eReaderQuestionList[1],l=document.createElement("IMG");l.id=r.questionId,l.className="ereader-assessment-icons",l.style.position="absolute",l.style.top=yValue-s-60+"px",l.style.left="-2px",l.setAttribute("questiontext",r.questionText),l.setAttribute("generalfeedback",r.generalFeedback),l.setAttribute("questionid",r.questionId),l.setAttribute("contenttitle",r.contentTitle),l.setAttribute("learningobjectid",r.learningObjectIdList),a.eReaderQuestionList[1].studyAidVOList&&(l.setAttribute("studyAidTitle",r.studyAidVOList.studyAidTitle),l.setAttribute("studyAidLink",r.studyAidVOList.studyAidLink),l.setAttribute("studyAidAuthor",r.studyAidVOList.studyAidAuthor)),"multichoice"===r.questionType?(l.setAttribute("title","Multiple Choice Question from the Study Center"),l.setAttribute("alt","Multiple Choice Question from the Study Center"),l.setAttribute("src","img/ereader/roc/assessment-mcq.png"),l.setAttribute("incorrectfeedback",r.incorrectFeedback),l.setAttribute("data-answervolist",JSON.stringify(r.answerVOList)),l.className="ereader-mcq-questions ereader-media-background",l.setAttribute("onclick","ereaderMcqTemplate(event)")):"hypothetical"===r.questionType?(l.className="ereader-hypothetical-questions ereader-media-background",l.setAttribute("title","Short Answer Question from the Study Center"),l.setAttribute("alt","Short Answer Question from the Study Center"),l.setAttribute("src","img/ereader/roc/assessment-hypo.png"),l.setAttribute("onclick","ereaderHypoTemplate(event)")):"flashcard"===r.questionType&&(l.className="ereader-flashcard-questions ereader-media-background",l.setAttribute("title","Flashcard from the Study Center"),l.setAttribute("alt","Flashcard from the Study Center"),l.setAttribute("src","img/ereader/roc/assessment-flash-card.png"),l.setAttribute("onclick","ereaderFlashcardTemplate(event)")),i=!0,document.getElementById("media-elements-column").appendChild(l)}if(a.eReaderQuestionList[0].questionType){var d=a.eReaderQuestionList[0],c=document.createElement("IMG");c.id=d.questionId,c.className="ereader-assessment-icons",c.style.position="absolute",i?(c.style.top=yValue-s-60-65+"px",c.style.left="-2px"):(c.style.top=yValue-s-60+"px",c.style.left="-2px"),c.setAttribute("contenttitle",d.contentTitle),c.setAttribute("questionText",d.questionText),c.setAttribute("questionid",d.questionId),c.setAttribute("learningobjectid",d.learningObjectIdList),d.explainerLinkVOList&&(c.setAttribute("expdetail",d.explainerLinkVOList.expdetail),c.setAttribute("provider",d.explainerLinkVOList.provider),c.setAttribute("spanid",d.explainerLinkVOList.spanid)),a.eReaderQuestionList[0].studyAidVOList&&(c.setAttribute("studyAidTitle",d.studyAidVOList.studyAidTitle),c.setAttribute("studyAidLink",d.studyAidVOList.studyAidLink),c.setAttribute("studyAidAuthor",d.studyAidVOList.studyAidAuthor)),"Text"===d.contentType?(c.setAttribute("title","Explanation from the Study Center"),c.setAttribute("alt","Explanation from the Study Center"),c.setAttribute("src","img/ereader/roc/assessment-text.png"),c.className="ereader-text-questions ereader-media-background",c.setAttribute("onclick","ereaderExplanatoryContentText(event)")):"Audio"===d.contentType?(c.setAttribute("title","Audio Clip from the Study Center"),c.setAttribute("alt","Audio Clip from the Study Center"),c.setAttribute("src","img/ereader/roc/assessment-audio.png"),c.setAttribute("expdetail",d.explainerLinkVOList.expdetail),c.setAttribute("provider",d.explainerLinkVOList.provider),c.setAttribute("spanid",d.explainerLinkVOList.spanid),c.className="ereader-audio-questions ereader-media-background",c.setAttribute("onclick","ereaderExplanatoryContentVideo(event)")):"Video"===d.contentType&&(c.setAttribute("title","Video"),c.setAttribute("alt","Video"),c.setAttribute("src","img/ereader/roc/assessment-video.png"),c.setAttribute("expdetail",d.explainerLinkVOList.expdetail),c.setAttribute("provider",d.explainerLinkVOList.provider),c.setAttribute("spanid",d.explainerLinkVOList.spanid),c.className="ereader-video-questions ereader-media-background",c.setAttribute("onclick","ereaderExplanatoryContentVideo(event)")),document.getElementById("media-elements-column").appendChild(c)}}}}setTimeout(function(){$("#txtPageNum").val(CaseConnect.currentPageNumber),$("#txtPageNumMobile").val(CaseConnect.currentPageNumber),"iOS"===CaseConnect.deviceOS&&"iPad"===CaseConnect.deviceType||"iOS"===CaseConnect.deviceOS&&"iPhone"===CaseConnect.deviceType||CaseConnect.deviceType},1e3),sessionTimeOut()},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}}function ereaderExplanatoryContentText(e){currentlearningObjectId=e.currentTarget.getAttribute("learningobjectid"),currentQuestionId=e.currentTarget.id,$("#ereader-assessment-lightbox").modal("show");var t=Handlebars.getTemplate("ereader-explanatory-text");$("#ereader-assessment-content-area").html(t),saveExplanatoryContentResponse("EREADER_STREAMING_EXPLAINER_TEXT"),$("#ereader-text-attribution-text").attr("href",e.currentTarget.getAttribute("studyAidLink")),$("#ereader-text-attribution-text").html(e.currentTarget.getAttribute("studyAidTitle")+" "),$("#ereader-text-attribution-author-name").html(e.currentTarget.getAttribute("studyAidAuthor")),$("#explanatoryContentTextQuestion").html(e.currentTarget.getAttribute("questiontext"))}function ereaderExplanatoryContentVideo(e){if("Firefox"===CaseConnect.browserName){var t=e.currentTarget.getAttribute("expdetail"),n=window.open("","_blank","width=700,height=400,scrollbars=yes,resizable=yes,toolbar=no,directories=no,location=no,menubar=no,status=no,left=200,top=200").document;n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'),n.write("<html>"),n.write("<head>"),n.write('<script src="https://sadmin.brightcove.com/js/BrightcoveExperiences.js"><\/script>'),n.write("</head>"),n.write("<body>"),n.write('<object width="640" height="360" type="application/x-shockwave-flash" data="https://secure.brightcove.com/services/viewer/federated_f9?&amp;width=640&amp;height=360&amp;flashID=myExperience'+t+"&amp;bgcolor=%23FFFFFF&amp;playerID=3629462730001&amp;playerKey=AQ~~%2CAAAABNa5hoE~%2CruH2nxQOkuQA2rTuHVFj9aEJ1V2vNuMp&amp;isVid=true&amp;isUI=true&amp;dynamicStreaming=true&amp;%40videoPlayer="+t+'&amp;secureConnections=true&amp;secureHTMLConnections=true&amp;autoStart=&amp;debuggerID=&amp;startTime=1408351167295" id="myExperience'+t+'" class="BrightcoveExperience" seamlesstabbing="undefined"><param name="allowScriptAccess" value="always"><param name="allowFullScreen" value="true"><param name="seamlessTabbing" value="false"><param name="swliveconnect" value="true"><param name="wmode" value="window"><param name="quality" value="high"><param name="bgcolor" value="#FFFFFF"></object>'),n.write("</body>"),n.write("</html>")}else{currentlearningObjectId=e.currentTarget.getAttribute("learningobjectid"),currentQuestionId=e.currentTarget.id,$("#ereader-assessment-lightbox").modal("show");var i=Handlebars.getTemplate("ereader-explainer-video");$("#ereader-assessment-content-area").html(i),$("#explanatoryContentVideoContent1").attr("src",e.currentTarget.getAttribute("explainerurl")),$("#explanatoryContentVideoContent2").attr("src",e.currentTarget.getAttribute("explainerurl")),saveExplanatoryContentResponse("EREADER_STREAMING_EXPLAINER_VIDEO");var o,a=brightcovePlayer.height,s=brightcovePlayer.width,r=brightcovePlayer.playerID,l=brightcovePlayer.playerKey;t=e.currentTarget.getAttribute("expdetail");o=generateBridecovePlayer(t,s,a,r,l),$("#ereader-video-content").html(o),brightcove.createExperiences(),$("#videoQuestionTextEreader").html(e.currentTarget.getAttribute("questiontext"))}}function ShowVideo(e){var t=brightcovePlayer.height,n=brightcovePlayer.width,i=brightcovePlayer.playerID,o=brightcovePlayer.playerKey;$("#ereader-assessment-lightbox").modal("show");var a=Handlebars.getTemplate("ereader-explainer-video");$("#ereader-assessment-content-area").html(a),$("#explanatoryContentVideoTitle").hide(),$("#video-footer-link").hide(),mediaplayer=generateBridecovePlayer(e,n,t,i,o),$("#ereader-video-content").html(mediaplayer)}function saveExplanatoryContentResponse(e){var t={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:e,pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadChapterId:CaseConnect.currentChapterId,lastViewedLearningObjectId:currentlearningObjectId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},assessmentVO:{questionVO:{questionType:"explanatory",questionId:currentQuestionId,optionNumber:"",grade:"1",studyCenterFlag:0,chapterId:CaseConnect.currentChapterId,questionNumber:"1",answerVOList:[{responseText:""}]}}};$.ajax({url:properties[properties.env]+"/manageAssessmentService/saveQuestionResponse",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(e){void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),$("#page-loading-spinner").hide(),sessionTimeOut()},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function tinyMceInitializerForHypo(){tinymce.init({selector:"textarea.ereaderHypoTextarea",theme:"silver",mobile:{theme:"mobile",plugins:"autosave lists autolink",toolbar:["undo","redo","bold","italic","bullist","numlist","outdent","indent","styleselect"]},plugins:"lists fullscreen template directionality noneditable advlist nonbreaking",toolbar1:"undo redo | fontselect fontsizeselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist | outdent indent",menubar:!1,directionality:"ltr",toolbar_items_size:"medium",extended_valid_elements:"a[href|onclick]",entity_encoding:"raw",fontsize_formats:"10px 12px 14px 18px 24px 36px 48px 64px",font_formats:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago",entity_encoding:"named",resize:"true",statusbar:!1,height:300,nonbreaking_force_tab:!1,toolbar:"ltr rtl  bullist numlist",forced_root_block:"p",force_br_newlines:!1,force_p_newlines:!0,paste_auto_cleanup_on_paste:!1,setup:function(e){e.on("init",function(){""!=e.getContent()&&$('label[for="tinymce"]').hide(),$(e.getDoc()).contents().find("body").focus(function(){$('label[for="tinymce"]').hide()}),$(e.getDoc()).contents().find("body").blur(function(){""==e.getContent()&&$('label[for="tinymce"]').show()})}),e.on("keypress",function(){""!=tinymce.activeEditor.getContent()?$("#submitBtnHypoEreader").removeAttr("disabled"):$("#submitBtnHypoEreader").attr("disabled","disabled")}),e.on("keyup",function(){""!=e.getContent()?$("#submitBtnHypoEreader").removeAttr("disabled"):$("#submitBtnHypoEreader").attr("disabled","disabled")}),e.on("keydown",function(){""!=e.getContent()?$("#submitBtnHypoEreader").removeAttr("disabled"):$("#submitBtnHypoEreader").attr("disabled","disabled")}),e.on("blur",function(){""!=e.getContent()?$("#submitBtnHypoEreader").removeAttr("disabled"):$("#submitBtnHypoEreader").attr("disabled","disabled")})}})}function ereaderHypoTemplate(e){questionAlreadyAttempted=!1,currentlearningObjectId=e.currentTarget.getAttribute("learningobjectid"),currentQuestionId=e.currentTarget.id,$("#ereader-assessment-lightbox").modal("show");var t=Handlebars.getTemplate("ereader-hypothetical");$("#ereader-assessment-content-area").html(t),tinyMceInitializerForHypo(),$("#ereaderHypotheticalQuestionText").html(e.currentTarget.getAttribute("questiontext")),$("#showFeedbackHypoEreader").attr("generalfeedback",e.currentTarget.getAttribute("generalfeedback")),$("#showFeedbackHypoEreader").attr("questiontext",e.currentTarget.getAttribute("questiontext")),e.currentTarget.getAttribute("studyAidTitle")?$("#ereader-hypo-attribution-text").html(e.currentTarget.getAttribute("studyAidTitle")+" "):$("#ereader-hypo-attribution-text").parent().hide(),$("#ereader-hypo-attribution-text").html(e.currentTarget.getAttribute("studyAidTitle")+" "),$("#ereader-hypo-attribution-author-name").html(e.currentTarget.getAttribute("studyAidAuthor")),$("#ereaderHypoAnswer").html(e.currentTarget.getAttribute("generalfeedback")),$("#ereaderHypotheticalEditor_ifr").css("border","1px solid #cacaca")[0],$("#ereaderHypotheticalEditor_ifr").css("border-radius","5px")[0],$("#page-loading-spinner").show(),setTimeout(function(){$("#page-loading-spinner").hide(),$(questionIdAttemptedInRhythmOfContent).each(function(){this.questionId===currentQuestionId&&(tinymce.activeEditor.setContent(this.submittedText),tinyMCE.get("ereaderHypotheticalEditor").getBody().setAttribute("contenteditable",!1),$("#page-loading-spinner").hide(),$("#submitBtnHypoEreader").hide(),$("#ereaderHypoAnswer").show(),$("#thumbsBtnForHypo").show(),$("#ereaderHypoDoneBtn").show(),$("#ereader-hypo-border-b").show(),$("#likeBtnForHypo").show(),$(".assessment-tinymce-placeholder").hide(),this.stateOfThumbs&&($("#radioNoBtnHypo").removeAttr("disabled"),$("#radioYesBtnHypo").removeAttr("disabled"),"0"===this.stateOfThumbs?($("#ereaderHypoThumbsDownBtn").removeClass("gray-thumbsDown"),$("#ereaderHypoThumbsDownBtn").addClass("red-thumbsDown"),$("#ereaderHypoThumbsUpBtn").removeClass("green-thumbsUp"),$("#ereaderHypoThumbsUpBtn").addClass("gray-thumbsUp")):($("#ereaderHypoThumbsDownBtn").addClass("gray-thumbsDown"),$("#ereaderHypoThumbsDownBtn").removeClass("red-thumbsDown"),$("#ereaderHypoThumbsUpBtn").removeClass("gray-thumbsUp"),$("#ereaderHypoThumbsUpBtn").addClass("green-thumbsUp"))),this.stateOfYesNo&&("0"===this.stateOfYesNo?$("#radioNoBtnHypo").attr("checked","checked"):$("#radioYesBtnHypo").attr("checked","checked")))})},2e3)}function submitBtnHypoEreader(e){tinyMCE.get("ereaderHypotheticalEditor").getBody().setAttribute("contenteditable",!1),submitHypoResponse()}function submitHypoResponse(){$("#page-loading-spinner").show();var e={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_FORMATIVE_ASSESSMENT_ANSWERING_QUESTIONS",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadChapterId:CaseConnect.currentChapterId,lastViewedLearningObjectId:currentlearningObjectId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},assessmentVO:{questionVO:{questionId:currentQuestionId,answerVOList:[{responseText:tinymce.activeEditor.getContent()}],saveFlag:0}}};$.ajax({url:properties[properties.env]+"/manageAssessmentService/submitQuestionResponse",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){sessionTimeOut(),void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),$("#page-loading-spinner").hide(),$("#submitBtnHypoEreader").hide(),$("#ereaderHypoAnswer").show(),$("#thumbsBtnForHypo").show(),$("#likeBtnForHypo").show(),$("#ereaderHypoDoneBtn").show(),$("#ereader-hypo-border-b").show();var t=!1;$(questionIdAttemptedInRhythmOfContent).each(function(){this.questionId===currentQuestionId&&(t=!0)}),t||questionIdAttemptedInRhythmOfContent.push({questionId:currentQuestionId,submittedText:tinymce.activeEditor.getContent()})},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function thumbsUpDownForHypo(e){"0"===e?($("#ereaderHypoThumbsDownBtn").removeClass("gray-thumbsDown"),$("#ereaderHypoThumbsDownBtn").addClass("red-thumbsDown"),$("#ereaderHypoThumbsUpBtn").removeClass("green-thumbsUp"),$("#ereaderHypoThumbsUpBtn").addClass("gray-thumbsUp")):($("#ereaderHypoThumbsDownBtn").addClass("gray-thumbsDown"),$("#ereaderHypoThumbsDownBtn").removeClass("red-thumbsDown"),$("#ereaderHypoThumbsUpBtn").removeClass("gray-thumbsUp"),$("#ereaderHypoThumbsUpBtn").addClass("green-thumbsUp")),$("#page-loading-spinner").show();var t={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_FORMATIVE_ASSESSMENT_ANSWERING_QUESTIONS",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadChapterId:CaseConnect.currentChapterId,lastViewedLearningObjectId:currentlearningObjectId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},assessmentVO:{questionVO:{questionId:currentQuestionId,grade:e,questionType:"hypothetical"}}};$.ajax({url:properties[properties.env]+"/manageAssessmentService/saveQuestionResponse",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(t){void 0!==t.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",t.sessionAuthenticationToken),$("#page-loading-spinner").hide(),$("#radioNoBtnHypo").removeAttr("disabled"),$("#radioYesBtnHypo").removeAttr("disabled"),$(questionIdAttemptedInRhythmOfContent).each(function(){this.questionId===currentQuestionId&&(this.stateOfThumbs=e)}),sessionTimeOut()},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function ereaderMcqTemplate(e,t){currentlearningObjectId=e.currentTarget.getAttribute("learningobjectid"),currentQuestionId=e.currentTarget.id,$("#ereader-assessment-lightbox").modal("show");var n=Handlebars.getTemplate("ereader-multichoice");$("#ereader-assessment-content-area").html(n),$("#ereaderMultichoiceQuestionText").html(e.currentTarget.getAttribute("questiontext")),$("#ereader-mcq-attribution-text").attr("href",e.currentTarget.getAttribute("studyAidLink")),e.currentTarget.getAttribute("studyAidTitle")?$("#ereader-mcq-attribution-text").html(e.currentTarget.getAttribute("studyAidTitle")+" "):$("#ereader-mcq-attribution-text").parent().hide(),$("#ereader-mcq-attribution-author-name").html(e.currentTarget.getAttribute("studyAidAuthor")),$("#showFeedbackMCQ").attr("questiontext",e.currentTarget.getAttribute("questiontext")),$("#showFeedbackMCQ").attr("contenttitle",e.currentTarget.getAttribute("contenttitle")),$("#showFeedbackMCQ").attr("incorrectfeedback",e.currentTarget.getAttribute("incorrectfeedback")),$("#showFeedbackMCQ").attr("generalfeedback",e.currentTarget.getAttribute("generalFeedback")),""!==e.currentTarget.getAttribute("incorrectfeedback")?$("#mcqAnswerFeedback").html(e.currentTarget.getAttribute("incorrectfeedback")):$("#mcqAnswerFeedback").html(e.currentTarget.getAttribute("generalFeedback"));var i;t=$("#"+e.currentTarget.id).data("answervolist");for(i=0;i<t.length;i++){var o=document.createElement("DIV");o.className="radio-custom ereader-radio-custom";var a=document.createElement("INPUT");a.type="radio",a.id="optionsRadio"+i,a.value=i,a.name="optionsRadio",a.className="ereader-options-radio",a.setAttribute("onclick","enableSubmitButtonMCQ(event)"),a.setAttribute("fraction",t[i].fraction);var s=document.createElement("LABEL");s.id="mcqOptionsText"+i,s.className="ereader-mcq-options-text",s.innerHTML=numberToCharacterMap[i+1]+". "+t[i].answer,o.appendChild(a),o.appendChild(s),document.getElementById("mcqAnswerListEreader").appendChild(o)}$(questionIdAttemptedInRhythmOfContent).each(function(){if(this.questionId===currentQuestionId){var e=this.selectedOption;$(".ereader-mcq-block").show(),$("#likeBtnForMCQ").show(),$("#mcqModalAnswer").show(),$("#mcqAnswerFeedback").show(),$("#ereader-mcq-border-b").show(),$("#ereaderMcqDoneBtn").show(),$('input[name="optionsRadio"]').attr("disabled","disabled"),$("#submitButtonWrapperinMCQ").hide(),$("#submitBtnMCQ").hide(),$("input[name=optionsRadio]").each(function(){"1.0"===$(this).attr("fraction")?($(this).parent().addClass("radio-ereader-correct"),$(this).attr("value")===e&&$(this).attr("checked","checked")):$(this).attr("value")===e&&($(this).parent().addClass("radio-ereader-incorrect"),$(this).attr("checked","checked"))}),this.stateOfYesNo&&("0"===this.stateOfYesNo?$("#radioNoBtnMCQ").attr("checked","checked"):$("#radioYesBtnMCQ").attr("checked","checked"))}})}function enableSubmitButtonMCQ(e){$("#submitBtnMCQ").removeAttr("disabled")}function submitMCQAnswer(){$(".ereader-mcq-block").show(),$("#likeBtnForMCQ").show(),$("#mcqModalAnswer").show(),$("#mcqAnswerFeedback").show(),$("#ereaderMcqDoneBtn").show(),$("#ereader-mcq-border-b").show(),$('input[name="optionsRadio"]').attr("disabled","disabled"),$("#submitButtonWrapperinMCQ").hide(),$("#submitBtnMCQ").hide(),submitMCQResponse(),"1.0"===$("input[name=optionsRadio]:checked").attr("fraction")?($("input[name=optionsRadio]:checked").parent().addClass("radio-ereader-correct"),$("input[name=optionsRadio]").parent().removeClass("radio-ereader-incorrect")):"0.0"===$("input[name=optionsRadio]:checked").attr("fraction")&&($("input[name=optionsRadio]:checked").parent().addClass("radio-ereader-incorrect"),$("input[name=optionsRadio]").each(function(){"1.0"===$(this).attr("fraction")&&$(this).parent().addClass("radio-ereader-correct")}))}function submitMCQResponse(){$("#page-loading-spinner").show();var e=parseInt($("input[name=optionsRadio]:checked").val()),t={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_FORMATIVE_ASSESSMENT_ANSWERING_QUESTIONS",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadChapterId:CaseConnect.currentChapterId,lastViewedLearningObjectId:currentlearningObjectId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},assessmentVO:{questionVO:{questionType:"multichoice",questionId:currentQuestionId,studyCenterFlag:0,optionNumber:e+1,answerVOList:[{responseText:$("#mcqOptionsText"+e).html()}],grade:"0",learningObjectId:currentlearningObjectId,chapterId:CaseConnect.currentChapterId,questionNumber:"1"}}};$.ajax({url:properties[properties.env]+"/manageAssessmentService/saveQuestionResponse",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(t){void 0!==t.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",t.sessionAuthenticationToken);var n=!1;$(questionIdAttemptedInRhythmOfContent).each(function(){this.questionId===currentQuestionId&&(n=!0)}),n||questionIdAttemptedInRhythmOfContent.push({questionId:currentQuestionId,selectedOption:e.toString()}),$("#page-loading-spinner").hide(),sessionTimeOut()},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function ereaderFlashcardTemplate(e){currentlearningObjectId=e.currentTarget.getAttribute("learningobjectid"),currentQuestionId=e.currentTarget.id,$("#ereader-assessment-lightbox").modal("show");var t=Handlebars.getTemplate("ereader-flashcard");$("#ereader-assessment-content-area").html(t),$("#ereader-flash-attribution-text").attr("href",e.currentTarget.getAttribute("studyAidLink")),e.currentTarget.getAttribute("studyAidTitle")?$("#ereader-flash-attribution-text").html(e.currentTarget.getAttribute("studyAidTitle")+" "):$("#ereader-flash-attribution-text").parent().hide(),$("#ereader-flash-attribution-author-name").html(e.currentTarget.getAttribute("studyAidAuthor")),$("#ereaderFlashcardQuestionText").html(e.currentTarget.getAttribute("questiontext")),$("#ereaderFlashCardAnswer").html(e.currentTarget.getAttribute("generalfeedback")),$(questionIdAttemptedInRhythmOfContent).each(function(){this.questionId===currentQuestionId&&($("#ereaderFlashCardAnswer").show(),$("#thumbsBtnForFlashCard").show(),$("#likeBtnForFlashCard").show(),$("#ereaderFlashDoneBtn").show(),$("#ereaderBtnFlagHideShow").html("Hide Answer"),this.stateOfThumbs&&("0"===this.stateOfThumbs?($("#ereaderFlashCardThumbsDownBtn").removeClass("gray-thumbsDown"),$("#ereaderFlashCardThumbsDownBtn").addClass("red-thumbsDown"),$("#ereaderFlashCardThumbsUpBtn").removeClass("green-thumbsUp"),$("#ereaderFlashCardThumbsUpBtn").addClass("gray-thumbsUp")):($("#ereaderFlashCardThumbsDownBtn").addClass("gray-thumbsDown"),$("#ereaderFlashCardThumbsDownBtn").removeClass("red-thumbsDown"),$("#ereaderFlashCardThumbsUpBtn").removeClass("gray-thumbsUp"),$("#ereaderFlashCardThumbsUpBtn").addClass("green-thumbsUp"))),this.stateOfYesNo&&("0"===this.stateOfYesNo?$("#radioNoBtnFlashCard").attr("checked","checked"):$("#radioYesBtnFlashCard").attr("checked","checked")))})}function outlineConfirmationMessage(){$("#outline-save-confirmation-message").modal("show")}function showFlashCardAnswerEreader(e){"Show Answer"===$("#ereaderBtnFlagHideShow").html()?($(".ereader-flash-block").show(),$("#ereaderFlashCardAnswer").show(),$("#thumbsBtnForFlashCard").show(),$("#likeBtnForFlashCard").show(),$("#ereaderFlashDoneBtn").show(),$("#ereader-border-b").show(),$("#ereaderBtnFlagHideShow").html("Hide Answer")):($("#ereaderFlashCardAnswer").hide(),$("#thumbsBtnForFlashCard").hide(),$("#likeBtnForFlashCard").hide(),$("#ereaderFlashDoneBtn").hide(),$("#ereader-border-b").hide(),$("#ereaderBtnFlagHideShow").html("Show Answer"))}function submitFlashCardResponse(e){$("#page-loading-spinner").show(),"0"===e?($("#ereaderFlashCardThumbsDownBtn").removeClass("gray-thumbsDown"),$("#ereaderFlashCardThumbsDownBtn").addClass("red-thumbsDown"),$("#ereaderFlashCardThumbsUpBtn").removeClass("green-thumbsUp"),$("#ereaderFlashCardThumbsUpBtn").addClass("gray-thumbsUp")):($("#ereaderFlashCardThumbsDownBtn").addClass("gray-thumbsDown"),$("#ereaderFlashCardThumbsDownBtn").removeClass("red-thumbsDown"),$("#ereaderFlashCardThumbsUpBtn").removeClass("gray-thumbsUp"),$("#ereaderFlashCardThumbsUpBtn").addClass("green-thumbsUp"));var t={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_FORMATIVE_ASSESSMENT_ANSWERING_QUESTIONS",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadChapterId:CaseConnect.currentChapterId,lastViewedLearningObjectId:currentlearningObjectId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},assessmentVO:{questionVO:{questionType:"flashcard",questionId:currentQuestionId,optionNumber:"",learningObjectId:currentlearningObjectId,studyCenterFlag:0,chapterId:CaseConnect.currentChapterId,questionNumber:"1",answerVOList:[{responseText:""}],grade:e}}};$.ajax({url:properties[properties.env]+"/manageAssessmentService/saveQuestionResponse",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(t){void 0!==t.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",t.sessionAuthenticationToken);var n=!1;$(questionIdAttemptedInRhythmOfContent).each(function(){this.questionId===currentQuestionId&&(n=!0,this.stateOfThumbs=e)}),n||questionIdAttemptedInRhythmOfContent.push({questionId:currentQuestionId,stateOfThumbs:e}),$("#page-loading-spinner").hide(),sessionTimeOut()},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function likeDislikeBtnSelected(e){$("#page-loading-spinner").show();var t={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_FORMATIVE_ASSESSMENT_LIKE_UNLIKE_QUESTIONS",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadChapterId:CaseConnect.currentChapterId,lastViewedLearningObjectId:currentlearningObjectId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},assessmentVO:{questionVO:{questionId:currentQuestionId,likeQuestionFlag:e}}};$.ajax({url:properties[properties.env]+"/manageAssessmentService/saveLikeUnlikeStatus",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(t){void 0!==t.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",t.sessionAuthenticationToken),$(questionIdAttemptedInRhythmOfContent).each(function(){this.questionId===currentQuestionId&&(this.stateOfYesNo=e)}),$("#page-loading-spinner").hide(),sessionTimeOut()},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function adjustLeftNavHeight(){var e=0,t=0,n=$(window).width();if($(".app-left-navigation").css("min-height","0px"),$(".content-holder-block")&&!insideEreader){var i=$(".app-left-navigation").height();i<(e=!insideCasesPage||"block"!==$("#select-case-page").css("display")&&"inline-block"!==$("#select-case-page").css("display")?$(".content-holder-block").height():$("#select-case-page").height())?(t=0,t=(e+0).toString()+"px"):(t=0,0!==i&&(t=(i+0).toString()+"px")),$(".content-wrapper").css("padding-bottom","0px"),n>768&&fixLeftAndHeaderInDesktop(),$(".app-left-navigation").css("min-height",t)}else t=0,t=(e=$("#ereader-scroller").height()+$(".content-top-menu").height()+2).toString()+"px",$(".app-left-navigation").css("min-height",t)}function searchListOptionSelected(e){$(".popover-search-field")[1].value=e.target.innerHTML,$(".popover-search-field")[1].focus(),$("ul#searchAutoSuggestList")[1].style.display="none",searchValue(e),navigator.userAgent.match(/(iPad|Android|iPhone)/)&&document.activeElement.blur()}function searchSuggestion(e){if(13!==e.keyCode&&37!==e.keyCode&&39!==e.keyCode&&38!==e.keyCode&&40!==e.keyCode){var t=$(".popover-search-field")[1].value.replace(/\//g,"&#47;").replace(/\\/g,"&#92;").replace(/{/g,"&#123;").replace(/;/g,"&#59;");if($("ul#searchAutoSuggestList")[1].innerHTML="",$("ul#searchAutoSuggestList")[1].style.display="none",t.length>2&&t.length<30){var n={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_AUTOSUGGEST_SEARCH_BOOK_CONTENT ",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,ipAddress:localStorage.getItem("ipAddress"),sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},contentSearchVO:{bookId:CaseConnect.currentBookId,searchKeyWord:t}};$.ajax({url:properties[properties.env]+"/manageSearchService/autoSuggestTextInBook ",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(n),success:function(e){if(void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),e.autoSuggestSearchResultVOList&&e.autoSuggestSearchResultVOList.listEntries){var t=[];$.isArray(e.autoSuggestSearchResultVOList.listEntries)?t=e.autoSuggestSearchResultVOList.listEntries:t.push(e.autoSuggestSearchResultVOList.listEntries),t,$("ul#searchAutoSuggestList")[1].innerHTML="",currentSelectedAutoSuggestIndex=null,$.each(t,function(e,n){var i=document.createElement("li");i.className="search-suggest-options",i.id=e+"search-suggest-options",i.innerHTML=t[e],$("ul#searchAutoSuggestList")[1].appendChild(i),navigator.userAgent.match(/(iPad|Android|iPhone)/)?$("#"+e+"search-suggest-options").attr("ontouchstart","searchListOptionSelected(event);"):$("#"+e+"search-suggest-options").attr("onclick","searchListOptionSelected(event);"),$("#"+e+"search-suggest-options").attr("onmouseover","elementHovering(event);")}),$("ul#searchAutoSuggestList")[1].style.display="block"}sessionTimeOut()},error:function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?alertMessagesModal(e.responseJSON.errorMessg):window.location=properties.ui_domain}})}}else if((38===e.keyCode||40===e.keyCode)&&"block"===$("ul#searchAutoSuggestList")[1].style.display){var i=$("ul#searchAutoSuggestList").children();40===e.keyCode?null===currentSelectedAutoSuggestIndex?i.length>0&&$("#0search-suggest-options")&&($("#0search-suggest-options").addClass("sel"),$(".popover-search-field")[1].value=$("#0search-suggest-options").html(),currentSelectedAutoSuggestIndex=0):($(i).each(function(){$(this).removeClass("sel")}),currentSelectedAutoSuggestIndex!==i.length-1?($("#"+(currentSelectedAutoSuggestIndex+1)+"search-suggest-options").addClass("sel"),$(".popover-search-field")[1].value=$("#"+(currentSelectedAutoSuggestIndex+1)+"search-suggest-options").html(),currentSelectedAutoSuggestIndex++):($("#0search-suggest-options").addClass("sel"),$(".popover-search-field")[1].value=$("#0search-suggest-options").html(),currentSelectedAutoSuggestIndex=0)):null===currentSelectedAutoSuggestIndex?i.length>0&&$("#0search-suggest-options")&&($("#"+(currentSelectedAutoSuggestIndex-1)+"search-suggest-options").addClass("sel"),$(".popover-search-field")[1].value=$("#"+(currentSelectedAutoSuggestIndex-1)+"search-suggest-options").html(),currentSelectedAutoSuggestIndex=i.length-1):($(i).each(function(){$(this).removeClass("sel")}),0!==currentSelectedAutoSuggestIndex?($("#"+(currentSelectedAutoSuggestIndex-1)+"search-suggest-options").addClass("sel"),$(".popover-search-field")[1].value=$("#"+(currentSelectedAutoSuggestIndex-1)+"search-suggest-options").html(),currentSelectedAutoSuggestIndex--):($("#"+(i.length-1)+"search-suggest-options").addClass("sel"),$(".popover-search-field")[1].value=$("#"+(i.length-1)+"search-suggest-options").html(),currentSelectedAutoSuggestIndex=i.length-1)),$(".popover-search-field")[1].focus()}}function elementHovering(e){var t=$("ul#searchAutoSuggestList").children();$(t).each(function(){$(this).removeClass("sel")}),currentSelectedAutoSuggestIndex=parseInt(e.target.id.substring(0,1))}function searchBookTextInEreader(e){e&&("pageSearch"===e.currentTarget.value?($("#search-by-section-tab img").attr("src","img/ereader/highlight/search-by-section-default.png"),$("#search-by-page-tab img").attr("src","img/ereader/highlight/search-by-page-active.png"),lastViewedSearchEreader="searchBySection"):($("#search-by-section-tab img").attr("src","img/ereader/highlight/search-by-section-active.png"),$("#search-by-page-tab img").attr("src","img/ereader/highlight/search-by-page-default.png"),lastViewedSearchEreader="searchByPage"))}function searchBySectionResults(){$(".popover-search-field")&&setTimeout(function(){var e;e=$("input#search-text")[1].value.trim(),$("input#search-text")[1].value="",$("input#search-text")[1].focus(),$("input#search-text")[1].click(),$("input#search-text")[1].value=e},150),lastViewedSearchEreader="searchBySection",$("#search-by-section-tab div.search-by-section-button").css("color","#000000"),$("#search-by-page-tab div.search-by-page-button").css("color","#555555"),$(".search-result-list").html(""),$(".search-result").hide(),""!==$("input#search-text")[1].value&&validateStopWords(lastViewedSearchEreader)}function searchByPageResults(){$(".popover-search-field")&&setTimeout(function(){var e;e=$("input#search-text")[1].value.trim(),$("input#search-text")[1].value="",$("input#search-text")[1].focus(),$("input#search-text")[1].click(),$("input#search-text")[1].value=e},150),lastViewedSearchEreader="searchByPage",$("#search-by-section-tab div.search-by-section-button").css("color","#555555"),$("#search-by-page-tab div.search-by-page-button").css("color","#000000"),$(".back-to-section-result").hide(),$(".search-result").hide(),""!==$("input#search-text")[1].value&&validateStopWords(lastViewedSearchEreader)}function searchResultBySection(){if(""!==$(".popover-search-field")[1].value){$(".search-result-list li").remove(),$(".resultFound").html(""),$(".search-no-result-error").hide(),$(".search-result-section").scrollTop(0)[1],searchedText=$(".popover-search-field")[1].value;var e={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_SEARCH_BOOK_CONTENT_GROUP_BY_CHAPTER",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,ipAddress:localStorage.getItem("ipAddress"),sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},contentSearchVO:{bookId:CaseConnect.currentBookId,searchKeyWord:searchedText,paginationResultsPerPage:"100"}};$(".search-loading-spinner").show(),$(".search-by-page-tab").removeAttr("onclick")[1],$.ajax({url:properties[properties.env]+"/manageSearchService/searchTextInBookGroupByChapterId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){if(void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),e.contentSearchResultVOList){var t=[];e.contentSearchResultVOList.length>0?t=e.contentSearchResultVOList:t.push(e.contentSearchResultVOList);for(var n=0;n<t.length;n++)searchChapterId=t[n].chapterId,$(".search-value-section").attr("searchChapterId",t[n].chapterId),t[n].chapterNumber?"1"===t[n].numFound?$(".search-result-list").append('<li class="search-result-item list-style-none" tabindex="-1"><a href="#" id="" searchChapterId='+t[n].chapterId+' onClick="expandSearchResultFromChapter(event)"><div class="search-value-section search-result-list-value-section" id=""  onclick="" searchChapterId='+t[n].chapterId+">Chapter "+t[n].chapterNumber+": "+t[n].chapterTitleInherit+'</div><span class="search-count-by-section">'+t[n].numFound+" result found></span></a></li>"):"1"!==t[n].numFound&&$(".search-result-list").append('<li class="search-result-item list-style-none" tabindex="-1"><a href="#" id="" searchChapterId='+t[n].chapterId+' onClick="expandSearchResultFromChapter(event)"><div class="search-value-section search-result-list-value-section" id=""  onclick="" searchChapterId='+t[n].chapterId+">Chapter "+t[n].chapterNumber+": "+t[n].chapterTitleInherit+'</div><span class="search-count-by-section">'+t[n].numFound+" results found ></span></a></li>"):"1"===t[n].numFound?$(".search-result-list").append('<li class="search-result-item list-style-none" tabindex="-1"><a href="#" id="" searchChapterId='+t[n].chapterId+' onClick="expandSearchResultFromChapter(event)"><div class="search-value-section search-result-list-value-section" id=""  onclick="" searchChapterId='+t[n].chapterId+">"+t[n].chapterTitleInherit+'</div><span class="search-count-by-section">'+t[n].numFound+" result found></span></a></li>"):"1"!==t[n].numFound&&$(".search-result-list").append('<li class="search-result-item list-style-none" tabindex="-1"><a href="#" id="" searchChapterId='+t[n].chapterId+' onClick="expandSearchResultFromChapter(event)"><div class="search-value-section search-result-list-value-section" id=""  onclick="" searchChapterId='+t[n].chapterId+">"+t[n].chapterTitleInherit+'</div><span class="search-count-by-section">'+t[n].numFound+" results found ></span></a></li>");$("ul#searchAutoSuggestList").length>1&&($("ul#searchAutoSuggestList")[1].style.display="none")}e.contentSearchResultVOList||"true"!==e.status||($(".search-result").show(),$(".resultFound").html("No result found."),$(".resultFound").attr("aria-label","No result found.")),$(".search-loading-spinner").hide(),$(".search-by-page-tab").attr("onclick","searchByPageResults(event)")[1],$(".popover-search-field").val(searchedText),searchedTextSaved=$(".popover-search-field")[1].value,searchResultListVisible=!0,$("#search-by-section-tab").focus(),sessionTimeOut()},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain,$(".search-loading-spinner").hide(),$(".search-by-page-tab").attr("onclick","searchByPageResults(event)")[1]})}else $(".search-result-list").html("")}function expandSearchResultFromChapter(e){searchChapterId=e.currentTarget.getAttribute("searchChapterId"),$(".search-result-section").scrollTop(0)[1];var t,n=$(".popover-search-field")[1].value,i={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"EREADER_SEARCH_BOOK_CONTENT_FOR_CHAPTER",pageNavigatingFrom:"EReader",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,ipAddress:localStorage.getItem("ipAddress"),sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},contentSearchVO:{bookId:CaseConnect.currentBookId,searchKeyWord:n,chapterId:searchChapterId}};$(".search-loading-spinner").show(),$(".search-result-list").css("opacity","0.6"),$.ajax({url:properties[properties.env]+"/manageSearchService/searchTextInBookForChapterId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(e){if(void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),e.contentSearchResultVOList){for(i=0;i<bookChapterSupplimentList.length;i++)bookChapterSupplimentList[i].chapterId===searchChapterId&&(t=bookChapterSupplimentList[i].chapterNumber);var n=[];e.contentSearchResultVOList.length>0?(n=e.contentSearchResultVOList,$(".resultFound").html("Showing "+n.length+" results for Chapter "+t)):(n.push(e.contentSearchResultVOList),$(".resultFound").html("Showing "+n.length+" result for Chapter "+t)),$(".search-result-list").html(""),$("input#search-text")[1].focus();for(var i=0;i<n.length;i++){n[i].aheadTitleInherit||n[i].bheadTitleInherit||!n[i].selectedText||$(".search-result-list").append('<li class="search-result-item list-style-none"><a href="#" onClick="pageNavigationFromSearch(event)" class="display-inline-block" style="width:100%" id="sectionId'+n[i].sectionId+'" currentpage = '+n[i].pageNumber+' ><div class="search-item-byChapter-textresult" currentpage = '+n[i].pageNumber+">"+n[i].selectedText+"</div></a></li>"),n[i].aheadTitleInherit&&n[i].bheadTitleInherit&&n[i].selectedText&&$(".search-result-list").append('<li class="search-result-item list-style-none"><a href="#" onClick="pageNavigationFromSearch(event)" class="display-inline-block" style="width:100%" id="sectionId'+n[i].sectionId+'" currentpage = '+n[i].pageNumber+' ><div class="search-item-byChapter-sectionTitle">'+n[i].aheadTitleInherit+'</div><div class="search-item-byChapter-sectionBHead">'+n[i].bheadTitleInherit+'</div><div class="search-item-byChapter-textresult"   currentpage = '+n[i].pageNumber+" >"+n[i].selectedText+"</div></a></li>"),n[i].aheadTitleInherit&&!n[i].bheadTitleInherit&&n[i].selectedText&&$(".search-result-list").append('<li class="search-result-item list-style-none"><a href="#" onClick="pageNavigationFromSearch(event)" class="display-inline-block" style="width:100%" id="sectionId'+n[i].sectionId+'" currentpage = '+n[i].pageNumber+'><div class="search-item-byChapter-sectionTitle">'+n[i].aheadTitleInherit+'</div><div class="search-item-byChapter-textresult" currentpage = '+n[i].pageNumber+">"+n[i].selectedText+"</div></a></li>");$("#"+n[i].chapterId+"contentSearchChapterText")}$(".search-result").show(),$(".back-to-section-result").show()}(e.contentSearchResultVOList||"true"!==e.status)&&e.contentSearchResultVOList||($(".search-result").show(),$(".resultFound").html("No result found."),$(".resultFound").attr("aria-label","No result found.")),$(".search-count-by-section").hide(),$(".search-result-list").css("opacity","1"),$(".search-loading-spinner").hide(),sessionTimeOut()},function(e){sessionTimeOut(),sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($(".search-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain,$(".search-loading-spinner").hide(),$(".search-result-list").css("opacity","1")})}function backToChapterResultList(){$(".search-result").hide(),$(".back-to-section-result").hide(),searchResultBySection()}!function(e){e.fn.placeholder=function(t){return this.each(function(){var n,i=e(this),o="placeholder"in document.createElement("input");function a(){if(""===i.val()){if("password"===i.attr("type"))try{i.attr("type","text")}catch(e){return!1}i.val(n),i.addClass("ui-placeholder")}}n=void 0===t?e(this).attr("placeholder"):t,o?i.attr("placeholder",n):(a(i.blur(function(t){a(e(t.target))}).focus(function(e){i.removeClass("ui-placeholder"),i.val()===n&&i.val("")})),i.parents("form").submit(function(e){i.val()===n&&i.val("")}))})}}(jQuery),$(window).resize(function(e){if($("ul.drop-nav-navigation-cog li[displayInReadOnly]").hide(),$("ul.drop-nav-navigation-cog li[displayInReadOnly]").css("display","none"),$(".header-read-right div[displayInReadOnly]").hide(),$(".header-read-right div[displayInReadOnly]").css("display","none"),$(".header-read-right div[displayInCasesOnly]").hide(),$(".header-read-right div[displayInCasesOnly]").css("display","none"),$(".header-read-right div[displayInOutlineOnly]").hide(),$(".header-read-right div[displayInOutlineOnly]").css("display","none"),$("#insights-student-total-result").children("div.insights-total-doughnut:first").css("border-right","2px solid #dbdbdb"),$("#insights-pdf-total-result").children("div.insights-total-doughnut:first").css("border-right","2px solid #dbdbdb"),$("#insights-pdf-total-result .insights-total-doughnut.donut-wrapper").children("div#chartAll:first").css("border-right","2px solid #dbdbdb"),$(".prevent-split").children("div.faculty-class-materials .student-dashboard-chapter-elements:first").css("border-top","0px solid #dbdbdb"),(n=$(window).width())<768&&$("#insights-student-total-result").children("div.insights-total-doughnut:first").css("border-right","0px solid #dbdbdb"),fixLeftAndHeaderInDesktop(),insideEreader){if(insideGlobalSearchResult=!1,"Android"===CaseConnect.deviceOS&&!0===CaseConnect.androidIssueKeypad)return CaseConnect.androidIssueKeypad=!1,e.preventDefault(),!1;if("goToPageTop"===CaseConnect.goToPageTop)document.getElementById("ereader-scroller").scrollTop=0;var t=$(window).height(),n=$(window).width();if(insideTouchDevices)$(".ereader-sub-header-desktop .create-annotation-tch-btn").css("display","block"),$("#ebook-print").css("display","none"),$(".ebook-print").hide();else{ereaderPrintClicked&&(reCalculateBriefOnRight(),reCalculateNotesOnRight(),reCalculateLinkOnLeft(),reCalculateRtSOnLeft()),$(".ereader-sub-header-desktop .create-annotation-tch-btn").css("display","none"),$("#ebook-print").css("display","block"),$(".ebook-print").show();var n=$(window).width()}if($(".rTsIconPopover").popover("hide"),"Android"===CaseConnect.deviceOS&&"Chrome"===CaseConnect.browserName&&"add-note-textarea"===$(document.activeElement).attr("id")&&"add-link-textarea"===$(document.activeElement).attr("id")&&"add-brief-textarea"===$(document.activeElement).attr("id"))return e.preventDefault(),!1;updatingNote||addingNote||addingLink||updatingLink||addingBrief||updatingBrief||(reCalculateNotesOnRight(),reCalculateBriefOnRight(),reCalculateLinkOnLeft(),reCalculateRtSOnLeft());t=$(window).height(),n=$(window).width();heightWithoutHeader=0,$("#media-elements-column").height($(".ereader-content").height()+31);var i=$(".next-chapter-footer").css("display");if(n<768){nextChapterFooterHeight=$("#next-chapter-footer").height();var o=$("#ereader").height()+$(".ereader-green-block").height()+1;heightWithHeader="block"===i?o+parseInt(nextChapterFooterHeight):o}else heightWithHeader="block"===i?$("#header-wrapper").height()+$(".ereader-green-block").height()+1+$("#next-chapter-footer").height()+$(".content-top-menu").height()+1:139;"block"===$("#email-notification").css("display")?heightWithHeader+=$("#email-notification").height():heightWithHeader=heightWithHeader;heightWithHeader;var a=$(".app-left-navigation").height()-($(".content-top-menu").height()+1);$(".ereader-scroll-container").css("max-height",t-heightWithHeader),$(".ereader-scroll-container").css("height",t-heightWithHeader),navigator.userAgent.match(/(iPad|Android|iPhone)/)&&($(".ereader-scroll-container").css("height",t-heightWithHeader),$(".ereader-scroll-container").css("max-height",t-heightWithHeader));var s=0;s=($("#ereader-scroller").height()+$(".content-top-menu").height()+2).toString()+"px",$(".app-left-navigation").css("min-height",s);t=$(window).height(),n=$(window).width();if("true"==CaseConnect.resourceFlag&&($(".resourceMenushow").removeClass("resourceMenuhide"),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&(n<992&&n>767?"true"==CaseConnect.resourceFlag&&($(".resourceMenushow").removeClass("resourceMenuhide"),$(".ereader-sub-header-previous span").css("width","auto"),$(".ereader-sub-header-previous span").css("padding","0px"),$(".ereader-header-btn-field button").css("padding","0 6px"),$("#ereader-total-pge-count").css("display","none"),$(".ereader-pge-count-span").css("display","none")):($("#ereader-total-pge-count").css("display","inline-block"),$(".ereader-pge-count-span").css("display","inline-block"),$(".ereader-sub-header-pages").removeAttr("style"),$(".ereader-header-btn-field button").removeAttr("style"),$(".ereader-sub-header-previous span").removeAttr("style"),$(".ereader-sub-header-row").removeAttr("style"))),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide()),disableCopyPaste(),$("ul.drop-nav-navigation-cog li[displayInReadOnly]").show(),$("ul.drop-nav-navigation-cog li[displayInReadOnly]").css("display","inline-block"),$(".header-read-right div[displayInReadOnly]").show(),$(".header-read-right div[displayInReadOnly]").css("display","inline-block"),$(".header-read-right div[displayInCasesOnly]").hide(),$(".header-read-right div[displayInCasesOnly]").css("display","none"),$(".header-read-right div[displayInOutlineOnly]").hide(),$(".header-read-right div[displayInOutlineOnly]").css("display","none"),ereaderPrintClicked){var r=$("#ereader-container #ereader-scroller").css("max-height").replace("px",""),l=(r=parseInt(r)+1)+"px";$("#print-content-modal .modal-content .ereader-assessment-modal-body").css("max-height",l),$("#print-content-modal .modal-content .ereader-assessment-modal-body .print-options").css("height",l)}}if(insideOutline&&(insideCasesPage=!1,insideEreader=!1,insideNewsFeed=!1,insideAssessment=!1,insideResourcePage=!1,insideStudycenterPage=!1,insideStaticPage=!1,insideBookshelf=!1,insideClassInsightsPage=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,(n=$(window).width())<768?($(".outline-editor-header-editable-desktop").hide(),$(".new-note-save-mobile").show()):($(".outline-editor-header-editable-desktop").show(),$(".new-note-save-mobile").hide()),$(".header-read-right div[displayInOutlineOnly]").show(),$(".header-read-right div[displayInOutlineOnly]").css("display","inline-block"),$(".header-read-right div[displayInReadOnly]").hide(),$(".header-read-right div[displayInReadOnly]").css("display","none"),$(".header-read-right div[displayInCasesOnly]").hide(),$(".header-read-right div[displayInCasesOnly]").css("display","none"),$("ul.drop-nav-navigation-cog li[displayInReadOnly]").hide(),$("ul.drop-nav-navigation-cog li[displayInReadOnly]").css("display","none"),outlineSearchText(),outlineSearchTextMobile(),casesSearchText(),n>768)){t=$(window).height();var d,c=0,h=0,p=0,u=(a=0,0);(c=parseInt($(".app-left-navigation li").css("height")))*(I=$(".app-left-navigation li a").length)-25;var g=(u=(p=t-(h=parseInt($("#header-wrapper").css("height"))+parseInt($(".outline-blue-block").css("height"))+parseInt($(".outline-heading-chapter-title").css("height"))+parseInt($("#export-chapter-outline").css("height"))+25))>(a=c*I-(d=parseInt($(".outline-heading-chapter-title").css("height"))+parseInt($("#export-chapter-outline").css("height"))+25))?p:a)+35;$(".outline-notes-list-block-desktop").css("height",g+"px");var m=u+d;$(".outline-notes-column").css("height",m+"px"),$(".outline-notes-list-block-desktop").css("overflow-y","hidden"),insideCustomOutline||($(".outline-editor-container").css("height",u+"px"),$(".outline-editor-container").css("overflow-y","hidden"),$(".outline-editor-container").customScrollbar({skin:"default-skin",hScroll:!1,vScroll:!0,updateOnWindowResize:!0})),parseInt($("#outline-notes-list-block li").css("height"))*$("#outline-notes-list-block li").length>g?$(".outline-notes-list-block-desktop").customScrollbar({skin:"default-skin",hScroll:!1,vScroll:!0,updateOnWindowResize:!0}):$(".outline-notes-list-block-desktop").removeClass("default-skin")}if(insideCasesPage&&!insideManageConnection){if(insideGlobalSearchResult=!1,"Android"===CaseConnect.deviceOS&&!0===CaseConnect.androidIssueKeypad)return CaseConnect.androidIssueKeypad=!1,e.preventDefault(),!1;if("Android"===CaseConnect.deviceOS&&"Chrome"===CaseConnect.browserName&&"add-note-textarea"===$(document.activeElement).attr("id")&&"add-link-textarea"===$(document.activeElement).attr("id")&&"add-brief-textarea"===$(document.activeElement).attr("id"))return e.preventDefault(),!1;updatingNote||addingNote||addingLink||updatingLink||addingBrief||updatingBrief||(reCalculateNotesOnRight(),reCalculateBriefOnRight(),reCalculateLinkOnLeft());t=$(window).height(),n=$(window).width();"true"==CaseConnect.resourceFlag&&($(".resourceMenushow").removeClass("resourceMenuhide"),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&(n<992&&n>767?"true"==CaseConnect.resourceFlag&&($(".resourceMenushow").removeClass("resourceMenuhide"),$(".ereader-sub-header-previous span").css("width","auto"),$(".ereader-sub-header-previous span").css("padding","0px"),$(".ereader-header-btn-field button").css("padding","0 6px"),$("#ereader-total-pge-count").css("display","none"),$(".ereader-pge-count-span").css("display","none")):($("#ereader-total-pge-count").css("display","inline-block"),$(".ereader-pge-count-span").css("display","inline-block"),$(".ereader-sub-header-pages").removeAttr("style"),$(".ereader-header-btn-field button").removeAttr("style"),$(".ereader-sub-header-previous span").removeAttr("style"),$(".ereader-sub-header-row").removeAttr("style")))),"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide();t=$(window).height(),n=$(window).width();var b=localStorage.getItem("caseExcerptClicked"),f=localStorage.getItem("shareBriefClickedMobile");n>991&&(leftPaneTitle=$("h2.case-left-header").html(),rightPaneTitle=$("h2.case-right-header").html()),(n<992&&!caseExcerptClicked||n<992&&null!==b&&"true"!==b)&&(n<992&&null!==f&&"true"!==f||n<992&&!shareBriefClickedMobile)?(showBrief(),n<992&&("undefined"!=typeof caseExcerptRightTitle||"undefined"!=typeof caseExcerptLeftTitle)&&("My Brief"!==caseExcerptRightTitle&&"Shared Brief"===caseExcerptLeftTitle||"My Brief"!==caseExcerptLeftTitle&&"Shared Brief"===caseExcerptRightTitle)&&showCaseExcerptOnResize()):n<992&&caseExcerptClicked||n<992&&"true"===b||n<992&&null!==f&&"true"!==f||n<992&&!shareBriefClickedMobile?showCaseExcerptOnResize():n<992&&null!==f&&"true"===f||n<992&&shareBriefClickedMobile||showCasesInDesktop(),$(".header-read-right div[displayInCasesOnly]").show(),$(".header-read-right div[displayInCasesOnly]").css("display","inline-block"),$(".header-read-right div[displayInReadOnly]").hide(),$(".header-read-right div[displayInReadOnly]").css("display","none"),$(".header-read-right div[displayInOutlineOnly]").hide(),$(".header-read-right div[displayInOutlineOnly]").css("display","none"),$("ul.drop-nav-navigation-cog li[displayInReadOnly]").hide(),$("ul.drop-nav-navigation-cog li[displayInReadOnly]").css("display","none"),adjustLeftNavHeight();var C=0;if($(".case-excerpt-md-wrapper")&&n>991){$(".case-excerpt-md-wrapper").css("height","0px"),$(".case-excerpt-md-wrapper").css("min-height","0px");var v,y=$(window).height();h=0,a=0;h=parseInt($("#header-wrapper").css("height"))+parseInt($(".cases-two-div-block").css("height"))+parseInt($("#cases-heading-details").css("height"))+parseInt($(".case-menu-header").css("height")),v=parseInt($(".cases-two-div-block").css("height"))+parseInt($("#cases-heading-details").css("height"));p=0,c=0;c=parseInt($(".app-left-navigation li").css("height"));for(var x=0,I=$(".app-left-navigation li a").length,k=0;k<I;k++){var T=$(".app-left-navigation li a")[k];"none"!==$(T).css("display")?x+=1:x=x}u=0;u=(p=y-h)>(a=c*x-v)?p:a,$(".case-excerpt-md-wrapper").css({"min-height":u+"px",height:u+"px"}),$(".case-excerpt-second-div").css({"min-height":u+"px",height:u+"px"}),$(".case-excerpt-first-div").css({"min-height":u+"px",height:u+"px"}),$(".shared-brief-wrapper").css({"min-height":u+"px",height:u+"px"}),$(".myBrief").css({"min-height":u+"px",height:u+"px"}),$("#dragbar").css({"min-height":u+"px"}),p>a||adjustLeftNavHeight()}outlineSearchText(),outlineSearchTextMobile(),casesSearchText()}if(insideManageConnection){if(insideGlobalSearchResult=!1,"Android"===CaseConnect.deviceOS&&!0===CaseConnect.androidIssueKeypad)return CaseConnect.androidIssueKeypad=!1,e.preventDefault(),!1;t=$(window).height(),n=$(window).width();if("true"==CaseConnect.resourceFlag&&($(".resourceMenushow").removeClass("resourceMenuhide"),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&(n<992&&n>767?"true"==CaseConnect.resourceFlag&&($(".resourceMenushow").removeClass("resourceMenuhide"),$(".ereader-sub-header-previous span").css("width","auto"),$(".ereader-sub-header-previous span").css("padding","0px"),$(".ereader-header-btn-field button").css("padding","0 6px"),$("#ereader-total-pge-count").css("display","none"),$(".ereader-pge-count-span").css("display","none")):($("#ereader-total-pge-count").css("display","inline-block"),$(".ereader-pge-count-span").css("display","inline-block"),$(".ereader-sub-header-pages").removeAttr("style"),$(".ereader-header-btn-field button").removeAttr("style"),$(".ereader-sub-header-previous span").removeAttr("style"),$(".ereader-sub-header-row").removeAttr("style")))),"true"==CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),n>991)"true"==$("[aria-controls='peopleYouMayKnow']").parent().hasClass("active").toString()&&($('.connection-tabs a[href="#addConnections"]').trigger("click"),$('.connection-tabs a[href="#peopleYouMayKnow"]').blur());if(n<992&&n>768){var w=$(".tab-pane.active").attr("id");$(".connection-tabs.dropdown-menu").find('a[aria-controls="'+w+'"]').length>0&&$(".connection-tabs.dropdown-menu").find('a[aria-controls="'+w+'"]').parent().addClass("active")}if(n<768){$(".connection-tabs.dropdown-menu").children().removeClass("active");$(".connection-tabs.dropdown-menu").children();var A=$(".tab-pane.active").attr("id");$(".connection-tabs.dropdown-menu").find('a[aria-controls="'+A+'"]').length>0&&$(".connection-tabs.dropdown-menu").find('a[aria-controls="'+A+'"]').parent().addClass("active")}}(insideCasesPage||(shareBriefClickedMobile=!1),insideNewsFeed)&&(insideCasesPage=!1,insideOutline=!1,insideResourcePage=!1,insideStudycenterPage=!1,insideGlobalSearchResult=!1,$(".content-wrapper").css("padding-bottom","0px"),(n=$(window).width())>768&&null!==rssFeedSAList?(selectFeedFunction(),$(".news-feed-filter").css("display","inline-block"),$(".news-feed-content-wrap").css("display","inline-block"),$(".all-news-content-wrapper").css("display","inline-block"),$(".all-news-content-wrapper").removeAttr("style")):n>768&&null===rssFeedSAList?(selectFeedFunction(),$(".news-feed-content-wrap").css("display","none"),$(".all-news-content-wrapper").removeClass("hidden-xs"),$(".all-news-content-wrapper").css("width","100%"),$(".all-feed-status-bar").css("width","100%")):selectFeedFunction(),n>768&&null==rssFeedAllList?($(".all-news-content-wrapper").css("display","none"),$(".news-feed-filter-toggle").css("display","none"),$(".news-feed-filter-toggle").removeClass("visible-xs"),$(".news-feed-content-wrap").css("width","100%"),$(".news-feed-status-bar").css("width","100%")):n>768&&null!==rssFeedAllList&&null!==rssFeedSAList&&($(".all-news-content-wrapper").css("display","inline-block"),$(".news-feed-filter-toggle").css("display","inline-block"),$(".news-feed-content-wrap").removeAttr("style"),$(".news-feed-status-bar").removeAttr("style"),$(".news-feed-filter-toggle").addClass("visible-xs")));if(insideResourcePage&&(insideGlobalSearchResult=!1,adjustLeftNavHeight()),"true"===localStorage.getItem("InsideClasInsights")||insideClassInsightsPage){if(insideCasesPage=!1,insideOutline=!1,insideResourcePage=!1,insideEreader=!1,insideStudycenterPage=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,$(".content-wrapper").css("padding-bottom","0px"),"Student"===CaseConnect.currentUserRole){var S=parseInt($("#studyDashBoard").css("height"))-22;$(".student-dashboard-table").height(S+"px"),$(".professor-dashboard-table-td").height(S+"px")}else if("Professor"===CaseConnect.currentUserRole){var N=parseInt($("#studyDashBoard").css("height"))-50;$(".professor-dashboard-table").height(N+"px"),$(".professor-dashboard-table-td").height(N+"px")}if(adjustLeftNavHeight(),void 0!==$(".student-dashboard-table")&&$(".student-dashboard-table").length>0){var O=parseInt($(".student-dashboard-table").css("width"))/4;$(".professor-dashboard-table-td").css("width",O)}if(void 0!==$(".professor-dashboard-table")&&$(".professor-dashboard-table").length>0){O=parseInt($(".professor-dashboard-table").css("width"))/4;$(".professor-dashboard-table-td").css("width",O)}}if(insideStudycenterPage){insideCasesPage=!1,insideOutline=!1,insideEreader=!1,insideResourcePage=!1,insideNewsFeed=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1;s=null;$("#wk_content").css("padding-bottom","0px"),$(".content-wrapper").css("padding-bottom","0px"),(n=$(window).width())>991&&setTimeout(function(){adjustLeftNavHeight()},300),n>768?$(".study-chapter-list-popover").css({width:"65%"}):$(".study-chapter-list-popover").css({width:"100%"})}if(insideThemis){n=window.innerWidth;if(themisLandingPage){var B=$(".overall-progress-wrapper div.progress-bar-cc-correct").css("width");if("0%"===$(".overall-progress-wrapper div.progress-bar-cc-correct span").html()?$(".overall-progress-wrapper .progress-bar-cc-incorrect span").hide():$(".overall-progress-wrapper .progress-bar-cc-incorrect span").show(),parseInt(B)<35){var P=$(".progress-bar-cc-correct span.progress-text").width()+5+"px";$(".overall-progress-wrapper .progress-bar-cc-incorrect span").css({position:"absolute",left:P})}else $(".overall-progress-wrapper .progress-bar-cc-incorrect span").css({position:"",left:""});var R=$(".course-progress-bar div.progress-bar-cc-correct");$(R).each(function(e){var t=$(this).css("width");if(parseInt(t)<35)$(this).find("span").width()}),$(".resourceMenushow").addClass("resourceMenuhide")}else{var L=$(".quiz-details-title"),E=0;$(L).each(function(){this.clientHeight>E&&(E=this.clientHeight),0!==E&&($(L).height(E+"px"),E=0)});var F=$("#themis-checkpoint-content .doughnut");for(k=0;k<F.length;k++)if("background-gray"==F[k].classList[5]){H=k;break}if(n<768){$("#themis-checkpoint-content .doughnut").hide(),$("#themis-checkpoint-content .doughnut.background-gray").show(),$(".display-title-info").next(".display-title-elems").css("width","85%"),$(".display-title-elems").css("margin-left","14px"),$(".display-title-info").next(".display-title-elems").children("p.themis-message:first-child").css("margin-left","25px"),$(".themis-quiz-circle").parent().attr({width:"100",height:"100"}),$(".themis-quiz-circle").attr({r:"47",cx:"49",cy:"49"});var M=$(".themis-quiz-inner-circle");$(M).each(function(e){var t=incrementRadius($(this).attr("radius"));$(this).attr({r:t,cx:"49",cy:"49"})}),$(".prev-checkpoint-arrow.hidden-xs").hide(),$(".next-checkpoint-arrow.hidden-xs").hide(),0==H?($(".prev-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".next-checkpoint-arrow.hidden-lg.hidden-md").show()):H==F.length-1?($(".next-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".prev-checkpoint-arrow.hidden-lg.hidden-md").show()):($(".next-checkpoint-arrow.hidden-lg.hidden-md").show(),$(".prev-checkpoint-arrow.hidden-lg.hidden-md").show())}else if(n<992&&n>767){$(".display-title-info").next(".display-title-elems").css("width","95%"),$(".display-title-elems").css("margin-left","14px"),$(".display-title-info").next(".display-title-elems").children("p.themis-message:first-child").css("margin-left","25px"),$(".themis-quiz-circle").parent().attr({width:"180",height:"180"}),$(".themis-quiz-circle").attr({r:"84",cx:"90",cy:"90"});M=$(".themis-quiz-inner-circle");$(M).each(function(e){var t=incrementRadius($(this).attr("radius"));$(this).attr({r:t,cx:"90",cy:"90"})}),$("#themis-checkpoint-content .doughnut").hide(),$(".prev-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".next-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".prev-checkpoint-arrow.hidden-xs").show(),$(".next-checkpoint-arrow.hidden-xs").show(),null!=H&&null!=H&&(0==H?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+2].style.display="inline-block",$(".prev-checkpoint-arrow.hidden-xs").hide()):H==F.length-1?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-2].style.display="inline-block",$(".next-checkpoint-arrow.hidden-xs").hide()):($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block"))}else if(n<1025&&n>991){$(".display-title-info").next(".display-title-elems").css("width","95%"),$(".display-title-elems").css("margin-left","14px"),$(".display-title-info").next(".display-title-elems").children("p.themis-message:first-child").css("margin-left","25px"),$(".themis-quiz-circle").parent().attr({width:"100",height:"100"}),$(".themis-quiz-circle").attr({r:"47",cx:"49",cy:"49"});M=$(".themis-quiz-inner-circle");$(M).each(function(e){var t=incrementRadius($(this).attr("radius"));$(this).attr({r:t,cx:"49",cy:"49"})}),$("#themis-checkpoint-content .doughnut").hide(),$(".prev-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".next-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".prev-checkpoint-arrow.hidden-xs").show(),$(".next-checkpoint-arrow.hidden-xs").show(),null!=H&&null!=H&&(0==H?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+2].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+3].style.display="inline-block",$(".prev-checkpoint-arrow.hidden-xs").hide()):H==F.length-1?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-2].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-3].style.display="inline-block",$(".next-checkpoint-arrow.hidden-xs").hide()):3==H?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-2].style.display="inline-block"):($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+2].style.display="inline-block"))}else{$(".themis-quiz-circle").parent().attr({width:"100",height:"100"}),$(".themis-quiz-circle").attr({r:"47",cx:"49",cy:"49"});M=$(".themis-quiz-inner-circle");$(M).each(function(e){var t=incrementRadius($(this).attr("radius"));$(this).attr({r:t,cx:"49",cy:"49"})}),$("#themis-checkpoint-content .doughnut").show(),$(".display-title-info").next(".display-title-elems").css("width","95%"),$(".display-title-elems").css("margin-left","14px"),$(".display-title-info").next(".display-title-elems").children("p.themis-message:first-child").css("margin-left","25px"),$(".prev-checkpoint-arrow.hidden-xs").hide(),$(".next-checkpoint-arrow.hidden-xs").hide()}}}else if(insideThemisAdmin){n=window.innerWidth;if(CaseConnect.currentProductId=localStorage.getItem("currentProductId"),null!==CaseConnect.currentProductId&&""!==CaseConnect.currentProductId&&"null"!==CaseConnect.currentProductId?$(".hide-bar-check-class").show():$(".hide-bar-check-class").hide(),insideThemisStudProfile){B=$(".overall-progress-wrapper div.progress-bar-cc-correct").css("width");if("0%"===$(".overall-progress-wrapper div.progress-bar-cc-correct span").html()?$(".overall-progress-wrapper .progress-bar-cc-incorrect span").hide():$(".overall-progress-wrapper .progress-bar-cc-incorrect span").show(),parseInt(B)<35){P=$(".progress-bar-cc-correct span.progress-text").width()+5+"px";$(".overall-progress-wrapper .progress-bar-cc-incorrect span").css({position:"absolute",left:P})}else $(".overall-progress-wrapper .progress-bar-cc-incorrect span").css({position:"",left:""});R=$(".course-progress-bar div.progress-bar-cc-correct");$(R).each(function(e){var t=$(this).css("width");if(parseInt(t)<35)$(this).find("span").width()})}if(insideAdminQuiz){null!=localStorage.getItem("CurrentSubjectAreaTitle")&&null!=localStorage.getItem("CurrentSubjectAreaTitle")?($("nav-ipad-saTitleName.institution-name").html(localStorage.getItem("CurrentSubjectAreaTitle")),$(".nav-ipad-saTitleName.institution-name").attr("title",localStorage.getItem("CurrentSubjectAreaTitle"))):$("nav-ipad-saTitleName.institution-name").html(""),$(".navbar-ipad-section").children().removeClass("border-bottom-blue"),$("#themisAdminCourses-popover li a").removeClass("border-bottom-blue"),$(".navbar-ipad-section").children().children().removeClass("border-bottom-blue"),$(".navbar-ipad-section").children().children().children().removeClass("border-bottom-blue");L=$(".quiz-details-title"),E=0;$(L).each(function(){this.clientHeight>E&&(E=this.clientHeight),0!==E&&($(L).height(E+"px"),E=0)});var H;for(F=$("#themis-checkpoint-content .doughnut"),k=0;k<F.length;k++)if("background-gray"==F[k].classList[5]){H=k;break}if(n<768){$("#themis-checkpoint-content .doughnut").hide(),$("#themis-checkpoint-content .doughnut.background-gray").show(),$(".display-title-info").next(".display-title-elems").css("width","85%"),$(".display-title-elems").css("margin-left","14px"),$(".display-title-info").next(".display-title-elems").children("p.themis-message:first-child").css("margin-left","25px"),$(".themis-quiz-circle").parent().attr({width:"100",height:"100"}),$(".themis-quiz-circle").attr({r:"47",cx:"49",cy:"49"});M=$(".themis-quiz-inner-circle");$(M).each(function(e){var t=incrementRadius($(this).attr("radius"));$(this).attr({r:t,cx:"49",cy:"49"})}),$(".prev-checkpoint-arrow.hidden-xs").hide(),$(".next-checkpoint-arrow.hidden-xs").hide(),0==H?($(".prev-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".next-checkpoint-arrow.hidden-lg.hidden-md").show()):H==F.length-1?($(".next-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".prev-checkpoint-arrow.hidden-lg.hidden-md").show()):($(".next-checkpoint-arrow.hidden-lg.hidden-md").show(),$(".prev-checkpoint-arrow.hidden-lg.hidden-md").show())}else if(n<992&&n>767){$(".display-title-info").next(".display-title-elems").css("width","95%"),$(".display-title-elems").css("margin-left","14px"),$(".display-title-info").next(".display-title-elems").children("p.themis-message:first-child").css("margin-left","25px"),$(".themis-quiz-circle").parent().attr({width:"180",height:"180"}),$(".themis-quiz-circle").attr({r:"84",cx:"90",cy:"90"});M=$(".themis-quiz-inner-circle");$(M).each(function(e){var t=incrementRadius($(this).attr("radius"));$(this).attr({r:t,cx:"90",cy:"90"})}),$("#themis-checkpoint-content .doughnut").hide(),$(".prev-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".next-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".prev-checkpoint-arrow.hidden-xs").show(),$(".next-checkpoint-arrow.hidden-xs").show(),null!=H&&null!=H&&(0==H?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+2].style.display="inline-block",$(".prev-checkpoint-arrow.hidden-xs").hide()):H==F.length-1?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-2].style.display="inline-block",$(".next-checkpoint-arrow.hidden-xs").hide()):($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block"))}else if(n<1025&&n>991){$(".display-title-info").next(".display-title-elems").css("width","95%"),$(".display-title-elems").css("margin-left","14px"),$(".display-title-info").next(".display-title-elems").children("p.themis-message:first-child").css("margin-left","25px"),$(".themis-quiz-circle").parent().attr({width:"100",height:"100"}),$(".themis-quiz-circle").attr({r:"47",cx:"49",cy:"49"});M=$(".themis-quiz-inner-circle");$(M).each(function(e){var t=incrementRadius($(this).attr("radius"));$(this).attr({r:t,cx:"49",cy:"49"})}),$("#themis-checkpoint-content .doughnut").hide(),$(".prev-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".next-checkpoint-arrow.hidden-lg.hidden-md").hide(),$(".prev-checkpoint-arrow.hidden-xs").show(),$(".next-checkpoint-arrow.hidden-xs").show(),null!=H&&null!=H&&(0==H?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+2].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+3].style.display="inline-block",$(".prev-checkpoint-arrow.hidden-xs").hide()):H==F.length-1?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-2].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-3].style.display="inline-block",$(".next-checkpoint-arrow.hidden-xs").hide()):3==H?($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-2].style.display="inline-block"):($("#themis-checkpoint-content .doughnut")[H].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H-1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+1].style.display="inline-block",$("#themis-checkpoint-content .doughnut")[H+2].style.display="inline-block"))}else{$(".themis-quiz-circle").parent().attr({width:"100",height:"100"}),$(".themis-quiz-circle").attr({r:"47",cx:"49",cy:"49"});M=$(".themis-quiz-inner-circle");$(M).each(function(e){var t=incrementRadius($(this).attr("radius"));$(this).attr({r:t,cx:"49",cy:"49"})}),$("#themis-checkpoint-content .doughnut").show(),$(".display-title-info").next(".display-title-elems").css("width","95%"),$(".display-title-elems").css("margin-left","14px"),$(".display-title-info").next(".display-title-elems").children("p.themis-message:first-child").css("margin-left","25px"),$(".prev-checkpoint-arrow.hidden-xs").hide(),$(".next-checkpoint-arrow.hidden-xs").hide()}}else null!=localStorage.getItem("mbeAdminSchoolName")&&null!=localStorage.getItem("mbeAdminSchoolName")&&($(".nav-ipad-saTitleName.institution-name").html(localStorage.getItem("mbeAdminSchoolName")),$(".nav-ipad-saTitleName.institution-name").attr("title",localStorage.getItem("mbeAdminSchoolName")))}else CaseConnect.currentProductId=localStorage.getItem("currentProductId"),CaseConnect.themisSubjectAreaId="",null!==CaseConnect.currentProductId&&""!==CaseConnect.currentProductId&&"null"!==CaseConnect.currentProductId?$(".hide-bar-check-class").show():$(".hide-bar-check-class").hide();if(insideCQuizzing){var z=$(window).width(),V=$(".cQuizMain-container").width();$(".tutoriallink").hide(),z<768&&z>=V?$("#header-wrapper").hide():$("#header-wrapper").show(),"Student"===map.userRole?($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Help Center")):($(".contactAssessmentSpecialistId").show(),$(".contactAssessmentSpecialistId button.contactAssessmentSpecialistBtn").html("Quiz Concierge")),adjustLeftNavHeight()}if(insidePracticePerfect){var D=$(window).width();$(".cQuizMain-container").width();$(".tutoriallink").hide(),D<768?$("#header-wrapper").hide():$("#header-wrapper").show(),adjustLeftNavHeight()}if(insideGlobalSearchResult?($("ul.drop-nav-navigation-cog li[displayInGlobalSearchOnly]").show(),$("ul.drop-nav-navigation-cog li[displayInGlobalSearchOnly]").css("display","inline-block"),$(".header-read-right div[displayInGlobalSearchOnly]").show(),$(".header-read-right div[displayInGlobalSearchOnly]").css("display","inline-block")):($("ul.drop-nav-navigation-cog li[displayInGlobalSearchOnly]").hide(),$("ul.drop-nav-navigation-cog li[displayInGlobalSearchOnly]").css("display","none"),$(".header-read-right div[displayInGlobalSearchOnly]").hide(),$(".header-read-right div[displayInGlobalSearchOnly]").css("display","none")),adjustLeftNavHeight(),insideCasesPage&&0!==C&&$(".case-excerpt-md-wrapper")&&n>991&&(C=0),"sameSession=true"==document.cookie||-1!==document.cookie.indexOf("sameSession=true")||"true"===CaseConnect.keepMeLoggedInFlag){if(insideStaticPage||insideCQuizzing||insidePracticePerfect)n<768?insideCQuizzing?($("#header-wrapper").hide(),$(".connectQuizzing-mob-header").css("display","block")):($(".header-mobile-view-small").css("display","block"),$(".header-mobile-view-wide").css("display","none")):insideCQuizzing?$(".connectQuizzing-mob-header").css("display","none"):($(".header-mobile-view-small").css("display","none"),$(".header-mobile-view-wide").css("display","block")),"1"==CaseConnect.userSuspendedFlag||localStorage.getItem("userSuspendedFlag"),adminNotificationTab();else{n=$(window).width();var q=$(".main-container").width();n<768&&n>=q?$("#header-wrapper").hide():($("#header-wrapper").show(),$(".cc-container-base").css({"margin-left":"20px","margin-right":"60px"}),$("#header .cc-container-base").css({"margin-left":"20px","margin-right":"60px"})),n<768?($(".header-mobile-view-small").css("display","block"),$(".header-mobile-view-wide").css("display","none")):($(".header-mobile-view-small").css("display","none"),$(".header-mobile-view-wide").css("display","block"))}currentTime=new Date,!1===timeoutToScroll&&(timeoutToScroll=!0,setTimeout(function e(){if(new Date-currentTime<delayTimeToScroll)setTimeout(e,delayTimeToScroll);else if(timeoutToScroll=!1,updatingNote||addingNote||addingLink||updatingLink||addingBrief||updatingBrief||(scrollTolastVisitedpage(),reCalculateNotesOnRight(),reCalculateBriefOnRight(),reCalculateLinkOnLeft(),reCalculateRtSOnLeft()),ereaderPrintClicked){var t=300;t=null!==localStorage.getItem("briefAnnotationListForChapter")?localStorage.getItem("briefAnnotationListForChapter").split(",").length:1e3;var i=(null!==localStorage.getItem("annotationListForChapter")?localStorage.getItem("annotationListForChapter").split(",").length:1e3)+t;i<50?setTimeout(function(){loadPrintModalAfterResize()},400):i>50&&i<150?setTimeout(function(){loadPrintModalAfterResize()},400):i>150&&i<400?setTimeout(function(){loadPrintModalAfterResize()},600):i>400&&i<800?setTimeout(function(){loadPrintModalAfterResize()},800):i>800&&i<1500?setTimeout(function(){loadPrintModalAfterResize()},1e3):i>1500&&i<3e3?setTimeout(function(){loadPrintModalAfterResize()},3e3):i>3e3&&i<4500?setTimeout(function(){loadPrintModalAfterResize()},5e3):setTimeout(function(){loadPrintModalAfterResize()},6e3)}insideBookshelf&&$(window).trigger("resize");if(insideEreader){if(n<768&&$("#txtPageNumMobile").val()&&CaseConnect.currentPageNumber){var o=document.getElementById("page-"+CaseConnect.currentPageNumber);if(o||$("#txtPageNumMobile").val()!==CaseConnect.currentPageNumber){var a=document.getElementById("page-"+CaseConnect.currentPageNumber),s=document.getElementById("ereader-scroller");$("ol.epub-parenlistlcletter li").addClass("goToPageBug"),$("ol.epub-parenlistucletter li").addClass("goToPageBug"),$("ol.epub-parenlistdecimal li").addClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").addClass("goToPageBug"),$("ol.epub-ucletter li").addClass("goToPageBug"),$("ol.epub-lcletter li").addClass("goToPageBug"),$("ol.epub-ucroman li").addClass("goToPageBug"),$("ol.epub-lcroman li").addClass("goToPageBug"),$("ol.epub-decimal li").addClass("goToPageBug"),$(".epub-law-case-marker").addClass("goToPageBug"),$(".epub-law-heading-container").addClass("goToPageBug");var r=a.offsetTop,l=$("#tab-section-container")[0].offsetTop,d="";d=parseInt(r)>parseInt(l)?r:l,"Android"!=CaseConnect.deviceOS&&(s.scrollTop=d),$("ol.epub-parenlistlcletter li").removeClass("goToPageBug"),$("ol.epub-parenlistucletter li").removeClass("goToPageBug"),$("ol.epub-parenlistdecimal li").removeClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").removeClass("goToPageBug"),$("ol.epub-ucletter li").removeClass("goToPageBug"),$("ol.epub-lcletter li").removeClass("goToPageBug"),$("ol.epub-ucroman li").removeClass("goToPageBug"),$("ol.epub-lcroman li").removeClass("goToPageBug"),$("ol.epub-decimal li").removeClass("goToPageBug"),$(".epub-law-case-marker").removeClass("goToPageBug"),$(".epub-law-heading-container").removeClass("goToPageBug")}}else if(n>767&&$("#txtPageNum").val()&&CaseConnect.currentPageNumber){var o=document.getElementById("page-"+CaseConnect.currentPageNumber);if(o||$("#txtPageNum").val()!==CaseConnect.currentPageNumber){var a=document.getElementById("page-"+CaseConnect.currentPageNumber),s=document.getElementById("ereader-scroller");$("ol.epub-parenlistlcletter li").addClass("goToPageBug"),$("ol.epub-parenlistucletter li").addClass("goToPageBug"),$("ol.epub-parenlistdecimal li").addClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").addClass("goToPageBug"),$("ol.epub-ucletter li").addClass("goToPageBug"),$("ol.epub-lcletter li").addClass("goToPageBug"),$("ol.epub-ucroman li").addClass("goToPageBug"),$("ol.epub-lcroman li").addClass("goToPageBug"),$("ol.epub-decimal li").addClass("goToPageBug"),$(".epub-law-case-marker").addClass("goToPageBug"),$(".epub-law-heading-container").addClass("goToPageBug");var r=a.offsetTop,l=$("#tab-section-container")[0].offsetTop,d="";d=parseInt(r)>parseInt(l)?r:l,"Android"!=CaseConnect.deviceOS&&(s.scrollTop=d),$("ol.epub-parenlistlcletter li").removeClass("goToPageBug"),$("ol.epub-parenlistucletter li").removeClass("goToPageBug"),$("ol.epub-parenlistdecimal li").removeClass("goToPageBug"),$("ol.epub-bracketlistdecimal li").removeClass("goToPageBug"),$("ol.epub-ucletter li").removeClass("goToPageBug"),$("ol.epub-lcletter li").removeClass("goToPageBug"),$("ol.epub-ucroman li").removeClass("goToPageBug"),$("ol.epub-lcroman li").removeClass("goToPageBug"),$("ol.epub-decimal li").removeClass("goToPageBug"),$(".epub-law-case-marker").removeClass("goToPageBug"),$(".epub-law-heading-container").removeClass("goToPageBug")}}insideEreader&&redirectingFromSearchBySection&&(redirectingFromSearchBySection=!1,document.getElementById(sectionIdToBeRedirected)&&$("#ereader-scroller").scrollTop(document.getElementById(sectionIdToBeRedirected).offsetTop))}},delayTimeToScroll))}else $("ul.drop-nav-navigation-cog li[displayInGlobalSearchOnly]").hide(),$("ul.drop-nav-navigation-cog li[displayInGlobalSearchOnly]").css("display","none"),$(".header-read-right div[displayInGlobalSearchOnly]").hide(),$(".header-read-right div[displayInGlobalSearchOnly]").css("display","none");n=$(window).width();$(".cases-notification-cog-new sup").css("left","0px"),fixLeftAndHeaderInDesktop(),insideStaticPage&&($(".tutoriallink").hide(),$(".contactAssessmentSpecialistId").hide()),n<768?insideBookshelf&&("none"===$("#global-search-box-wrap").css("display")?$(".globalSearchBlock").css("height","70px"):$(".globalSearchBlock").css("height","100px"),$("input#global-search-box").attr("placeholder","Search inside your books...")):(n<1024?insideBookshelf&&$("input#global-search-box").attr("placeholder","Search inside your books ..."):$("input#global-search-box").attr("placeholder","Search inside your books for topics, cases, or keywords"),insideBookshelf&&$(".globalSearchBlock").css("height","60px")),(insideThemis||insideThemisAdmin)&&($(".header-read-right div[displayInCasesOnly]").hide(),$(".header-read-right div[displayInCasesOnly]").css("display","none"),$(".header-read-right div[displayInReadOnly]").hide(),$(".header-read-right div[displayInReadOnly]").css("display","none"),$(".header-read-right div[displayInOutlineOnly]").hide(),$(".header-read-right div[displayInOutlineOnly]").css("display","none"),$("ul.drop-nav-navigation-cog li[displayInReadOnly]").hide(),$("ul.drop-nav-navigation-cog li[displayInReadOnly]").css("display","none"),$(".tutoriallink").hide(),$(".quiz-details-title").css("height","40"),n<1198&&$(".quiz-details-title").css("height","60"),n<768&&$(".quiz-details-title").css("height","40")),"true"==CaseConnect.barCheckFlag&&n<1124?($(".app-left-navigation ul.list-style-none li a label").addClass("padding-2px"),$(".app-left-navigation ul.list-style-none li a").addClass("padding-2px")):($(".app-left-navigation ul.list-style-none li a label").removeClass("padding-2px"),$(".app-left-navigation ul.list-style-none li a").removeClass("padding-2px")),null!==CaseConnect.currentProductId&&""!==CaseConnect.currentProductId&&"null"!==CaseConnect.currentProductId?$(".hide-bar-check-class").show():$(".hide-bar-check-class").hide(),insideThemisAdmin&&(n<768?$("#header-wrapper").hide():$("#header-wrapper").css("display","")),adminSuppressFunc()}),$("#ereader-assessment-lightbox").on("hidden.bs.modal",function(e){$("#ereader-assessment-content-area").empty()});var someId=null;function copyTextToClipBoard(e){if(insideTouchDevices)$(".copy-clipboard-button").css("visibility","hidden")[1],$(".copy-clipboard-text").css("visibility","hidden")[1],$(".copy-clip-button").css("visibility","hidden")[1];else{ZeroClipboard.setMoviePath(properties.full_base_url+"js/libs/ZeroClipboard.swf");var t=new ZeroClipboard.Client;t.addEventListener("mousedown",function(){t.setText(highlightedTextWithoutHTML)}),t.addEventListener("complete",function(e,t){}),t.glue(e)}}function closeSearchPopover(){$(".ebook-search").popover("hide"),$("#ereader-nav-menu-mobile").modal("hide"),focusNavInEreader=!0,$(".ebook-search").on("hidden.bs.popover",function(e){focusNavInEreader&&($(".ereader-features-nav").focus(),focusNavInEreader=!1)})}function closeChapterPopover(){$(".ereader-chapter-list").popover("hide"),setTimeout(function(){$(".ereader-chapter-list").focus(),$(".ereader-chapter-list").find(".toggle-up-down").addClass("glyphicon-menu-down").removeClass("glyphicon-menu-up")},300)}function closeFontPopover(){$(".ebook-fontsize").popover("hide"),$("#ereader-nav-menu-mobile").modal("hide"),focusNavInEreader=!0,$(".ebook-fontsize").on("hidden.bs.popover",function(e){focusNavInEreader&&($(".ereader-features-nav").focus(),focusNavInEreader=!1)})}function closeAnnotationPopover(){$("#ebook-toc").popover("hide"),$("#ebook-toc-mobile").popover("hide"),focusNavInEreader=!0,$("#ebook-toc").on("hidden.bs.popover",function(e){focusNavInEreader&&($(".ereader-features-nav").focus(),focusNavInEreader=!1)})}function closeAnnotationPopoverMobile(){$("#ebook-toc-mobile").popover("hide"),focusNavInEreader=!0,$("#ebook-toc-mobile").on("hidden.bs.popover",function(e){focusNavInEreader&&($(".ereader-features-nav").focus(),focusNavInEreader=!1)})}function reCalculateLinkOnLeft(){var e,t,n,i,o,a;$(".anchorElementText").each(function(){1===$("#linkDiv"+this.id).length&&(t=this.id,e=document.getElementById("linkDiv"+this.id).getAttribute("urltext"),o=document.getElementById("linkDiv"+this.id).getAttribute("sharelinkchecked"),i=document.getElementById("linkDiv"+this.id).getAttribute("urlcomments"),a=document.getElementById("linkDiv"+this.id).getAttribute("linkeditingforproffessor"),n=document.getElementById(this.id).getBoundingClientRect().top,$("#linkAnchorElement"+this.id).remove(),displayLinksOnLeft(t,n,e,i,o,a))})}function showClassDetailsMobile(e){var t=e.currentTarget.getAttribute("bookId");"none"===$("#"+t+"staticMessageForMobile").css("display")?($("#"+t+"staticMessageForMobile").css("display","block"),"block"==$("#"+t+"staticMessageText").css("display")?$("#"+t+"faculty-add-class-mobile").css("display","none"):$("#"+t+"faculty-add-class-mobile").css("display","block"),$("#"+t+"class-info-hidden").css("display","none"),$("#"+t+"class-info-shown").css("display","inline-block")):($("#"+t+"staticMessageForMobile").css("display","none"),$("#"+t+"class-info-shown").css("display","none"),$("#"+t+"class-info-hidden").css("display","inline-block"),$("#"+t+"faculty-add-class-mobile").css("display","none"))}function showClassDetailsMobileStud(e){var t=e.currentTarget.getAttribute("bookId");"none"===$("#"+t+"staticMessageForMobile").css("display")?($("#"+t+"staticMessageForMobile").css("display","block"),$("#"+t+"class-info-hidden").css("display","none"),$("#"+t+"class-info-shown").css("display","inline-block")):($("#"+t+"staticMessageForMobile").css("display","none"),$("#"+t+"class-info-shown").css("display","none"),$("#"+t+"class-info-hidden").css("display","inline-block"))}function getAnnotatableChapterAndSupplementalList(){var e={userVO:{userId:CaseConnect.currentUserId,userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),streamContentRequiredFlag:!1,userActivityVO:{lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:CaseConnect.currentPageNumber,lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:CaseConnect.currentSectionId,lastReadSubSectionId:"subsec01",lastReadParagraphId:"para01",lastViewedOutlineId:CaseConnect.lastViewedOutlineId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId}};insideEreader?(e.userVO.userActivityVO.lastActivityCode="EREADER_READING_BOOK",e.userVO.userActivityVO.pageNavigatingFrom="EReader",e.userVO.userActivityVO.pageNavigatingTo="EReader"):(e.userVO.userActivityVO.lastActivityCode="CASE_PAGE",e.userVO.userActivityVO.pageNavigatingFrom="CASES",e.userVO.userActivityVO.pageNavigatingTo="CASES"),$.ajax({url:properties[properties.env]+"/bookContentRetrievalService/getAnnotatableChapterAndSupplementalList ",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),annotationListingChapterId=CaseConnect.currentChapterId,bookAnnotateFileList=e.chapterVOList},function(e){sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}
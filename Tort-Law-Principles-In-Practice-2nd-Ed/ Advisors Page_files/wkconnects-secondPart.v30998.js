function sessionAuthFails(e){e?"bus.exception.session.authentication.fail"===e.wkErrorCode&&"ERS500"===e.genericParam?(document.cookie="sameSession=false;path=/",localStorage.clear(),delete map.userId,window.location=properties.ui_domain):e.responseJSON?"bus.exception.session.authentication.fail"===e.responseJSON.wkErrorCode&&"ERS500"===e.responseJSON.genericParam&&(document.cookie="sameSession=false;path=/",localStorage.clear(),delete map.userId,window.location=properties.ui_domain):(Utility.hideSpinner(),$("#page-loading-spinner").hide()):(Utility.hideSpinner(),$("#page-loading-spinner").hide())}function hideDropModal(){$("#drop-class-dialog").modal("hide"),$(".modal-backdrop").remove()}function cancelEnrollPageWelcomeMsg(){$("#student-enroll-class-welcome-modal").modal("hide"),$(".modal-backdrop").remove(),$("#student-enroll-class-welcome-modal").on("hidden.bs.modal",function(e){setTimeout(function(){$("#student-class-code").focus()},30)})}function stayInStudEnrollPage(){$("#cancel-enroll-dialog").modal("hide"),$(".modal-backdrop").remove(),$("#cancel-enroll-dialog").on("hidden.bs.modal",function(e){setTimeout(function(){$("#student-professor-name").focus()},30)})}function cancelCreateClassPageWelcomeMsg(){$("#faculty-create-class-welcome-modal").modal("hide"),$(".modal-backdrop").remove(),$("#faculty-create-class-welcome-modal").on("hidden.bs.modal",function(e){setTimeout(function(){$("#faculty-class-name").focus()},30)})}function cancelEnrollSuccessMsg(){$("#student-enroll-success-message").modal("hide"),$(".modal-backdrop").remove(),$("#student-enroll-success-message").on("hidden.bs.modal",function(e){setTimeout(function(){$(".books-thumbnail").focus()},30)})}function stayInCreateClassPage(){$("#cancel-create-class-message").modal("hide"),$(".modal-backdrop").remove(),$("#cancel-create-class-message").on("hidden.bs.modal",function(e){setTimeout(function(){$("#faculty-class-name").focus()},30)})}function cancelDeleteDocumentProf(){$("#delete-file-message").modal("hide"),$(".modal-backdrop").remove(),$("#delete-file-message").on("hidden.bs.modal",function(e){setTimeout(function(){$("#faculty-uploaded-list").focus()},30)})}function cancelFacultyDeleteClassMsg(){$("#faculty-delete-class-confirmation-window").modal("hide"),$(".modal-backdrop").remove(),$("#faculty-delete-class-confirmation-window").on("hidden.bs.modal",function(e){setTimeout(function(){$("#faculty-delete-class-button").focus()},30)})}function showHideSubjectArea(e){var t=$(e);t.parent().find(">a:first").toggleClass("expand-subject-area").toggleClass("collapse-subject-area"),t.parent().find(">a:first").hasClass("collapse-subject-area")?(t.parent().find(">a:first").attr("aria-label","Hide book list"),t.parent().next().hasClass("catalog-book-dropdown-list-wrapper")&&t.parent().next().slideToggle("slow")):t.parent().find(">a:first").hasClass("expand-subject-area")&&(t.parent().find(">a:first").attr("aria-label","View book list"),t.parent().next().hasClass("catalog-book-dropdown-list-wrapper")&&t.parent().next().slideToggle("slow"))}function getCountryListOnChange(){$.ajax({url:properties[properties.env]+"/manageUserService/getLocationAndRoleList",type:"GET",async:!1}).then(function(e){if("true"===e.status){var t=e.locationVOList;if(Utility.showSpinner(),"undefined"!=typeof editUserdetails)for($(editUserdetails[5]).html(""),i=0;i<t.length;i++){var o=t[i].schoolLocation,a=$('<option value="'+o+'">'+o+"</option>");$(editUserdetails[5]).append(a)}if("undefined"!=typeof createAccountForm){for($(createAccountForm[9]).html(""),i=0;i<t.length;i++)createAccountForm[8].options[i+1]=new Option(t[i].schoolLocation),$("#page-loading-spinner").hide(),$(createAccountForm[8]).removeAttr("disabled");$(createAccountForm[9]).html('<option value="">Select</option>')}if("undefined"!=typeof almostThere){for($(almostThere[2]).html(""),i=0;i<t.length;i++)almostThere[1].options[i+1]=new Option(t[i].schoolLocation),$("#page-loading-spinner").hide(),$(almostThere[1]).removeAttr("disabled");$(almostThere[2]).html('<option value="">Select</option>')}$("#page-loading-spinner").hide()}sessionTimeOut()},function(e){$("#page-loading-spinner").hide(),sessionAuthFails(data),sessionTimeOut(),alertMessagesModal(exceptionMsg.systemError)})}function seSsionOut(){var e={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"",pageNavigatingFrom:"",pageNavigatingTo:"",lastReadBookId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId,pageNumber:CaseConnect.currentPageNumber}};$.ajax({url:properties[properties.env]+"/manageUserService/extendUserSession",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){},function(e){sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}Handler.goToCatalogPage={request:function(e){},response:function(e){if((localStorage.getItem("userId")||CaseConnect.currentUserId)&&sessionTimeOut(),void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),"false"===e.status)sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#catalog-page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain;else{var t,o=null,a=null,s=null;t=e.bookTypeVOList;for(var i=0;i<t.length;i++)"casebook,coursebook"==t[i].bookType?o=t[i].subjectAreaVOList:"studyaid"==t[i].bookType?a=t[i].subjectAreaVOList:"practicepack"!=t[i].bookType&&"oer"!=t[i].bookType||(s=t[i].subjectAreaVOList);if(null!=o&&null!=o)for(i=0;i<o.length;i++){var n=document.getElementById("catalog-casebook-wrapper");if((d=document.createElement("div")).className="catalog-subject-area-info",(c=document.createElement("a")).className="expand-subject-area",c.style.cursor="pointer",c.setAttribute("href","javascript:;"),c.setAttribute("aria-label","View book list"),c.setAttribute("onClick","showHideSubjectArea(this)"),(u=document.createElement("h3")).className="display-inline-block",u.setAttribute("onClick","showHideSubjectArea(this)"),(p=document.createElement("span")).className="subject-area-title",p.style.cursor="pointer",p.innerHTML=o[i].subjectAreaName,p.setAttribute("tabindex","0"),u.appendChild(p),d.appendChild(c),d.appendChild(u),n.appendChild(d),(g=document.createElement("div")).className="catalog-book-dropdown-list-wrapper col-md-12 col-sm-12 col-xs-12 ",g.setAttribute("style","display:none"),null!=o[i].bookVOList.length&&null!=o[i].bookVOList){for(var r=0;r<o[i].bookVOList.length;r++)if("yes"==o[i].bookVOList[r].displayInCatalog){(h=document.createElement("div")).className="catalog-book-dropdown-list col-md-12 col-sm-12 col-xs-12",(m=document.createElement("div")).className="catalog-book col-xs-3 col-sm-3 col-md-3",(b=document.createElement("img")).className="catalog-books-thumbnail","yes"==o[i].bookVOList[r].bookReadyForUseFlag?(b.setAttribute("alt",o[i].bookVOList[r].bookTitle),b.setAttribute("src",o[i].bookVOList[r].thumbnailImagePath)):(b.setAttribute("alt","Coming Soon"),b.setAttribute("src","img/bookshelf/title-coming-soon.png")),m.appendChild(b),(v=document.createElement("div")).className="catalog-book-title-author col-xs-9 col-sm-9 col-md-9",(f=document.createElement("div")).className="catalog-book-title",f.setAttribute("tabindex","0"),(C=document.createElement("span")).innerHTML=o[i].bookVOList[r].bookTitle,f.appendChild(C),(y=document.createElement("div")).className="catalog-book-author",y.setAttribute("tabindex","0");var l=document.createElement("span");if((k=document.createElement("span")).innerHTML="by ",l.innerHTML=o[i].bookVOList[r].bookAuthor,y.appendChild(k),y.appendChild(l),v.appendChild(f),v.appendChild(y),(O=document.createElement("div")).className="catalog-buy-option-button-group col-xs-12 col-sm-9 col-md-9",null!=o[i].bookVOList[r].buyOptionLink&&""!=o[i].bookVOList[r].buyOptionLink&&null!=o[i].bookVOList[r].buyOptionLink)(I=document.createElement("button")).className="catalog-buy-option-button ",I.style.cursor="pointer",I.innerHTML="BUYING OPTIONS",(S=document.createElement("a")).setAttribute("href",o[i].bookVOList[r].buyOptionLink),S.setAttribute("target","_blank"),S.appendChild(I);else(S=document.createElement("button")).className="catalog-coming-soon-button ",S.innerHTML="COMING SOON",S.setAttribute("disabled","disabled");(T=document.createElement("a")).className="catalog-xamCopyReq-link",T.style.cursor="pointer",T.innerHTML="Professor Exam Copy Request",T.setAttribute("href","https://support.wklegaledu.com/hc/en-us/requests/new"),T.setAttribute("target","_blank"),O.appendChild(S),O.appendChild(T),h.appendChild(m),h.appendChild(v),h.appendChild(O),g.appendChild(h)}n.appendChild(g)}else if(null!=o[i].bookVOList&&"yes"==o[i].bookVOList.displayInCatalog){(g=document.createElement("div")).className="catalog-book-dropdown-list-wrapper col-md-12 col-sm-12 col-xs-12",g.setAttribute("style","display:none"),(h=document.createElement("div")).className="catalog-book-dropdown-list col-md-12 col-sm-12 col-xs-12",(m=document.createElement("div")).className="catalog-book col-xs-3 col-sm-3 col-md-3",(b=document.createElement("img")).className="catalog-books-thumbnail","yes"==o[i].bookVOList.bookReadyForUseFlag?(b.setAttribute("alt",o[i].bookVOList.bookTitle),b.setAttribute("src",o[i].bookVOList.thumbnailImagePath)):(b.setAttribute("alt","Coming Soon"),b.setAttribute("src","img/bookshelf/title-coming-soon.png")),m.appendChild(b),(v=document.createElement("div")).className="catalog-book-title-author col-xs-9 col-sm-9 col-md-9",(f=document.createElement("div")).className="catalog-book-title",f.setAttribute("tabindex","0"),(C=document.createElement("span")).innerHTML=o[i].bookVOList.bookTitle,f.appendChild(C),(y=document.createElement("div")).className="catalog-book-author",y.setAttribute("tabindex","0");l=document.createElement("span");if((k=document.createElement("span")).innerHTML="by ",l.innerHTML=o[i].bookVOList.bookAuthor,y.appendChild(k),y.appendChild(l),v.appendChild(f),v.appendChild(y),(O=document.createElement("div")).className="catalog-buy-option-button-group col-xs-12 col-sm-9 col-md-9",null!=o[i].bookVOList.buyOptionLink&&""!=o[i].bookVOList.buyOptionLink&&null!=o[i].bookVOList.buyOptionLink)(I=document.createElement("button")).className="catalog-buy-option-button ",I.style.cursor="pointer",I.innerHTML="BUYING OPTIONS",(S=document.createElement("a")).setAttribute("href",o[i].bookVOList.buyOptionLink),S.setAttribute("target","_blank"),S.appendChild(I);else(S=document.createElement("button")).className="catalog-coming-soon-button ",S.innerHTML="COMING SOON",S.setAttribute("disabled","disabled");(T=document.createElement("a")).className="catalog-xamCopyReq-link",T.style.cursor="pointer",T.innerHTML="Professor Exam Copy Request",T.setAttribute("href","https://support.wklegaledu.com/hc/en-us/requests/new"),T.setAttribute("target","_blank"),O.appendChild(S),O.appendChild(T),h.appendChild(m),h.appendChild(v),h.appendChild(O),g.appendChild(h)}n.appendChild(g)}else $("#catalog-page-loading-spinner").hide();if(null!=a&&null!=a)for(i=0;i<a.length;i++){n=document.getElementById("catalog-studyaid-wrapper");if((d=document.createElement("div")).className="catalog-subject-area-info",(c=document.createElement("a")).className="expand-subject-area",c.style.cursor="pointer",c.setAttribute("href","javascript:;"),c.setAttribute("aria-label","View book list"),c.setAttribute("onClick","showHideSubjectArea(this)"),(u=document.createElement("h3")).className="display-inline-block",u.setAttribute("onClick","showHideSubjectArea(this)"),(p=document.createElement("span")).className="subject-area-title",p.style.cursor="pointer",p.innerHTML=a[i].subjectAreaName,p.setAttribute("tabindex","0"),u.appendChild(p),d.appendChild(c),d.appendChild(u),n.appendChild(d),(g=document.createElement("div")).className="catalog-book-dropdown-list-wrapper col-md-12 col-sm-12 col-xs-12 ",g.setAttribute("style","display:none"),null!=a[i].bookVOList.length&&null!=a[i].bookVOList){for(r=0;r<a[i].bookVOList.length;r++)if("yes"==a[i].bookVOList[r].displayInCatalog){(h=document.createElement("div")).className="catalog-book-dropdown-list col-md-12 col-sm-12 col-xs-12",(m=document.createElement("div")).className="catalog-book col-xs-3 col-sm-3 col-md-3",(b=document.createElement("img")).className="catalog-books-thumbnail","yes"==a[i].bookVOList[r].bookReadyForUseFlag?(b.setAttribute("alt",a[i].bookVOList[r].bookTitle),b.setAttribute("src",a[i].bookVOList[r].thumbnailImagePath)):(b.setAttribute("alt","Coming Soon"),b.setAttribute("src","img/bookshelf/title-coming-soon.png")),m.appendChild(b),(v=document.createElement("div")).className="catalog-book-title-author col-xs-9 col-sm-9 col-md-9",(f=document.createElement("div")).className="catalog-book-title",f.setAttribute("tabindex","0"),(C=document.createElement("span")).innerHTML=a[i].bookVOList[r].bookTitle,f.appendChild(C),(y=document.createElement("div")).className="catalog-book-author",y.setAttribute("tabindex","0");l=document.createElement("span");if((k=document.createElement("span")).innerHTML="by ",l.innerHTML=a[i].bookVOList[r].bookAuthor,y.appendChild(k),y.appendChild(l),v.appendChild(f),v.appendChild(y),(O=document.createElement("div")).className="catalog-buy-option-button-group col-xs-12 col-sm-9 col-md-9",null!=a[i].bookVOList[r].buyOptionLink&&""!=a[i].bookVOList[r].buyOptionLink&&null!=a[i].bookVOList[r].buyOptionLink)(I=document.createElement("button")).className="catalog-buy-option-button ",I.style.cursor="pointer",I.innerHTML="BUYING OPTIONS",(S=document.createElement("a")).setAttribute("href",a[i].bookVOList[r].buyOptionLink),S.setAttribute("target","_blank"),S.appendChild(I);else(S=document.createElement("button")).className="catalog-coming-soon-button ",S.innerHTML="COMING SOON",S.setAttribute("disabled","disabled");(T=document.createElement("a")).className="catalog-xamCopyReq-link",T.style.cursor="pointer",T.innerHTML="Professor Exam Copy Request",T.setAttribute("href","https://support.wklegaledu.com/hc/en-us/requests/new"),T.setAttribute("target","_blank"),O.appendChild(S),O.appendChild(T),h.appendChild(m),h.appendChild(v),h.appendChild(O),g.appendChild(h)}n.appendChild(g)}else if(null!=a[i].bookVOList&&"yes"==a[i].bookVOList.displayInCatalog){(g=document.createElement("div")).className="catalog-book-dropdown-list-wrapper col-md-12 col-sm-12 col-xs-12",g.setAttribute("style","display:none"),(h=document.createElement("div")).className="catalog-book-dropdown-list col-md-12 col-sm-12 col-xs-12",(m=document.createElement("div")).className="catalog-book col-xs-3 col-sm-3 col-md-3",(b=document.createElement("img")).className="catalog-books-thumbnail","yes"==a[i].bookVOList.bookReadyForUseFlag?(b.setAttribute("alt",a[i].bookVOList.bookTitle),b.setAttribute("src",a[i].bookVOList.thumbnailImagePath)):(b.setAttribute("alt","Coming Soon"),b.setAttribute("src","img/bookshelf/title-coming-soon.png")),m.appendChild(b),(v=document.createElement("div")).className="catalog-book-title-author col-xs-9 col-sm-9 col-md-9",(f=document.createElement("div")).className="catalog-book-title",f.setAttribute("tabindex","0"),(C=document.createElement("span")).innerHTML=a[i].bookVOList.bookTitle,f.appendChild(C),(y=document.createElement("div")).className="catalog-book-author",y.setAttribute("tabindex","0");l=document.createElement("span");if((k=document.createElement("span")).innerHTML="by ",l.innerHTML=a[i].bookVOList.bookAuthor,y.appendChild(k),y.appendChild(l),v.appendChild(f),v.appendChild(y),(O=document.createElement("div")).className="catalog-buy-option-button-group col-xs-12 col-sm-9 col-md-9",null!=a[i].bookVOList.buyOptionLink&&""!=a[i].bookVOList.buyOptionLink&&null!=a[i].bookVOList.buyOptionLink)(I=document.createElement("button")).className="catalog-buy-option-button ",I.style.cursor="pointer",I.innerHTML="BUYING OPTIONS",(S=document.createElement("a")).setAttribute("href",a[i].bookVOList.buyOptionLink),S.setAttribute("target","_blank"),S.appendChild(I);else(S=document.createElement("button")).className="catalog-coming-soon-button ",S.innerHTML="COMING SOON",S.setAttribute("disabled","disabled");(T=document.createElement("a")).className="catalog-xamCopyReq-link",T.style.cursor="pointer",T.innerHTML="Professor Exam Copy Request",T.setAttribute("href","https://support.wklegaledu.com/hc/en-us/requests/new"),T.setAttribute("target","_blank"),O.appendChild(S),O.appendChild(T),h.appendChild(m),h.appendChild(v),h.appendChild(O),g.appendChild(h)}n.appendChild(g)}else $("#catalog-page-loading-spinner").hide();if(null!=s&&null!=s)for(i=0;i<s.length;i++){var d,c,u,p;n=document.getElementById("catalog-practicepack-wrapper");if((d=document.createElement("div")).className="catalog-subject-area-info",(c=document.createElement("a")).className="expand-subject-area",c.style.cursor="pointer",c.setAttribute("href","javascript:;"),c.setAttribute("aria-label","View book list"),c.setAttribute("onClick","showHideSubjectArea(this)"),(u=document.createElement("h3")).className="display-inline-block",u.setAttribute("onClick","showHideSubjectArea(this)"),(p=document.createElement("span")).className="subject-area-title",p.style.cursor="pointer",p.innerHTML=s[i].subjectAreaName,p.setAttribute("tabindex","0"),u.appendChild(p),d.appendChild(c),d.appendChild(u),n.appendChild(d),(g=document.createElement("div")).className="catalog-book-dropdown-list-wrapper col-md-12 col-sm-12 col-xs-12 ",g.setAttribute("style","display:none"),null!=s[i].bookVOList.length&&null!=s[i].bookVOList){for(r=0;r<s[i].bookVOList.length;r++)if("yes"==s[i].bookVOList[r].displayInCatalog){(h=document.createElement("div")).className="catalog-book-dropdown-list col-md-12 col-sm-12 col-xs-12",(m=document.createElement("div")).className="catalog-book col-xs-3 col-sm-3 col-md-3",(b=document.createElement("img")).className="catalog-books-thumbnail","yes"==s[i].bookVOList[r].bookReadyForUseFlag?(b.setAttribute("alt",s[i].bookVOList[r].bookTitle),b.setAttribute("src",s[i].bookVOList[r].thumbnailImagePath)):(b.setAttribute("alt","Coming Soon"),b.setAttribute("src","img/bookshelf/title-coming-soon.png")),m.appendChild(b),(v=document.createElement("div")).className="catalog-book-title-author col-xs-9 col-sm-9 col-md-9",(f=document.createElement("div")).className="catalog-book-title",f.setAttribute("tabindex","0"),(C=document.createElement("span")).innerHTML=s[i].bookVOList[r].bookTitle,f.appendChild(C),(y=document.createElement("div")).className="catalog-book-author",y.setAttribute("tabindex","0");l=document.createElement("span");if((k=document.createElement("span")).innerHTML="by ",l.innerHTML=s[i].bookVOList[r].bookAuthor,y.appendChild(k),y.appendChild(l),v.appendChild(f),v.appendChild(y),(O=document.createElement("div")).className="catalog-buy-option-button-group col-xs-12 col-sm-9 col-md-9",null!=s[i].bookVOList[r].buyOptionLink&&""!=s[i].bookVOList[r].buyOptionLink&&null!=s[i].bookVOList[r].buyOptionLink)(I=document.createElement("button")).className="catalog-buy-option-button ",I.style.cursor="pointer",I.innerHTML="BUYING OPTIONS",(S=document.createElement("a")).setAttribute("href",s[i].bookVOList[r].buyOptionLink),S.setAttribute("target","_blank"),S.appendChild(I);else(S=document.createElement("button")).className="catalog-coming-soon-button ",S.innerHTML="COMING SOON",S.setAttribute("disabled","disabled");(T=document.createElement("a")).className="catalog-xamCopyReq-link",T.style.cursor="pointer",T.innerHTML="Professor Exam Copy Request",T.setAttribute("href","https://support.wklegaledu.com/hc/en-us/requests/new"),T.setAttribute("target","_blank"),O.appendChild(S),O.appendChild(T),h.appendChild(m),h.appendChild(v),h.appendChild(O),g.appendChild(h)}n.appendChild(g)}else if(null!=s[i].bookVOList&&"yes"==s[i].bookVOList.displayInCatalog){var g,h,m,b,v,f,C,y;(g=document.createElement("div")).className="catalog-book-dropdown-list-wrapper col-md-12 col-sm-12 col-xs-12",g.setAttribute("style","display:none"),(h=document.createElement("div")).className="catalog-book-dropdown-list col-md-12 col-sm-12 col-xs-12",(m=document.createElement("div")).className="catalog-book col-xs-3 col-sm-3 col-md-3",(b=document.createElement("img")).className="catalog-books-thumbnail","yes"==s[i].bookVOList.bookReadyForUseFlag?(b.setAttribute("alt",s[i].bookVOList.bookTitle),b.setAttribute("src",s[i].bookVOList.thumbnailImagePath)):(b.setAttribute("alt","Coming Soon"),b.setAttribute("src","img/bookshelf/title-coming-soon.png")),m.appendChild(b),(v=document.createElement("div")).className="catalog-book-title-author col-xs-9 col-sm-9 col-md-9",(f=document.createElement("div")).className="catalog-book-title",f.setAttribute("tabindex","0"),(C=document.createElement("span")).innerHTML=s[i].bookVOList.bookTitle,f.appendChild(C),(y=document.createElement("div")).className="catalog-book-author",y.setAttribute("tabindex","0");var k,O,I,S,T;l=document.createElement("span");if((k=document.createElement("span")).innerHTML="by ",l.innerHTML=s[i].bookVOList.bookAuthor,y.appendChild(k),y.appendChild(l),v.appendChild(f),v.appendChild(y),(O=document.createElement("div")).className="catalog-buy-option-button-group col-xs-12 col-sm-9 col-md-9",null!=s[i].bookVOList.buyOptionLink&&""!=s[i].bookVOList.buyOptionLink&&null!=s[i].bookVOList.buyOptionLink)(I=document.createElement("button")).className="catalog-buy-option-button ",I.style.cursor="pointer",I.innerHTML="BUYING OPTIONS",(S=document.createElement("a")).setAttribute("href",s[i].bookVOList.buyOptionLink),S.setAttribute("target","_blank"),S.appendChild(I);else(S=document.createElement("button")).className="catalog-coming-soon-button ",S.innerHTML="COMING SOON",S.setAttribute("disabled","disabled");(T=document.createElement("a")).className="catalog-xamCopyReq-link",T.style.cursor="pointer",T.innerHTML="Professor Exam Copy Request",T.setAttribute("href","https://support.wklegaledu.com/hc/en-us/requests/new"),T.setAttribute("target","_blank"),O.appendChild(S),O.appendChild(T),h.appendChild(m),h.appendChild(v),h.appendChild(O),g.appendChild(h)}n.appendChild(g)}else $("#catalog-page-loading-spinner").hide();$("#catalog-page-loading-spinner").hide()}}};var archievedDate=null,archievedList=null,validArchivedList=[],archivedHistoryId=null,archivedStatus=!1,archivedSelected=!1;function showHideArchivedDateArea(e){var t=$(e);t.parent().find(">a:first").toggleClass("archived-expand-subject-area").toggleClass("archived-collapse-subject-area"),t.parent().find(">a:first").hasClass("archived-collapse-subject-area")?(1==archivedSelected&&(t.parent().parent().find(".archived-collapse-subject-area").removeClass("archived-collapse-subject-area").addClass("archived-expand-subject-area"),t.removeClass("archived-expand-subject-area").addClass("archived-collapse-subject-area"),$("#archivedStudyDashBoardProfessor").parent().css("display","none"),$("#archivedStudyDashBoardProfessor").remove()),t.parent().next().append("<div id='archivedStudyDashBoardProfessor' class='archived-dashboard-snapshot'></div>"),archivedSelected=!0,getArchivedData(e),t.parent().find(">a:first").attr("aria-label","Hide archived study dashboard"),t.parent().next().hasClass("archived-data-dropdown-list-wrapper")&&t.parent().next().slideToggle("slow")):t.parent().find(">a:first").hasClass("archived-expand-subject-area")&&(t.parent().next().children().hasClass("archived-dashboard-snapshot")&&(archivedSelected=!1,t.parent().next().children().remove()),t.parent().find(">a:first").attr("aria-label","View archived study dashboard"),t.parent().next().hasClass("archived-data-dropdown-list-wrapper")&&t.parent().next().slideToggle("slow"))}function dateModification(e){var t=(e=e.split(" "))[0].split("-");switch(t[1]){case"01":t[1]="January";break;case"02":t[1]="February";break;case"03":t[1]="March";break;case"04":t[1]="April";break;case"05":t[1]="May";break;case"06":t[1]="June";break;case"07":t[1]="July";break;case"08":t[1]="August";break;case"09":t[1]="September";break;case"10":t[1]="October";break;case"11":t[1]="November";break;case"12":t[1]="December"}return t[1]+" "+t[2]+", "+t[0]}function getArchivedClass(){var e={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CLASS_INSIGHT_GET_STUDY_DASHBOARD",pageNavigatingFrom:"class-insight",pageNavigatingTo:"",lastReadBookId:CaseConnect.currentBookId,lastViewedClassId:CaseConnect.currentClassId},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},classVO:{classId:CaseConnect.currentClassId,bookId:CaseConnect.currentBookId}};$.ajax({url:properties[properties.env]+"/manageClassWebService/getStudyDashBoardHistoryForClassAndProfessor",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){if(null!=e.classVOList&&null!=e.classVOList){null!==$.type(e.classVOList.createdDate)&&null!=e.classVOList.createdDate&&(e.classVOList=[e.classVOList]),archievedList=e.classVOList;for(var t=0;t<archievedList.length;t++){var o=archievedList[t].jsonData;JSON.parse(o).studyDashBoardVO.numberOfEnrolledStudentInClass>=2&&validArchivedList.push(archievedList[t])}0==validArchivedList.length?$("#archivedStudyDashboard,#archivedSeperator,#hyperLinkForArchive").hide():$("#archivedStudyDashboard,#archivedSeperator,#hyperLinkForArchive").show();for(var a=0;a<validArchivedList.length;a++){archievedDate=dateModification(validArchivedList[a].createdDate),archivedHistoryId=validArchivedList[a].classHistoryId;var s=document.getElementById("archived-data-wrapper"),i=document.createElement("div");i.className="archieved-date-info";var n=document.createElement("a");n.className="archived-expand-subject-area",n.style.cursor="pointer",n.setAttribute("href","javascript:;"),n.setAttribute("aria-label",""),n.setAttribute("onClick","showHideArchivedDateArea(this)"),n.setAttribute("classHistoryId",archivedHistoryId);var r=document.createElement("div");r.className="display-inline-block archived-class-date-wrapper",r.setAttribute("onClick","showHideArchivedDateArea(this)"),r.setAttribute("classHistoryId",archivedHistoryId);var l=document.createElement("span");l.className="archived-class-date-span",l.style.cursor="pointer",l.innerHTML=archievedDate,l.setAttribute("tabindex","0"),r.appendChild(l),i.appendChild(n),i.appendChild(r),s.appendChild(i);var d=document.createElement("div");d.className="archived-data-dropdown-list-wrapper no-padding col-md-12 col-sm-12 col-xs-12",d.setAttribute("style","display:none"),s.appendChild(d)}validArchivedList.length=0}else $("#archivedStudyDashboard,#archivedSeperator,#hyperLinkForArchive").hide()},function(e){sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function getArchivedData(e){Utility.showSpinner();var t=e.getAttribute("classHistoryId"),o={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"CLASS_INSIGHT_GET_STUDY_DASHBOARD",pageNavigatingFrom:"class-insight",pageNavigatingTo:"",lastReadBookId:CaseConnect.currentBookId,lastViewedClassId:CaseConnect.currentClassId},sessionVO:{deviceOS:CaseConnect.deviceOS,deviceType:CaseConnect.deviceType,browserName:CaseConnect.browserName,appType:CaseConnect.appType,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},classVO:{classId:CaseConnect.currentClassId,bookId:CaseConnect.currentBookId,classHistoryId:t}};$.ajax({url:properties[properties.env]+"/manageClassWebService/getStudyDashBoardHistoryForProfessorByHistoryId",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(o)}).then(function(e){if("false"===e.status)alert("Error occured while saving data"),sessionAuthFails(e),Utility.hideSpinner();else{var t=e.studyDashBoardVO.numberOfEnrolledStudentInClass;e.studyDashBoardVO.enrolledStudentList;if(0==t)$("#archivedStudyDashBoardProfessor").html("No students enrolled.");else{if($("#faculty-delete-class-button").css("display","none"),t<2)$("#archivedStudyDashBoardProfessor").html("Not enough enrolled students to display study center data.").show();else{"object"==$.type(e.studyDashBoardVO.studyDashBoardDetail)&&(e.studyDashBoardVO.studyDashBoardDetail=[e.studyDashBoardVO.studyDashBoardDetail]);var o=e.studyDashBoardVO.studyDashBoardDetail;archivedStatus=!0,Handler.getStudyDashBoardForProfessor.processStudyDashBoardData(o,t)}$(".class-enrolled-students-count").show()}Utility.hideSpinner()}sessionTimeOut()},function(e){sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function notificationHeaderShow(e){$(".email-notification").show(),$("#notfication-header-text").html(e)}function emailNotificationClose(){$(".email-notification").hide();var e=localStorage.getItem("collectnotificationId");null!=e&&null!=e&&(storeNotificationId.push(e),localStorage.setItem("closedNotification",JSON.stringify(storeNotificationId))),adminNotificationStatus&&!adminPublishedNotification&&(adminPublishedNotification=!1,adminNotificationStatus=!1),emailNotificationStatus&&emailvalidNotification&&(emailNotificationStatus=!1,emailvalidNotification=!1,CaseConnect.userSuspendedFlag="",localStorage.setItem("userSuspendedFlag","")),systemWarningNotificationStatus&&systemWarningNotification&&(systemWarningNotificationStatus=!1,systemWarningNotification=!1,localStorage.setItem("systemWarningNotification","")),adminNotificationTab(),insideEreader&&updatePageNoAndChapterName()}function commonNotificationHeader(){var e=null;if(adminPublishedNotification||emailvalidNotification){adminPublishedNotification||adminPublishedNotification&&emailvalidNotification?(e=adminNotificationMessage,adminPublishedNotification=!1,adminNotificationStatus=!0):(emailvalidNotification||!adminPublishedNotification&&emailvalidNotification)&&(e="<p>You have not verified your email address. Please check your inbox or SPAM folder for a verification email. <a href=' https://support.casebookconnect.com/hc/en-us/requests/new' target='_blank'>Contact us</a> if you did not receive the email.</p>",emailNotificationStatus=!0);var t=localStorage.getItem("userRole");null!=t||null!=t||"all users"==adminNotificationUsers?notificationHeaderShow(e):adminNotificationUsers==t||"all users"==adminNotificationUsers?notificationHeaderShow(e):null!=adminNotificationUsers&&"all users"!=adminNotificationUsers||notificationHeaderShow(e)}else $(".email-notification").hide()}function getAdminNotificationStatus(e,t){var o,a;adminPublishedNotification=!1,"1"===localStorage.getItem("userSuspendedFlag")||"1"===CaseConnect.userSuspendedFlag?emailvalidNotification=!0:emailvalidNotification=!1,o=adminPublishedNotification,a=emailvalidNotification,"undefined"!=o&&"undefined"!=a&&commonNotificationHeader(e,t)}function browserNotificationHeader(){if(1==systemWarningNotification){systemWarningNotificationStatus=!0,notificationHeaderShow("<p>You are using a browser or operating system that may affect your experience on this site. For the best reading experience, we recommend using Chrome or Firefox or updating your operating system. <a href=' https://support.casebookconnect.com/hc/en-us/articles/202767480-What-browsers-and-devices-are-compatible-with-CasebookConnect-com' target='_blank'>Visit our help center</a> for details and recommendations.</p>")}else getAdminNotificationStatus()}var notificationList=[],notificationLists=null,adminNotificationMessage,adminNotificationUsers,activeList,storeNotificationId=[];function checkAdminNotification(){startCount=window.setTimeout(function(){adminNotificationTab(),checkAdminNotification()},9e5)}function adminNotificationTab(){var e=new Date,t=e.getDate(),o=e.getMonth()+1,a=e.getFullYear();t<10&&(t="0"+t),o<10&&(o="0"+o),e=o+"-"+t+"-"+a;var s=new Date,i=s.getHours()-(s.getHours()>=12?12:0),n=s.getHours()>=12?"PM":"AM",r=i;0==r&&(r=12),0!=r&&r<10&&(r="0"+r);var l=s.getMinutes();l<10&&(l="0"+l);var d=e+" "+r+":"+l+" "+n,c={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userActivityVO:{lastActivityCode:"",pageNavigatingFrom:"",pageNavigatingTo:""}},notificationVO:{browserTime:d}};$.ajax({url:properties[properties.env]+"/manageNotifications/getNotificationsForApplication",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(c)}).then(function(e){if("true"==e.status)if(adminPublishedNotification=!1,$(".email-notification").hide(),null!=e.notificationVOList&&null!=e.notificationVOList){null!==$.type(e.notificationVOList.readyToPublish)&&null!=e.notificationVOList.readyToPublish&&(e.notificationVOList=[e.notificationVOList]);var t=localStorage.getItem("closedNotification");activeList=JSON.parse(t),notificationLists=e.notificationVOList,notificationList=[];for(var o=0;o<notificationLists.length;o++)"all users"==notificationLists[o].displayOption&&(notificationList.push(notificationLists[o]),notificationLists.splice(o,1));if(0==systemWarningNotification){for(o=0;o<notificationLists.length;o++)"logged in users"==notificationLists[o].displayOption&&(notificationList.push(notificationLists[o]),notificationLists.splice(o,1));var a=localStorage.getItem("userRole");if("Student"==a)for(o=0;o<notificationLists.length;o++)"student"==notificationLists[o].displayOption&&(notificationList.push(notificationLists[o]),notificationLists.splice(o,1));if("Professor"==a)for(o=0;o<notificationLists.length;o++)"professor"==notificationLists[o].displayOption&&(notificationList.push(notificationLists[o]),notificationLists.splice(o,1))}if(null!=activeList&&null!=activeList)for(o=0;o<notificationList.length;o++)for(var s=0;s<activeList.length;s++)notificationList[o].notificationId==activeList[s]&&notificationList.splice(o,1);if(0==notificationList.length)browserNotificationHeader(),localStorage.removeItem("collectnotificationId");else for(o=0;o<notificationList.length;o++){if("yes"==notificationList[o].readyToPublish&&"active"==notificationList[o].status){adminPublishedNotification=!0;var i=localStorage.getItem("userRole");localStorage.setItem("collectnotificationId",notificationList[o].notificationId),"all users"==notificationList[o].displayOption?notificationHeaderShow(adminNotificationMessage=notificationList[o].notificationMessage):"logged in users"==notificationList[o].displayOption?(adminNotificationMessage=notificationList[o].notificationMessage,null==i&&null==i||notificationHeaderShow(adminNotificationMessage)):"student"==notificationList[o].displayOption?(adminNotificationMessage=notificationList[o].notificationMessage,"Student"==i&&notificationHeaderShow(adminNotificationMessage)):"professor"==notificationList[o].displayOption&&(adminNotificationMessage=notificationList[o].notificationMessage,"Professor"==i&&notificationHeaderShow(adminNotificationMessage))}break}}else browserNotificationHeader()},function(e){browserNotificationHeader(),sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}var previewResourceContent=null,resourceNodeVOListData=null,resourceDetails,orderIndex,subOrderIndex,assocStatus,bookDataArr=[],resourceNodeVOList,selectedNodeId,selectedNodeOrderIndex,selectedSubNodeOrderIndex,previewFlag=!1,heightOfTab,noOfSubtab=[];function loadResourcePageOnReload(e){if($("#page-loading-spinner").show(),previewFlag=!0,insideStaticPage=!1,insideBookshelf=!1,void 0!==e.userActivityVO){"RESOURCE_AS_BOOK"===e.userActivityVO.lastActivityCode&&void 0===e.userActivityVO.bookVO&&($(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".ereader-heading-pipes").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".tutorial-resource-page").hide(),$(".tutoriallink").hide()),"undefined"!==e.userActivityVO.casesFlag&&"true"==e.userActivityVO.casesFlag&&$(".hide-case-page-class").show(),"undefined"!==e.userActivityVO.casesFlag&&(CaseConnect.casesFlag=e.userActivityVO.casesFlag),"undefined"!==e.userActivityVO.newsFeedFlag&&(CaseConnect.newsFeedFlag=e.userActivityVO.newsFeedFlag),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),void 0!==e.userActivityVO.bookVO&&(CaseConnect.bookData=e.userActivityVO.bookVO,CaseConnect.bookData.bookTitle=e.userActivityVO.bookVO.bookTitle,CaseConnect.currentBookId=e.userActivityVO.bookVO.bookId,CaseConnect.bookType=e.userActivityVO.bookVO.bookType,(CaseConnect.bookType&&"practicepack"===CaseConnect.bookType||CaseConnect.bookType&&"oer"===CaseConnect.bookType)&&($(".hide-study-page-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".ereader-heading-pipes").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden"),$(".tutorial-resource-page").show(),$(".tutoriallink").show(),"true"==CaseConnect.resourceFlag&&$(".resource-heading-pipes").hide()),(CaseConnect.bookType&&"casebook"===CaseConnect.bookType||CaseConnect.bookType&&"coursebook"===CaseConnect.bookType)&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").show(),$(".hide-pipe-line-class").show(),$(".ereader-heading-pipes").hide(),$(".class-insights-mobile-visibility").css("visibility","visible")),CaseConnect.bookType&&"studyaid"===CaseConnect.bookType&&($(".hide-study-page-class").show(),$(".hide-ereader-class").show(),$(".hide-outline-page-class").show(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").show(),$(".ereader-heading-pipes").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden")),$(".ereader-main-header-title").html(CaseConnect.bookData.bookTitle),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle)),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide();var t=e.userActivityVO.resourceNodeVOList;"object"==$.type(t)&&(t,t=[t]),resourceNodeVOListData=t,resourceIdFromBookshelf=t[0].resourceId,setTimeout(function(){"undefined"!=t&&drawTableForPreview(t)},1e3),previewResourceContent=t,null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&checkNewsFeedInApp(),expiryDate(),getMyRequestNoftificationCount(),$(".resourceMenushow").removeClass("resourceMenuhide"),adminSuppressFunc()}else $("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)}function goToResourceFromBookshelf(){previewFlag=!0;var e=null;comingFromBookshelfToResource&&resourceIdFromBookshelf&&(e=resourceIdFromBookshelf);var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),streamContentRequiredFlag:!1,userActivityVO:{lastActivityCode:"RESOURCE_AS_BOOK",pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:e,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},resourceVO:{resourceId:e}};$.ajax({url:properties[properties.env]+"/manageResource/getPublishedResourceForApplicationFromBookShelf",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(e){if("true"==e.status){var t=e.resourceNodeVOList;"object"==$.type(t)&&(t,t=[t]),resourceNodeVOListData=t,setTimeout(function(){"undefined"!=t&&drawTableForPreview(t)},1e3),previewResourceContent=t,comingFromBookshelfToResource&&($(".bookshelflink").show(),$(".hide-study-page-class").hide(),$(".hide-ereader-class").hide(),$(".hide-outline-page-class").hide(),$(".hide-class-insights-class").hide(),$(".hide-pipe-line-class").hide(),$(".ereader-heading-pipes").hide(),$(".resource-heading-pipes").hide(),"true"==CaseConnect.resourceFlag&&$(".resourceMenushow").removeClass("resourceMenuhide"),void 0!==e.casesFlag&&(CaseConnect.casesFlag=e.casesFlag),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),void 0!==e.newsFeedFlag&&(CaseConnect.newsFeedFlag=e.newsFeedFlag),$(".hide-news-feed-class").hide(),$(".class-insights-mobile-visibility").css("visibility","hidden")),$("#page-loading-spinner").hide(),expiryDate()}"false"==e.status&&(alertMessagesModal(e.responseJSON.errorMessg),Utility.hideSpinner()),sessionTimeOut()},function(e){alertMessagesModal(e.responseJSON.errorMessg),Utility.hideSpinner(),sessionTimeOut()})}function showPreviewInNewPage(){previewFlag=!0,insideStaticPage=!1,insideBookshelf=!1;var e={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),streamContentRequiredFlag:!1,userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"RESOURCE_LANDING_PAGE",pageNavigatingFrom:"ResourceLanding",pageNavigatingTo:"ResourceLanding",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:CaseConnect.currentChapterId,lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:CaseConnect.currentBookId}};$.ajax({url:properties[properties.env]+"/manageResource/getPublishedResourceForApplication",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){if("true"==e.status){var t=e.resourceNodeVOList;"object"==$.type(t)&&(t,t=[t]),resourceNodeVOListData=t,setTimeout(function(){"undefined"!=t&&drawTableForPreview(t)},1e3),previewResourceContent=t,void 0!==e.newsFeedFlag&&(CaseConnect.newsFeedFlag=e.newsFeedFlag),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),void 0!==e.casesFlag&&(CaseConnect.casesFlag=e.casesFlag),"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),$(".read-modal-book-title").html(CaseConnect.bookData.bookTitle),$(".resourceMenushow").removeClass("resourceMenuhide")}"false"==e.status&&(alertMessagesModal(e.responseJSON.errorMessg),Utility.hideSpinner()),sessionTimeOut()},function(e){alertMessagesModal(e.responseJSON.errorMessg),sessionTimeOut(),Utility.hideSpinner()})}var countofStudentsubtab=0,resourceFirstElementIdInEditor="",resourcetabsMobileView;function drawTableForPreview(e){if(void 0!==e){for(var t=0;t<e.length;t++){var o=e[t].resourceSubNodeVOList;"object"==$.type(o)&&("true"===o.instructorFlag&&"Professor"!==map.userRole&&(countofStudentsubtab=0,noOfSubtab[t]=countofStudentsubtab,heightOfTab=45*countofStudentsubtab+50),o=[o]);var a=e[t].nodeName;a=(a=a.replace(/\'/g,"&sq")).replace(/\"/g,"&dq");var s=e[t].nodeTitle;if(s=(s=s.replace(/\'/g,"&sq")).replace(/\"/g,"&dq"),void 0!==o){noOfSubtab[t]=o.length,countofStudentsubtab=0;for(var i=0;i<o.length;i++)"true"==o[i].instructorFlag?"Professor"===map.userRole&&(1==o.length?heightOfTab=95:(noOfSubtab[t]=o.length,heightOfTab=45*o.length+50)):"Professor"===map.userRole?1==o.length?heightOfTab=95:(noOfSubtab[t]=o.length,heightOfTab=45*o.length+50):(countofStudentsubtab++,noOfSubtab[t]=countofStudentsubtab,heightOfTab=45*countofStudentsubtab+50);if("Professor"!==map.userRole&&0==countofStudentsubtab&&(noOfSubtab[t]=countofStudentsubtab,heightOfTab=45*countofStudentsubtab+50),"true"==e[t].instructorFlag){if("Professor"===map.userRole){$(".resources-notes-list-block").append('<div class="tabDiv list-style-none"><a class="listid'+t+' list-group-item outline-notes-list-item resource-tab-design ellipsis"  instructorFlag = "'+e[t].instructorFlag+'" resourceHtmlTitle = "'+s+'" resourceHtmlName = "'+a+'" resourceHtmlUrl = "'+e[t].htmlS3URL+'" resourceId = "'+e[t].resourceId+'" nodeId = "'+e[t].nodeId+'" style="height:55px;" href="#"><div class="iconFordropdown'+t+' resource-icon-dropdown glyphicon glyphicon-menu-down" onclick="toggleforsubmenu('+t+');"></div><div class="resource-notes-chapter-name ellipsis" resourceId = "'+e[t].resourceId+'"  nodeId = "'+e[t].nodeId+'" onclick="navBarButtonClick(event);toggleforsubmenu('+t+');" instructorFlag = "'+e[t].instructorFlag+'" resourceHtmlTitle = "'+s+'" resourceHtmlName = "'+a+'" resourceHtmlUrl = "'+e[t].htmlS3URL+'" checkforsubtab = no  ><div class="glyphicon glyphicon-check resource-prof-icon"></div>'+e[t].nodeName+'</div><span class="outline-notes-edited-date"></span><li class="subnodes'+t+' submenutoggle list-style-none resource-submenu-list-prof" style="display:none;"></li></a></div>');for(i=0;i<o.length;i++){n=(n=(n=o[i].subNodeTitle).replace(/\'/g,"&sq")).replace(/\"/g,"&dq"),r=(r=(r=o[i].subNodeName).replace(/\'/g,"&sq")).replace(/\"/g,"&dq"),$(".subnodes"+t).append('<div class="subnodeclass list-group-item subnode-list-item resource-subtab ellipsis selected" href="#" checkforsubtab = yes  instructorFlag = "'+e[t].instructorFlag+'" resourceId = "'+o[i].resourceId+'" nodeId = "'+o[i].nodeId+'" subNodeId = "'+o[i].subNodeId+'" resourceHtmlTitle = "'+n+'" resourceHtmlName = "'+r+'" resourceHtmlUrl = "'+o[i].htmlS3URL+'" onclick="navBarButtonClick(event);"><div class="glyphicon glyphicon-check resource-prof-icon"></div><span class="outline-notes-chapter-name ellipsis resource-subtab-title" style="margin-top:-28px;margin-left:26px" resourceHtmlTitle = "'+n+'"  resourceHtmlName = "'+r+'">'+o[i].subNodeName+'</span><span class="outline-notes-edited-date"></span></div>')}}}else{$(".resources-notes-list-block").append('<div class="tabDiv list-style-none"><a  class="listid'+t+' list-group-item outline-notes-list-item resource-tab-design ellipsis" style="height:55px;" href="#" resourceHtmlTitle = "'+s+'" resourceHtmlName = "'+a+'" resourceHtmlUrl = "'+e[t].htmlS3URL+'" instructorFlag = "'+e[t].instructorFlag+'" resourceId = "'+e[t].resourceId+'"  nodeId = "'+e[t].nodeId+'"><div class="iconFordropdown'+t+' resource-icon-dropdown glyphicon glyphicon-menu-down"onclick="toggleforsubmenu('+t+');"></div><div class="resource-notes-chapter-name ellipsis" onclick="navBarButtonClick(event);toggleforsubmenu('+t+');"  instructorFlag = "'+e[t].instructorFlag+'" resourceId = "'+e[t].resourceId+'" nodeId = "'+e[t].nodeId+'" resourceHtmlTitle = "'+s+'" resourceHtmlName = "'+a+'" resourceHtmlUrl = "'+e[t].htmlS3URL+'" checkforsubtab = no  >'+e[t].nodeName+'</div><span class="outline-notes-edited-date"></span><li class="subnodes'+t+' submenutoggle resource-submenu-list list-style-none" style="display:none;"></li></a></div>');for(i=0;i<o.length;i++){var n,r;n=(n=(n=o[i].subNodeTitle).replace(/\'/g,"&sq")).replace(/\"/g,"&dq"),r=(r=(r=o[i].subNodeName).replace(/\'/g,"&sq")).replace(/\"/g,"&dq"),"true"==o[i].instructorFlag?"Professor"===map.userRole&&$(".subnodes"+t).append('<div class="subnodeclass list-group-item subnode-list-item resource-subtab ellipsis selected" href="#" checkforsubtab = yes  instructorFlag = "'+o[i].instructorFlag+'" resourceId = "'+o[i].resourceId+'" subNodeId = "'+o[i].subNodeId+'" nodeId = "'+o[i].nodeId+'" resourceHtmlTitle = "'+n+'" resourceHtmlName = "'+r+'" resourceHtmlUrl = "'+o[i].htmlS3URL+'" onclick="navBarButtonClick(event);"><div class="glyphicon glyphicon-check resource-prof-icon"></div><span class="outline-notes-chapter-name ellipsis resource-subtab-title" style="margin-top:-28px;margin-left:26px" resourceHtmlTitle = "'+n+'" resourceHtmlName = "'+r+'">'+o[i].subNodeName+'</span><span class="outline-notes-edited-date"></span></div>'):$(".subnodes"+t).append('<div class="list-group-item subnode-list-item resource-subtab ellipsis selected" href="#" checkforsubtab = yes  instructorFlag = "'+o[i].instructorFlag+'" resourceId = "'+o[i].resourceId+'" nodeId = "'+o[i].nodeId+'" subNodeId = "'+o[i].subNodeId+'" resourceHtmlTitle = "'+n+'" resourceHtmlName = "'+r+'" resourceHtmlUrl = "'+o[i].htmlS3URL+'"  onclick="navBarButtonClick(event);" ><span class="outline-notes-chapter-name resource-subtab-title ellipsis"  resourceHtmlTitle = "'+n+'" resourceHtmlName = "'+r+'">'+o[i].subNodeName+'</span><span class="outline-notes-edited-date"></span></div>')}}}else"true"==e[t].instructorFlag?"Professor"===map.userRole&&$(".resources-notes-list-block").append('<div  class="tabDiv list-style-none"><a class="listid'+t+' list-group-item resource-tab-without-subtab outline-notes-list-item ellipsis" href="#"  instructorFlag = "'+e[t].instructorFlag+'" resourceId = "'+e[t].resourceId+'" nodeId = "'+e[t].nodeId+'" resourceHtmlTitle = "'+s+'" resourceHtmlName = "'+a+'" resourceHtmlUrl = "'+e[t].htmlS3URL+'" checkforsubtab = no  onclick="navBarButtonClick(event);" ><span class="resource-notes-chapter-name ellipsis" resourceHtmlTitle = "'+s+'" resourceHtmlName = "'+a+'"><span class="glyphicon glyphicon-check resource-prof-icon"></span>'+e[t].nodeName+'</span><span class="outline-notes-edited-date"></span></a></div>'):$(".resources-notes-list-block").append('<div  class="tabDiv list-style-none"><a class="listid'+t+' list-group-item resource-tab-without-subtab outline-notes-list-item ellipsis" href="#"  instructorFlag = "'+e[t].instructorFlag+'" resourceId = "'+e[t].resourceId+'" nodeId = "'+e[t].nodeId+'" resourceHtmlTitle = "'+s+'" resourceHtmlName = "'+a+'" resourceHtmlUrl = "'+e[t].htmlS3URL+'" checkforsubtab = no  onclick="navBarButtonClick(event);" ><span class="resource-notes-chapter-name ellipsis" resourceHtmlTitle = "'+s+'" resourceHtmlName = "'+a+'">'+e[t].nodeName+'</span><span class="outline-notes-edited-date"></span></a></div>');"Professor"!==map.userRole&&0==countofStudentsubtab&&$(".iconFordropdown"+t).hide()}if(isPermaTabs="",isPermaTab="","true"==CaseConnect.permalinkOrigin&&void 0!==e){"object"==$.type(e)&&(e=[e]);for(var l=0;l<e.length;l++){if("true"==e[l].permaLink){isPermaTab=e[l].nodeId;break}if(void 0!==e[l].resourceSubNodeVOList){"object"==$.type(e[l].resourceSubNodeVOList)&&(e[l].resourceSubNodeVOList=[e[l].resourceSubNodeVOList]);for(var d=0;d<e[l].resourceSubNodeVOList.length;d++)if("true"==e[l].resourceSubNodeVOList[d].permaLink){isPermaTabs=e[l].resourceSubNodeVOList[d].subNodeId;break}}}}navBarWhileLoading(e)}$(window).trigger("resize"),$("#page-loading-spinner").hide()}function toggleforsubmenu(e){$(".iconFordropdown"+e).toggleClass("glyphicon-menu-up glyphicon-menu-down"),$(".subnodes"+e).toggle(),$(".iconFordropdown"+e).hasClass("glyphicon-menu-down")?$(".listid"+e).css("height","55px"):(heightOfTab=45*noOfSubtab[e]+50,$(".listid"+e).css("height",heightOfTab+"px")),$(window).trigger("resize")}function navBarButtonClick(e){closeOverlayInMobile("outline-nav-menu-mobile"),$(".listid0").removeClass("selected"),$(".tabDiv").removeClass("selected"),$(".subnode-list-item").removeClass("selected"),"yes"==e.currentTarget.getAttribute("checkforsubtab")&&$(e.currentTarget).addClass("selected");var t=$(e.currentTarget).parent("a");$(t).parent(".tabDiv").addClass("selected"),$(e.currentTarget).parent(".tabDiv").addClass("selected"),"true"==e.currentTarget.getAttribute("instructorFlag")?$("#profMessage").show():$("#profMessage").hide();var o=e.target.getAttribute("resourceHtmlTitle");o=(o=o.replace(/&sq/g,"'")).replace(/&dq/g,'"'),$("#chapter-title-div-resources-mobile").html(o);var a=e.currentTarget.getAttribute("resourcehtmlurl");$("#page-loading-spinner").show(),$.ajax({url:a,type:"GET",async:!1}).then(function(e){var t=e;t.split("</head>")&&$("#setContentofEditor").html(t.split("</head>")),sessionTimeOut(),$("#page-loading-spinner").hide()},function(e){sessionTimeOut(),$("#page-loading-spinner").hide()}),$("#outline-notes-menu-mobile").modal("hide");var s=$("#maindivResource").height();s=s<595?595:$("#maindivResource").height(),$("#heightforResourceTab").css("min-height",s+"px");var i=$(".outline-editor-wrapper").width();$("#setContentofEditor").find("img").length;$("#setContentofEditor img").each(function(){var e=$(this).width(),t=e/i*100;e>i?$(this).css("width","100%"):$(this).css("width",t+"%")})}function showResourceNotesMoblie(e){void 0!==$("#outline-notes-menu-mobile").data()["bs.modal"]?$("#outline-notes-menu-mobile").data()["bs.modal"].isShown?($("#outline-notes-menu-mobile").modal("hide"),$("div.ereader-page-info-modal-container .ereader-top-nav-cog").attr("onclick","showAccountMenuInMobile('"+e+"')"),$("div.common-book-info-modal-container .ereader-top-nav-cog").addClass("cc-header-account").removeClass("glyphicon glyphicon-remove")):($("#outline-notes-menu-mobile").modal("show"),$(".outline-notes-list-block").scrollTop(0),$(".ereader-assessment-content-area").scrollTop(0),$("div.common-book-info-modal-container .ereader-top-nav-cog").removeClass("cc-header-account").addClass("glyphicon glyphicon-remove"),$("div.common-book-info-modal-container .ereader-top-nav-cog").attr("onclick","closeOverlayInMobile('"+e+"')")):($("#outline-notes-menu-mobile").modal("show"),$("div.common-book-info-modal-container .ereader-top-nav-cog").removeClass("cc-header-account").addClass("glyphicon glyphicon-remove"),$("div.common-book-info-modal-container .ereader-top-nav-cog").attr("onclick","closeOverlayInMobile('"+e+"')")),$(".common-book-menu-dropdown").attr("onclick","showAccountMenuFromHamburger('"+e+"');")}function navBarWhileLoading(e){var t,o,a="";"true"==CaseConnect.permalinkOrigin?""!=isPermaTab&&""==isPermaTabs?a=isPermaTab:""==isPermaTab&&""!=isPermaTabs&&(a=isPermaTabs):a=$("#heightforResourceTab").find("a")[0].getAttribute("nodeid"),"object"==$.type(e)&&(e=[e]);for(var s,i=0;i<e.length;i++){if(e[i].nodeId===a){var n=i;o=e[n].nodeTitle,t=e[n].htmlS3URL,s=e[n].instructorFlag;break}if(void 0!==resourceNodeVOListData[i].resourceSubNodeVOList){"object"==$.type(resourceNodeVOListData[i].resourceSubNodeVOList)&&(resourceNodeVOListData[i].resourceSubNodeVOList=[resourceNodeVOListData[i].resourceSubNodeVOList]);for(var r=0;r<resourceNodeVOListData[i].resourceSubNodeVOList.length;r++)if(resourceNodeVOListData[i].resourceSubNodeVOList[r].subNodeId==a){o=e[i].resourceSubNodeVOList[r].subNodeTitle,t=e[i].resourceSubNodeVOList[r].htmlS3URL,s=e[i].resourceSubNodeVOList[r].instructorFlag;break}}}if("object"==$.type(e)){t=t,o=o,$("#chapter-title-div-resources-mobile").html(o),"true"==e.instructorFlag&&"Professor"===map.userRole?$("#profMessage").show():$("#profMessage").hide(),null===a&&(o=e.nodeTitle,t=e.htmlS3URL),c=(c=$("#maindivResource").height())<595?595:$("#maindivResource").height(),$("#heightforResourceTab").css("min-height",c+"px")}else{if("true"==s&&"Professor"===map.userRole?$("#profMessage").show():$("#profMessage").hide(),"true"==CaseConnect.permalinkOrigin){if(""!=isPermaTab&&""==isPermaTabs){var l=$(".tabDiv a");$(".tabDiv").removeClass("selected"),$(".subnode-list-item").removeClass("selected");for(var d=0;d<l.length;d++)l[d].getAttribute("nodeid")==isPermaTab&&($(".tabDiv a")[d].parentNode.className+=" selected")}else if(""==isPermaTab&&""!=isPermaTabs){l=$(".subnode-list-item");$(".tabDiv").removeClass("selected"),$(".subnode-list-item").removeClass("selected");for(d=0;d<l.length;d++)l[d].getAttribute("subnodeid")==isPermaTabs&&($(".subnode-list-item")[d].className+=" selected",-1!=$(".subnode-list-item")[d].parentNode.parentNode.children[0].className.indexOf("glyphicon-menu-down")&&$(".subnode-list-item")[d].parentNode.parentNode.children[0].click())}localStorage.setItem("permaOrigin","false"),CaseConnect.permalinkOrigin="false",permalinkUrl=""}else $(".listid0").parent(".tabDiv").addClass("selected"),$(".subnode-list-item").removeClass("selected");var c;o=o,$("#chapter-title-div-resources-mobile").html(o),t=t,$("#page-loading-spinner").show(),$.ajax({url:t,type:"GET",async:!1}).then(function(e){var t=e;t.split("</head>")&&$("#setContentofEditor").html(t.split("</head>")),$(window).trigger("resize"),$("#page-loading-spinner").hide()},function(e){$("#page-loading-spinner").hide()}),c=(c=$("#maindivResource").height())<595?595:$("#maindivResource").height(),$("#heightforResourceTab").css("min-height",c+"px")}var u=$(".outline-editor-wrapper").width();$("#setContentofEditor").find("img").length;$("#setContentofEditor img").each(function(){var e=$(this).width(),t=e/u*100;e>u?$(this).css("width","100%"):$(this).css("width",t+"%")}),$(window).trigger("resize")}function downloadDocResource(e){var t=map.sessionVO;$("#userIdDownload").val(map.userId),$("#userRoleDownload").val(map.userRole),$("#userRoleIdDownload").val(map.userRoleId),$("#appTypeDownload").val(t.appType),$("#deviceTypeDownload").val(t.deviceType),$("#deviceOSDownload").val(t.deviceOS);var o=e.currentTarget.getAttribute("fileid");$("#fileIdDownload").val(o),t.sessionAuthenticationToken||localStorage.getItem("sessionAuthenticationToken")&&(map.sessionVO.sessionAuthenticationToken=localStorage.getItem("sessionAuthenticationToken")),$("#sessionAuthenticationTokenDownload").val(t.sessionAuthenticationToken),$("#sessionAuthenticationTokenDownload").val(localStorage.getItem("sessionAuthenticationToken")),document.getElementById("downloadFormResource").action=properties[properties.env]+"/manageResource/downloadResourceDocumentForApplication",$("#downloadFormResource").submit()}function showHideResourceNavInMoblie(){$("#outline-notes-menu-mobile").modal("hide")}function showHideLoginResource(){var e=localStorage.getItem("rememberMe"),t="true"==Utility.getCookie("sameSession");localStorage.getItem("userId")&&("true"==e||t)?($(".resource-logged-in").show(),$(".resource-logged-out").hide()):($(".resource-logged-in").hide(),$(".resource-logged-out").show())}function ftshowHideLoginResource(e){var t=localStorage.getItem("rememberMe"),o="true"==Utility.getCookie("sameSession");localStorage.getItem("userId")&&("true"==t||o)?e?($(".ftresource-logged-in").show(),$(".ftresource-logged-out").hide(),$(".ftresource-single-logged").hide()):($(".ftresource-logged-in").hide(),$(".ftresource-logged-out").hide(),$(".ftresource-single-logged").show(),$(".single-logged-in").show(),$(".single-logged-out").hide()):e?($(".ftresource-logged-in").hide(),$(".ftresource-logged-out").show(),$(".ftresource-single-logged").hide()):($(".ftresource-logged-in").hide(),$(".ftresource-logged-out").hide(),$(".ftresource-single-logged").show(),$(".single-logged-in").hide(),$(".single-logged-out").show())}var slideIndex=1,caseBookTutorial=!1,practicePackTutorial=!1,studyAidTutorial=!1;function plusDivs(e){showDivs(slideIndex+=e)}function currentDiv(e){showDivs(slideIndex=e)}function showDivs(e){var t;if(1==slideIndex?($(".preButton").hide(),$("#preButton-studyaid").hide()):($(".preButton").show(),$("#preButton-studyaid").show()),1==caseBookTutorial){var o=$("#new-bookshelf-modal-faculty .carousel-indicators .demo"),a=$("#new-bookshelf-modal-faculty .carousel-inner .item");for(slideIndex==a.length?($(".nextButton").hide(),$(".done").show()):($(".nextButton").show(),$(".done").hide()),e>o.length&&(slideIndex=1),e<1&&(slideIndex=o.length),t=0;t<o.length;t++)o[t].className=o[t].className.replace("active","");for(j=0;j<a.length;j++)a[j].className=a[j].className.replace("active","");o[slideIndex-1].className+=" active",a[slideIndex-1].className+=" active"}else if(1==studyAidTutorial){o=$("#studyaid-tutorial-faculty .carousel-indicators .demo"),a=$("#studyaid-tutorial-faculty .carousel-inner .item");for(slideIndex==a.length?($(".nextButton").hide(),$(".done").show()):($(".nextButton").show(),$(".done").hide()),e>o.length&&(slideIndex=1),e<1&&(slideIndex=o.length),t=0;t<o.length;t++)o[t].className=o[t].className.replace("active","");for(j=0;j<a.length;j++)a[j].className=a[j].className.replace("active","");o[slideIndex-1].className+=" active",a[slideIndex-1].className+=" active"}}function showExpiryPopover(e){$("#book-expiry-message").modal("show"),e&&"yes"==e.currentTarget.getAttribute("extendableflag")?($("#book-expiry-message #okay-expiry").hide(),$("#book-expiry-message #extend-expiry").attr("buyOptionLink",e.currentTarget.getAttribute("buyOptionLink")),$("#book-expiry-message #extend-expiry").show()):($("#book-expiry-message #okay-expiry").show(),$("#book-expiry-message #extend-expiry").hide())}function clickedExtendAccess(e){window.open(""+e.currentTarget.getAttribute("buyOptionLink"),"_blank")}function convertToServerTimeZone(){var e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t+-18e6)}function checkExpiredOnclickOfBook(event){localStorage.setItem("eulaValidationCheck",event.currentTarget.getAttribute("eulaFlag")),localStorage.setItem("bookIsbn",event.currentTarget.getAttribute("bookISBN"));var eulaValidationElem=localStorage.getItem("eulaValidationCheck");if(void 0!==event){var bookId=event.currentTarget.getAttribute("bookid"),bookType=event.currentTarget.getAttribute("booktype"),bookIsbn=event.currentTarget.getAttribute("bookisbn"),pageNumberElementGlobal=event.currentTarget.getAttribute("currentpage"),freeTrialFlag=event.currentTarget.getAttribute("freeTrialFlag"),adminStudyFlag=event.currentTarget.getAttribute("adminStudyFlag"),adminOutlineFlag=event.currentTarget.getAttribute("adminOutlineFlag"),adminInsightsFlag=event.currentTarget.getAttribute("adminInsightsFlag"),adminNewsFlag=event.currentTarget.getAttribute("adminNewsFlag");if(""!==event.currentTarget.getAttribute("relatedthemisproductid")){var relatedThemisProductId=event.currentTarget.getAttribute("relatedthemisproductid");CaseConnect.currentProductId=event.currentTarget.getAttribute("relatedthemisproductid"),localStorage.setItem("currentProductId",CaseConnect.currentProductId)}CaseConnect.currentBookId=bookId,CaseConnect.currentPageNumber=pageNumberElementGlobal,CaseConnect.freeTrialFlag=freeTrialFlag,CaseConnect.adminStudyFlag=adminStudyFlag,CaseConnect.adminOutlineFlag=adminOutlineFlag,CaseConnect.adminInsightsFlag=adminInsightsFlag,CaseConnect.adminNewsFlag=adminNewsFlag,localStorage.setItem("freeTrialFlag",freeTrialFlag),localStorage.setItem("adminStudyFlag",adminStudyFlag),localStorage.setItem("adminOutlineFlag",adminOutlineFlag),localStorage.setItem("adminInsightsFlag",adminInsightsFlag),localStorage.setItem("adminNewsFlag",adminNewsFlag),localStorage.setItem("bookIsbn",bookIsbn),"Themis"===bookType&&(CaseConnect.currentProductId=bookId);var listOfAttributes=event.currentTarget.attributes}if("true"===eulaValidationElem)return $("[rel=popover]").popover("hide"),map.overlay.fadeOut(200),$("#eula-validation-modal").modal("show"),$(listOfAttributes).each(function(){var e=this.name,t=this.value;$("#btn-eula-accept").attr(e,t)}),$(".eula-text-container").load("endUserLisenceAggrement.html"),void $("#eula-validation-modal button").removeAttr("id","class").removeAttr("style").attr({id:"btn-eula-accept",class:"btn btn-default popover-common-btn ereader-btn-custom-gradient",onClick:"saveEulaValidationStatus(event,true)"});$(".books-thumbnail").popover("hide"),map.overlay.fadeOut(200),$("#page-loading-spinner").show();var reqData={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf"},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}};"Resource"==bookType?reqData.resourceVO={resourceId:bookId}:"Themis"===bookType?reqData.themisProductVO={productId:bookId}:insideGlobalSearchResult&&void 0!==bookIsbn&&""!==bookIsbn&&null!==bookIsbn?reqData.bookVO={bookISBN:bookIsbn}:reqData.bookVO={bookId:CaseConnect.currentBookId},$.ajax({url:properties[properties.env]+"/manageBookService/checkValidityPeriod",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(reqData)}).then(function(data){if("true"==data.status){if(data.bookVO)if("active"==data.bookVO.validityStatus||"Life time"==data.bookVO.validityStatus){expirypopoverFlag=!1,expiredBookFlag=!1;var request={},reqData={};insideGlobalSearchResult?(CaseConnect.currentBookIsbn=bookIsbn,CaseConnect.currentPageNumber=pageNumberElementGlobal):CaseConnect.currentBookId=bookId,void 0!==data.bookVO.bookId&&(CaseConnect.currentBookId=data.bookVO.bookId),"Themis"!==bookType?(request.url=properties[properties.env]+"/bookContentRetrievalService/getBookContent",request.method="POST",request.handler=eval("Handler.loadEreader"),request.data=reqData,request.handler.request.apply(null,[request]),Utility.fireRequest(request)):determineThemis()}else"expired"==data.bookVO.validityStatus&&(showExpiryPopover(event),expiredBookFlag=!0);data.resourceVO&&("active"==data.resourceVO.validityStatus||"Life time"==data.resourceVO.validityStatus?(expirypopoverFlag=!1,expiredBookFlag=!1,resourceIdFromBookshelf=bookId,Handler.click.comingFromBookshelfToResource()):"expired"==data.resourceVO.validityStatus&&(showExpiryPopover(event),expiredBookFlag=!0)),"Themis"===bookType&&(CaseConnect.currentProductId=bookId,localStorage.setItem("currentProductId",CaseConnect.currentProductId),expirypopoverFlag=!1,expiredBookFlag=!1,determineThemis())}},function(e){$("#page-loading-spinner").hide()})}function expiryDate(){var e={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf"},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}}};""==CaseConnect.bookType&&insideResourcePage?insideResourcePagefromPermawithBookAssoc&&insideResourcePage?e.bookVO={bookId:localStorage.getItem("bookIdassocWithResource")}:e.resourceVO={resourceId:resourceIdFromBookshelf}:(insideThemis||insideThemisAdmin)&&""!==CaseConnect.currentProductId&&"null"!==CaseConnect.currentProductId&&null!==CaseConnect.currentProductId?e.themisProductVO={productId:CaseConnect.currentProductId}:null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(e.bookVO={bookId:CaseConnect.currentBookId}),$.ajax({url:properties[properties.env]+"/manageBookService/checkValidityPeriod",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(e)}).then(function(e){if("true"==e.status){if(e.bookVO)if("active"==e.bookVO.validityStatus||"Life time"==e.bookVO.validityStatus){if(e.bookVO.accessCodeExpirationDate)new Date(e.bookVO.accessCodeExpirationDate)-convertToServerTimeZone()<=9e5&&(expirypopoverFlag||(alertMessagesModal("Book is going to be expired within 15 mins."),expirypopoverFlag=!0));expiredBookFlag=!1}else"expired"==e.bookVO.validityStatus&&($("#index-automation-bookshelf-three").click(),showExpiryPopover(),expiredBookFlag=!0);if(e.resourceVO)if("active"==e.resourceVO.validityStatus||"Life time"==e.resourceVO.validityStatus){if(e.resourceVO.accessCodeExpirationDate)new Date(e.resourceVO.accessCodeExpirationDate)-convertToServerTimeZone()<=9e5&&(expirypopoverFlag||(alertMessagesModal("Book is going to be expired within 15 mins."),expirypopoverFlag=!0));expiredBookFlag=!1}else"expired"==e.resourceVO.validityStatus&&($("#index-automation-bookshelf-three").click(),showExpiryPopover(),expiredBookFlag=!0)}setExpiryDateTimer()},function(e){$("#page-loading-spinner").hide()})}function expiryDateForLoginandRefresh(e){var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf"},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:e.sessionAuthenticationToken}}};"RESOURCE_AS_BOOK"===e.userActivityVO.lastActivityCode?("object"==$.type(e.userActivityVO.resourceNodeVOList)&&(e.userActivityVO.resourceNodeVOList=[e.userActivityVO.resourceNodeVOList]),null!=e.userActivityVO.bookId?t.bookVO={bookId:e.userActivityVO.bookId}:(resourceIdFromBookshelf=e.userActivityVO.resourceNodeVOList[0].resourceId,t.resourceVO={resourceId:resourceIdFromBookshelf})):e.userActivityVO.lastActivityCode.indexOf("THEMIS_")>=0?t.themisProductVO={productId:CaseConnect.currentProductId}:null!==CaseConnect.currentBookId&&""!==CaseConnect.currentBookId&&void 0!==CaseConnect.currentBookId&&(t.bookVO={bookId:CaseConnect.currentBookId}),$.ajax({url:properties[properties.env]+"/manageBookService/checkValidityPeriod",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(t){"true"==t.status&&(t.bookVO&&("active"==t.bookVO.validityStatus||"Life time"==t.bookVO.validityStatus?(expiredBookFlag=!1,e.userActivityVO&&void 0!==e.userActivityVO.lastActivityCode&&e.userActivityVO.lastActivityCode.indexOf("EREADER")>=0?($(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),Utility.showSpinner(),addBookshelfLinkTOLogo(),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),Handler.login.updateStatusBar(),CaseConnect.outlineTimer&&clearTimeout(CaseConnect.outlineTimer),loadEreaderFromLogin(e)):e.userActivityVO&&void 0!==e.userActivityVO.lastActivityCode&&e.userActivityVO.lastActivityCode.indexOf("STUDY_CENTER")>=0?(Utility.showSpinner(),Handler.login.updateStatusBar(),$(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),loadStudyCenterFromLogin(e),addBookshelfLinkTOLogo()):e.userActivityVO&&void 0!==e.userActivityVO.lastActivityCode&&e.userActivityVO.lastActivityCode.indexOf("OUTLINE")>=0?(map.wk_conatiner.load("outline-editing-tool.html?v10840"),$("#bookshelf-nav-menu-mobile").modal("hide"),Utility.showSpinner(),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),Handler.login.updateStatusBar(),Handler.login.removeUnderlineStyle(),addBookshelfLinkTOLogo(),enableCopyPaste(),insideOutline=!0,insideNewsFeed=!1,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,$(window).trigger("resize"),nonEditableChapterOutline=!0,$(".bookshelflink").show(),$(".tutoriallink").show(),$("#page-loading-spinner").hide(),loadOutlineFromLogin(e),$(window).scrollTop(0),$("body").removeClass("modal-open")):e.userActivityVO&&void 0!==e.userActivityVO.lastActivityCode&&e.userActivityVO.lastActivityCode.indexOf("CASE_")>=0?($("#page-loading-spinner").show(),addBookshelfLinkTOLogo(),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),Handler.login.updateStatusBar(),$(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),e.userActivityVO.lastActivityCode.indexOf("CASE_MANAGE_CONNECTION_PAGE")>=0?loadManageConnectionFromLogin(e):loadCasesBriefsFromLogin(e)):e.userActivityVO&&void 0!==e.userActivityVO.lastActivityCode&&e.userActivityVO.lastActivityCode.indexOf("NEWS_PAGE")>=0?($("#page-loading-spinner").show(),addBookshelfLinkTOLogo(),CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),Handler.login.updateStatusBar(),$(".bookshelflink").show(),$(".tutoriallink").show(),$("#bookshelf-nav-menu-mobile").modal("hide"),map.wk_conatiner.load("news-feed.html?v16865",function(){loadnewsFeedFromLogin(e)})):e.userActivityVO&&void 0!==e.userActivityVO.lastActivityCode&&e.userActivityVO.lastActivityCode.indexOf("RESOURCE")>=0&&(null!=e.userActivityVO.bookId&&""!=e.userActivityVO.bookId&&(insideResourcePagefromPermawithBookAssoc=!0,localStorage.setItem("bookIdassocWithResource",e.userActivityVO.bookId)),map.wk_conatiner.load("view-resource.html?v19893",function(){Utility.showSpinner(),insideResourcePage=!0,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideCasesPage=!1,insideOutline=!1,insideEreader=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),CaseConnect.resourceFlag="true",CaseConnect.casesFlag=e.userActivityVO.casesFlag,CaseConnect.newsFeedFlag=e.userActivityVO.newsFeedFlag,"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),CaseConnect.resourceFlag="true",Handler.login.updateStatusBar(),Handler.login.removeUnderlineStyle(),$(".bookshelflink").show(),$(".tutoriallink").show(),addBookshelfLinkTOLogo(),enableCopyPaste(),$(window).trigger("resize"),loadResourcePageOnReload(e),$(window).scrollTop(0)}))):"expired"==t.bookVO.validityStatus&&($("#index-automation-bookshelf-three").click(),showExpiryPopover(),expiredBookFlag=!0)),t.resourceVO&&("active"==t.resourceVO.validityStatus||"Life time"==t.resourceVO.validityStatus?(expiredBookFlag=!1,e.userActivityVO&&void 0!==e.userActivityVO.lastActivityCode&&e.userActivityVO.lastActivityCode.indexOf("RESOURCE")>=0&&map.wk_conatiner.load("view-resource.html?v19893",function(){Utility.showSpinner(),insideResourcePage=!0,insideClassInsightsPage=!1,insideStudycenterPage=!1,insideNewsFeed=!1,insideCasesPage=!1,insideOutline=!1,insideEreader=!1,insideGlobalSearchResult=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,CaseConnect.currentUserId=localStorage.getItem("userId"),CaseConnect.currentUserRole=localStorage.getItem("userRole"),CaseConnect.currentUserRoleId=localStorage.getItem("userRoleId"),CaseConnect.resourceFlag="true",CaseConnect.casesFlag=e.userActivityVO.casesFlag,CaseConnect.newsFeedFlag=e.userActivityVO.newsFeedFlag,"true"===CaseConnect.casesFlag?CaseConnect.bookType?"oer"!==CaseConnect.bookType&&$(".hide-case-page-class").show():$(".hide-case-page-class").show():$(".hide-case-page-class").hide(),"true"===CaseConnect.newsFeedFlag&&"true"==CaseConnect.adminNewsFlag?$(".hide-news-feed-class").show():$(".hide-news-feed-class").hide(),CaseConnect.resourceFlag="true",Handler.login.updateStatusBar(),Handler.login.removeUnderlineStyle(),$(".bookshelflink").show(),$(".tutoriallink").show(),addBookshelfLinkTOLogo(),enableCopyPaste(),$(window).trigger("resize"),loadResourcePageOnReload(e),$(window).scrollTop(0)})):"expired"==t.resourceVO.validityStatus&&($("#index-automation-bookshelf-three").click(),showExpiryPopover(),expiredBookFlag=!0))),setExpiryDateTimer()},function(e){$("#page-loading-spinner").hide()})}function loadGlobalSearchResultOnClick(e){var t;void 0!==e&&(void 0!==t&&""!==t&&null!==t||loadGlobalSearchResult(t=$("#globalSearch").val()))}function loadGlobalSearchResult(e){$("#page-loading-spinner").show();localStorage.setItem("globalSearchKeyword",e);var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"GLOBAL_SEARCH_LANDING_PAGE",pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf",lastReadBookId:"39",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},contentSearchVO:{searchKeyWord:e}};$.ajax({url:properties[properties.env]+"/bookShelfRetrivalService/globalSearch",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(t){void 0!==t.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",t.sessionAuthenticationToken);var o=Handlebars.getTemplate("globalSearchResult");if(insideCasesPage=!1,insideEreader=!1,insideNewsFeed=!1,insideAssessment=!1,insideOutline=!1,insideResourcePage=!1,insideStudycenterPage=!1,insideStaticPage=!0,insideBookshelf=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,null!=t.contentSearchResultVOList&&null!=t.contentSearchResultVOList){var a=t.contentSearchResultVOList;if("object"==$.type(a)&&(a=[a]),insideGlobalSearchResult){var s,i,n=o(a);$("#global-search-result-container").html(n),$("input#globalSearch").val(e),$("#globalSearch").focus(),1===a.length?$(".global-result-count").html('<span class="global-result-count">'+a.length+"</span><span>Result Found</span>"):(a.length>1||0===a.length)&&$(".global-result-count").html('<span class="global-result-count">'+a.length+"</span><span>Results Found</span>");for(var r=0;r<a.length;r++)void 0!==a[r].pubDate?(s=a[r].pubDate,i=moment(s).format("YYYY"),$("#bookPub-year_"+a[r].recordId).html(" ("+i+")")):$("#bookPub-year_"+a[r].recordId).html("");$("#globalSearch").focus(),$(window).trigger("resize"),$("#page-loading-spinner").hide()}else map.wk_conatiner.load("globalSearchResultDashboard.html?v04",function(){insideGlobalSearchResult=!0;var t,s,i=o(a);$("#global-search-result-container").html(i),$("input#globalSearch").val(e),1===a.length?$(".global-result-count").html('<span class="global-result-count">'+a.length+"</span><span>Result Found</span>"):(a.length>1||0===a.length)&&$(".global-result-count").html('<span class="global-result-count">'+a.length+"</span><span>Results Found</span>");for(var n=0;n<a.length;n++)void 0!==a[n].pubDate?(t=a[n].pubDate,s=moment(t).format("YYYY"),$("#bookPub-year_"+a[n].recordId).html(" ("+s+")")):$("#bookPub-year_"+a[n].recordId).html("");$(window).trigger("resize"),$("#page-loading-spinner").hide()})}else insideGlobalSearchResult?($("input#globalSearch").val(e),$(".global-result-count").html('<span class="global-result-count">0</span><span>Results Found</span>'),$("#global-search-result-container").html(""),$("#global-search-result-container").css("min-height","100px"),$("#page-loading-spinner").hide()):map.wk_conatiner.load("globalSearchResultDashboard.html?v04",function(){insideGlobalSearchResult=!0,$("input#globalSearch").val(e),$(".global-result-count").html('<span class="global-result-count">0</span><span>Results Found</span>'),$("#global-search-result-container").html(""),$("#global-search-result-container").css("min-height","100px"),$("#page-loading-spinner").hide()})},function(e){sessionAuthFails(e),sessionTimeOut(),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}function enterGlobalKeyWord(e,t){"13"==e.keyCode&&loadGlobalSearchResult(e.currentTarget.value)}function pinBooks(e,t){var o=t.currentTarget,a=o.parentElement.parentElement;if("yes"==e&&$(a).find(".expired").length>0){var s=$(a).find(".expired span")[0].innerText;alertMessagesModal("This title expired on "+s+". Please renew this title before using the pin feature.")}else{var i={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf",lastReadBookId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},bookVO:{bookId:o.getAttribute("bookId"),pinnedFlag:e}};"Resource"==o.getAttribute("booktype")?i.bookVO.bookType="Resource":"Themis"==o.getAttribute("booktype")?i.bookVO.bookType="Themis":"ConnectedQuiz"==o.getAttribute("booktype")?i.bookVO.bookType="ConnectedQuiz":"PracticePerfect"==o.getAttribute("booktype")?i.bookVO.bookType="PracticePerfect":i.bookVO.bookType="Book",$.ajax({url:properties[properties.env]+"/bookShelfRetrivalService/pinBooks",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(i)}).then(function(t){"yes"==e?(o.children[0].className="glyphicon glyphicon-pushpin pinning-icon pinned-book",o.removeAttribute("onclick"),o.setAttribute("onclick","pinBooks('no',event)")):(o.children[0].className="glyphicon glyphicon-pushpin pinning-icon unpinned-book",o.removeAttribute("onclick"),o.setAttribute("onclick","pinBooks('yes',event)"))},function(e){alertMessagesModal(e.responseJSON.errorMessg)})}}function hover(e){e.setAttribute("src","img/green-plus-hover.png")}function unhover(e){e.setAttribute("src","img/green-plus.png")}function showHideBookListInDashboard(e){var t=null,o=CaseConnect.bookListForUser.bookVOList.length,a=$("#my-search-box").val(),s="";if(s="Student"===localStorage.getItem("userRole")?"student-book-elements":"faculty-book-elements",null!=e){$("span.dashboard-view-block").html("View More"),$(".view-more-less-bottom").hide();for(var i=0;i<o;i++)void 0!==$("ul#"+s+" li")[i+3]&&($("ul#"+s+" li")[i+3].classList.remove("show-books"),$("ul#"+s+" li")[i+3].classList.add("hide-books"))}else if(null===(t=""===a?$("ul#"+s+" li:visible").length:$("ul#"+s+" li:visible").length+$("ul#"+s+" li:hidden").length)&&(t=o),t<4){$("span.dashboard-view-block").html("View Less"),$(".view-more-less-bottom").show(),$("div.view-more-less-link span.glyphicon").removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-up");for(i=0;i<o;i++)$("ul#"+s+" li")[i],$("ul#"+s+" li")[i].classList.add("show-books"),$("ul#"+s+" li")[i].classList.remove("hide-books")}else{$("span.dashboard-view-block").html("View More"),$(".view-more-less-bottom").hide(),$("div.view-more-less-link span.glyphicon").removeClass("glyphicon-chevron-up").addClass("glyphicon-chevron-down");for(i=0;i<o;i++)void 0!==$("ul#"+s+" li")[i+3]&&($("ul#"+s+" li")[i+3].classList.remove("show-books"),$("ul#"+s+" li")[i+3].classList.add("hide-books"));t=null}o<4?$(".view-more-less-link").hide():$(".view-more-less-link").show()}function checkSorting(){$("#my-search-box").val();$("#my-search-box").on("keypress",function(){""===$("#my-search-box").val()?(showCount=3,showHideBookListInDashboard(showCount)):(showCount=null,showHideBookListInDashboard(showCount))})}showDivs(slideIndex);var comingFromAddProductPopover=!1;function showRedeemPopoverFromBookshelf(){var e=$("#addBook").clone(!0);$("#add-product-to-bookshelf").html(""),$("#add-product-to-bookshelf").append(e.html()),comingFromAddProductPopover=!0}function loadPromoSpotlightDashboard(e){var t={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userType:localStorage.getItem("userType"),userActivityVO:{lastActivityCode:"BOOKSHELF",pageNavigatingFrom:"EReader",pageNavigatingTo:"Bookshelf",lastReadBookId:"",lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:""},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")},spotlightFlag:!0};$.ajax({url:properties[properties.env]+"/managePromo/getPromoForApplication",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(t)}).then(function(e){if("true"==e.status){var t=!1,o=!1,a={};if(void 0!==e.promoVOList&&null!==e.promoVOList&&""!==e.promoVOList?(o=!0,Array.isArray(e.promoVOList)||(e.promoVOList=[e.promoVOList]),a=e.promoVOList,CaseConnect.totalPromo=a.length):o=!1,void 0!==e.spotLightVOList&&null!==e.spotLightVOList&&""!==e.spotLightVOList?(Array.isArray(e.spotLightVOList)||(e.spotLightVOList=[e.spotLightVOList]),e.spotLightVOList,t=!0):t=!1,o){var s=Handlebars.getTemplate("dashboard-recommended")(e);$("#dashboard-promo-container").html(s)}if(t){var i=Handlebars.getTemplate("dashboard-resource-link")(e);$("#dashboard-right-container").show(),$("#dashboard-left-container").addClass("col-md-7 col-sm-7 col-xs-12").removeClass("col-md-12 col-sm-12 col-xs-12");$("#spotlight-content-container").html(i)}else $("#dashboard-right-container").hide(),$("#add-to-bookshelf").hide(),$(".pinning-block").css("width","6%"),$("#dashboard-left-container").addClass("col-md-12 col-sm-12 col-xs-12").removeClass("col-md-7 col-sm-7 col-xs-12");o?($(".dashboard-view-book-container").show(),o?($(".dashboard-view-recommend-container").show(),a.length>3?$(".dashboard-view-recommend-container").show():$(".dashboard-view-recommend-container").hide()):$(".dashboard-view-recommend-container").hide()):Utility.hideSpinner(),$("#page-loading-spinner").hide()}"false"==e.status&&(alertMessagesModal(e.responseJSON.errorMessg),Utility.hideSpinner()),sessionTimeOut()},function(e){alertMessagesModal(e.responseJSON.errorMessg),Utility.hideSpinner(),sessionTimeOut()})}function generateLstToken(e){var t="",o="";$("#promo-protected_"+o).attr("href",""),$("#promo-protected_"+o).attr("target",""),void 0!==e&&(t=e.currentTarget.getAttribute("protectedLink"),o=e.currentTarget.getAttribute("promoId"));var a={userVO:{userId:localStorage.getItem("userId")}};$.ajax({url:properties[properties.env]+"/manageLST/generateLSTAuthToken",type:"POST",contentType:"application/json",accept:"application/json",async:!1,data:JSON.stringify(a)}).then(function(e){if("true"==e.status){var o="";if(e.lstAuthToken)o=e.lstAuthToken,window.open("","_blank","",!1).location.href=t+"?lsttokenauth="+o+"&userid="+a.userVO.userId}},function(e){alertMessagesModal(e.responseJSON.errorMessg),Utility.hideSpinner(),sessionTimeOut()})}function downloadSpotlightFile(e){var t=map.sessionVO;$("#userId").val(map.userId),$("#userRole").val(map.userRole),$("#userRoleId").val(map.userRoleId),$("#appType").val(t.appType),$("#deviceType").val(t.deviceType),$("#deviceOS").val(t.deviceOS);var o=e.currentTarget.getAttribute("spotlightId");o=parseInt(o),$("#spotlightId").val(o),t.sessionAuthenticationToken||localStorage.getItem("sessionAuthenticationToken")&&(map.sessionVO.sessionAuthenticationToken=localStorage.getItem("sessionAuthenticationToken")),$("#sessionAuthenticationToken").val(localStorage.getItem("sessionAuthenticationToken")),document.getElementById("downloadFormSpotlight").action=properties[properties.env]+"/manageSpotLight/downloadSpotLightFile",$("#downloadFormSpotlight").submit()}function classInsightsTotalBookQuestion(){var e={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userActivityVO:{lastActivityCode:"CLASS_INSIGHT_GET_STUDY_DASHBOARD",pageNavigatingFrom:"class-insight",pageNavigatingTo:"",lastReadBookId:CaseConnect.currentBookId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},classVO:{bookId:CaseConnect.currentBookId}};$("#page-loading-spinner").show(),$.ajax({url:properties[properties.env]+"/manageClassWebService/getStudyDashBoardForTotalBook",type:"POST",contentType:"application/json",accept:"application/json",async:!1,data:JSON.stringify(e)}).then(function(e){var t;if("true"===e.status)if(void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),e.studyDashBoardVO){if(0!==e.studyDashBoardVO.bookLevelProgressList.length){t=e.studyDashBoardVO;var o=Handlebars.getTemplate("insights-student-total-result")(t);$("#insights-student-total-result").html(o);o=Handlebars.getTemplate("insights-pdf-total-result")(t);$("#insights-pdf-total-result").html(o),$("#page-loading-spinner").hide()}}else $("#page-loading-spinner").hide()},function(e){sessionAuthFails(e),sessionTimeOut(),alertMessagesModal(exceptionMsg.systemError)})}function checkClassComparison(){$("input#stud-class-comparison").prop("checked")?($(".stud-dashboard-class-data").show(),$("#comparisonContainer div.switch-label").html("CLASS COMPARISON - ON"),$("#comparisonContainer div.switch-user").show()):($("#comparisonContainer div.switch-label").html("CLASS COMPARISON - OFF"),$("#comparisonContainer div.switch-user").hide(),$(".stud-dashboard-class-data").hide())}Handlebars.registerHelper("containsVideoType",function(e){var t=e;return-1!==t.indexOf("BrightcoveExperience")||-1!==t.indexOf("brightcove")&&-1==t.indexOf("<video")?-1==t.indexOf("<div")?'<div class="brightcove-container-nodiv"><div style="position: relative; display: block; max-width: 100%;"><div style="padding-top: 56.25%;">'+t+"</div></div></div>":'<div class="brightcove-container">'+t+"</div>":-1!==t.indexOf("youtube")?'<div class="youtube-container">'+t+"</div>":-1!==t.indexOf("<video")?'<div class="htmlvideo-container"><div style="position: relative; display: block; max-width: 100%;"><div style="padding-top: 56.25%;">'+t+"</div></div></div>":void 0});var classInsightsQuestionResultCalled=!1;function getStudyDashBoardForClassInsight(){$("#page-loading-spinner").show(),setTimeout(function(){var e={userVO:{userId:map.userId,userRole:map.userRole,userRoleId:map.userRoleId,userActivityVO:{lastActivityCode:"CLASS_INSIGHT_GET_STUDY_DASHBOARD",pageNavigatingFrom:"class-insight",pageNavigatingTo:"",lastReadBookId:CaseConnect.currentBookId},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},classVO:{bookId:CaseConnect.currentBookId}};$.ajax({url:properties[properties.env]+"/manageClassWebService/getStudyDashBoardForClassInsight",type:"POST",contentType:"application/json",accept:"application/json",async:!1,data:JSON.stringify(e)}).then(function(e){if("true"===e.status){if(classInsightsQuestionResultCalled=!0,void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),e.studyDashBoardVO)if(e.studyDashBoardVO.bookLevelQuestionProgress){"object"==$.type(e.studyDashBoardVO.bookLevelQuestionProgress)&&(e.studyDashBoardVO.bookLevelQuestionProgress=[e.studyDashBoardVO.bookLevelQuestionProgress]);var t=e.studyDashBoardVO,o=e.studyDashBoardVO.bookLevelQuestionProgress,a=Handlebars.getTemplate("insights-student-total-question-result")(t);if($("#ques-resultsTab").html(a),o)for(var s=0;s<o.length;s++){"object"==$.type(o[s].loDetails)&&(o[s].loDetails=[o[s].loDetails]);var i=Handlebars.getTemplate("insights-learning-objective")(o[s]);if($("#dashboard-learning-obj-item_"+e.studyDashBoardVO.bookLevelQuestionProgress[s].chapterId).html(i),void 0!==o[s].loDetails)for(var n=o[s].loDetails.length,r=o[s].loDetails,l=0;l<n;l++){if(void 0!==r[l].mcqQuestioninLO){"object"==$.type(r[l].mcqQuestioninLO)&&(r[l].mcqQuestioninLO=[r[l].mcqQuestioninLO]);var d=Handlebars.getTemplate("insights-question-multichoice")(r[l]);$("#insights-multi-choice_"+r[l].learningObjId).html(d)}if(void 0!==r[l].fcQuestioninLO){"object"==$.type(r[l].fcQuestioninLO)&&(r[l].fcQuestioninLO=[r[l].fcQuestioninLO]);var c=Handlebars.getTemplate("insights-question-flashcard")(r[l]);$("#insights-flash-card_"+r[l].learningObjId).html(c)}if(void 0!==r[l].hypoDetailsinLO){"object"==$.type(r[l].hypoDetailsinLO)&&(r[l].hypoDetailsinLO=[r[l].hypoDetailsinLO]);var u=Handlebars.getTemplate("insights-question-shortAns")(r[l]);$("#insights-short-answer_"+r[l].learningObjId).html(u)}if(void 0!==r[l].essayQuestioninLO){"object"==$.type(r[l].essayQuestioninLO)&&(r[l].essayQuestioninLO=[r[l].essayQuestioninLO]);var p=Handlebars.getTemplate("insights-question-essay")(r[l]);$("#insights-essay_"+r[l].learningObjId).html(p)}if(void 0!==r[l].issueSpotQuestioninLO){"object"==$.type(r[l].issueSpotQuestioninLO)&&(r[l].issueSpotQuestioninLO=[r[l].issueSpotQuestioninLO]);var g=Handlebars.getTemplate("insights-question-issueSpot")(r[l]);$("#insights-issue-spotting_"+r[l].learningObjId).html(g)}}0!==$("#ques-resultsTab .question.padding0 br").length&&$("#ques-resultsTab .question.padding0 br").replaceWith(" "),$("#ques-resultsTab .question.padding0").find("p").addClass("ellipsis"),$("#ques-resultsTab .question.padding0").find("p").next("p, ol, ul, img").remove()}$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide();else $("#page-loading-spinner").hide();showHideAllLearningObjectiveStudQues("hide")}else $("#page-loading-spinner").hide()},function(e){sessionAuthFails(e),sessionTimeOut(),alertMessagesModal(exceptionMsg.systemError)})},200)}function showHideLearningObjectiveQuestion(e){$(window).width();var t=$(e);t.parent().find(">a:first").toggleClass("glyphicon-chevron-right").toggleClass("glyphicon-chevron-down"),t.parent().find(">a:first").hasClass("glyphicon-chevron-down")?t.parent().find(">a:first").attr("aria-label","Hide chapter details"):t.parent().find(">a:first").hasClass("glyphicon-chevron-right")&&t.parent().find(">a:first").attr("aria-label","View chapter details"),t.parent().next().children().slideToggle("slow",function(){parseInt($("#ques-resultsTab").css("height"));adjustLeftNavHeight()})}function showHideAllLearningObjectiveStudChap(e){$(window).width();"show"==e?($(".container-studinsights #studyDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-down"),$(".container-studinsights #studyDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-right"),$(".container-studinsights #studyDashBoard .faculty-class-materials a").addClass("glyphicon-chevron-down"),$(".container-studinsights #studyDashBoard .faculty-class-materials a").attr("aria-label","Hide chapter details"),$(".container-studinsights #studyDashBoard .learningObjectiveList").slideDown("slow",function(){var e=parseInt($("#studyDashBoard").css("height"))-60;$(".student-dashboard-table").height(e+"px"),$(".professor-dashboard-table-td").height(e+"px"),adjustLeftNavHeight()})):($(".container-studinsights #studyDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-right"),$(".container-studinsights #studyDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-down"),$(".container-studinsights #studyDashBoard .faculty-class-materials a").addClass("glyphicon-chevron-right"),$(".container-studinsights #studyDashBoard .faculty-class-materials a").attr("aria-label","View chapter details"),$(".container-studinsights #studyDashBoard .learningObjectiveList").slideUp("slow",function(){var e=parseInt($("#studyDashBoard").css("height"))-60;$(".student-dashboard-table").height(e+"px"),$(".professor-dashboard-table-td").height(e+"px"),adjustLeftNavHeight()}))}function showHideAllLearningObjectiveProfChap(e){$(window).width();"show"==e?($(".container-profinsights #studyDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-down"),$(".container-profinsights #studyDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-right"),$(".container-profinsights #studyDashBoard .faculty-class-materials a").addClass("glyphicon-chevron-right"),$(".container-profinsights #studyDashBoard .faculty-class-materials a").attr("aria-label","Hide chapter details"),$(".container-profinsights #studyDashBoard .learningObjectiveList").slideDown("slow",function(){var e=parseInt($("#studyDashBoard").css("height"))-60;$(".professor-dashboard-table").height(e+"px"),$(".professor-dashboard-table-td").height(e+"px"),adjustLeftNavHeight()})):($(".container-profinsights #studyDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-right"),$(".container-profinsights #studyDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-down"),$(".container-profinsights #studyDashBoard .faculty-class-materials a").addClass("glyphicon-chevron-down"),$(".container-profinsights #studyDashBoard .faculty-class-materials a").attr("aria-label","View chapter details"),$(".container-profinsights #studyDashBoard .learningObjectiveList").slideUp("slow",function(){var e=parseInt($("#studyDashBoard").css("height"))-60;$(".professor-dashboard-table").height(e+"px"),$(".professor-dashboard-table-td").height(e+"px"),adjustLeftNavHeight()}))}function tabChangeStudent(e,t){var o=$(e);$(".container-studinsights #titleContainer .titleTab").removeClass("tab-selected active"),o.addClass("tab-selected active"),"chapterTopic"==t?($(".container-studinsights #studyDashBoardContainer").show(),$(".container-studinsights #ques-resultsTab").hide(),showHideAllLearningObjectiveStudChap("hide")):"question"==t&&($(".container-studinsights #studyDashBoardContainer").hide(),$(".container-studinsights #ques-resultsTab").show(),classInsightsQuestionResultCalled||($("#page-loading-spinner").show(),getStudyDashBoardForClassInsight()),showHideAllLearningObjectiveStudQues("hide"))}function tabChangeProfessor(e,t){var o=$(e);$(".container-profinsights #titleContainer .titleTab").removeClass("tab-selected active"),o.addClass("tab-selected active"),"chapterTopic"==t?($(".container-profinsights #studyDashBoardContainer").show(),$(".container-profinsights #ques-resultsTab").hide(),showHideAllLearningObjectiveProfChap("hide")):"question"==t&&($(".container-profinsights #studyDashBoardContainer").hide(),$(".container-profinsights #ques-resultsTab").show(),showHideAllLearningObjectiveProfQues("hide"))}function showHideLOQues(e){$(window).width();var t=$(e);t.parent().find(">span:first").toggleClass("expand-lOQues").toggleClass("collapse-lOQues"),t.parent().find(">span:first").hasClass("collapse-lOQues")?(t.parent().find(">span:first").attr("aria-label","Hide questions"),t.parent().find(">span:first").toggleClass("glyphicon-chevron-right").toggleClass("glyphicon-chevron-down")):t.parent().find(">span:first").hasClass("expand-lOQues")&&(t.parent().find(">span:first").attr("aria-label","View questions"),t.parent().find(">span:first").toggleClass("glyphicon-chevron-right").toggleClass("glyphicon-chevron-down")),t.parent().next(".faculty-dashboard-learning-obj-ques").slideToggle("slow")}function showHideAllLearningObjectiveStudQues(e){$(window).width();"show"==e?($(".container-studinsights #ques-resultsDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-down"),$(".container-studinsights #ques-resultsDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-right"),$(".container-studinsights #ques-resultsDashBoard .faculty-class-materials a").addClass("glyphicon-chevron-down"),$(".container-studinsights #ques-resultsDashBoard .faculty-class-materials a").attr("aria-label","Hide chapter details"),$(".container-studinsights #ques-resultsDashBoard .learningObjectiveList").slideDown("slow",function(){$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("collapse-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("expand-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").addClass("expand-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").attr("aria-label","Hide questions"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("glyphicon-chevron-right"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("glyphicon-chevron-down"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").addClass("glyphicon-chevron-down"),$(this).find(".faculty-dashboard-learning-obj-ques").slideDown("slow")})):($(".container-studinsights #ques-resultsDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-right"),$(".container-studinsights #ques-resultsDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-down"),$(".container-studinsights #ques-resultsDashBoard .faculty-class-materials a").addClass("glyphicon-chevron-right"),$(".container-studinsights #ques-resultsDashBoard .faculty-class-materials a").attr("aria-label","View chapter details"),$(".container-studinsights #ques-resultsDashBoard .learningObjectiveList").slideUp("slow",function(){$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("expand-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("collapse-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").addClass("collapse-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").attr("aria-label","View questions"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("glyphicon-chevron-right"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("glyphicon-chevron-down"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").addClass("glyphicon-chevron-right"),$(this).find(".faculty-dashboard-learning-obj-ques").slideUp("slow")}))}function showHideAllLearningObjectiveProfQues(e){$(window).width();"show"==e?($(".container-profinsights #ques-resultsDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-down"),$(".container-profinsights #ques-resultsDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-right"),$(".container-profinsights #ques-resultsDashBoard .faculty-class-materials a").addClass("glyphicon-chevron-right"),$(".container-profinsights #ques-resultsDashBoard .faculty-class-materials a").attr("aria-label","Hide chapter details"),$(".container-profinsights #ques-resultsDashBoard .learningObjectiveList").slideDown("slow",function(){$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("collapse-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("expand-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").addClass("expand-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").attr("aria-label","Hide questions"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("glyphicon-chevron-right"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("glyphicon-chevron-down"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").addClass("glyphicon-chevron-down"),$(this).find(".faculty-dashboard-learning-obj-ques").slideDown("slow")})):($(".container-profinsights #ques-resultsDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-right"),$(".container-profinsights #ques-resultsDashBoard .faculty-class-materials a").removeClass("glyphicon-chevron-down"),$(".container-profinsights #ques-resultsDashBoard .faculty-class-materials a").addClass("glyphicon-chevron-down"),$(".container-profinsights #ques-resultsDashBoard .faculty-class-materials a").attr("aria-label","View chapter details"),$(".container-profinsights #ques-resultsDashBoard .learningObjectiveList").slideUp("slow",function(){$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("expand-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("collapse-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").addClass("collapse-lOQues"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").attr("aria-label","View questions"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("glyphicon-chevron-right"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").removeClass("glyphicon-chevron-down"),$(this).find(".faculty-dashboard-learning-obj span.glyphicon").addClass("glyphicon-chevron-right"),$(this).find(".faculty-dashboard-learning-obj-ques").slideUp("slow")}))}function convertPDFISSUE(){$("#pdf-download-delay-window").modal("show"),$("#pdfConverted").html(""),$("#pdfConverted").append("<h3 style='color: #181818;'>CASEBOOK<span style='font-weight:700;'>CONNECT</span></h3>"),$("#pdfConverted").append("<h3 style='color: #181818;'><div style='color: #181818;text-align: initial;font-family: arial;font-size: 18px;max-width: 375px;font-weight:650;min-width:100%'><i>"+$(".ereader-main-header-title").text()+" by "+CaseConnect.bookData.bookAuthor+"</i></div></h3>"),$("#pdfConverted").append('<h2 class="display-inline-block" style=""><div  style="font-size:29px!important; color:#333333!important; font-weight: 300;font-style: normal;font-family:"akzidenz-grotesk";>Study Dashboard</div></h2>'),$("#pdfConverted").append("<div id='totalResultImage' style='margin-bottom:5%'></div>"),$(".removeOnceExecuted").remove(),$("#pdfConverted").append('<div id="pdfVersion" class="col-xs-12 col-sm-12 col-md-12 col-lg-12 student-dashboard no-padding" style="margin-top:10px!important;">'+$("#xyz")[0].innerHTML+"</div>");var e=(new Date).getMonth(),t=(new Date).getFullYear(),o=(new Date).getDate(),a=localStorage.getItem("firstName")+" "+localStorage.getItem("lastName")+" | CasebookConnect.com | "+["January","February","March","April","May","June","July","August","September","October","November","December"][e]+" "+o+", "+t;$("#pdf-page-template").html('<div class="page-template" style="position: absolute;width: 100%;height: 100%;top: 0;left: 0;"><div class="header" style="position: absolute;top: 30px;left: 55px;text-align: left;font-size: 18px;">'+a+"</div></div>"),"Chapter/Topic Results"==$("#titleContainer .nav-link.titleTab.active")[0].text?$("#pdfConverted  #studyDashBoard .learningObjectiveList").slideDown("fast",function(){for(var e=$(".faculty-class-materials"),t=0;t<e.length;t++){var o=$(".faculty-class-materials"+t).height()+$(".learningObjectiveList"+t).height()+70;$("#pdfConverted #fetchBorderHeight"+t).children().css("height",o),$("#pdfConverted #totalTabHeight"+t).css("height",o),$("#pdfConverted .pdf-icons").show()}}):$("#pdfConverted #ques-resultsDashBoard .learningObjectiveList").slideDown("fast",function(){$(this).find(" .faculty-dashboard-learning-obj-ques").slideDown("fast")}),setTimeout(function(){$("#pdfConverted #insights-study-center, #pdfConverted .student-dashboard-separate, #pdfConverted .faculty-class-insights-explanatory-content, #pdfConverted #titleContainer, #pdfConverted #resultsPDF, #pdfConverted #filterContainer, #pdfConverted .faculty-class-insights-separator, #pdfConverted .faculty-dashboard-correct-percnt .glyphicon-ok-circle, #pdfConverted .faculty-dashboard-incorrect-percnt .glyphicon-remove-circle, #pdfConverted .pdf-hide, #pdfConverted .class-insights-question-type, #pdfConverted .tableHeaderToHide, #pdfConverted #studyDashBoard .faculty-class-materials a ,#pdfConverted #ques-resultsDashBoard .faculty-class-materials .faculty-dashboard-chapter-name a,#pdfConverted #insights-student-total-result, #pdfConverted .class-insights-enrolled-students,#pdfConverted .faculty-dashboard-partialCorrect-percnt,#pdfConverted .ques-showHide, #pdfConverted #ques-resultsDashBoard .faculty-dashboard-chapter-name a,#pdfConverted .faculty-dashboard-learning-obj span.glyphicon-chevron-down").hide(),$("#pdfConverted .learning-objective-chapter-title").removeClass("learning-objective-chapter-title"),$("#pdfConverted .class-insights-pdf-sub-title").show(),$("#pdfConverted .objective-progress .bar").addClass("pdf-green-class"),$("#pdfConverted .objective-progress .bar.graybar").addClass("pdf-gray-class"),$("#pdfConverted").show(),$("#pdfConverted #resultsPDF, #pdfConverted #insights-student-total-result").hide(),$("#pdfConverted #comparisonContainer").hide(),$("#pdfConverted .pdf-hide").hide(),$("#insights-pdf-total-result").show(),kendo.drawing.drawDOM("#insights-pdf-total-result").then(function(e){kendo.drawing.Surface.create($("#totalResultImage"),{type:"svg"}).draw(e),$("#insights-pdf-total-result").hide()}),kendo.drawing.drawDOM("#pdfConverted",{paperSize:"A4",margin:{top:"1cm",bottom:"1cm",right:"1cm",left:"1cm"},template:$("#pdf-page-template").html(),avoidLinks:!0,scale:.5,multiPage:!0,repeatHeaders:!0,keepTogether:".prevent-split"}).then(function(e){var t="";t="Chapter/Topic Results"==$("#titleContainer .nav-link.titleTab.active")[0].text?"Insight_ChapterTopicResult.pdf":"Insight_QuestionResult.pdf",kendo.drawing.pdf.saveAs(e,t),$("#pdf-download-delay-window").modal("hide"),document.close(),$("#pdfConverted").hide(),$("#pdfConverted").html("")})},500)}function saveEulaValidationStatus(e,t,o){if($(".popover").hide(),t){localStorage.setItem("eulaValidationCheck","false"),$("[eulaFlag='true']").attr("eulaFlag","false");"Student"!==localStorage.getItem("userType")?void 0!==e.currentTarget.getAttribute("thumbnailimagepath")&&null!==e.currentTarget.getAttribute("thumbnailimagepath")?void 0!==e.currentTarget.getAttribute("classid")&&null!==e.currentTarget.getAttribute("classid")?getClassDetails(e):goToCreateClassPage(e):"ConnectedQuiz"==e.currentTarget.getAttribute("booktype")?null!=o&&null!=o?connectQuizStudentLanding(o):connectQuizProfLanding(e):"PracticePerfect"==e.currentTarget.getAttribute("booktype")?ppLandingpage():checkExpiredOnclickOfBook(e):void 0!==e.currentTarget.getAttribute("thumbnailimagepath")&&null!==e.currentTarget.getAttribute("thumbnailimagepath")?void 0!==e.currentTarget.getAttribute("classid")&&null!==e.currentTarget.getAttribute("classid")?(insideEreader=!1,insideThemis=!1,insideThemisAdmin=!1,insideCQuizzing=!1,insidePracticePerfect=!1,$(window).trigger("resize")):Handler.student.goToStudentEnrollPage(e):"ConnectedQuiz"==e.currentTarget.getAttribute("booktype")?null!=o&&null!=o?connectQuizStudentLanding(o):connectQuizProfLanding(e):checkExpiredOnclickOfBook(e);var a={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),userActivityVO:{lastActivityCode:"BOOKSHELF_SAVE_USER_SETTINGS",pageNavigatingFrom:"BOOKSHELF",pageNavigatingTo:"BOOKSHELF"},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")},userSettingsVO:{userId:localStorage.getItem("userId")}}};$.ajax({url:properties[properties.env]+"/manageUserService/saveEulaFlagStatus",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(a)}).then(function(e){void 0!==e.sessionAuthenticationToken&&localStorage.setItem("sessionAuthenticationToken",e.sessionAuthenticationToken),localStorage.setItem("eulaValidationCheck","false"),$("[eulaFlag='true']").attr("eulaFlag","false"),sessionTimeOut()},function(e){sessionTimeOut(),sessionAuthFails(e),Utility.handleSessionAuthentication(e.responseJSON)?($("#page-loading-spinner").hide(),alertMessagesModal(e.responseJSON.errorMessg)):window.location=properties.ui_domain})}else welcomeTutorial(!0)}function studentEulaValidationOnClass(e){if(localStorage.setItem("eulaValidationCheck",e.currentTarget.getAttribute("eulaFlag")),"true"===localStorage.getItem("eulaValidationCheck")){if($("[rel=popover]").popover("hide"),map.overlay.fadeOut(200),e)var t=e.currentTarget.attributes;return $("#eula-validation-modal").modal("show"),$(t).each(function(){var e=this.name,t=this.value;$("#eula-validation-modal button").attr(e,t)}),$(".eula-text-container").load("endUserLisenceAggrement.html"),$("#eula-validation-modal button").removeAttr("id","class").removeAttr("style").attr({id:"btn-eula-accept",class:"btn btn-default popover-common-btn ereader-btn-custom-gradient",onClick:"saveEulaValidationStatus(event,true)"}),void e.stopPropagation(e)}}Handlebars.registerHelper("splitbars",function(e){return e.split("|||||")[1]}),Handlebars.registerHelper("incrementByOne",function(e){return parseInt(e)+1}),Handlebars.registerHelper("truncateText",function(e,t){return e.slice(0,parseInt(t))+"..."}),Handlebars.registerHelper("eachList",function(e,t){var o="";"object"==$.type(e)&&(e=[e]);for(var a=0,s=e.length;a<s;a++)o+=t.fn(e[a]);return o});var cumulativeReportList=[];function cqClassCumulativeReportService(e){$("#page-loading-spinner").show();var t=$(".semester-drpdwn option:selected").val(),o=[],a=e.currentTarget.getAttribute("cqclasstype"),s=e.currentTarget.getAttribute("className");localStorage.setItem("classNameReport",s);var n=e.currentTarget.getAttribute("semName");localStorage.setItem("semNameReport",n);var r=e.currentTarget.id,l=(e.currentTarget.getAttribute("totquizzes"),e.currentTarget.getAttribute("totalcompletedquizzes"));localStorage.setItem("totalcompletedquizzes",l);var d=0;if("true"===localStorage.getItem("cqassistantFlag"))for(d=$(".cQuizButtonsAssistants").find('[classId="'+r+'"]').length,i=0;i<d;i++){if("scheduled"!==(p=(u=$(".cQuizButtonsAssistants").find('[classId="'+r+'"]')[i]).firstElementChild.getAttribute("scheduleStatus"))&&"yet to schedule"!==p){var c={quizName:u.firstElementChild.innerText,quizIdentifier:u.firstElementChild.getAttribute("quiz-identifier"),quizStatus:u.firstElementChild.getAttribute("quizStatus")};o.push(c)}}else for(d=$(".cQuizButtons").find('[classId="'+r+'"]').length,i=0;i<d;i++){var u,p;if("scheduled"!==(p=(u=$(".cQuizButtons").find('[classId="'+r+'"]')[i]).firstElementChild.getAttribute("scheduleStatus"))&&"yet to schedule"!==p){c={quizName:u.firstElementChild.innerText,quizIdentifier:u.firstElementChild.getAttribute("quiz-identifier"),quizStatus:u.firstElementChild.getAttribute("quizStatus")};o.push(c)}}if(0===o.length)$("#page-loading-spinner").hide(),alertMessagesModal("None of your quizzes contain student results. Please assign your quizzes and try again after students have submitted.");else{localStorage.setItem("quizNameList",JSON.stringify(o));var g={userVO:{userId:localStorage.getItem("userId"),userRole:localStorage.getItem("userRole"),userRoleId:localStorage.getItem("userRoleId"),schoolId:localStorage.getItem("schoolId"),userActivityVO:{pageNavigatingFrom:"Bookshelf",pageNavigatingTo:"EReader",lastReadBookId:CaseConnect.currentBookId,lastReadPageNum:"",lastReadChapterId:"",lastReadSectionId:"",lastReadSubSectionId:"",lastReadParagraphId:"",lastViewedOutlineId:"",schoolId:localStorage.getItem("schoolId"),cqClassId:r,lastViewedCQSemesterId:t},sessionVO:{appType:CaseConnect.appType,deviceType:CaseConnect.deviceType,deviceOS:CaseConnect.deviceOS,deviceMacId:CaseConnect.deviceMacId,keepMeLoggedInFlag:CaseConnect.keepMeLoggedInFlag,browserName:CaseConnect.browserName,sessionAuthenticationToken:localStorage.getItem("sessionAuthenticationToken")}},cqClassVO:{cqClassId:r}};"true"===localStorage.getItem("cqassistantFlag")?g.userVO.userActivityVO.lastActivityCode="CQ_STUDENT_DASHBOARD_PAGE":g.userVO.userActivityVO.lastActivityCode="CQ_PROFESSOR_DASHBOARD",$.ajax({url:properties[properties.env]+"/manageCQ/getCumulativeStudentReport",type:"POST",contentType:"application/json",accept:"application/json",data:JSON.stringify(g)}).then(function(e){if("true"===e.status){if(e.cqClassVO){"object"==$.type(e.cqClassVO)&&(e.cqClassVO=[e.cqClassVO]);var t=e.cqClassVO[0];if(t.averageClassScore){var o=Math.floor(100*t.averageClassScore)/100;localStorage.setItem("averageClassScore",o)}else localStorage.setItem("averageClassScore","0.00");if(t.avgStudentsCompleted){var s=parseInt(t.avgStudentsCompleted);localStorage.setItem("avgStudentsCompleted",s)}else localStorage.setItem("avgStudentsCompleted","0");t.totalStudents?localStorage.setItem("totalStudents",t.totalStudents):localStorage.setItem("totalStudents","0")}else localStorage.setItem("averageClassScore","0.00"),localStorage.setItem("avgStudentsCompleted","0"),localStorage.setItem("totalStudents","0");if(e.cqResultVOList){"object"==$.type(e.cqResultVOList)&&(e.cqResultVOList=[e.cqResultVOList]);for(var i=0;i<e.cqResultVOList.length;i++)"object"==$.type(e.cqResultVOList[i].qpQuizVOList)&&(e.cqResultVOList[i].qpQuizVOList=[e.cqResultVOList[i].qpQuizVOList]);cumulativeReportList=e.cqResultVOList,cqClassCumulativeReportDownload(a)}else cumulativeReportList=[],cqClassCumulativeReportDownload(a);$("#page-loading-spinner").hide()}else $("#page-loading-spinner").hide()},function(e){alertMessagesModal(e.responseJSON.errorMessg),$("#page-loading-spinner").hide()})}}function cqClassCumulativeReportDownload(e){for(var t={color:"#000000",size:1},o=JSON.parse(localStorage.getItem("quizNameList")),a=moment(Date()).format("MM/DD/YYYY hh:mm A"),s=new kendo.data.DataSource({type:"odata",schema:{model:{fields:{StringVal:{type:"string"},Numbering:{type:"number"}}}}}),i=[{cells:[{value:"Professor Name",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{value:localStorage.getItem("firstName")+" "+localStorage.getItem("lastName"),hAlign:"left",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{},{value:"Total Enrolled Students",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{value:parseInt(localStorage.getItem("totalStudents")),borderBottom:t,borderLeft:t,hAlign:"left",borderRight:t,borderTop:t}]},{cells:[{value:"Institution",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{value:localStorage.getItem("schoolName"),borderBottom:t,borderLeft:t,hAlign:"left",borderRight:t,borderTop:t},{},{value:"Total Completed Quizzes",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{value:parseInt(localStorage.getItem("totalcompletedquizzes")),borderBottom:t,borderLeft:t,borderRight:t,borderTop:t,hAlign:"left"}]},{cells:[{value:"Semester",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{value:localStorage.getItem("semNameReport"),borderBottom:t,borderLeft:t,hAlign:"left",borderRight:t,borderTop:t},{},{value:"Average % of Students Completing each Quiz",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{value:parseInt(localStorage.getItem("avgStudentsCompleted")),hAlign:"left",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t}]},{cells:[{value:"Class Name",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{value:localStorage.getItem("classNameReport"),hAlign:"left",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{},{value:"Average Score (%)",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{value:parseFloat(localStorage.getItem("averageClassScore")),hAlign:"left",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t}]},{cells:[{value:"Date Report Generated",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t},{value:a,hAlign:"left",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t}]},{cells:[{},{}]},"anonymous"===e?{cells:[{value:"Student ID",hAlign:"center",borderBottom:t,borderLeft:t,borderTop:t},{value:"Average Score",hAlign:"center",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t,bold:!0}]}:{cells:[{value:"Last Name",hAlign:"center",borderBottom:t,borderLeft:t,borderTop:t,bold:!0},{value:"First Name",hAlign:"center",borderBottom:t,borderLeft:t,borderTop:t,bold:!0},{value:"Average Score",hAlign:"center",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t,bold:!0}]}],n=0;n<o.length;n++)i[i.length-1].cells.push({value:o[n].quizName+" Score",hAlign:"center",borderBottom:t,borderLeft:t,borderRight:t,borderTop:t,bold:!0,wrap:!0});s.fetch(function(){var t=cumulativeReportList;for(var a in t)if(t[a].qpQuizVOList)for(var s in"object"==$.type(t[a].qpQuizVOList)&&(t[a].qpQuizVOList=[t[a].qpQuizVOList]),t[a].qpQuizVOList)for(var n in o)if(t[a].qpQuizVOList.some(e=>e.qpQuizIdentifier===o[n].quizIdentifier));else{if("scheduled"===o[n].quizStatus||"active"===o[n].quizStatus)var r={qpQuizName:o[n].quizName,qpQuizIdentifier:o[n].quizIdentifier,score:"N/A"};else r={qpQuizName:o[n].quizName,qpQuizIdentifier:o[n].quizIdentifier,score:parseFloat("0.00")};t[a].qpQuizVOList.push(r)}else for(var l in t[a].qpQuizVOList=[],o){if("scheduled"===o[l].quizStatus||"active"===o[l].quizStatus)r={qpQuizName:o[l].quizName,qpQuizIdentifier:o[l].quizIdentifier,score:"N/A"};else r={qpQuizName:o[l].quizName,qpQuizIdentifier:o[l].quizIdentifier,score:parseFloat("0.00")};t[a].qpQuizVOList.push(r)}for(j=0;j<t.length;j++)if("anonymous"===e){if(void 0!==t[j].firstName){if(t[j].avgScore?i.push({cells:[{value:t[j].firstName,hAlign:"center"},{value:Math.floor(100*t[j].avgScore)/100,hAlign:"center"}]}):i.push({cells:[{value:t[j].firstName,hAlign:"center"},{value:parseFloat("0.00"),hAlign:"center"}]}),t[j].qpQuizVOList){"object"==$.type(t[j].qpQuizVOList)&&(t[j].qpQuizVOList=[t[j].qpQuizVOList]);var d=0,c=0;for(d=0;d<o.length;d++)for(c=0;c<t[j].qpQuizVOList.length;c++)o[d].quizIdentifier===t[j].qpQuizVOList[c].qpQuizIdentifier&&("N/A"!==t[j].qpQuizVOList[c].score?i[i.length-1].cells.push({value:Math.floor(100*t[j].qpQuizVOList[c].score)/100,hAlign:"center"}):i[i.length-1].cells.push({value:t[j].qpQuizVOList[c].score,hAlign:"center"}))}}else if(t[j].avgScore?i.push({cells:[{value:"Student has not entered ID",hAlign:"center"},{value:Math.floor(100*t[j].avgScore)/100,hAlign:"center"}]}):i.push({cells:[{value:"Student has not entered ID",hAlign:"center"},{value:parseFloat("0.00"),hAlign:"center"}]}),t[j].qpQuizVOList){"object"==$.type(t[j].qpQuizVOList)&&(t[j].qpQuizVOList=[t[j].qpQuizVOList]);var u=0,p=0;for(u=0;u<o.length;u++)for(p=0;p<t[j].qpQuizVOList.length;p++)o[u].quizIdentifier===t[j].qpQuizVOList[p].qpQuizIdentifier&&("N/A"!==t[j].qpQuizVOList[p].score?i[i.length-1].cells.push({value:Math.floor(100*t[j].qpQuizVOList[p].score)/100,hAlign:"center"}):i[i.length-1].cells.push({value:t[j].qpQuizVOList[p].score,hAlign:"center"}))}}else if(t[j].avgScore?i.push({cells:[{value:t[j].lastName,hAlign:"center"},{value:t[j].firstName,hAlign:"center"},{value:Math.floor(100*t[j].avgScore)/100,hAlign:"center"}]}):i.push({cells:[{value:t[j].lastName,hAlign:"center"},{value:t[j].firstName,hAlign:"center"},{value:parseFloat("0.00"),hAlign:"center"}]}),t[j].qpQuizVOList){"object"==$.type(t[j].qpQuizVOList)&&(t[j].qpQuizVOList=[t[j].qpQuizVOList]);var g=0,h=0;for(g=0;g<o.length;g++)for(h=0;h<t[j].qpQuizVOList.length;h++)o[g].quizIdentifier===t[j].qpQuizVOList[h].qpQuizIdentifier&&("N/A"!==t[j].qpQuizVOList[h].score?i[i.length-1].cells.push({value:Math.floor(100*t[j].qpQuizVOList[h].score)/100,hAlign:"center"}):i[i.length-1].cells.push({value:t[j].qpQuizVOList[h].score,hAlign:"center"}))}var m=new kendo.ooxml.Workbook({sheets:[{columns:[{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0},{autoWidth:!0}],title:"Class Results",rows:i}]});kendo.saveAs({dataURI:m.toDataURL(),fileName:localStorage.getItem("lastName")+"_"+localStorage.getItem("classNameReport")+".xlsx"})})}Handlebars.registerHelper("JSON2string",function(e){return JSON.stringify(e)});